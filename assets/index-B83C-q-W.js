(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function nT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var sw={exports:{}},x1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OP;function SX(){if(OP)return x1;OP=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var o=null;if(s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),"key"in r){s={};for(var a in r)a!=="key"&&(s[a]=r[a])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:o,ref:r!==void 0?r:null,props:s}}return x1.Fragment=e,x1.jsx=t,x1.jsxs=t,x1}var IP;function TX(){return IP||(IP=1,sw.exports=SX()),sw.exports}var rs=TX(),ow={exports:{}},si={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BP;function EX(){if(BP)return si;BP=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function _(ne){return ne===null||typeof ne!="object"?null:(ne=d&&ne[d]||ne["@@iterator"],typeof ne=="function"?ne:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,R={};function E(ne,ye,ve){this.props=ne,this.context=ye,this.refs=R,this.updater=ve||x}E.prototype.isReactComponent={},E.prototype.setState=function(ne,ye){if(typeof ne!="object"&&typeof ne!="function"&&ne!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ne,ye,"setState")},E.prototype.forceUpdate=function(ne){this.updater.enqueueForceUpdate(this,ne,"forceUpdate")};function w(){}w.prototype=E.prototype;function L(ne,ye,ve){this.props=ne,this.context=ye,this.refs=R,this.updater=ve||x}var D=L.prototype=new w;D.constructor=L,b(D,E.prototype),D.isPureReactComponent=!0;var O=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},G=Object.prototype.hasOwnProperty;function k(ne,ye,ve,Pe,Se,Fe){return ve=Fe.ref,{$$typeof:i,type:ne,key:ye,ref:ve!==void 0?ve:null,props:Fe}}function z(ne,ye){return k(ne.type,ye,void 0,void 0,void 0,ne.props)}function F(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===i}function q(ne){var ye={"=":"=0",":":"=2"};return"$"+ne.replace(/[=:]/g,function(ve){return ye[ve]})}var H=/\/+/g;function Q(ne,ye){return typeof ne=="object"&&ne!==null&&ne.key!=null?q(""+ne.key):ye.toString(36)}function K(){}function se(ne){switch(ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason;default:switch(typeof ne.status=="string"?ne.then(K,K):(ne.status="pending",ne.then(function(ye){ne.status==="pending"&&(ne.status="fulfilled",ne.value=ye)},function(ye){ne.status==="pending"&&(ne.status="rejected",ne.reason=ye)})),ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason}}throw ne}function ee(ne,ye,ve,Pe,Se){var Fe=typeof ne;(Fe==="undefined"||Fe==="boolean")&&(ne=null);var Ye=!1;if(ne===null)Ye=!0;else switch(Fe){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(ne.$$typeof){case i:case e:Ye=!0;break;case h:return Ye=ne._init,ee(Ye(ne._payload),ye,ve,Pe,Se)}}if(Ye)return Se=Se(ne),Ye=Pe===""?"."+Q(ne,0):Pe,O(Se)?(ve="",Ye!=null&&(ve=Ye.replace(H,"$&/")+"/"),ee(Se,ye,ve,"",function(Gt){return Gt})):Se!=null&&(F(Se)&&(Se=z(Se,ve+(Se.key==null||ne&&ne.key===Se.key?"":(""+Se.key).replace(H,"$&/")+"/")+Ye)),ye.push(Se)),1;Ye=0;var at=Pe===""?".":Pe+":";if(O(ne))for(var At=0;At<ne.length;At++)Pe=ne[At],Fe=at+Q(Pe,At),Ye+=ee(Pe,ye,ve,Fe,Se);else if(At=_(ne),typeof At=="function")for(ne=At.call(ne),At=0;!(Pe=ne.next()).done;)Pe=Pe.value,Fe=at+Q(Pe,At++),Ye+=ee(Pe,ye,ve,Fe,Se);else if(Fe==="object"){if(typeof ne.then=="function")return ee(se(ne),ye,ve,Pe,Se);throw ye=String(ne),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(ne).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function $(ne,ye,ve){if(ne==null)return ne;var Pe=[],Se=0;return ee(ne,Pe,"","",function(Fe){return ye.call(ve,Fe,Se++)}),Pe}function re(ne){if(ne._status===-1){var ye=ne._result;ye=ye(),ye.then(function(ve){(ne._status===0||ne._status===-1)&&(ne._status=1,ne._result=ve)},function(ve){(ne._status===0||ne._status===-1)&&(ne._status=2,ne._result=ve)}),ne._status===-1&&(ne._status=0,ne._result=ye)}if(ne._status===1)return ne._result.default;throw ne._result}var ae=typeof reportError=="function"?reportError:function(ne){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ye=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ne=="object"&&ne!==null&&typeof ne.message=="string"?String(ne.message):String(ne),error:ne});if(!window.dispatchEvent(ye))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ne);return}console.error(ne)};function _e(){}return si.Children={map:$,forEach:function(ne,ye,ve){$(ne,function(){ye.apply(this,arguments)},ve)},count:function(ne){var ye=0;return $(ne,function(){ye++}),ye},toArray:function(ne){return $(ne,function(ye){return ye})||[]},only:function(ne){if(!F(ne))throw Error("React.Children.only expected to receive a single React element child.");return ne}},si.Component=E,si.Fragment=t,si.Profiler=r,si.PureComponent=L,si.StrictMode=n,si.Suspense=l,si.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,si.__COMPILER_RUNTIME={__proto__:null,c:function(ne){return B.H.useMemoCache(ne)}},si.cache=function(ne){return function(){return ne.apply(null,arguments)}},si.cloneElement=function(ne,ye,ve){if(ne==null)throw Error("The argument must be a React element, but you passed "+ne+".");var Pe=b({},ne.props),Se=ne.key,Fe=void 0;if(ye!=null)for(Ye in ye.ref!==void 0&&(Fe=void 0),ye.key!==void 0&&(Se=""+ye.key),ye)!G.call(ye,Ye)||Ye==="key"||Ye==="__self"||Ye==="__source"||Ye==="ref"&&ye.ref===void 0||(Pe[Ye]=ye[Ye]);var Ye=arguments.length-2;if(Ye===1)Pe.children=ve;else if(1<Ye){for(var at=Array(Ye),At=0;At<Ye;At++)at[At]=arguments[At+2];Pe.children=at}return k(ne.type,Se,void 0,void 0,Fe,Pe)},si.createContext=function(ne){return ne={$$typeof:o,_currentValue:ne,_currentValue2:ne,_threadCount:0,Provider:null,Consumer:null},ne.Provider=ne,ne.Consumer={$$typeof:s,_context:ne},ne},si.createElement=function(ne,ye,ve){var Pe,Se={},Fe=null;if(ye!=null)for(Pe in ye.key!==void 0&&(Fe=""+ye.key),ye)G.call(ye,Pe)&&Pe!=="key"&&Pe!=="__self"&&Pe!=="__source"&&(Se[Pe]=ye[Pe]);var Ye=arguments.length-2;if(Ye===1)Se.children=ve;else if(1<Ye){for(var at=Array(Ye),At=0;At<Ye;At++)at[At]=arguments[At+2];Se.children=at}if(ne&&ne.defaultProps)for(Pe in Ye=ne.defaultProps,Ye)Se[Pe]===void 0&&(Se[Pe]=Ye[Pe]);return k(ne,Fe,void 0,void 0,null,Se)},si.createRef=function(){return{current:null}},si.forwardRef=function(ne){return{$$typeof:a,render:ne}},si.isValidElement=F,si.lazy=function(ne){return{$$typeof:h,_payload:{_status:-1,_result:ne},_init:re}},si.memo=function(ne,ye){return{$$typeof:u,type:ne,compare:ye===void 0?null:ye}},si.startTransition=function(ne){var ye=B.T,ve={};B.T=ve;try{var Pe=ne(),Se=B.S;Se!==null&&Se(ve,Pe),typeof Pe=="object"&&Pe!==null&&typeof Pe.then=="function"&&Pe.then(_e,ae)}catch(Fe){ae(Fe)}finally{B.T=ye}},si.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},si.use=function(ne){return B.H.use(ne)},si.useActionState=function(ne,ye,ve){return B.H.useActionState(ne,ye,ve)},si.useCallback=function(ne,ye){return B.H.useCallback(ne,ye)},si.useContext=function(ne){return B.H.useContext(ne)},si.useDebugValue=function(){},si.useDeferredValue=function(ne,ye){return B.H.useDeferredValue(ne,ye)},si.useEffect=function(ne,ye,ve){var Pe=B.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Pe.useEffect(ne,ye)},si.useId=function(){return B.H.useId()},si.useImperativeHandle=function(ne,ye,ve){return B.H.useImperativeHandle(ne,ye,ve)},si.useInsertionEffect=function(ne,ye){return B.H.useInsertionEffect(ne,ye)},si.useLayoutEffect=function(ne,ye){return B.H.useLayoutEffect(ne,ye)},si.useMemo=function(ne,ye){return B.H.useMemo(ne,ye)},si.useOptimistic=function(ne,ye){return B.H.useOptimistic(ne,ye)},si.useReducer=function(ne,ye,ve){return B.H.useReducer(ne,ye,ve)},si.useRef=function(ne){return B.H.useRef(ne)},si.useState=function(ne){return B.H.useState(ne)},si.useSyncExternalStore=function(ne,ye,ve){return B.H.useSyncExternalStore(ne,ye,ve)},si.useTransition=function(){return B.H.useTransition()},si.version="19.1.0",si}var UP;function D4(){return UP||(UP=1,ow.exports=EX()),ow.exports}var On=D4();const wX=nT(On);var aw={exports:{}},b1={},lw={exports:{}},uw={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FP;function MX(){return FP||(FP=1,function(i){function e($,re){var ae=$.length;$.push(re);e:for(;0<ae;){var _e=ae-1>>>1,ne=$[_e];if(0<r(ne,re))$[_e]=re,$[ae]=ne,ae=_e;else break e}}function t($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var re=$[0],ae=$.pop();if(ae!==re){$[0]=ae;e:for(var _e=0,ne=$.length,ye=ne>>>1;_e<ye;){var ve=2*(_e+1)-1,Pe=$[ve],Se=ve+1,Fe=$[Se];if(0>r(Pe,ae))Se<ne&&0>r(Fe,Pe)?($[_e]=Fe,$[Se]=ae,_e=Se):($[_e]=Pe,$[ve]=ae,_e=ve);else if(Se<ne&&0>r(Fe,ae))$[_e]=Fe,$[Se]=ae,_e=Se;else break e}}return re}function r($,re){var ae=$.sortIndex-re.sortIndex;return ae!==0?ae:$.id-re.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,d=null,_=3,x=!1,b=!1,R=!1,E=!1,w=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O($){for(var re=t(u);re!==null;){if(re.callback===null)n(u);else if(re.startTime<=$)n(u),re.sortIndex=re.expirationTime,e(l,re);else break;re=t(u)}}function B($){if(R=!1,O($),!b)if(t(l)!==null)b=!0,G||(G=!0,Q());else{var re=t(u);re!==null&&ee(B,re.startTime-$)}}var G=!1,k=-1,z=5,F=-1;function q(){return E?!0:!(i.unstable_now()-F<z)}function H(){if(E=!1,G){var $=i.unstable_now();F=$;var re=!0;try{e:{b=!1,R&&(R=!1,L(k),k=-1),x=!0;var ae=_;try{t:{for(O($),d=t(l);d!==null&&!(d.expirationTime>$&&q());){var _e=d.callback;if(typeof _e=="function"){d.callback=null,_=d.priorityLevel;var ne=_e(d.expirationTime<=$);if($=i.unstable_now(),typeof ne=="function"){d.callback=ne,O($),re=!0;break t}d===t(l)&&n(l),O($)}else n(l);d=t(l)}if(d!==null)re=!0;else{var ye=t(u);ye!==null&&ee(B,ye.startTime-$),re=!1}}break e}finally{d=null,_=ae,x=!1}re=void 0}}finally{re?Q():G=!1}}}var Q;if(typeof D=="function")Q=function(){D(H)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,se=K.port2;K.port1.onmessage=H,Q=function(){se.postMessage(null)}}else Q=function(){w(H,0)};function ee($,re){k=w(function(){$(i.unstable_now())},re)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function($){$.callback=null},i.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<$?Math.floor(1e3/$):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function($){switch(_){case 1:case 2:case 3:var re=3;break;default:re=_}var ae=_;_=re;try{return $()}finally{_=ae}},i.unstable_requestPaint=function(){E=!0},i.unstable_runWithPriority=function($,re){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ae=_;_=$;try{return re()}finally{_=ae}},i.unstable_scheduleCallback=function($,re,ae){var _e=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?_e+ae:_e):ae=_e,$){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=ae+ne,$={id:h++,callback:re,priorityLevel:$,startTime:ae,expirationTime:ne,sortIndex:-1},ae>_e?($.sortIndex=ae,e(u,$),t(l)===null&&$===t(u)&&(R?(L(k),k=-1):R=!0,ee(B,ae-_e))):($.sortIndex=ne,e(l,$),b||x||(b=!0,G||(G=!0,Q()))),$},i.unstable_shouldYield=q,i.unstable_wrapCallback=function($){var re=_;return function(){var ae=_;_=re;try{return $.apply(this,arguments)}finally{_=ae}}}}(uw)),uw}var kP;function RX(){return kP||(kP=1,lw.exports=MX()),lw.exports}var cw={exports:{}},po={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GP;function CX(){if(GP)return po;GP=1;var i=D4();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(l,u,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:d==null?null:""+d,children:l,containerInfo:u,implementation:h}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return po.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,po.createPortal=function(l,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return s(l,u,null,h)},po.flushSync=function(l){var u=o.T,h=n.p;try{if(o.T=null,n.p=2,l)return l()}finally{o.T=u,n.p=h,n.d.f()}},po.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(l,u))},po.prefetchDNS=function(l){typeof l=="string"&&n.d.D(l)},po.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var h=u.as,d=a(h,u.crossOrigin),_=typeof u.integrity=="string"?u.integrity:void 0,x=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?n.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:d,integrity:_,fetchPriority:x}):h==="script"&&n.d.X(l,{crossOrigin:d,integrity:_,fetchPriority:x,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},po.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=a(u.as,u.crossOrigin);n.d.M(l,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(l)},po.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,d=a(h,u.crossOrigin);n.d.L(l,h,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},po.preloadModule=function(l,u){if(typeof l=="string")if(u){var h=a(u.as,u.crossOrigin);n.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(l)},po.requestFormReset=function(l){n.d.r(l)},po.unstable_batchedUpdates=function(l,u){return l(u)},po.useFormState=function(l,u,h){return o.H.useFormState(l,u,h)},po.useFormStatus=function(){return o.H.useHostTransitionStatus()},po.version="19.1.0",po}var zP;function NX(){if(zP)return cw.exports;zP=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),cw.exports=CX(),cw.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VP;function DX(){if(VP)return b1;VP=1;var i=RX(),e=D4(),t=NX();function n(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)f+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function s(c){var f=c,y=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(y=f.return),c=f.return;while(c)}return f.tag===3?y:null}function o(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function a(c){if(s(c)!==c)throw Error(n(188))}function l(c){var f=c.alternate;if(!f){if(f=s(c),f===null)throw Error(n(188));return f!==c?null:c}for(var y=c,T=f;;){var P=y.return;if(P===null)break;var U=P.alternate;if(U===null){if(T=P.return,T!==null){y=T;continue}break}if(P.child===U.child){for(U=P.child;U;){if(U===y)return a(P),c;if(U===T)return a(P),f;U=U.sibling}throw Error(n(188))}if(y.return!==T.return)y=P,T=U;else{for(var Y=!1,le=P.child;le;){if(le===y){Y=!0,y=P,T=U;break}if(le===T){Y=!0,T=P,y=U;break}le=le.sibling}if(!Y){for(le=U.child;le;){if(le===y){Y=!0,y=U,T=P;break}if(le===T){Y=!0,T=U,y=P;break}le=le.sibling}if(!Y)throw Error(n(189))}}if(y.alternate!==T)throw Error(n(190))}if(y.tag!==3)throw Error(n(188));return y.stateNode.current===y?c:f}function u(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c;for(c=c.child;c!==null;){if(f=u(c),f!==null)return f;c=c.sibling}return null}var h=Object.assign,d=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function Q(c){return c===null||typeof c!="object"?null:(c=H&&c[H]||c["@@iterator"],typeof c=="function"?c:null)}var K=Symbol.for("react.client.reference");function se(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===K?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case b:return"Fragment";case E:return"Profiler";case R:return"StrictMode";case B:return"Suspense";case G:return"SuspenseList";case F:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case x:return"Portal";case D:return(c.displayName||"Context")+".Provider";case L:return(c._context.displayName||"Context")+".Consumer";case O:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case k:return f=c.displayName||null,f!==null?f:se(c.type)||"Memo";case z:f=c._payload,c=c._init;try{return se(c(f))}catch{}}return null}var ee=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},_e=[],ne=-1;function ye(c){return{current:c}}function ve(c){0>ne||(c.current=_e[ne],_e[ne]=null,ne--)}function Pe(c,f){ne++,_e[ne]=c.current,c.current=f}var Se=ye(null),Fe=ye(null),Ye=ye(null),at=ye(null);function At(c,f){switch(Pe(Ye,f),Pe(Fe,c),Pe(Se,null),f.nodeType){case 9:case 11:c=(c=f.documentElement)&&(c=c.namespaceURI)?lP(c):0;break;default:if(c=f.tagName,f=f.namespaceURI)f=lP(f),c=uP(f,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}ve(Se),Pe(Se,c)}function Gt(){ve(Se),ve(Fe),ve(Ye)}function Dt(c){c.memoizedState!==null&&Pe(at,c);var f=Se.current,y=uP(f,c.type);f!==y&&(Pe(Fe,c),Pe(Se,y))}function Nn(c){Fe.current===c&&(ve(Se),ve(Fe)),at.current===c&&(ve(at),m1._currentValue=ae)}var bn=Object.prototype.hasOwnProperty,$t=i.unstable_scheduleCallback,he=i.unstable_cancelCallback,vt=i.unstable_shouldYield,ft=i.unstable_requestPaint,pt=i.unstable_now,et=i.unstable_getCurrentPriorityLevel,Ft=i.unstable_ImmediatePriority,Tt=i.unstable_UserBlockingPriority,Lt=i.unstable_NormalPriority,_n=i.unstable_LowPriority,pe=i.unstable_IdlePriority,ie=i.log,Ge=i.unstable_setDisableYieldValue,Qe=null,nt=null;function Ke(c){if(typeof ie=="function"&&Ge(c),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(Qe,c)}catch{}}var qt=Math.clz32?Math.clz32:nn,Bt=Math.log,Zt=Math.LN2;function nn(c){return c>>>=0,c===0?32:31-(Bt(c)/Zt|0)|0}var _t=256,jt=4194304;function un(c){var f=c&42;if(f!==0)return f;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function sn(c,f,y){var T=c.pendingLanes;if(T===0)return 0;var P=0,U=c.suspendedLanes,Y=c.pingedLanes;c=c.warmLanes;var le=T&134217727;return le!==0?(T=le&~U,T!==0?P=un(T):(Y&=le,Y!==0?P=un(Y):y||(y=le&~c,y!==0&&(P=un(y))))):(le=T&~U,le!==0?P=un(le):Y!==0?P=un(Y):y||(y=T&~c,y!==0&&(P=un(y)))),P===0?0:f!==0&&f!==P&&(f&U)===0&&(U=P&-P,y=f&-f,U>=y||U===32&&(y&4194048)!==0)?f:P}function It(c,f){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&f)===0}function Dn(c,f){switch(c){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fe(){var c=_t;return _t<<=1,(_t&4194048)===0&&(_t=256),c}function Ut(){var c=jt;return jt<<=1,(jt&62914560)===0&&(jt=4194304),c}function xt(c){for(var f=[],y=0;31>y;y++)f.push(c);return f}function Ht(c,f){c.pendingLanes|=f,f!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function Ct(c,f,y,T,P,U){var Y=c.pendingLanes;c.pendingLanes=y,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=y,c.entangledLanes&=y,c.errorRecoveryDisabledLanes&=y,c.shellSuspendCounter=0;var le=c.entanglements,xe=c.expirationTimes,qe=c.hiddenUpdates;for(y=Y&~y;0<y;){var ot=31-qt(y),mt=1<<ot;le[ot]=0,xe[ot]=-1;var Xe=qe[ot];if(Xe!==null)for(qe[ot]=null,ot=0;ot<Xe.length;ot++){var $e=Xe[ot];$e!==null&&($e.lane&=-536870913)}y&=~mt}T!==0&&ut(c,T,0),U!==0&&P===0&&c.tag!==0&&(c.suspendedLanes|=U&~(Y&~f))}function ut(c,f,y){c.pendingLanes|=f,c.suspendedLanes&=~f;var T=31-qt(f);c.entangledLanes|=f,c.entanglements[T]=c.entanglements[T]|1073741824|y&4194090}function kt(c,f){var y=c.entangledLanes|=f;for(c=c.entanglements;y;){var T=31-qt(y),P=1<<T;P&f|c[T]&f&&(c[T]|=f),y&=~P}}function hn(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function $n(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function Bn(){var c=re.p;return c!==0?c:(c=window.event,c===void 0?32:RP(c.type))}function Hi(c,f){var y=re.p;try{return re.p=c,f()}finally{re.p=y}}var Ti=Math.random().toString(36).slice(2),ke="__reactFiber$"+Ti,We="__reactProps$"+Ti,St="__reactContainer$"+Ti,rt="__reactEvents$"+Ti,p="__reactListeners$"+Ti,J="__reactHandles$"+Ti,ti="__reactResources$"+Ti,ci="__reactMarker$"+Ti;function hr(c){delete c[ke],delete c[We],delete c[rt],delete c[p],delete c[J]}function Tn(c){var f=c[ke];if(f)return f;for(var y=c.parentNode;y;){if(f=y[St]||y[ke]){if(y=f.alternate,f.child!==null||y!==null&&y.child!==null)for(c=dP(c);c!==null;){if(y=c[ke])return y;c=dP(c)}return f}c=y,y=c.parentNode}return null}function Zn(c){if(c=c[ke]||c[St]){var f=c.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return c}return null}function ho(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c.stateNode;throw Error(n(33))}function ri(c){var f=c[ti];return f||(f=c[ti]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function on(c){c[ci]=!0}var $s=new Set,Sc={};function kl(c,f){ue(c,f),ue(c+"Capture",f)}function ue(c,f){for(Sc[c]=f,c=0;c<f.length;c++)$s.add(f[c])}var De=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),je={},He={};function Ie(c){return bn.call(He,c)?!0:bn.call(je,c)?!1:De.test(c)?He[c]=!0:(je[c]=!0,!1)}function Nt(c,f,y){if(Ie(f))if(y===null)c.removeAttribute(f);else{switch(typeof y){case"undefined":case"function":case"symbol":c.removeAttribute(f);return;case"boolean":var T=f.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){c.removeAttribute(f);return}}c.setAttribute(f,""+y)}}function Ot(c,f,y){if(y===null)c.removeAttribute(f);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(f);return}c.setAttribute(f,""+y)}}function ct(c,f,y,T){if(T===null)c.removeAttribute(y);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(y);return}c.setAttributeNS(f,y,""+T)}}var te,Rt;function yn(c){if(te===void 0)try{throw Error()}catch(y){var f=y.stack.trim().match(/\n( *(at )?)/);te=f&&f[1]||"",Rt=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+c+Rt}var cn=!1;function ni(c,f){if(!c||cn)return"";cn=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(f){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch($e){var Xe=$e}Reflect.construct(c,[],mt)}else{try{mt.call()}catch($e){Xe=$e}c.call(mt.prototype)}}else{try{throw Error()}catch($e){Xe=$e}(mt=c())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch($e){if($e&&Xe&&typeof $e.stack=="string")return[$e.stack,Xe.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var U=T.DetermineComponentFrameRoot(),Y=U[0],le=U[1];if(Y&&le){var xe=Y.split(`
`),qe=le.split(`
`);for(P=T=0;T<xe.length&&!xe[T].includes("DetermineComponentFrameRoot");)T++;for(;P<qe.length&&!qe[P].includes("DetermineComponentFrameRoot");)P++;if(T===xe.length||P===qe.length)for(T=xe.length-1,P=qe.length-1;1<=T&&0<=P&&xe[T]!==qe[P];)P--;for(;1<=T&&0<=P;T--,P--)if(xe[T]!==qe[P]){if(T!==1||P!==1)do if(T--,P--,0>P||xe[T]!==qe[P]){var ot=`
`+xe[T].replace(" at new "," at ");return c.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",c.displayName)),ot}while(1<=T&&0<=P);break}}}finally{cn=!1,Error.prepareStackTrace=y}return(y=c?c.displayName||c.name:"")?yn(y):""}function Pi(c){switch(c.tag){case 26:case 27:case 5:return yn(c.type);case 16:return yn("Lazy");case 13:return yn("Suspense");case 19:return yn("SuspenseList");case 0:case 15:return ni(c.type,!1);case 11:return ni(c.type.render,!1);case 1:return ni(c.type,!0);case 31:return yn("Activity");default:return""}}function fr(c){try{var f="";do f+=Pi(c),c=c.return;while(c);return f}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}function Z(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Li(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function vn(c){var f=Li(c)?"checked":"value",y=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),T=""+c[f];if(!c.hasOwnProperty(f)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var P=y.get,U=y.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return P.call(this)},set:function(Y){T=""+Y,U.call(this,Y)}}),Object.defineProperty(c,f,{enumerable:y.enumerable}),{getValue:function(){return T},setValue:function(Y){T=""+Y},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function Wi(c){c._valueTracker||(c._valueTracker=vn(c))}function mi(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var y=f.getValue(),T="";return c&&(T=Li(c)?c.checked?"true":"false":c.value),c=T,c!==y?(f.setValue(c),!0):!1}function ls(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var Su=/[\n"\\]/g;function Ji(c){return c.replace(Su,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function nl(c,f,y,T,P,U,Y,le){c.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?c.type=Y:c.removeAttribute("type"),f!=null?Y==="number"?(f===0&&c.value===""||c.value!=f)&&(c.value=""+Z(f)):c.value!==""+Z(f)&&(c.value=""+Z(f)):Y!=="submit"&&Y!=="reset"||c.removeAttribute("value"),f!=null?yr(c,Y,Z(f)):y!=null?yr(c,Y,Z(y)):T!=null&&c.removeAttribute("value"),P==null&&U!=null&&(c.defaultChecked=!!U),P!=null&&(c.checked=P&&typeof P!="function"&&typeof P!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?c.name=""+Z(le):c.removeAttribute("name")}function ji(c,f,y,T,P,U,Y,le){if(U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(c.type=U),f!=null||y!=null){if(!(U!=="submit"&&U!=="reset"||f!=null))return;y=y!=null?""+Z(y):"",f=f!=null?""+Z(f):y,le||f===c.value||(c.value=f),c.defaultValue=f}T=T??P,T=typeof T!="function"&&typeof T!="symbol"&&!!T,c.checked=le?c.checked:!!T,c.defaultChecked=!!T,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(c.name=Y)}function yr(c,f,y){f==="number"&&ls(c.ownerDocument)===c||c.defaultValue===""+y||(c.defaultValue=""+y)}function hi(c,f,y,T){if(c=c.options,f){f={};for(var P=0;P<y.length;P++)f["$"+y[P]]=!0;for(y=0;y<c.length;y++)P=f.hasOwnProperty("$"+c[y].value),c[y].selected!==P&&(c[y].selected=P),P&&T&&(c[y].defaultSelected=!0)}else{for(y=""+Z(y),f=null,P=0;P<c.length;P++){if(c[P].value===y){c[P].selected=!0,T&&(c[P].defaultSelected=!0);return}f!==null||c[P].disabled||(f=c[P])}f!==null&&(f.selected=!0)}}function Wr(c,f,y){if(f!=null&&(f=""+Z(f),f!==c.value&&(c.value=f),y==null)){c.defaultValue!==f&&(c.defaultValue=f);return}c.defaultValue=y!=null?""+Z(y):""}function vs(c,f,y,T){if(f==null){if(T!=null){if(y!=null)throw Error(n(92));if(ee(T)){if(1<T.length)throw Error(n(93));T=T[0]}y=T}y==null&&(y=""),f=y}y=Z(f),c.defaultValue=y,T=c.textContent,T===y&&T!==""&&T!==null&&(c.value=T)}function il(c,f){if(f){var y=c.firstChild;if(y&&y===c.lastChild&&y.nodeType===3){y.nodeValue=f;return}}c.textContent=f}var rl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function x2(c,f,y){var T=f.indexOf("--")===0;y==null||typeof y=="boolean"||y===""?T?c.setProperty(f,""):f==="float"?c.cssFloat="":c[f]="":T?c.setProperty(f,y):typeof y!="number"||y===0||rl.has(f)?f==="float"?c.cssFloat=y:c[f]=(""+y).trim():c[f]=y+"px"}function b2(c,f,y){if(f!=null&&typeof f!="object")throw Error(n(62));if(c=c.style,y!=null){for(var T in y)!y.hasOwnProperty(T)||f!=null&&f.hasOwnProperty(T)||(T.indexOf("--")===0?c.setProperty(T,""):T==="float"?c.cssFloat="":c[T]="");for(var P in f)T=f[P],f.hasOwnProperty(P)&&y[P]!==T&&x2(c,P,T)}else for(var U in f)f.hasOwnProperty(U)&&x2(c,U,f[U])}function vg(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yd(c){return xg.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}var bg=null;function Sg(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Hh=null,Tc=null;function o0(c){var f=Zn(c);if(f&&(c=f.stateNode)){var y=c[We]||null;e:switch(c=f.stateNode,f.type){case"input":if(nl(c,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name),f=y.name,y.type==="radio"&&f!=null){for(y=c;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll('input[name="'+Ji(""+f)+'"][type="radio"]'),f=0;f<y.length;f++){var T=y[f];if(T!==c&&T.form===c.form){var P=T[We]||null;if(!P)throw Error(n(90));nl(T,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(f=0;f<y.length;f++)T=y[f],T.form===c.form&&mi(T)}break e;case"textarea":Wr(c,y.value,y.defaultValue);break e;case"select":f=y.value,f!=null&&hi(c,!!y.multiple,f,!1)}}}var vd=!1;function S2(c,f,y){if(vd)return c(f,y);vd=!0;try{var T=c(f);return T}finally{if(vd=!1,(Hh!==null||Tc!==null)&&(dv(),Hh&&(f=Hh,c=Tc,Tc=Hh=null,o0(f),c)))for(f=0;f<c.length;f++)o0(c[f])}}function xd(c,f){var y=c.stateNode;if(y===null)return null;var T=y[We]||null;if(T===null)return null;y=T[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(c=c.type,T=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!T;break e;default:c=!1}if(c)return null;if(y&&typeof y!="function")throw Error(n(231,f,typeof y));return y}var Gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a0=!1;if(Gl)try{var bd={};Object.defineProperty(bd,"passive",{get:function(){a0=!0}}),window.addEventListener("test",bd,bd),window.removeEventListener("test",bd,bd)}catch{a0=!1}var sl=null,Sd=null,l0=null;function Tg(){if(l0)return l0;var c,f=Sd,y=f.length,T,P="value"in sl?sl.value:sl.textContent,U=P.length;for(c=0;c<y&&f[c]===P[c];c++);var Y=y-c;for(T=1;T<=Y&&f[y-T]===P[U-T];T++);return l0=P.slice(c,1<T?1-T:void 0)}function Td(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Ed(){return!0}function T2(){return!1}function fo(c){function f(y,T,P,U,Y){this._reactName=y,this._targetInst=P,this.type=T,this.nativeEvent=U,this.target=Y,this.currentTarget=null;for(var le in c)c.hasOwnProperty(le)&&(y=c[le],this[le]=y?y(U):U[le]);return this.isDefaultPrevented=(U.defaultPrevented!=null?U.defaultPrevented:U.returnValue===!1)?Ed:T2,this.isPropagationStopped=T2,this}return h(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=Ed)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=Ed)},persist:function(){},isPersistent:Ed}),f}var Ec={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},u0=fo(Ec),jr=h({},Ec,{view:0,detail:0}),wc=fo(jr),xs,wd,Wh,Mc=h({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wg,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Wh&&(Wh&&c.type==="mousemove"?(xs=c.screenX-Wh.screenX,wd=c.screenY-Wh.screenY):wd=xs=0,Wh=c),xs)},movementY:function(c){return"movementY"in c?c.movementY:wd}}),E2=fo(Mc),M3=h({},Mc,{dataTransfer:0}),R3=fo(M3),w2=h({},jr,{relatedTarget:0}),jh=fo(w2),Rc=h({},Ec,{animationName:0,elapsedTime:0,pseudoElement:0}),M2=fo(Rc),R2=h({},Ec,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),c0=fo(R2),Cc=h({},Ec,{data:0}),zl=fo(Cc),C2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Eg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C3(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=Eg[c])?!!f[c]:!1}function wg(){return C3}var D2=h({},jr,{key:function(c){if(c.key){var f=C2[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=Td(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?N2[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wg,charCode:function(c){return c.type==="keypress"?Td(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Td(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),N3=fo(D2),D3=h({},Mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P2=fo(D3),P3=h({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wg}),L3=fo(P3),O3=h({},Ec,{propertyName:0,elapsedTime:0,pseudoElement:0}),I3=fo(O3),B3=h({},Mc,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),h0=fo(B3),U3=h({},Ec,{newState:0,oldState:0}),F3=fo(U3),k3=[9,13,27,32],Nc=Gl&&"CompositionEvent"in window,Md=null;Gl&&"documentMode"in document&&(Md=document.documentMode);var Mg=Gl&&"TextEvent"in window&&!Md,Rg=Gl&&(!Nc||Md&&8<Md&&11>=Md),Dc=" ",L2=!1;function f0(c,f){switch(c){case"keyup":return k3.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cg(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Xh=!1;function O2(c,f){switch(c){case"compositionend":return Cg(f);case"keypress":return f.which!==32?null:(L2=!0,Dc);case"textInput":return c=f.data,c===Dc&&L2?null:c;default:return null}}function Ng(c,f){if(Xh)return c==="compositionend"||!Nc&&f0(c,f)?(c=Tg(),l0=Sd=sl=null,Xh=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Rg&&f.locale!=="ko"?null:f.data;default:return null}}var Dg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d0(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!Dg[c.type]:f==="textarea"}function $h(c,f,y,T){Hh?Tc?Tc.push(T):Tc=[T]:Hh=T,f=yv(f,"onChange"),0<f.length&&(y=new u0("onChange","change",null,y,T),c.push({event:y,listeners:f}))}var wi=null,Rd=null;function I2(c){iP(c,0)}function Cd(c){var f=ho(c);if(mi(f))return c}function B2(c,f){if(c==="change")return f}var U2=!1;if(Gl){var Pg;if(Gl){var Lg="oninput"in document;if(!Lg){var Ys=document.createElement("div");Ys.setAttribute("oninput","return;"),Lg=typeof Ys.oninput=="function"}Pg=Lg}else Pg=!1;U2=Pg&&(!document.documentMode||9<document.documentMode)}function A0(){wi&&(wi.detachEvent("onpropertychange",Tu),Rd=wi=null)}function Tu(c){if(c.propertyName==="value"&&Cd(Rd)){var f=[];$h(f,Rd,c,Sg(c)),S2(I2,f)}}function G3(c,f,y){c==="focusin"?(A0(),wi=f,Rd=y,wi.attachEvent("onpropertychange",Tu)):c==="focusout"&&A0()}function Og(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Cd(Rd)}function z3(c,f){if(c==="click")return Cd(f)}function Xo(c,f){if(c==="input"||c==="change")return Cd(f)}function Ig(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var Qs=typeof Object.is=="function"?Object.is:Ig;function ol(c,f){if(Qs(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var y=Object.keys(c),T=Object.keys(f);if(y.length!==T.length)return!1;for(T=0;T<y.length;T++){var P=y[T];if(!bn.call(f,P)||!Qs(c[P],f[P]))return!1}return!0}function Eu(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Pc(c,f){var y=Eu(c);c=0;for(var T;y;){if(y.nodeType===3){if(T=c+y.textContent.length,c<=f&&T>=f)return{node:y,offset:f-c};c=T}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=Eu(y)}}function F2(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?F2(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function Bg(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var f=ls(c.document);f instanceof c.HTMLIFrameElement;){try{var y=typeof f.contentWindow.location.href=="string"}catch{y=!1}if(y)c=f.contentWindow;else break;f=ls(c.document)}return f}function Ug(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}var Fg=Gl&&"documentMode"in document&&11>=document.documentMode,Yh=null,kg=null,Lc=null,p0=!1;function m0(c,f,y){var T=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;p0||Yh==null||Yh!==ls(T)||(T=Yh,"selectionStart"in T&&Ug(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Lc&&ol(Lc,T)||(Lc=T,T=yv(kg,"onSelect"),0<T.length&&(f=new u0("onSelect","select",null,f,y),c.push({event:f,listeners:T}),f.target=Yh)))}function wa(c,f){var y={};return y[c.toLowerCase()]=f.toLowerCase(),y["Webkit"+c]="webkit"+f,y["Moz"+c]="moz"+f,y}var Ma={animationend:wa("Animation","AnimationEnd"),animationiteration:wa("Animation","AnimationIteration"),animationstart:wa("Animation","AnimationStart"),transitionrun:wa("Transition","TransitionRun"),transitionstart:wa("Transition","TransitionStart"),transitioncancel:wa("Transition","TransitionCancel"),transitionend:wa("Transition","TransitionEnd")},Ks={},k2={};Gl&&(k2=document.createElement("div").style,"AnimationEvent"in window||(delete Ma.animationend.animation,delete Ma.animationiteration.animation,delete Ma.animationstart.animation),"TransitionEvent"in window||delete Ma.transitionend.transition);function Ra(c){if(Ks[c])return Ks[c];if(!Ma[c])return c;var f=Ma[c],y;for(y in f)if(f.hasOwnProperty(y)&&y in k2)return Ks[c]=f[y];return c}var G2=Ra("animationend"),z2=Ra("animationiteration"),V2=Ra("animationstart"),q2=Ra("transitionrun"),V3=Ra("transitionstart"),q3=Ra("transitioncancel"),H2=Ra("transitionend"),g0=new Map,_0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_0.push("scrollEnd");function Co(c,f){g0.set(c,f),kl(f,[c])}var W2=new WeakMap;function $o(c,f){if(typeof c=="object"&&c!==null){var y=W2.get(c);return y!==void 0?y:(f={value:c,source:f,stack:fr(f)},W2.set(c,f),f)}return{value:c,source:f,stack:fr(f)}}var Yo=[],Qh=0,Gg=0;function y0(){for(var c=Qh,f=Gg=Qh=0;f<c;){var y=Yo[f];Yo[f++]=null;var T=Yo[f];Yo[f++]=null;var P=Yo[f];Yo[f++]=null;var U=Yo[f];if(Yo[f++]=null,T!==null&&P!==null){var Y=T.pending;Y===null?P.next=P:(P.next=Y.next,Y.next=P),T.pending=P}U!==0&&zg(y,P,U)}}function v0(c,f,y,T){Yo[Qh++]=c,Yo[Qh++]=f,Yo[Qh++]=y,Yo[Qh++]=T,Gg|=T,c.lanes|=T,c=c.alternate,c!==null&&(c.lanes|=T)}function x0(c,f,y,T){return v0(c,f,y,T),Qo(c)}function Kh(c,f){return v0(c,null,null,f),Qo(c)}function zg(c,f,y){c.lanes|=y;var T=c.alternate;T!==null&&(T.lanes|=y);for(var P=!1,U=c.return;U!==null;)U.childLanes|=y,T=U.alternate,T!==null&&(T.childLanes|=y),U.tag===22&&(c=U.stateNode,c===null||c._visibility&1||(P=!0)),c=U,U=U.return;return c.tag===3?(U=c.stateNode,P&&f!==null&&(P=31-qt(y),c=U.hiddenUpdates,T=c[P],T===null?c[P]=[f]:T.push(f),f.lane=y|536870912),U):null}function Qo(c){if(50<l1)throw l1=0,CE=null,Error(n(185));for(var f=c.return;f!==null;)c=f,f=c.return;return c.tag===3?c.stateNode:null}var Oc={};function H3(c,f,y,T){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function No(c,f,y,T){return new H3(c,f,y,T)}function Vg(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Vl(c,f){var y=c.alternate;return y===null?(y=No(c.tag,f,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=f,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&65011712,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,f=c.dependencies,y.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y.refCleanup=c.refCleanup,y}function j2(c,f){c.flags&=65011714;var y=c.alternate;return y===null?(c.childLanes=0,c.lanes=f,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=y.childLanes,c.lanes=y.lanes,c.child=y.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=y.memoizedProps,c.memoizedState=y.memoizedState,c.updateQueue=y.updateQueue,c.type=y.type,f=y.dependencies,c.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),c}function Ca(c,f,y,T,P,U){var Y=0;if(T=c,typeof c=="function")Vg(c)&&(Y=1);else if(typeof c=="string")Y=cX(c,y,Se.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case F:return c=No(31,y,f,P),c.elementType=F,c.lanes=U,c;case b:return ql(y.children,P,U,f);case R:Y=8,P|=24;break;case E:return c=No(12,y,f,P|2),c.elementType=E,c.lanes=U,c;case B:return c=No(13,y,f,P),c.elementType=B,c.lanes=U,c;case G:return c=No(19,y,f,P),c.elementType=G,c.lanes=U,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case w:case D:Y=10;break e;case L:Y=9;break e;case O:Y=11;break e;case k:Y=14;break e;case z:Y=16,T=null;break e}Y=29,y=Error(n(130,c===null?"null":typeof c,"")),T=null}return f=No(Y,y,f,P),f.elementType=c,f.type=T,f.lanes=U,f}function ql(c,f,y,T){return c=No(7,c,T,f),c.lanes=y,c}function qg(c,f,y){return c=No(6,c,null,f),c.lanes=y,c}function Zh(c,f,y){return f=No(4,c.children!==null?c.children:[],c.key,f),f.lanes=y,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}var Ic=[],Jh=0,b0=null,wu=0,Do=[],Ls=0,Hl=null,Na=1,al="";function ll(c,f){Ic[Jh++]=wu,Ic[Jh++]=b0,b0=c,wu=f}function Hg(c,f,y){Do[Ls++]=Na,Do[Ls++]=al,Do[Ls++]=Hl,Hl=c;var T=Na;c=al;var P=32-qt(T)-1;T&=~(1<<P),y+=1;var U=32-qt(f)+P;if(30<U){var Y=P-P%5;U=(T&(1<<Y)-1).toString(32),T>>=Y,P-=Y,Na=1<<32-qt(f)+P|y<<P|T,al=U+c}else Na=1<<U|y<<P|T,al=c}function Wg(c){c.return!==null&&(ll(c,1),Hg(c,1,0))}function jg(c){for(;c===b0;)b0=Ic[--Jh],Ic[Jh]=null,wu=Ic[--Jh],Ic[Jh]=null;for(;c===Hl;)Hl=Do[--Ls],Do[Ls]=null,al=Do[--Ls],Do[Ls]=null,Na=Do[--Ls],Do[Ls]=null}var Zs=null,Nr=null,Ci=!1,Bc=null,ul=!1,Xg=Error(n(519));function Uc(c){var f=Error(n(418,""));throw Wl($o(f,c)),Xg}function $g(c){var f=c.stateNode,y=c.type,T=c.memoizedProps;switch(f[ke]=c,f[We]=T,y){case"dialog":_i("cancel",f),_i("close",f);break;case"iframe":case"object":case"embed":_i("load",f);break;case"video":case"audio":for(y=0;y<c1.length;y++)_i(c1[y],f);break;case"source":_i("error",f);break;case"img":case"image":case"link":_i("error",f),_i("load",f);break;case"details":_i("toggle",f);break;case"input":_i("invalid",f),ji(f,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0),Wi(f);break;case"select":_i("invalid",f);break;case"textarea":_i("invalid",f),vs(f,T.value,T.defaultValue,T.children),Wi(f)}y=T.children,typeof y!="string"&&typeof y!="number"&&typeof y!="bigint"||f.textContent===""+y||T.suppressHydrationWarning===!0||aP(f.textContent,y)?(T.popover!=null&&(_i("beforetoggle",f),_i("toggle",f)),T.onScroll!=null&&_i("scroll",f),T.onScrollEnd!=null&&_i("scrollend",f),T.onClick!=null&&(f.onclick=vv),f=!0):f=!1,f||Uc(c)}function Yg(c){for(Zs=c.return;Zs;)switch(Zs.tag){case 5:case 13:ul=!1;return;case 27:case 3:ul=!0;return;default:Zs=Zs.return}}function vr(c){if(c!==Zs)return!1;if(!Ci)return Yg(c),Ci=!0,!1;var f=c.tag,y;if((y=f!==3&&f!==27)&&((y=f===5)&&(y=c.type,y=!(y!=="form"&&y!=="button")||WE(c.type,c.memoizedProps)),y=!y),y&&Nr&&Uc(c),Yg(c),f===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(n(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8)if(y=c.data,y==="/$"){if(f===0){Nr=Ql(c.nextSibling);break e}f--}else y!=="$"&&y!=="$!"&&y!=="$?"||f++;c=c.nextSibling}Nr=null}}else f===27?(f=Nr,pf(c.type)?(c=YE,YE=null,Nr=c):Nr=f):Nr=Zs?Ql(c.stateNode.nextSibling):null;return!0}function Nd(){Nr=Zs=null,Ci=!1}function X2(){var c=Bc;return c!==null&&(ea===null?ea=c:ea.push.apply(ea,c),Bc=null),c}function Wl(c){Bc===null?Bc=[c]:Bc.push(c)}var Ao=ye(null),Fc=null,jl=null;function Mu(c,f,y){Pe(Ao,f._currentValue),f._currentValue=y}function cl(c){c._currentValue=Ao.current,ve(Ao)}function S0(c,f,y){for(;c!==null;){var T=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,T!==null&&(T.childLanes|=f)):T!==null&&(T.childLanes&f)!==f&&(T.childLanes|=f),c===y)break;c=c.return}}function T0(c,f,y,T){var P=c.child;for(P!==null&&(P.return=c);P!==null;){var U=P.dependencies;if(U!==null){var Y=P.child;U=U.firstContext;e:for(;U!==null;){var le=U;U=P;for(var xe=0;xe<f.length;xe++)if(le.context===f[xe]){U.lanes|=y,le=U.alternate,le!==null&&(le.lanes|=y),S0(U.return,y,c),T||(Y=null);break e}U=le.next}}else if(P.tag===18){if(Y=P.return,Y===null)throw Error(n(341));Y.lanes|=y,U=Y.alternate,U!==null&&(U.lanes|=y),S0(Y,y,c),Y=null}else Y=P.child;if(Y!==null)Y.return=P;else for(Y=P;Y!==null;){if(Y===c){Y=null;break}if(P=Y.sibling,P!==null){P.return=Y.return,Y=P;break}Y=Y.return}P=Y}}function ef(c,f,y,T){c=null;for(var P=f,U=!1;P!==null;){if(!U){if((P.flags&524288)!==0)U=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var Y=P.alternate;if(Y===null)throw Error(n(387));if(Y=Y.memoizedProps,Y!==null){var le=P.type;Qs(P.pendingProps.value,Y.value)||(c!==null?c.push(le):c=[le])}}else if(P===at.current){if(Y=P.alternate,Y===null)throw Error(n(387));Y.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(c!==null?c.push(m1):c=[m1])}P=P.return}c!==null&&T0(f,c,y,T),f.flags|=262144}function E0(c){for(c=c.firstContext;c!==null;){if(!Qs(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function kc(c){Fc=c,jl=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Os(c){return Xl(Fc,c)}function w0(c,f){return Fc===null&&kc(c),Xl(c,f)}function Xl(c,f){var y=f._currentValue;if(f={context:f,memoizedValue:y,next:null},jl===null){if(c===null)throw Error(n(308));jl=f,c.dependencies={lanes:0,firstContext:f},c.flags|=524288}else jl=jl.next=f;return y}var hl=typeof AbortController<"u"?AbortController:function(){var c=[],f=this.signal={aborted:!1,addEventListener:function(y,T){c.push(T)}};this.abort=function(){f.aborted=!0,c.forEach(function(y){return y()})}},xn=i.unstable_scheduleCallback,Ko=i.unstable_NormalPriority,Xt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ns(){return{controller:new hl,data:new Map,refCount:0}}function tf(c){c.refCount--,c.refCount===0&&xn(Ko,function(){c.controller.abort()})}var Gc=null,fl=0,nf=0,Ur=null;function rf(c,f){if(Gc===null){var y=Gc=[];fl=0,nf=BE(),Ur={status:"pending",value:void 0,then:function(T){y.push(T)}}}return fl++,f.then(zc,zc),f}function zc(){if(--fl===0&&Gc!==null){Ur!==null&&(Ur.status="fulfilled");var c=Gc;Gc=null,nf=0,Ur=null;for(var f=0;f<c.length;f++)(0,c[f])()}}function $2(c,f){var y=[],T={status:"pending",value:null,reason:null,then:function(P){y.push(P)}};return c.then(function(){T.status="fulfilled",T.value=f;for(var P=0;P<y.length;P++)(0,y[P])(f)},function(P){for(T.status="rejected",T.reason=P,P=0;P<y.length;P++)(0,y[P])(void 0)}),T}var gt=$.S;$.S=function(c,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&rf(c,f),gt!==null&&gt(c,f)};var wt=ye(null);function M0(){var c=wt.current;return c!==null?c:xr.pooledCache}function Dd(c,f){f===null?Pe(wt,wt.current):Pe(wt,f.pool)}function Pd(){var c=M0();return c===null?null:{parent:Xt._currentValue,pool:c}}var Ru=Error(n(460)),Vc=Error(n(474)),dl=Error(n(542)),R0={then:function(){}};function $l(c){return c=c.status,c==="fulfilled"||c==="rejected"}function A(){}function m(c,f,y){switch(y=c[y],y===void 0?c.push(f):y!==f&&(f.then(A,A),f=y),f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,S(c),c;default:if(typeof f.status=="string")f.then(A,A);else{if(c=xr,c!==null&&100<c.shellSuspendCounter)throw Error(n(482));c=f,c.status="pending",c.then(function(T){if(f.status==="pending"){var P=f;P.status="fulfilled",P.value=T}},function(T){if(f.status==="pending"){var P=f;P.status="rejected",P.reason=T}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,S(c),c}throw g=f,Ru}}var g=null;function v(){if(g===null)throw Error(n(459));var c=g;return g=null,c}function S(c){if(c===Ru||c===dl)throw Error(n(483))}var M=!1;function C(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function N(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function I(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function V(c,f,y){var T=c.updateQueue;if(T===null)return null;if(T=T.shared,(er&2)!==0){var P=T.pending;return P===null?f.next=f:(f.next=P.next,P.next=f),T.pending=f,f=Qo(c),zg(c,null,y),f}return v0(c,T,f,y),Qo(c)}function j(c,f,y){if(f=f.updateQueue,f!==null&&(f=f.shared,(y&4194048)!==0)){var T=f.lanes;T&=c.pendingLanes,y|=T,f.lanes=y,kt(c,y)}}function oe(c,f){var y=c.updateQueue,T=c.alternate;if(T!==null&&(T=T.updateQueue,y===T)){var P=null,U=null;if(y=y.firstBaseUpdate,y!==null){do{var Y={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};U===null?P=U=Y:U=U.next=Y,y=y.next}while(y!==null);U===null?P=U=f:U=U.next=f}else P=U=f;y={baseState:T.baseState,firstBaseUpdate:P,lastBaseUpdate:U,shared:T.shared,callbacks:T.callbacks},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=f:c.next=f,y.lastBaseUpdate=f}var ge=!1;function de(){if(ge){var c=Ur;if(c!==null)throw c}}function Ae(c,f,y,T){ge=!1;var P=c.updateQueue;M=!1;var U=P.firstBaseUpdate,Y=P.lastBaseUpdate,le=P.shared.pending;if(le!==null){P.shared.pending=null;var xe=le,qe=xe.next;xe.next=null,Y===null?U=qe:Y.next=qe,Y=xe;var ot=c.alternate;ot!==null&&(ot=ot.updateQueue,le=ot.lastBaseUpdate,le!==Y&&(le===null?ot.firstBaseUpdate=qe:le.next=qe,ot.lastBaseUpdate=xe))}if(U!==null){var mt=P.baseState;Y=0,ot=qe=xe=null,le=U;do{var Xe=le.lane&-536870913,$e=Xe!==le.lane;if($e?(Mi&Xe)===Xe:(T&Xe)===Xe){Xe!==0&&Xe===nf&&(ge=!0),ot!==null&&(ot=ot.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var Un=c,Mn=le;Xe=f;var or=y;switch(Mn.tag){case 1:if(Un=Mn.payload,typeof Un=="function"){mt=Un.call(or,mt,Xe);break e}mt=Un;break e;case 3:Un.flags=Un.flags&-65537|128;case 0:if(Un=Mn.payload,Xe=typeof Un=="function"?Un.call(or,mt,Xe):Un,Xe==null)break e;mt=h({},mt,Xe);break e;case 2:M=!0}}Xe=le.callback,Xe!==null&&(c.flags|=64,$e&&(c.flags|=8192),$e=P.callbacks,$e===null?P.callbacks=[Xe]:$e.push(Xe))}else $e={lane:Xe,tag:le.tag,payload:le.payload,callback:le.callback,next:null},ot===null?(qe=ot=$e,xe=mt):ot=ot.next=$e,Y|=Xe;if(le=le.next,le===null){if(le=P.shared.pending,le===null)break;$e=le,le=$e.next,$e.next=null,P.lastBaseUpdate=$e,P.shared.pending=null}}while(!0);ot===null&&(xe=mt),P.baseState=xe,P.firstBaseUpdate=qe,P.lastBaseUpdate=ot,U===null&&(P.shared.lanes=0),hf|=Y,c.lanes=Y,c.memoizedState=mt}}function Te(c,f){if(typeof c!="function")throw Error(n(191,c));c.call(f)}function Ne(c,f){var y=c.callbacks;if(y!==null)for(c.callbacks=null,c=0;c<y.length;c++)Te(y[c],f)}var Ve=ye(null),Be=ye(0);function Le(c,f){c=Yc,Pe(Be,c),Pe(Ve,f),Yc=c|f.baseLanes}function Ee(){Pe(Be,Yc),Pe(Ve,Ve.current)}function Mt(){Yc=Be.current,ve(Ve),ve(Be)}var Yt=0,yt=null,Wt=null,tn=null,Yn=!1,fn=!1,Kt=!1,Et=0,Ln=0,xi=null,kn=0;function wn(){throw Error(n(321))}function bs(c,f){if(f===null)return!1;for(var y=0;y<f.length&&y<c.length;y++)if(!Qs(c[y],f[y]))return!1;return!0}function C0(c,f,y,T,P,U){return Yt=U,yt=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,$.H=c===null||c.memoizedState===null?zN:VN,Kt=!1,U=y(T,P),Kt=!1,fn&&(U=oN(f,y,T,P)),sN(c),U}function sN(c){$.H=ev;var f=Wt!==null&&Wt.next!==null;if(Yt=0,tn=Wt=yt=null,Yn=!1,Ln=0,xi=null,f)throw Error(n(300));c===null||Is||(c=c.dependencies,c!==null&&E0(c)&&(Is=!0))}function oN(c,f,y,T){yt=c;var P=0;do{if(fn&&(xi=null),Ln=0,fn=!1,25<=P)throw Error(n(301));if(P+=1,tn=Wt=null,c.updateQueue!=null){var U=c.updateQueue;U.lastEffect=null,U.events=null,U.stores=null,U.memoCache!=null&&(U.memoCache.index=0)}$.H=xj,U=f(y,T)}while(fn);return U}function pj(){var c=$.H,f=c.useState()[0];return f=typeof f.then=="function"?Qg(f):f,c=c.useState()[0],(Wt!==null?Wt.memoizedState:null)!==c&&(yt.flags|=1024),f}function W3(){var c=Et!==0;return Et=0,c}function j3(c,f,y){f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~y}function X3(c){if(Yn){for(c=c.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}Yn=!1}Yt=0,tn=Wt=yt=null,fn=!1,Ln=Et=0,xi=null}function Zo(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tn===null?yt.memoizedState=tn=c:tn=tn.next=c,tn}function us(){if(Wt===null){var c=yt.alternate;c=c!==null?c.memoizedState:null}else c=Wt.next;var f=tn===null?yt.memoizedState:tn.next;if(f!==null)tn=f,Wt=c;else{if(c===null)throw yt.alternate===null?Error(n(467)):Error(n(310));Wt=c,c={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},tn===null?yt.memoizedState=tn=c:tn=tn.next=c}return tn}function $3(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qg(c){var f=Ln;return Ln+=1,xi===null&&(xi=[]),c=m(xi,c,f),f=yt,(tn===null?f.memoizedState:tn.next)===null&&(f=f.alternate,$.H=f===null||f.memoizedState===null?zN:VN),c}function Y2(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return Qg(c);if(c.$$typeof===D)return Os(c)}throw Error(n(438,String(c)))}function Y3(c){var f=null,y=yt.updateQueue;if(y!==null&&(f=y.memoCache),f==null){var T=yt.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(f={data:T.data.map(function(P){return P.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),y===null&&(y=$3(),yt.updateQueue=y),y.memoCache=f,y=f.data[f.index],y===void 0)for(y=f.data[f.index]=Array(c),T=0;T<c;T++)y[T]=q;return f.index++,y}function qc(c,f){return typeof f=="function"?f(c):f}function Q2(c){var f=us();return Q3(f,Wt,c)}function Q3(c,f,y){var T=c.queue;if(T===null)throw Error(n(311));T.lastRenderedReducer=y;var P=c.baseQueue,U=T.pending;if(U!==null){if(P!==null){var Y=P.next;P.next=U.next,U.next=Y}f.baseQueue=P=U,T.pending=null}if(U=c.baseState,P===null)c.memoizedState=U;else{f=P.next;var le=Y=null,xe=null,qe=f,ot=!1;do{var mt=qe.lane&-536870913;if(mt!==qe.lane?(Mi&mt)===mt:(Yt&mt)===mt){var Xe=qe.revertLane;if(Xe===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),mt===nf&&(ot=!0);else if((Yt&Xe)===Xe){qe=qe.next,Xe===nf&&(ot=!0);continue}else mt={lane:0,revertLane:qe.revertLane,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},xe===null?(le=xe=mt,Y=U):xe=xe.next=mt,yt.lanes|=Xe,hf|=Xe;mt=qe.action,Kt&&y(U,mt),U=qe.hasEagerState?qe.eagerState:y(U,mt)}else Xe={lane:mt,revertLane:qe.revertLane,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},xe===null?(le=xe=Xe,Y=U):xe=xe.next=Xe,yt.lanes|=mt,hf|=mt;qe=qe.next}while(qe!==null&&qe!==f);if(xe===null?Y=U:xe.next=le,!Qs(U,c.memoizedState)&&(Is=!0,ot&&(y=Ur,y!==null)))throw y;c.memoizedState=U,c.baseState=Y,c.baseQueue=xe,T.lastRenderedState=U}return P===null&&(T.lanes=0),[c.memoizedState,T.dispatch]}function K3(c){var f=us(),y=f.queue;if(y===null)throw Error(n(311));y.lastRenderedReducer=c;var T=y.dispatch,P=y.pending,U=f.memoizedState;if(P!==null){y.pending=null;var Y=P=P.next;do U=c(U,Y.action),Y=Y.next;while(Y!==P);Qs(U,f.memoizedState)||(Is=!0),f.memoizedState=U,f.baseQueue===null&&(f.baseState=U),y.lastRenderedState=U}return[U,T]}function aN(c,f,y){var T=yt,P=us(),U=Ci;if(U){if(y===void 0)throw Error(n(407));y=y()}else y=f();var Y=!Qs((Wt||P).memoizedState,y);Y&&(P.memoizedState=y,Is=!0),P=P.queue;var le=cN.bind(null,T,P,c);if(Kg(2048,8,le,[c]),P.getSnapshot!==f||Y||tn!==null&&tn.memoizedState.tag&1){if(T.flags|=2048,N0(9,K2(),uN.bind(null,T,P,y,f),null),xr===null)throw Error(n(349));U||(Yt&124)!==0||lN(T,f,y)}return y}function lN(c,f,y){c.flags|=16384,c={getSnapshot:f,value:y},f=yt.updateQueue,f===null?(f=$3(),yt.updateQueue=f,f.stores=[c]):(y=f.stores,y===null?f.stores=[c]:y.push(c))}function uN(c,f,y,T){f.value=y,f.getSnapshot=T,hN(f)&&fN(c)}function cN(c,f,y){return y(function(){hN(f)&&fN(c)})}function hN(c){var f=c.getSnapshot;c=c.value;try{var y=f();return!Qs(c,y)}catch{return!0}}function fN(c){var f=Kh(c,2);f!==null&&Ia(f,c,2)}function Z3(c){var f=Zo();if(typeof c=="function"){var y=c;if(c=y(),Kt){Ke(!0);try{y()}finally{Ke(!1)}}}return f.memoizedState=f.baseState=c,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qc,lastRenderedState:c},f}function dN(c,f,y,T){return c.baseState=y,Q3(c,Wt,typeof T=="function"?T:qc)}function mj(c,f,y,T,P){if(J2(c))throw Error(n(485));if(c=f.action,c!==null){var U={payload:P,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){U.listeners.push(Y)}};$.T!==null?y(!0):U.isTransition=!1,T(U),y=f.pending,y===null?(U.next=f.pending=U,AN(f,U)):(U.next=y.next,f.pending=y.next=U)}}function AN(c,f){var y=f.action,T=f.payload,P=c.state;if(f.isTransition){var U=$.T,Y={};$.T=Y;try{var le=y(P,T),xe=$.S;xe!==null&&xe(Y,le),pN(c,f,le)}catch(qe){J3(c,f,qe)}finally{$.T=U}}else try{U=y(P,T),pN(c,f,U)}catch(qe){J3(c,f,qe)}}function pN(c,f,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(T){mN(c,f,T)},function(T){return J3(c,f,T)}):mN(c,f,y)}function mN(c,f,y){f.status="fulfilled",f.value=y,gN(f),c.state=y,f=c.pending,f!==null&&(y=f.next,y===f?c.pending=null:(y=y.next,f.next=y,AN(c,y)))}function J3(c,f,y){var T=c.pending;if(c.pending=null,T!==null){T=T.next;do f.status="rejected",f.reason=y,gN(f),f=f.next;while(f!==T)}c.action=null}function gN(c){c=c.listeners;for(var f=0;f<c.length;f++)(0,c[f])()}function _N(c,f){return f}function yN(c,f){if(Ci){var y=xr.formState;if(y!==null){e:{var T=yt;if(Ci){if(Nr){t:{for(var P=Nr,U=ul;P.nodeType!==8;){if(!U){P=null;break t}if(P=Ql(P.nextSibling),P===null){P=null;break t}}U=P.data,P=U==="F!"||U==="F"?P:null}if(P){Nr=Ql(P.nextSibling),T=P.data==="F!";break e}}Uc(T)}T=!1}T&&(f=y[0])}}return y=Zo(),y.memoizedState=y.baseState=f,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_N,lastRenderedState:f},y.queue=T,y=FN.bind(null,yt,T),T.dispatch=y,T=Z3(!1),U=rE.bind(null,yt,!1,T.queue),T=Zo(),P={state:f,dispatch:null,action:c,pending:null},T.queue=P,y=mj.bind(null,yt,P,U,y),P.dispatch=y,T.memoizedState=c,[f,y,!1]}function vN(c){var f=us();return xN(f,Wt,c)}function xN(c,f,y){if(f=Q3(c,f,_N)[0],c=Q2(qc)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var T=Qg(f)}catch(Y){throw Y===Ru?dl:Y}else T=f;f=us();var P=f.queue,U=P.dispatch;return y!==f.memoizedState&&(yt.flags|=2048,N0(9,K2(),gj.bind(null,P,y),null)),[T,U,c]}function gj(c,f){c.action=f}function bN(c){var f=us(),y=Wt;if(y!==null)return xN(f,y,c);us(),f=f.memoizedState,y=us();var T=y.queue.dispatch;return y.memoizedState=c,[f,T,!1]}function N0(c,f,y,T){return c={tag:c,create:y,deps:T,inst:f,next:null},f=yt.updateQueue,f===null&&(f=$3(),yt.updateQueue=f),y=f.lastEffect,y===null?f.lastEffect=c.next=c:(T=y.next,y.next=c,c.next=T,f.lastEffect=c),c}function K2(){return{destroy:void 0,resource:void 0}}function SN(){return us().memoizedState}function Z2(c,f,y,T){var P=Zo();T=T===void 0?null:T,yt.flags|=c,P.memoizedState=N0(1|f,K2(),y,T)}function Kg(c,f,y,T){var P=us();T=T===void 0?null:T;var U=P.memoizedState.inst;Wt!==null&&T!==null&&bs(T,Wt.memoizedState.deps)?P.memoizedState=N0(f,U,y,T):(yt.flags|=c,P.memoizedState=N0(1|f,U,y,T))}function TN(c,f){Z2(8390656,8,c,f)}function EN(c,f){Kg(2048,8,c,f)}function wN(c,f){return Kg(4,2,c,f)}function MN(c,f){return Kg(4,4,c,f)}function RN(c,f){if(typeof f=="function"){c=c();var y=f(c);return function(){typeof y=="function"?y():f(null)}}if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function CN(c,f,y){y=y!=null?y.concat([c]):null,Kg(4,4,RN.bind(null,f,c),y)}function eE(){}function NN(c,f){var y=us();f=f===void 0?null:f;var T=y.memoizedState;return f!==null&&bs(f,T[1])?T[0]:(y.memoizedState=[c,f],c)}function DN(c,f){var y=us();f=f===void 0?null:f;var T=y.memoizedState;if(f!==null&&bs(f,T[1]))return T[0];if(T=c(),Kt){Ke(!0);try{c()}finally{Ke(!1)}}return y.memoizedState=[T,f],T}function tE(c,f,y){return y===void 0||(Yt&1073741824)!==0?c.memoizedState=f:(c.memoizedState=y,c=OD(),yt.lanes|=c,hf|=c,y)}function PN(c,f,y,T){return Qs(y,f)?y:Ve.current!==null?(c=tE(c,y,T),Qs(c,f)||(Is=!0),c):(Yt&42)===0?(Is=!0,c.memoizedState=y):(c=OD(),yt.lanes|=c,hf|=c,f)}function LN(c,f,y,T,P){var U=re.p;re.p=U!==0&&8>U?U:8;var Y=$.T,le={};$.T=le,rE(c,!1,f,y);try{var xe=P(),qe=$.S;if(qe!==null&&qe(le,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var ot=$2(xe,T);Zg(c,f,ot,Oa(c))}else Zg(c,f,T,Oa(c))}catch(mt){Zg(c,f,{then:function(){},status:"rejected",reason:mt},Oa())}finally{re.p=U,$.T=Y}}function _j(){}function nE(c,f,y,T){if(c.tag!==5)throw Error(n(476));var P=ON(c).queue;LN(c,P,f,ae,y===null?_j:function(){return IN(c),y(T)})}function ON(c){var f=c.memoizedState;if(f!==null)return f;f={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qc,lastRenderedState:ae},next:null};var y={};return f.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qc,lastRenderedState:y},next:null},c.memoizedState=f,c=c.alternate,c!==null&&(c.memoizedState=f),f}function IN(c){var f=ON(c).next.queue;Zg(c,f,{},Oa())}function iE(){return Os(m1)}function BN(){return us().memoizedState}function UN(){return us().memoizedState}function yj(c){for(var f=c.return;f!==null;){switch(f.tag){case 24:case 3:var y=Oa();c=I(y);var T=V(f,c,y);T!==null&&(Ia(T,f,y),j(T,f,y)),f={cache:ns()},c.payload=f;return}f=f.return}}function vj(c,f,y){var T=Oa();y={lane:T,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null},J2(c)?kN(f,y):(y=x0(c,f,y,T),y!==null&&(Ia(y,c,T),GN(y,f,T)))}function FN(c,f,y){var T=Oa();Zg(c,f,y,T)}function Zg(c,f,y,T){var P={lane:T,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null};if(J2(c))kN(f,P);else{var U=c.alternate;if(c.lanes===0&&(U===null||U.lanes===0)&&(U=f.lastRenderedReducer,U!==null))try{var Y=f.lastRenderedState,le=U(Y,y);if(P.hasEagerState=!0,P.eagerState=le,Qs(le,Y))return v0(c,f,P,0),xr===null&&y0(),!1}catch{}finally{}if(y=x0(c,f,P,T),y!==null)return Ia(y,c,T),GN(y,f,T),!0}return!1}function rE(c,f,y,T){if(T={lane:2,revertLane:BE(),action:T,hasEagerState:!1,eagerState:null,next:null},J2(c)){if(f)throw Error(n(479))}else f=x0(c,y,T,2),f!==null&&Ia(f,c,2)}function J2(c){var f=c.alternate;return c===yt||f!==null&&f===yt}function kN(c,f){fn=Yn=!0;var y=c.pending;y===null?f.next=f:(f.next=y.next,y.next=f),c.pending=f}function GN(c,f,y){if((y&4194048)!==0){var T=f.lanes;T&=c.pendingLanes,y|=T,f.lanes=y,kt(c,y)}}var ev={readContext:Os,use:Y2,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useLayoutEffect:wn,useInsertionEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useSyncExternalStore:wn,useId:wn,useHostTransitionStatus:wn,useFormState:wn,useActionState:wn,useOptimistic:wn,useMemoCache:wn,useCacheRefresh:wn},zN={readContext:Os,use:Y2,useCallback:function(c,f){return Zo().memoizedState=[c,f===void 0?null:f],c},useContext:Os,useEffect:TN,useImperativeHandle:function(c,f,y){y=y!=null?y.concat([c]):null,Z2(4194308,4,RN.bind(null,f,c),y)},useLayoutEffect:function(c,f){return Z2(4194308,4,c,f)},useInsertionEffect:function(c,f){Z2(4,2,c,f)},useMemo:function(c,f){var y=Zo();f=f===void 0?null:f;var T=c();if(Kt){Ke(!0);try{c()}finally{Ke(!1)}}return y.memoizedState=[T,f],T},useReducer:function(c,f,y){var T=Zo();if(y!==void 0){var P=y(f);if(Kt){Ke(!0);try{y(f)}finally{Ke(!1)}}}else P=f;return T.memoizedState=T.baseState=P,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:P},T.queue=c,c=c.dispatch=vj.bind(null,yt,c),[T.memoizedState,c]},useRef:function(c){var f=Zo();return c={current:c},f.memoizedState=c},useState:function(c){c=Z3(c);var f=c.queue,y=FN.bind(null,yt,f);return f.dispatch=y,[c.memoizedState,y]},useDebugValue:eE,useDeferredValue:function(c,f){var y=Zo();return tE(y,c,f)},useTransition:function(){var c=Z3(!1);return c=LN.bind(null,yt,c.queue,!0,!1),Zo().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,f,y){var T=yt,P=Zo();if(Ci){if(y===void 0)throw Error(n(407));y=y()}else{if(y=f(),xr===null)throw Error(n(349));(Mi&124)!==0||lN(T,f,y)}P.memoizedState=y;var U={value:y,getSnapshot:f};return P.queue=U,TN(cN.bind(null,T,U,c),[c]),T.flags|=2048,N0(9,K2(),uN.bind(null,T,U,y,f),null),y},useId:function(){var c=Zo(),f=xr.identifierPrefix;if(Ci){var y=al,T=Na;y=(T&~(1<<32-qt(T)-1)).toString(32)+y,f=""+f+"R"+y,y=Et++,0<y&&(f+="H"+y.toString(32)),f+=""}else y=kn++,f=""+f+"r"+y.toString(32)+"";return c.memoizedState=f},useHostTransitionStatus:iE,useFormState:yN,useActionState:yN,useOptimistic:function(c){var f=Zo();f.memoizedState=f.baseState=c;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=y,f=rE.bind(null,yt,!0,y),y.dispatch=f,[c,f]},useMemoCache:Y3,useCacheRefresh:function(){return Zo().memoizedState=yj.bind(null,yt)}},VN={readContext:Os,use:Y2,useCallback:NN,useContext:Os,useEffect:EN,useImperativeHandle:CN,useInsertionEffect:wN,useLayoutEffect:MN,useMemo:DN,useReducer:Q2,useRef:SN,useState:function(){return Q2(qc)},useDebugValue:eE,useDeferredValue:function(c,f){var y=us();return PN(y,Wt.memoizedState,c,f)},useTransition:function(){var c=Q2(qc)[0],f=us().memoizedState;return[typeof c=="boolean"?c:Qg(c),f]},useSyncExternalStore:aN,useId:BN,useHostTransitionStatus:iE,useFormState:vN,useActionState:vN,useOptimistic:function(c,f){var y=us();return dN(y,Wt,c,f)},useMemoCache:Y3,useCacheRefresh:UN},xj={readContext:Os,use:Y2,useCallback:NN,useContext:Os,useEffect:EN,useImperativeHandle:CN,useInsertionEffect:wN,useLayoutEffect:MN,useMemo:DN,useReducer:K3,useRef:SN,useState:function(){return K3(qc)},useDebugValue:eE,useDeferredValue:function(c,f){var y=us();return Wt===null?tE(y,c,f):PN(y,Wt.memoizedState,c,f)},useTransition:function(){var c=K3(qc)[0],f=us().memoizedState;return[typeof c=="boolean"?c:Qg(c),f]},useSyncExternalStore:aN,useId:BN,useHostTransitionStatus:iE,useFormState:bN,useActionState:bN,useOptimistic:function(c,f){var y=us();return Wt!==null?dN(y,Wt,c,f):(y.baseState=c,[c,y.queue.dispatch])},useMemoCache:Y3,useCacheRefresh:UN},D0=null,Jg=0;function tv(c){var f=Jg;return Jg+=1,D0===null&&(D0=[]),m(D0,c,f)}function e1(c,f){f=f.props.ref,c.ref=f!==void 0?f:null}function nv(c,f){throw f.$$typeof===d?Error(n(525)):(c=Object.prototype.toString.call(f),Error(n(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c)))}function qN(c){var f=c._init;return f(c._payload)}function HN(c){function f(Oe,Re){if(c){var ze=Oe.deletions;ze===null?(Oe.deletions=[Re],Oe.flags|=16):ze.push(Re)}}function y(Oe,Re){if(!c)return null;for(;Re!==null;)f(Oe,Re),Re=Re.sibling;return null}function T(Oe){for(var Re=new Map;Oe!==null;)Oe.key!==null?Re.set(Oe.key,Oe):Re.set(Oe.index,Oe),Oe=Oe.sibling;return Re}function P(Oe,Re){return Oe=Vl(Oe,Re),Oe.index=0,Oe.sibling=null,Oe}function U(Oe,Re,ze){return Oe.index=ze,c?(ze=Oe.alternate,ze!==null?(ze=ze.index,ze<Re?(Oe.flags|=67108866,Re):ze):(Oe.flags|=67108866,Re)):(Oe.flags|=1048576,Re)}function Y(Oe){return c&&Oe.alternate===null&&(Oe.flags|=67108866),Oe}function le(Oe,Re,ze,ht){return Re===null||Re.tag!==6?(Re=qg(ze,Oe.mode,ht),Re.return=Oe,Re):(Re=P(Re,ze),Re.return=Oe,Re)}function xe(Oe,Re,ze,ht){var rn=ze.type;return rn===b?ot(Oe,Re,ze.props.children,ht,ze.key):Re!==null&&(Re.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===z&&qN(rn)===Re.type)?(Re=P(Re,ze.props),e1(Re,ze),Re.return=Oe,Re):(Re=Ca(ze.type,ze.key,ze.props,null,Oe.mode,ht),e1(Re,ze),Re.return=Oe,Re)}function qe(Oe,Re,ze,ht){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==ze.containerInfo||Re.stateNode.implementation!==ze.implementation?(Re=Zh(ze,Oe.mode,ht),Re.return=Oe,Re):(Re=P(Re,ze.children||[]),Re.return=Oe,Re)}function ot(Oe,Re,ze,ht,rn){return Re===null||Re.tag!==7?(Re=ql(ze,Oe.mode,ht,rn),Re.return=Oe,Re):(Re=P(Re,ze),Re.return=Oe,Re)}function mt(Oe,Re,ze){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=qg(""+Re,Oe.mode,ze),Re.return=Oe,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case _:return ze=Ca(Re.type,Re.key,Re.props,null,Oe.mode,ze),e1(ze,Re),ze.return=Oe,ze;case x:return Re=Zh(Re,Oe.mode,ze),Re.return=Oe,Re;case z:var ht=Re._init;return Re=ht(Re._payload),mt(Oe,Re,ze)}if(ee(Re)||Q(Re))return Re=ql(Re,Oe.mode,ze,null),Re.return=Oe,Re;if(typeof Re.then=="function")return mt(Oe,tv(Re),ze);if(Re.$$typeof===D)return mt(Oe,w0(Oe,Re),ze);nv(Oe,Re)}return null}function Xe(Oe,Re,ze,ht){var rn=Re!==null?Re.key:null;if(typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint")return rn!==null?null:le(Oe,Re,""+ze,ht);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case _:return ze.key===rn?xe(Oe,Re,ze,ht):null;case x:return ze.key===rn?qe(Oe,Re,ze,ht):null;case z:return rn=ze._init,ze=rn(ze._payload),Xe(Oe,Re,ze,ht)}if(ee(ze)||Q(ze))return rn!==null?null:ot(Oe,Re,ze,ht,null);if(typeof ze.then=="function")return Xe(Oe,Re,tv(ze),ht);if(ze.$$typeof===D)return Xe(Oe,Re,w0(Oe,ze),ht);nv(Oe,ze)}return null}function $e(Oe,Re,ze,ht,rn){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Oe=Oe.get(ze)||null,le(Re,Oe,""+ht,rn);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case _:return Oe=Oe.get(ht.key===null?ze:ht.key)||null,xe(Re,Oe,ht,rn);case x:return Oe=Oe.get(ht.key===null?ze:ht.key)||null,qe(Re,Oe,ht,rn);case z:var fi=ht._init;return ht=fi(ht._payload),$e(Oe,Re,ze,ht,rn)}if(ee(ht)||Q(ht))return Oe=Oe.get(ze)||null,ot(Re,Oe,ht,rn,null);if(typeof ht.then=="function")return $e(Oe,Re,ze,tv(ht),rn);if(ht.$$typeof===D)return $e(Oe,Re,ze,w0(Re,ht),rn);nv(Re,ht)}return null}function Un(Oe,Re,ze,ht){for(var rn=null,fi=null,An=Re,Pn=Re=0,Us=null;An!==null&&Pn<ze.length;Pn++){An.index>Pn?(Us=An,An=null):Us=An.sibling;var Oi=Xe(Oe,An,ze[Pn],ht);if(Oi===null){An===null&&(An=Us);break}c&&An&&Oi.alternate===null&&f(Oe,An),Re=U(Oi,Re,Pn),fi===null?rn=Oi:fi.sibling=Oi,fi=Oi,An=Us}if(Pn===ze.length)return y(Oe,An),Ci&&ll(Oe,Pn),rn;if(An===null){for(;Pn<ze.length;Pn++)An=mt(Oe,ze[Pn],ht),An!==null&&(Re=U(An,Re,Pn),fi===null?rn=An:fi.sibling=An,fi=An);return Ci&&ll(Oe,Pn),rn}for(An=T(An);Pn<ze.length;Pn++)Us=$e(An,Oe,Pn,ze[Pn],ht),Us!==null&&(c&&Us.alternate!==null&&An.delete(Us.key===null?Pn:Us.key),Re=U(Us,Re,Pn),fi===null?rn=Us:fi.sibling=Us,fi=Us);return c&&An.forEach(function(vf){return f(Oe,vf)}),Ci&&ll(Oe,Pn),rn}function Mn(Oe,Re,ze,ht){if(ze==null)throw Error(n(151));for(var rn=null,fi=null,An=Re,Pn=Re=0,Us=null,Oi=ze.next();An!==null&&!Oi.done;Pn++,Oi=ze.next()){An.index>Pn?(Us=An,An=null):Us=An.sibling;var vf=Xe(Oe,An,Oi.value,ht);if(vf===null){An===null&&(An=Us);break}c&&An&&vf.alternate===null&&f(Oe,An),Re=U(vf,Re,Pn),fi===null?rn=vf:fi.sibling=vf,fi=vf,An=Us}if(Oi.done)return y(Oe,An),Ci&&ll(Oe,Pn),rn;if(An===null){for(;!Oi.done;Pn++,Oi=ze.next())Oi=mt(Oe,Oi.value,ht),Oi!==null&&(Re=U(Oi,Re,Pn),fi===null?rn=Oi:fi.sibling=Oi,fi=Oi);return Ci&&ll(Oe,Pn),rn}for(An=T(An);!Oi.done;Pn++,Oi=ze.next())Oi=$e(An,Oe,Pn,Oi.value,ht),Oi!==null&&(c&&Oi.alternate!==null&&An.delete(Oi.key===null?Pn:Oi.key),Re=U(Oi,Re,Pn),fi===null?rn=Oi:fi.sibling=Oi,fi=Oi);return c&&An.forEach(function(bX){return f(Oe,bX)}),Ci&&ll(Oe,Pn),rn}function or(Oe,Re,ze,ht){if(typeof ze=="object"&&ze!==null&&ze.type===b&&ze.key===null&&(ze=ze.props.children),typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case _:e:{for(var rn=ze.key;Re!==null;){if(Re.key===rn){if(rn=ze.type,rn===b){if(Re.tag===7){y(Oe,Re.sibling),ht=P(Re,ze.props.children),ht.return=Oe,Oe=ht;break e}}else if(Re.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===z&&qN(rn)===Re.type){y(Oe,Re.sibling),ht=P(Re,ze.props),e1(ht,ze),ht.return=Oe,Oe=ht;break e}y(Oe,Re);break}else f(Oe,Re);Re=Re.sibling}ze.type===b?(ht=ql(ze.props.children,Oe.mode,ht,ze.key),ht.return=Oe,Oe=ht):(ht=Ca(ze.type,ze.key,ze.props,null,Oe.mode,ht),e1(ht,ze),ht.return=Oe,Oe=ht)}return Y(Oe);case x:e:{for(rn=ze.key;Re!==null;){if(Re.key===rn)if(Re.tag===4&&Re.stateNode.containerInfo===ze.containerInfo&&Re.stateNode.implementation===ze.implementation){y(Oe,Re.sibling),ht=P(Re,ze.children||[]),ht.return=Oe,Oe=ht;break e}else{y(Oe,Re);break}else f(Oe,Re);Re=Re.sibling}ht=Zh(ze,Oe.mode,ht),ht.return=Oe,Oe=ht}return Y(Oe);case z:return rn=ze._init,ze=rn(ze._payload),or(Oe,Re,ze,ht)}if(ee(ze))return Un(Oe,Re,ze,ht);if(Q(ze)){if(rn=Q(ze),typeof rn!="function")throw Error(n(150));return ze=rn.call(ze),Mn(Oe,Re,ze,ht)}if(typeof ze.then=="function")return or(Oe,Re,tv(ze),ht);if(ze.$$typeof===D)return or(Oe,Re,w0(Oe,ze),ht);nv(Oe,ze)}return typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint"?(ze=""+ze,Re!==null&&Re.tag===6?(y(Oe,Re.sibling),ht=P(Re,ze),ht.return=Oe,Oe=ht):(y(Oe,Re),ht=qg(ze,Oe.mode,ht),ht.return=Oe,Oe=ht),Y(Oe)):y(Oe,Re)}return function(Oe,Re,ze,ht){try{Jg=0;var rn=or(Oe,Re,ze,ht);return D0=null,rn}catch(An){if(An===Ru||An===dl)throw An;var fi=No(29,An,null,Oe.mode);return fi.lanes=ht,fi.return=Oe,fi}finally{}}}var P0=HN(!0),WN=HN(!1),Al=ye(null),Cu=null;function sf(c){var f=c.alternate;Pe(Ss,Ss.current&1),Pe(Al,c),Cu===null&&(f===null||Ve.current!==null||f.memoizedState!==null)&&(Cu=c)}function jN(c){if(c.tag===22){if(Pe(Ss,Ss.current),Pe(Al,c),Cu===null){var f=c.alternate;f!==null&&f.memoizedState!==null&&(Cu=c)}}else of()}function of(){Pe(Ss,Ss.current),Pe(Al,Al.current)}function Hc(c){ve(Al),Cu===c&&(Cu=null),ve(Ss)}var Ss=ye(0);function iv(c){for(var f=c;f!==null;){if(f.tag===13){var y=f.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||$E(y)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function sE(c,f,y,T){f=c.memoizedState,y=y(T,f),y=y==null?f:h({},f,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}var oE={enqueueSetState:function(c,f,y){c=c._reactInternals;var T=Oa(),P=I(T);P.payload=f,y!=null&&(P.callback=y),f=V(c,P,T),f!==null&&(Ia(f,c,T),j(f,c,T))},enqueueReplaceState:function(c,f,y){c=c._reactInternals;var T=Oa(),P=I(T);P.tag=1,P.payload=f,y!=null&&(P.callback=y),f=V(c,P,T),f!==null&&(Ia(f,c,T),j(f,c,T))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var y=Oa(),T=I(y);T.tag=2,f!=null&&(T.callback=f),f=V(c,T,y),f!==null&&(Ia(f,c,y),j(f,c,y))}};function XN(c,f,y,T,P,U,Y){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(T,U,Y):f.prototype&&f.prototype.isPureReactComponent?!ol(y,T)||!ol(P,U):!0}function $N(c,f,y,T){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(y,T),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(y,T),f.state!==c&&oE.enqueueReplaceState(f,f.state,null)}function Ld(c,f){var y=f;if("ref"in f){y={};for(var T in f)T!=="ref"&&(y[T]=f[T])}if(c=c.defaultProps){y===f&&(y=h({},y));for(var P in c)y[P]===void 0&&(y[P]=c[P])}return y}var rv=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)};function YN(c){rv(c)}function QN(c){console.error(c)}function KN(c){rv(c)}function sv(c,f){try{var y=c.onUncaughtError;y(f.value,{componentStack:f.stack})}catch(T){setTimeout(function(){throw T})}}function ZN(c,f,y){try{var T=c.onCaughtError;T(y.value,{componentStack:y.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function aE(c,f,y){return y=I(y),y.tag=3,y.payload={element:null},y.callback=function(){sv(c,f)},y}function JN(c){return c=I(c),c.tag=3,c}function eD(c,f,y,T){var P=y.type.getDerivedStateFromError;if(typeof P=="function"){var U=T.value;c.payload=function(){return P(U)},c.callback=function(){ZN(f,y,T)}}var Y=y.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(c.callback=function(){ZN(f,y,T),typeof P!="function"&&(ff===null?ff=new Set([this]):ff.add(this));var le=T.stack;this.componentDidCatch(T.value,{componentStack:le!==null?le:""})})}function bj(c,f,y,T,P){if(y.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(f=y.alternate,f!==null&&ef(f,y,P,!0),y=Al.current,y!==null){switch(y.tag){case 13:return Cu===null?DE():y.alternate===null&&Xr===0&&(Xr=3),y.flags&=-257,y.flags|=65536,y.lanes=P,T===R0?y.flags|=16384:(f=y.updateQueue,f===null?y.updateQueue=new Set([T]):f.add(T),LE(c,T,P)),!1;case 22:return y.flags|=65536,T===R0?y.flags|=16384:(f=y.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([T])},y.updateQueue=f):(y=f.retryQueue,y===null?f.retryQueue=new Set([T]):y.add(T)),LE(c,T,P)),!1}throw Error(n(435,y.tag))}return LE(c,T,P),DE(),!1}if(Ci)return f=Al.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=P,T!==Xg&&(c=Error(n(422),{cause:T}),Wl($o(c,y)))):(T!==Xg&&(f=Error(n(423),{cause:T}),Wl($o(f,y))),c=c.current.alternate,c.flags|=65536,P&=-P,c.lanes|=P,T=$o(T,y),P=aE(c.stateNode,T,P),oe(c,P),Xr!==4&&(Xr=2)),!1;var U=Error(n(520),{cause:T});if(U=$o(U,y),a1===null?a1=[U]:a1.push(U),Xr!==4&&(Xr=2),f===null)return!0;T=$o(T,y),y=f;do{switch(y.tag){case 3:return y.flags|=65536,c=P&-P,y.lanes|=c,c=aE(y.stateNode,T,c),oe(y,c),!1;case 1:if(f=y.type,U=y.stateNode,(y.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(ff===null||!ff.has(U))))return y.flags|=65536,P&=-P,y.lanes|=P,P=JN(P),eD(P,c,y,T),oe(y,P),!1}y=y.return}while(y!==null);return!1}var tD=Error(n(461)),Is=!1;function Js(c,f,y,T){f.child=c===null?WN(f,null,y,T):P0(f,c.child,y,T)}function nD(c,f,y,T,P){y=y.render;var U=f.ref;if("ref"in T){var Y={};for(var le in T)le!=="ref"&&(Y[le]=T[le])}else Y=T;return kc(f),T=C0(c,f,y,Y,U,P),le=W3(),c!==null&&!Is?(j3(c,f,P),Wc(c,f,P)):(Ci&&le&&Wg(f),f.flags|=1,Js(c,f,T,P),f.child)}function iD(c,f,y,T,P){if(c===null){var U=y.type;return typeof U=="function"&&!Vg(U)&&U.defaultProps===void 0&&y.compare===null?(f.tag=15,f.type=U,rD(c,f,U,T,P)):(c=Ca(y.type,null,T,f,f.mode,P),c.ref=f.ref,c.return=f,f.child=c)}if(U=c.child,!pE(c,P)){var Y=U.memoizedProps;if(y=y.compare,y=y!==null?y:ol,y(Y,T)&&c.ref===f.ref)return Wc(c,f,P)}return f.flags|=1,c=Vl(U,T),c.ref=f.ref,c.return=f,f.child=c}function rD(c,f,y,T,P){if(c!==null){var U=c.memoizedProps;if(ol(U,T)&&c.ref===f.ref)if(Is=!1,f.pendingProps=T=U,pE(c,P))(c.flags&131072)!==0&&(Is=!0);else return f.lanes=c.lanes,Wc(c,f,P)}return lE(c,f,y,T,P)}function sD(c,f,y){var T=f.pendingProps,P=T.children,U=c!==null?c.memoizedState:null;if(T.mode==="hidden"){if((f.flags&128)!==0){if(T=U!==null?U.baseLanes|y:y,c!==null){for(P=f.child=c.child,U=0;P!==null;)U=U|P.lanes|P.childLanes,P=P.sibling;f.childLanes=U&~T}else f.childLanes=0,f.child=null;return oD(c,f,T,y)}if((y&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},c!==null&&Dd(f,U!==null?U.cachePool:null),U!==null?Le(f,U):Ee(),jN(f);else return f.lanes=f.childLanes=536870912,oD(c,f,U!==null?U.baseLanes|y:y,y)}else U!==null?(Dd(f,U.cachePool),Le(f,U),of(),f.memoizedState=null):(c!==null&&Dd(f,null),Ee(),of());return Js(c,f,P,y),f.child}function oD(c,f,y,T){var P=M0();return P=P===null?null:{parent:Xt._currentValue,pool:P},f.memoizedState={baseLanes:y,cachePool:P},c!==null&&Dd(f,null),Ee(),jN(f),c!==null&&ef(c,f,T,!0),null}function ov(c,f){var y=f.ref;if(y===null)c!==null&&c.ref!==null&&(f.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(n(284));(c===null||c.ref!==y)&&(f.flags|=4194816)}}function lE(c,f,y,T,P){return kc(f),y=C0(c,f,y,T,void 0,P),T=W3(),c!==null&&!Is?(j3(c,f,P),Wc(c,f,P)):(Ci&&T&&Wg(f),f.flags|=1,Js(c,f,y,P),f.child)}function aD(c,f,y,T,P,U){return kc(f),f.updateQueue=null,y=oN(f,T,y,P),sN(c),T=W3(),c!==null&&!Is?(j3(c,f,U),Wc(c,f,U)):(Ci&&T&&Wg(f),f.flags|=1,Js(c,f,y,U),f.child)}function lD(c,f,y,T,P){if(kc(f),f.stateNode===null){var U=Oc,Y=y.contextType;typeof Y=="object"&&Y!==null&&(U=Os(Y)),U=new y(T,U),f.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,U.updater=oE,f.stateNode=U,U._reactInternals=f,U=f.stateNode,U.props=T,U.state=f.memoizedState,U.refs={},C(f),Y=y.contextType,U.context=typeof Y=="object"&&Y!==null?Os(Y):Oc,U.state=f.memoizedState,Y=y.getDerivedStateFromProps,typeof Y=="function"&&(sE(f,y,Y,T),U.state=f.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(Y=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),Y!==U.state&&oE.enqueueReplaceState(U,U.state,null),Ae(f,T,U,P),de(),U.state=f.memoizedState),typeof U.componentDidMount=="function"&&(f.flags|=4194308),T=!0}else if(c===null){U=f.stateNode;var le=f.memoizedProps,xe=Ld(y,le);U.props=xe;var qe=U.context,ot=y.contextType;Y=Oc,typeof ot=="object"&&ot!==null&&(Y=Os(ot));var mt=y.getDerivedStateFromProps;ot=typeof mt=="function"||typeof U.getSnapshotBeforeUpdate=="function",le=f.pendingProps!==le,ot||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(le||qe!==Y)&&$N(f,U,T,Y),M=!1;var Xe=f.memoizedState;U.state=Xe,Ae(f,T,U,P),de(),qe=f.memoizedState,le||Xe!==qe||M?(typeof mt=="function"&&(sE(f,y,mt,T),qe=f.memoizedState),(xe=M||XN(f,y,xe,T,Xe,qe,Y))?(ot||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(f.flags|=4194308)):(typeof U.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=T,f.memoizedState=qe),U.props=T,U.state=qe,U.context=Y,T=xe):(typeof U.componentDidMount=="function"&&(f.flags|=4194308),T=!1)}else{U=f.stateNode,N(c,f),Y=f.memoizedProps,ot=Ld(y,Y),U.props=ot,mt=f.pendingProps,Xe=U.context,qe=y.contextType,xe=Oc,typeof qe=="object"&&qe!==null&&(xe=Os(qe)),le=y.getDerivedStateFromProps,(qe=typeof le=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Y!==mt||Xe!==xe)&&$N(f,U,T,xe),M=!1,Xe=f.memoizedState,U.state=Xe,Ae(f,T,U,P),de();var $e=f.memoizedState;Y!==mt||Xe!==$e||M||c!==null&&c.dependencies!==null&&E0(c.dependencies)?(typeof le=="function"&&(sE(f,y,le,T),$e=f.memoizedState),(ot=M||XN(f,y,ot,T,Xe,$e,xe)||c!==null&&c.dependencies!==null&&E0(c.dependencies))?(qe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(T,$e,xe),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(T,$e,xe)),typeof U.componentDidUpdate=="function"&&(f.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof U.componentDidUpdate!="function"||Y===c.memoizedProps&&Xe===c.memoizedState||(f.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Y===c.memoizedProps&&Xe===c.memoizedState||(f.flags|=1024),f.memoizedProps=T,f.memoizedState=$e),U.props=T,U.state=$e,U.context=xe,T=ot):(typeof U.componentDidUpdate!="function"||Y===c.memoizedProps&&Xe===c.memoizedState||(f.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Y===c.memoizedProps&&Xe===c.memoizedState||(f.flags|=1024),T=!1)}return U=T,ov(c,f),T=(f.flags&128)!==0,U||T?(U=f.stateNode,y=T&&typeof y.getDerivedStateFromError!="function"?null:U.render(),f.flags|=1,c!==null&&T?(f.child=P0(f,c.child,null,P),f.child=P0(f,null,y,P)):Js(c,f,y,P),f.memoizedState=U.state,c=f.child):c=Wc(c,f,P),c}function uD(c,f,y,T){return Nd(),f.flags|=256,Js(c,f,y,T),f.child}var uE={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cE(c){return{baseLanes:c,cachePool:Pd()}}function hE(c,f,y){return c=c!==null?c.childLanes&~y:0,f&&(c|=pl),c}function cD(c,f,y){var T=f.pendingProps,P=!1,U=(f.flags&128)!==0,Y;if((Y=U)||(Y=c!==null&&c.memoizedState===null?!1:(Ss.current&2)!==0),Y&&(P=!0,f.flags&=-129),Y=(f.flags&32)!==0,f.flags&=-33,c===null){if(Ci){if(P?sf(f):of(),Ci){var le=Nr,xe;if(xe=le){e:{for(xe=le,le=ul;xe.nodeType!==8;){if(!le){le=null;break e}if(xe=Ql(xe.nextSibling),xe===null){le=null;break e}}le=xe}le!==null?(f.memoizedState={dehydrated:le,treeContext:Hl!==null?{id:Na,overflow:al}:null,retryLane:536870912,hydrationErrors:null},xe=No(18,null,null,0),xe.stateNode=le,xe.return=f,f.child=xe,Zs=f,Nr=null,xe=!0):xe=!1}xe||Uc(f)}if(le=f.memoizedState,le!==null&&(le=le.dehydrated,le!==null))return $E(le)?f.lanes=32:f.lanes=536870912,null;Hc(f)}return le=T.children,T=T.fallback,P?(of(),P=f.mode,le=av({mode:"hidden",children:le},P),T=ql(T,P,y,null),le.return=f,T.return=f,le.sibling=T,f.child=le,P=f.child,P.memoizedState=cE(y),P.childLanes=hE(c,Y,y),f.memoizedState=uE,T):(sf(f),fE(f,le))}if(xe=c.memoizedState,xe!==null&&(le=xe.dehydrated,le!==null)){if(U)f.flags&256?(sf(f),f.flags&=-257,f=dE(c,f,y)):f.memoizedState!==null?(of(),f.child=c.child,f.flags|=128,f=null):(of(),P=T.fallback,le=f.mode,T=av({mode:"visible",children:T.children},le),P=ql(P,le,y,null),P.flags|=2,T.return=f,P.return=f,T.sibling=P,f.child=T,P0(f,c.child,null,y),T=f.child,T.memoizedState=cE(y),T.childLanes=hE(c,Y,y),f.memoizedState=uE,f=P);else if(sf(f),$E(le)){if(Y=le.nextSibling&&le.nextSibling.dataset,Y)var qe=Y.dgst;Y=qe,T=Error(n(419)),T.stack="",T.digest=Y,Wl({value:T,source:null,stack:null}),f=dE(c,f,y)}else if(Is||ef(c,f,y,!1),Y=(y&c.childLanes)!==0,Is||Y){if(Y=xr,Y!==null&&(T=y&-y,T=(T&42)!==0?1:hn(T),T=(T&(Y.suspendedLanes|y))!==0?0:T,T!==0&&T!==xe.retryLane))throw xe.retryLane=T,Kh(c,T),Ia(Y,c,T),tD;le.data==="$?"||DE(),f=dE(c,f,y)}else le.data==="$?"?(f.flags|=192,f.child=c.child,f=null):(c=xe.treeContext,Nr=Ql(le.nextSibling),Zs=f,Ci=!0,Bc=null,ul=!1,c!==null&&(Do[Ls++]=Na,Do[Ls++]=al,Do[Ls++]=Hl,Na=c.id,al=c.overflow,Hl=f),f=fE(f,T.children),f.flags|=4096);return f}return P?(of(),P=T.fallback,le=f.mode,xe=c.child,qe=xe.sibling,T=Vl(xe,{mode:"hidden",children:T.children}),T.subtreeFlags=xe.subtreeFlags&65011712,qe!==null?P=Vl(qe,P):(P=ql(P,le,y,null),P.flags|=2),P.return=f,T.return=f,T.sibling=P,f.child=T,T=P,P=f.child,le=c.child.memoizedState,le===null?le=cE(y):(xe=le.cachePool,xe!==null?(qe=Xt._currentValue,xe=xe.parent!==qe?{parent:qe,pool:qe}:xe):xe=Pd(),le={baseLanes:le.baseLanes|y,cachePool:xe}),P.memoizedState=le,P.childLanes=hE(c,Y,y),f.memoizedState=uE,T):(sf(f),y=c.child,c=y.sibling,y=Vl(y,{mode:"visible",children:T.children}),y.return=f,y.sibling=null,c!==null&&(Y=f.deletions,Y===null?(f.deletions=[c],f.flags|=16):Y.push(c)),f.child=y,f.memoizedState=null,y)}function fE(c,f){return f=av({mode:"visible",children:f},c.mode),f.return=c,c.child=f}function av(c,f){return c=No(22,c,null,f),c.lanes=0,c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},c}function dE(c,f,y){return P0(f,c.child,null,y),c=fE(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function hD(c,f,y){c.lanes|=f;var T=c.alternate;T!==null&&(T.lanes|=f),S0(c.return,f,y)}function AE(c,f,y,T,P){var U=c.memoizedState;U===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:T,tail:y,tailMode:P}:(U.isBackwards=f,U.rendering=null,U.renderingStartTime=0,U.last=T,U.tail=y,U.tailMode=P)}function fD(c,f,y){var T=f.pendingProps,P=T.revealOrder,U=T.tail;if(Js(c,f,T.children,y),T=Ss.current,(T&2)!==0)T=T&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&hD(c,y,f);else if(c.tag===19)hD(c,y,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}T&=1}switch(Pe(Ss,T),P){case"forwards":for(y=f.child,P=null;y!==null;)c=y.alternate,c!==null&&iv(c)===null&&(P=y),y=y.sibling;y=P,y===null?(P=f.child,f.child=null):(P=y.sibling,y.sibling=null),AE(f,!1,P,y,U);break;case"backwards":for(y=null,P=f.child,f.child=null;P!==null;){if(c=P.alternate,c!==null&&iv(c)===null){f.child=P;break}c=P.sibling,P.sibling=y,y=P,P=c}AE(f,!0,y,null,U);break;case"together":AE(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Wc(c,f,y){if(c!==null&&(f.dependencies=c.dependencies),hf|=f.lanes,(y&f.childLanes)===0)if(c!==null){if(ef(c,f,y,!1),(y&f.childLanes)===0)return null}else return null;if(c!==null&&f.child!==c.child)throw Error(n(153));if(f.child!==null){for(c=f.child,y=Vl(c,c.pendingProps),f.child=y,y.return=f;c.sibling!==null;)c=c.sibling,y=y.sibling=Vl(c,c.pendingProps),y.return=f;y.sibling=null}return f.child}function pE(c,f){return(c.lanes&f)!==0?!0:(c=c.dependencies,!!(c!==null&&E0(c)))}function Sj(c,f,y){switch(f.tag){case 3:At(f,f.stateNode.containerInfo),Mu(f,Xt,c.memoizedState.cache),Nd();break;case 27:case 5:Dt(f);break;case 4:At(f,f.stateNode.containerInfo);break;case 10:Mu(f,f.type,f.memoizedProps.value);break;case 13:var T=f.memoizedState;if(T!==null)return T.dehydrated!==null?(sf(f),f.flags|=128,null):(y&f.child.childLanes)!==0?cD(c,f,y):(sf(f),c=Wc(c,f,y),c!==null?c.sibling:null);sf(f);break;case 19:var P=(c.flags&128)!==0;if(T=(y&f.childLanes)!==0,T||(ef(c,f,y,!1),T=(y&f.childLanes)!==0),P){if(T)return fD(c,f,y);f.flags|=128}if(P=f.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Pe(Ss,Ss.current),T)break;return null;case 22:case 23:return f.lanes=0,sD(c,f,y);case 24:Mu(f,Xt,c.memoizedState.cache)}return Wc(c,f,y)}function dD(c,f,y){if(c!==null)if(c.memoizedProps!==f.pendingProps)Is=!0;else{if(!pE(c,y)&&(f.flags&128)===0)return Is=!1,Sj(c,f,y);Is=(c.flags&131072)!==0}else Is=!1,Ci&&(f.flags&1048576)!==0&&Hg(f,wu,f.index);switch(f.lanes=0,f.tag){case 16:e:{c=f.pendingProps;var T=f.elementType,P=T._init;if(T=P(T._payload),f.type=T,typeof T=="function")Vg(T)?(c=Ld(T,c),f.tag=1,f=lD(null,f,T,c,y)):(f.tag=0,f=lE(null,f,T,c,y));else{if(T!=null){if(P=T.$$typeof,P===O){f.tag=11,f=nD(null,f,T,c,y);break e}else if(P===k){f.tag=14,f=iD(null,f,T,c,y);break e}}throw f=se(T)||T,Error(n(306,f,""))}}return f;case 0:return lE(c,f,f.type,f.pendingProps,y);case 1:return T=f.type,P=Ld(T,f.pendingProps),lD(c,f,T,P,y);case 3:e:{if(At(f,f.stateNode.containerInfo),c===null)throw Error(n(387));T=f.pendingProps;var U=f.memoizedState;P=U.element,N(c,f),Ae(f,T,null,y);var Y=f.memoizedState;if(T=Y.cache,Mu(f,Xt,T),T!==U.cache&&T0(f,[Xt],y,!0),de(),T=Y.element,U.isDehydrated)if(U={element:T,isDehydrated:!1,cache:Y.cache},f.updateQueue.baseState=U,f.memoizedState=U,f.flags&256){f=uD(c,f,T,y);break e}else if(T!==P){P=$o(Error(n(424)),f),Wl(P),f=uD(c,f,T,y);break e}else{switch(c=f.stateNode.containerInfo,c.nodeType){case 9:c=c.body;break;default:c=c.nodeName==="HTML"?c.ownerDocument.body:c}for(Nr=Ql(c.firstChild),Zs=f,Ci=!0,Bc=null,ul=!0,y=WN(f,null,T,y),f.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling}else{if(Nd(),T===P){f=Wc(c,f,y);break e}Js(c,f,T,y)}f=f.child}return f;case 26:return ov(c,f),c===null?(y=gP(f.type,null,f.pendingProps,null))?f.memoizedState=y:Ci||(y=f.type,c=f.pendingProps,T=xv(Ye.current).createElement(y),T[ke]=f,T[We]=c,to(T,y,c),on(T),f.stateNode=T):f.memoizedState=gP(f.type,c.memoizedProps,f.pendingProps,c.memoizedState),null;case 27:return Dt(f),c===null&&Ci&&(T=f.stateNode=AP(f.type,f.pendingProps,Ye.current),Zs=f,ul=!0,P=Nr,pf(f.type)?(YE=P,Nr=Ql(T.firstChild)):Nr=P),Js(c,f,f.pendingProps.children,y),ov(c,f),c===null&&(f.flags|=4194304),f.child;case 5:return c===null&&Ci&&((P=T=Nr)&&(T=Kj(T,f.type,f.pendingProps,ul),T!==null?(f.stateNode=T,Zs=f,Nr=Ql(T.firstChild),ul=!1,P=!0):P=!1),P||Uc(f)),Dt(f),P=f.type,U=f.pendingProps,Y=c!==null?c.memoizedProps:null,T=U.children,WE(P,U)?T=null:Y!==null&&WE(P,Y)&&(f.flags|=32),f.memoizedState!==null&&(P=C0(c,f,pj,null,null,y),m1._currentValue=P),ov(c,f),Js(c,f,T,y),f.child;case 6:return c===null&&Ci&&((c=y=Nr)&&(y=Zj(y,f.pendingProps,ul),y!==null?(f.stateNode=y,Zs=f,Nr=null,c=!0):c=!1),c||Uc(f)),null;case 13:return cD(c,f,y);case 4:return At(f,f.stateNode.containerInfo),T=f.pendingProps,c===null?f.child=P0(f,null,T,y):Js(c,f,T,y),f.child;case 11:return nD(c,f,f.type,f.pendingProps,y);case 7:return Js(c,f,f.pendingProps,y),f.child;case 8:return Js(c,f,f.pendingProps.children,y),f.child;case 12:return Js(c,f,f.pendingProps.children,y),f.child;case 10:return T=f.pendingProps,Mu(f,f.type,T.value),Js(c,f,T.children,y),f.child;case 9:return P=f.type._context,T=f.pendingProps.children,kc(f),P=Os(P),T=T(P),f.flags|=1,Js(c,f,T,y),f.child;case 14:return iD(c,f,f.type,f.pendingProps,y);case 15:return rD(c,f,f.type,f.pendingProps,y);case 19:return fD(c,f,y);case 31:return T=f.pendingProps,y=f.mode,T={mode:T.mode,children:T.children},c===null?(y=av(T,y),y.ref=f.ref,f.child=y,y.return=f,f=y):(y=Vl(c.child,T),y.ref=f.ref,f.child=y,y.return=f,f=y),f;case 22:return sD(c,f,y);case 24:return kc(f),T=Os(Xt),c===null?(P=M0(),P===null&&(P=xr,U=ns(),P.pooledCache=U,U.refCount++,U!==null&&(P.pooledCacheLanes|=y),P=U),f.memoizedState={parent:T,cache:P},C(f),Mu(f,Xt,P)):((c.lanes&y)!==0&&(N(c,f),Ae(f,null,null,y),de()),P=c.memoizedState,U=f.memoizedState,P.parent!==T?(P={parent:T,cache:T},f.memoizedState=P,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=P),Mu(f,Xt,T)):(T=U.cache,Mu(f,Xt,T),T!==P.cache&&T0(f,[Xt],y,!0))),Js(c,f,f.pendingProps.children,y),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}function jc(c){c.flags|=4}function AD(c,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!bP(f)){if(f=Al.current,f!==null&&((Mi&4194048)===Mi?Cu!==null:(Mi&62914560)!==Mi&&(Mi&536870912)===0||f!==Cu))throw g=R0,Vc;c.flags|=8192}}function lv(c,f){f!==null&&(c.flags|=4),c.flags&16384&&(f=c.tag!==22?Ut():536870912,c.lanes|=f,B0|=f)}function t1(c,f){if(!Ci)switch(c.tailMode){case"hidden":f=c.tail;for(var y=null;f!==null;)f.alternate!==null&&(y=f),f=f.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var T=null;y!==null;)y.alternate!==null&&(T=y),y=y.sibling;T===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:T.sibling=null}}function Fr(c){var f=c.alternate!==null&&c.alternate.child===c.child,y=0,T=0;if(f)for(var P=c.child;P!==null;)y|=P.lanes|P.childLanes,T|=P.subtreeFlags&65011712,T|=P.flags&65011712,P.return=c,P=P.sibling;else for(P=c.child;P!==null;)y|=P.lanes|P.childLanes,T|=P.subtreeFlags,T|=P.flags,P.return=c,P=P.sibling;return c.subtreeFlags|=T,c.childLanes=y,f}function Tj(c,f,y){var T=f.pendingProps;switch(jg(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(f),null;case 1:return Fr(f),null;case 3:return y=f.stateNode,T=null,c!==null&&(T=c.memoizedState.cache),f.memoizedState.cache!==T&&(f.flags|=2048),cl(Xt),Gt(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(vr(f)?jc(f):c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,X2())),Fr(f),null;case 26:return y=f.memoizedState,c===null?(jc(f),y!==null?(Fr(f),AD(f,y)):(Fr(f),f.flags&=-16777217)):y?y!==c.memoizedState?(jc(f),Fr(f),AD(f,y)):(Fr(f),f.flags&=-16777217):(c.memoizedProps!==T&&jc(f),Fr(f),f.flags&=-16777217),null;case 27:Nn(f),y=Ye.current;var P=f.type;if(c!==null&&f.stateNode!=null)c.memoizedProps!==T&&jc(f);else{if(!T){if(f.stateNode===null)throw Error(n(166));return Fr(f),null}c=Se.current,vr(f)?$g(f):(c=AP(P,T,y),f.stateNode=c,jc(f))}return Fr(f),null;case 5:if(Nn(f),y=f.type,c!==null&&f.stateNode!=null)c.memoizedProps!==T&&jc(f);else{if(!T){if(f.stateNode===null)throw Error(n(166));return Fr(f),null}if(c=Se.current,vr(f))$g(f);else{switch(P=xv(Ye.current),c){case 1:c=P.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:c=P.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":c=P.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":c=P.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":c=P.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof T.is=="string"?P.createElement("select",{is:T.is}):P.createElement("select"),T.multiple?c.multiple=!0:T.size&&(c.size=T.size);break;default:c=typeof T.is=="string"?P.createElement(y,{is:T.is}):P.createElement(y)}}c[ke]=f,c[We]=T;e:for(P=f.child;P!==null;){if(P.tag===5||P.tag===6)c.appendChild(P.stateNode);else if(P.tag!==4&&P.tag!==27&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===f)break e;for(;P.sibling===null;){if(P.return===null||P.return===f)break e;P=P.return}P.sibling.return=P.return,P=P.sibling}f.stateNode=c;e:switch(to(c,y,T),y){case"button":case"input":case"select":case"textarea":c=!!T.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&jc(f)}}return Fr(f),f.flags&=-16777217,null;case 6:if(c&&f.stateNode!=null)c.memoizedProps!==T&&jc(f);else{if(typeof T!="string"&&f.stateNode===null)throw Error(n(166));if(c=Ye.current,vr(f)){if(c=f.stateNode,y=f.memoizedProps,T=null,P=Zs,P!==null)switch(P.tag){case 27:case 5:T=P.memoizedProps}c[ke]=f,c=!!(c.nodeValue===y||T!==null&&T.suppressHydrationWarning===!0||aP(c.nodeValue,y)),c||Uc(f)}else c=xv(c).createTextNode(T),c[ke]=f,f.stateNode=c}return Fr(f),null;case 13:if(T=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(P=vr(f),T!==null&&T.dehydrated!==null){if(c===null){if(!P)throw Error(n(318));if(P=f.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(n(317));P[ke]=f}else Nd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Fr(f),P=!1}else P=X2(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=P),P=!0;if(!P)return f.flags&256?(Hc(f),f):(Hc(f),null)}if(Hc(f),(f.flags&128)!==0)return f.lanes=y,f;if(y=T!==null,c=c!==null&&c.memoizedState!==null,y){T=f.child,P=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(P=T.alternate.memoizedState.cachePool.pool);var U=null;T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(U=T.memoizedState.cachePool.pool),U!==P&&(T.flags|=2048)}return y!==c&&y&&(f.child.flags|=8192),lv(f,f.updateQueue),Fr(f),null;case 4:return Gt(),c===null&&GE(f.stateNode.containerInfo),Fr(f),null;case 10:return cl(f.type),Fr(f),null;case 19:if(ve(Ss),P=f.memoizedState,P===null)return Fr(f),null;if(T=(f.flags&128)!==0,U=P.rendering,U===null)if(T)t1(P,!1);else{if(Xr!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(U=iv(c),U!==null){for(f.flags|=128,t1(P,!1),c=U.updateQueue,f.updateQueue=c,lv(f,c),f.subtreeFlags=0,c=y,y=f.child;y!==null;)j2(y,c),y=y.sibling;return Pe(Ss,Ss.current&1|2),f.child}c=c.sibling}P.tail!==null&&pt()>hv&&(f.flags|=128,T=!0,t1(P,!1),f.lanes=4194304)}else{if(!T)if(c=iv(U),c!==null){if(f.flags|=128,T=!0,c=c.updateQueue,f.updateQueue=c,lv(f,c),t1(P,!0),P.tail===null&&P.tailMode==="hidden"&&!U.alternate&&!Ci)return Fr(f),null}else 2*pt()-P.renderingStartTime>hv&&y!==536870912&&(f.flags|=128,T=!0,t1(P,!1),f.lanes=4194304);P.isBackwards?(U.sibling=f.child,f.child=U):(c=P.last,c!==null?c.sibling=U:f.child=U,P.last=U)}return P.tail!==null?(f=P.tail,P.rendering=f,P.tail=f.sibling,P.renderingStartTime=pt(),f.sibling=null,c=Ss.current,Pe(Ss,T?c&1|2:c&1),f):(Fr(f),null);case 22:case 23:return Hc(f),Mt(),T=f.memoizedState!==null,c!==null?c.memoizedState!==null!==T&&(f.flags|=8192):T&&(f.flags|=8192),T?(y&536870912)!==0&&(f.flags&128)===0&&(Fr(f),f.subtreeFlags&6&&(f.flags|=8192)):Fr(f),y=f.updateQueue,y!==null&&lv(f,y.retryQueue),y=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),T=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(T=f.memoizedState.cachePool.pool),T!==y&&(f.flags|=2048),c!==null&&ve(wt),null;case 24:return y=null,c!==null&&(y=c.memoizedState.cache),f.memoizedState.cache!==y&&(f.flags|=2048),cl(Xt),Fr(f),null;case 25:return null;case 30:return null}throw Error(n(156,f.tag))}function Ej(c,f){switch(jg(f),f.tag){case 1:return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return cl(Xt),Gt(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 26:case 27:case 5:return Nn(f),null;case 13:if(Hc(f),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(n(340));Nd()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return ve(Ss),null;case 4:return Gt(),null;case 10:return cl(f.type),null;case 22:case 23:return Hc(f),Mt(),c!==null&&ve(wt),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 24:return cl(Xt),null;case 25:return null;default:return null}}function pD(c,f){switch(jg(f),f.tag){case 3:cl(Xt),Gt();break;case 26:case 27:case 5:Nn(f);break;case 4:Gt();break;case 13:Hc(f);break;case 19:ve(Ss);break;case 10:cl(f.type);break;case 22:case 23:Hc(f),Mt(),c!==null&&ve(wt);break;case 24:cl(Xt)}}function n1(c,f){try{var y=f.updateQueue,T=y!==null?y.lastEffect:null;if(T!==null){var P=T.next;y=P;do{if((y.tag&c)===c){T=void 0;var U=y.create,Y=y.inst;T=U(),Y.destroy=T}y=y.next}while(y!==P)}}catch(le){Ar(f,f.return,le)}}function af(c,f,y){try{var T=f.updateQueue,P=T!==null?T.lastEffect:null;if(P!==null){var U=P.next;T=U;do{if((T.tag&c)===c){var Y=T.inst,le=Y.destroy;if(le!==void 0){Y.destroy=void 0,P=f;var xe=y,qe=le;try{qe()}catch(ot){Ar(P,xe,ot)}}}T=T.next}while(T!==U)}}catch(ot){Ar(f,f.return,ot)}}function mD(c){var f=c.updateQueue;if(f!==null){var y=c.stateNode;try{Ne(f,y)}catch(T){Ar(c,c.return,T)}}}function gD(c,f,y){y.props=Ld(c.type,c.memoizedProps),y.state=c.memoizedState;try{y.componentWillUnmount()}catch(T){Ar(c,f,T)}}function i1(c,f){try{var y=c.ref;if(y!==null){switch(c.tag){case 26:case 27:case 5:var T=c.stateNode;break;case 30:T=c.stateNode;break;default:T=c.stateNode}typeof y=="function"?c.refCleanup=y(T):y.current=T}}catch(P){Ar(c,f,P)}}function Nu(c,f){var y=c.ref,T=c.refCleanup;if(y!==null)if(typeof T=="function")try{T()}catch(P){Ar(c,f,P)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(P){Ar(c,f,P)}else y.current=null}function _D(c){var f=c.type,y=c.memoizedProps,T=c.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":y.autoFocus&&T.focus();break e;case"img":y.src?T.src=y.src:y.srcSet&&(T.srcset=y.srcSet)}}catch(P){Ar(c,c.return,P)}}function mE(c,f,y){try{var T=c.stateNode;jj(T,c.type,y,f),T[We]=f}catch(P){Ar(c,c.return,P)}}function yD(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&pf(c.type)||c.tag===4}function gE(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||yD(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&pf(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function _E(c,f,y){var T=c.tag;if(T===5||T===6)c=c.stateNode,f?(y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y).insertBefore(c,f):(f=y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y,f.appendChild(c),y=y._reactRootContainer,y!=null||f.onclick!==null||(f.onclick=vv));else if(T!==4&&(T===27&&pf(c.type)&&(y=c.stateNode,f=null),c=c.child,c!==null))for(_E(c,f,y),c=c.sibling;c!==null;)_E(c,f,y),c=c.sibling}function uv(c,f,y){var T=c.tag;if(T===5||T===6)c=c.stateNode,f?y.insertBefore(c,f):y.appendChild(c);else if(T!==4&&(T===27&&pf(c.type)&&(y=c.stateNode),c=c.child,c!==null))for(uv(c,f,y),c=c.sibling;c!==null;)uv(c,f,y),c=c.sibling}function vD(c){var f=c.stateNode,y=c.memoizedProps;try{for(var T=c.type,P=f.attributes;P.length;)f.removeAttributeNode(P[0]);to(f,T,y),f[ke]=c,f[We]=y}catch(U){Ar(c,c.return,U)}}var Xc=!1,is=!1,yE=!1,xD=typeof WeakSet=="function"?WeakSet:Set,Bs=null;function wj(c,f){if(c=c.containerInfo,qE=Mv,c=Bg(c),Ug(c)){if("selectionStart"in c)var y={start:c.selectionStart,end:c.selectionEnd};else e:{y=(y=c.ownerDocument)&&y.defaultView||window;var T=y.getSelection&&y.getSelection();if(T&&T.rangeCount!==0){y=T.anchorNode;var P=T.anchorOffset,U=T.focusNode;T=T.focusOffset;try{y.nodeType,U.nodeType}catch{y=null;break e}var Y=0,le=-1,xe=-1,qe=0,ot=0,mt=c,Xe=null;t:for(;;){for(var $e;mt!==y||P!==0&&mt.nodeType!==3||(le=Y+P),mt!==U||T!==0&&mt.nodeType!==3||(xe=Y+T),mt.nodeType===3&&(Y+=mt.nodeValue.length),($e=mt.firstChild)!==null;)Xe=mt,mt=$e;for(;;){if(mt===c)break t;if(Xe===y&&++qe===P&&(le=Y),Xe===U&&++ot===T&&(xe=Y),($e=mt.nextSibling)!==null)break;mt=Xe,Xe=mt.parentNode}mt=$e}y=le===-1||xe===-1?null:{start:le,end:xe}}else y=null}y=y||{start:0,end:0}}else y=null;for(HE={focusedElem:c,selectionRange:y},Mv=!1,Bs=f;Bs!==null;)if(f=Bs,c=f.child,(f.subtreeFlags&1024)!==0&&c!==null)c.return=f,Bs=c;else for(;Bs!==null;){switch(f=Bs,U=f.alternate,c=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((c&1024)!==0&&U!==null){c=void 0,y=f,P=U.memoizedProps,U=U.memoizedState,T=y.stateNode;try{var Un=Ld(y.type,P,y.elementType===y.type);c=T.getSnapshotBeforeUpdate(Un,U),T.__reactInternalSnapshotBeforeUpdate=c}catch(Mn){Ar(y,y.return,Mn)}}break;case 3:if((c&1024)!==0){if(c=f.stateNode.containerInfo,y=c.nodeType,y===9)XE(c);else if(y===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":XE(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(n(163))}if(c=f.sibling,c!==null){c.return=f.return,Bs=c;break}Bs=f.return}}function bD(c,f,y){var T=y.flags;switch(y.tag){case 0:case 11:case 15:lf(c,y),T&4&&n1(5,y);break;case 1:if(lf(c,y),T&4)if(c=y.stateNode,f===null)try{c.componentDidMount()}catch(Y){Ar(y,y.return,Y)}else{var P=Ld(y.type,f.memoizedProps);f=f.memoizedState;try{c.componentDidUpdate(P,f,c.__reactInternalSnapshotBeforeUpdate)}catch(Y){Ar(y,y.return,Y)}}T&64&&mD(y),T&512&&i1(y,y.return);break;case 3:if(lf(c,y),T&64&&(c=y.updateQueue,c!==null)){if(f=null,y.child!==null)switch(y.child.tag){case 27:case 5:f=y.child.stateNode;break;case 1:f=y.child.stateNode}try{Ne(c,f)}catch(Y){Ar(y,y.return,Y)}}break;case 27:f===null&&T&4&&vD(y);case 26:case 5:lf(c,y),f===null&&T&4&&_D(y),T&512&&i1(y,y.return);break;case 12:lf(c,y);break;case 13:lf(c,y),T&4&&ED(c,y),T&64&&(c=y.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(y=Ij.bind(null,y),Jj(c,y))));break;case 22:if(T=y.memoizedState!==null||Xc,!T){f=f!==null&&f.memoizedState!==null||is,P=Xc;var U=is;Xc=T,(is=f)&&!U?uf(c,y,(y.subtreeFlags&8772)!==0):lf(c,y),Xc=P,is=U}break;case 30:break;default:lf(c,y)}}function SD(c){var f=c.alternate;f!==null&&(c.alternate=null,SD(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&hr(f)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var Dr=null,Jo=!1;function $c(c,f,y){for(y=y.child;y!==null;)TD(c,f,y),y=y.sibling}function TD(c,f,y){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(Qe,y)}catch{}switch(y.tag){case 26:is||Nu(y,f),$c(c,f,y),y.memoizedState?y.memoizedState.count--:y.stateNode&&(y=y.stateNode,y.parentNode.removeChild(y));break;case 27:is||Nu(y,f);var T=Dr,P=Jo;pf(y.type)&&(Dr=y.stateNode,Jo=!1),$c(c,f,y),f1(y.stateNode),Dr=T,Jo=P;break;case 5:is||Nu(y,f);case 6:if(T=Dr,P=Jo,Dr=null,$c(c,f,y),Dr=T,Jo=P,Dr!==null)if(Jo)try{(Dr.nodeType===9?Dr.body:Dr.nodeName==="HTML"?Dr.ownerDocument.body:Dr).removeChild(y.stateNode)}catch(U){Ar(y,f,U)}else try{Dr.removeChild(y.stateNode)}catch(U){Ar(y,f,U)}break;case 18:Dr!==null&&(Jo?(c=Dr,fP(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,y.stateNode),v1(c)):fP(Dr,y.stateNode));break;case 4:T=Dr,P=Jo,Dr=y.stateNode.containerInfo,Jo=!0,$c(c,f,y),Dr=T,Jo=P;break;case 0:case 11:case 14:case 15:is||af(2,y,f),is||af(4,y,f),$c(c,f,y);break;case 1:is||(Nu(y,f),T=y.stateNode,typeof T.componentWillUnmount=="function"&&gD(y,f,T)),$c(c,f,y);break;case 21:$c(c,f,y);break;case 22:is=(T=is)||y.memoizedState!==null,$c(c,f,y),is=T;break;default:$c(c,f,y)}}function ED(c,f){if(f.memoizedState===null&&(c=f.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{v1(c)}catch(y){Ar(f,f.return,y)}}function Mj(c){switch(c.tag){case 13:case 19:var f=c.stateNode;return f===null&&(f=c.stateNode=new xD),f;case 22:return c=c.stateNode,f=c._retryCache,f===null&&(f=c._retryCache=new xD),f;default:throw Error(n(435,c.tag))}}function vE(c,f){var y=Mj(c);f.forEach(function(T){var P=Bj.bind(null,c,T);y.has(T)||(y.add(T),T.then(P,P))})}function Da(c,f){var y=f.deletions;if(y!==null)for(var T=0;T<y.length;T++){var P=y[T],U=c,Y=f,le=Y;e:for(;le!==null;){switch(le.tag){case 27:if(pf(le.type)){Dr=le.stateNode,Jo=!1;break e}break;case 5:Dr=le.stateNode,Jo=!1;break e;case 3:case 4:Dr=le.stateNode.containerInfo,Jo=!0;break e}le=le.return}if(Dr===null)throw Error(n(160));TD(U,Y,P),Dr=null,Jo=!1,U=P.alternate,U!==null&&(U.return=null),P.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)wD(f,c),f=f.sibling}var Yl=null;function wD(c,f){var y=c.alternate,T=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:Da(f,c),Pa(c),T&4&&(af(3,c,c.return),n1(3,c),af(5,c,c.return));break;case 1:Da(f,c),Pa(c),T&512&&(is||y===null||Nu(y,y.return)),T&64&&Xc&&(c=c.updateQueue,c!==null&&(T=c.callbacks,T!==null&&(y=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=y===null?T:y.concat(T))));break;case 26:var P=Yl;if(Da(f,c),Pa(c),T&512&&(is||y===null||Nu(y,y.return)),T&4){var U=y!==null?y.memoizedState:null;if(T=c.memoizedState,y===null)if(T===null)if(c.stateNode===null){e:{T=c.type,y=c.memoizedProps,P=P.ownerDocument||P;t:switch(T){case"title":U=P.getElementsByTagName("title")[0],(!U||U[ci]||U[ke]||U.namespaceURI==="http://www.w3.org/2000/svg"||U.hasAttribute("itemprop"))&&(U=P.createElement(T),P.head.insertBefore(U,P.querySelector("head > title"))),to(U,T,y),U[ke]=c,on(U),T=U;break e;case"link":var Y=vP("link","href",P).get(T+(y.href||""));if(Y){for(var le=0;le<Y.length;le++)if(U=Y[le],U.getAttribute("href")===(y.href==null||y.href===""?null:y.href)&&U.getAttribute("rel")===(y.rel==null?null:y.rel)&&U.getAttribute("title")===(y.title==null?null:y.title)&&U.getAttribute("crossorigin")===(y.crossOrigin==null?null:y.crossOrigin)){Y.splice(le,1);break t}}U=P.createElement(T),to(U,T,y),P.head.appendChild(U);break;case"meta":if(Y=vP("meta","content",P).get(T+(y.content||""))){for(le=0;le<Y.length;le++)if(U=Y[le],U.getAttribute("content")===(y.content==null?null:""+y.content)&&U.getAttribute("name")===(y.name==null?null:y.name)&&U.getAttribute("property")===(y.property==null?null:y.property)&&U.getAttribute("http-equiv")===(y.httpEquiv==null?null:y.httpEquiv)&&U.getAttribute("charset")===(y.charSet==null?null:y.charSet)){Y.splice(le,1);break t}}U=P.createElement(T),to(U,T,y),P.head.appendChild(U);break;default:throw Error(n(468,T))}U[ke]=c,on(U),T=U}c.stateNode=T}else xP(P,c.type,c.stateNode);else c.stateNode=yP(P,T,c.memoizedProps);else U!==T?(U===null?y.stateNode!==null&&(y=y.stateNode,y.parentNode.removeChild(y)):U.count--,T===null?xP(P,c.type,c.stateNode):yP(P,T,c.memoizedProps)):T===null&&c.stateNode!==null&&mE(c,c.memoizedProps,y.memoizedProps)}break;case 27:Da(f,c),Pa(c),T&512&&(is||y===null||Nu(y,y.return)),y!==null&&T&4&&mE(c,c.memoizedProps,y.memoizedProps);break;case 5:if(Da(f,c),Pa(c),T&512&&(is||y===null||Nu(y,y.return)),c.flags&32){P=c.stateNode;try{il(P,"")}catch($e){Ar(c,c.return,$e)}}T&4&&c.stateNode!=null&&(P=c.memoizedProps,mE(c,P,y!==null?y.memoizedProps:P)),T&1024&&(yE=!0);break;case 6:if(Da(f,c),Pa(c),T&4){if(c.stateNode===null)throw Error(n(162));T=c.memoizedProps,y=c.stateNode;try{y.nodeValue=T}catch($e){Ar(c,c.return,$e)}}break;case 3:if(Tv=null,P=Yl,Yl=bv(f.containerInfo),Da(f,c),Yl=P,Pa(c),T&4&&y!==null&&y.memoizedState.isDehydrated)try{v1(f.containerInfo)}catch($e){Ar(c,c.return,$e)}yE&&(yE=!1,MD(c));break;case 4:T=Yl,Yl=bv(c.stateNode.containerInfo),Da(f,c),Pa(c),Yl=T;break;case 12:Da(f,c),Pa(c);break;case 13:Da(f,c),Pa(c),c.child.flags&8192&&c.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(wE=pt()),T&4&&(T=c.updateQueue,T!==null&&(c.updateQueue=null,vE(c,T)));break;case 22:P=c.memoizedState!==null;var xe=y!==null&&y.memoizedState!==null,qe=Xc,ot=is;if(Xc=qe||P,is=ot||xe,Da(f,c),is=ot,Xc=qe,Pa(c),T&8192)e:for(f=c.stateNode,f._visibility=P?f._visibility&-2:f._visibility|1,P&&(y===null||xe||Xc||is||Od(c)),y=null,f=c;;){if(f.tag===5||f.tag===26){if(y===null){xe=y=f;try{if(U=xe.stateNode,P)Y=U.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{le=xe.stateNode;var mt=xe.memoizedProps.style,Xe=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;le.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch($e){Ar(xe,xe.return,$e)}}}else if(f.tag===6){if(y===null){xe=f;try{xe.stateNode.nodeValue=P?"":xe.memoizedProps}catch($e){Ar(xe,xe.return,$e)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===c)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break e;for(;f.sibling===null;){if(f.return===null||f.return===c)break e;y===f&&(y=null),f=f.return}y===f&&(y=null),f.sibling.return=f.return,f=f.sibling}T&4&&(T=c.updateQueue,T!==null&&(y=T.retryQueue,y!==null&&(T.retryQueue=null,vE(c,y))));break;case 19:Da(f,c),Pa(c),T&4&&(T=c.updateQueue,T!==null&&(c.updateQueue=null,vE(c,T)));break;case 30:break;case 21:break;default:Da(f,c),Pa(c)}}function Pa(c){var f=c.flags;if(f&2){try{for(var y,T=c.return;T!==null;){if(yD(T)){y=T;break}T=T.return}if(y==null)throw Error(n(160));switch(y.tag){case 27:var P=y.stateNode,U=gE(c);uv(c,U,P);break;case 5:var Y=y.stateNode;y.flags&32&&(il(Y,""),y.flags&=-33);var le=gE(c);uv(c,le,Y);break;case 3:case 4:var xe=y.stateNode.containerInfo,qe=gE(c);_E(c,qe,xe);break;default:throw Error(n(161))}}catch(ot){Ar(c,c.return,ot)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function MD(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var f=c;MD(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),c=c.sibling}}function lf(c,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)bD(c,f.alternate,f),f=f.sibling}function Od(c){for(c=c.child;c!==null;){var f=c;switch(f.tag){case 0:case 11:case 14:case 15:af(4,f,f.return),Od(f);break;case 1:Nu(f,f.return);var y=f.stateNode;typeof y.componentWillUnmount=="function"&&gD(f,f.return,y),Od(f);break;case 27:f1(f.stateNode);case 26:case 5:Nu(f,f.return),Od(f);break;case 22:f.memoizedState===null&&Od(f);break;case 30:Od(f);break;default:Od(f)}c=c.sibling}}function uf(c,f,y){for(y=y&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var T=f.alternate,P=c,U=f,Y=U.flags;switch(U.tag){case 0:case 11:case 15:uf(P,U,y),n1(4,U);break;case 1:if(uf(P,U,y),T=U,P=T.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(qe){Ar(T,T.return,qe)}if(T=U,P=T.updateQueue,P!==null){var le=T.stateNode;try{var xe=P.shared.hiddenCallbacks;if(xe!==null)for(P.shared.hiddenCallbacks=null,P=0;P<xe.length;P++)Te(xe[P],le)}catch(qe){Ar(T,T.return,qe)}}y&&Y&64&&mD(U),i1(U,U.return);break;case 27:vD(U);case 26:case 5:uf(P,U,y),y&&T===null&&Y&4&&_D(U),i1(U,U.return);break;case 12:uf(P,U,y);break;case 13:uf(P,U,y),y&&Y&4&&ED(P,U);break;case 22:U.memoizedState===null&&uf(P,U,y),i1(U,U.return);break;case 30:break;default:uf(P,U,y)}f=f.sibling}}function xE(c,f){var y=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),c=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(c=f.memoizedState.cachePool.pool),c!==y&&(c!=null&&c.refCount++,y!=null&&tf(y))}function bE(c,f){c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&tf(c))}function Du(c,f,y,T){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)RD(c,f,y,T),f=f.sibling}function RD(c,f,y,T){var P=f.flags;switch(f.tag){case 0:case 11:case 15:Du(c,f,y,T),P&2048&&n1(9,f);break;case 1:Du(c,f,y,T);break;case 3:Du(c,f,y,T),P&2048&&(c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&tf(c)));break;case 12:if(P&2048){Du(c,f,y,T),c=f.stateNode;try{var U=f.memoizedProps,Y=U.id,le=U.onPostCommit;typeof le=="function"&&le(Y,f.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(xe){Ar(f,f.return,xe)}}else Du(c,f,y,T);break;case 13:Du(c,f,y,T);break;case 23:break;case 22:U=f.stateNode,Y=f.alternate,f.memoizedState!==null?U._visibility&2?Du(c,f,y,T):r1(c,f):U._visibility&2?Du(c,f,y,T):(U._visibility|=2,L0(c,f,y,T,(f.subtreeFlags&10256)!==0)),P&2048&&xE(Y,f);break;case 24:Du(c,f,y,T),P&2048&&bE(f.alternate,f);break;default:Du(c,f,y,T)}}function L0(c,f,y,T,P){for(P=P&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var U=c,Y=f,le=y,xe=T,qe=Y.flags;switch(Y.tag){case 0:case 11:case 15:L0(U,Y,le,xe,P),n1(8,Y);break;case 23:break;case 22:var ot=Y.stateNode;Y.memoizedState!==null?ot._visibility&2?L0(U,Y,le,xe,P):r1(U,Y):(ot._visibility|=2,L0(U,Y,le,xe,P)),P&&qe&2048&&xE(Y.alternate,Y);break;case 24:L0(U,Y,le,xe,P),P&&qe&2048&&bE(Y.alternate,Y);break;default:L0(U,Y,le,xe,P)}f=f.sibling}}function r1(c,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var y=c,T=f,P=T.flags;switch(T.tag){case 22:r1(y,T),P&2048&&xE(T.alternate,T);break;case 24:r1(y,T),P&2048&&bE(T.alternate,T);break;default:r1(y,T)}f=f.sibling}}var s1=8192;function O0(c){if(c.subtreeFlags&s1)for(c=c.child;c!==null;)CD(c),c=c.sibling}function CD(c){switch(c.tag){case 26:O0(c),c.flags&s1&&c.memoizedState!==null&&fX(Yl,c.memoizedState,c.memoizedProps);break;case 5:O0(c);break;case 3:case 4:var f=Yl;Yl=bv(c.stateNode.containerInfo),O0(c),Yl=f;break;case 22:c.memoizedState===null&&(f=c.alternate,f!==null&&f.memoizedState!==null?(f=s1,s1=16777216,O0(c),s1=f):O0(c));break;default:O0(c)}}function ND(c){var f=c.alternate;if(f!==null&&(c=f.child,c!==null)){f.child=null;do f=c.sibling,c.sibling=null,c=f;while(c!==null)}}function o1(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var y=0;y<f.length;y++){var T=f[y];Bs=T,PD(T,c)}ND(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)DD(c),c=c.sibling}function DD(c){switch(c.tag){case 0:case 11:case 15:o1(c),c.flags&2048&&af(9,c,c.return);break;case 3:o1(c);break;case 12:o1(c);break;case 22:var f=c.stateNode;c.memoizedState!==null&&f._visibility&2&&(c.return===null||c.return.tag!==13)?(f._visibility&=-3,cv(c)):o1(c);break;default:o1(c)}}function cv(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var y=0;y<f.length;y++){var T=f[y];Bs=T,PD(T,c)}ND(c)}for(c=c.child;c!==null;){switch(f=c,f.tag){case 0:case 11:case 15:af(8,f,f.return),cv(f);break;case 22:y=f.stateNode,y._visibility&2&&(y._visibility&=-3,cv(f));break;default:cv(f)}c=c.sibling}}function PD(c,f){for(;Bs!==null;){var y=Bs;switch(y.tag){case 0:case 11:case 15:af(8,y,f);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var T=y.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:tf(y.memoizedState.cache)}if(T=y.child,T!==null)T.return=y,Bs=T;else e:for(y=c;Bs!==null;){T=Bs;var P=T.sibling,U=T.return;if(SD(T),T===y){Bs=null;break e}if(P!==null){P.return=U,Bs=P;break e}Bs=U}}}var Rj={getCacheForType:function(c){var f=Os(Xt),y=f.data.get(c);return y===void 0&&(y=c(),f.data.set(c,y)),y}},Cj=typeof WeakMap=="function"?WeakMap:Map,er=0,xr=null,gi=null,Mi=0,tr=0,La=null,cf=!1,I0=!1,SE=!1,Yc=0,Xr=0,hf=0,Id=0,TE=0,pl=0,B0=0,a1=null,ea=null,EE=!1,wE=0,hv=1/0,fv=null,ff=null,eo=0,df=null,U0=null,F0=0,ME=0,RE=null,LD=null,l1=0,CE=null;function Oa(){if((er&2)!==0&&Mi!==0)return Mi&-Mi;if($.T!==null){var c=nf;return c!==0?c:BE()}return Bn()}function OD(){pl===0&&(pl=(Mi&536870912)===0||Ci?fe():536870912);var c=Al.current;return c!==null&&(c.flags|=32),pl}function Ia(c,f,y){(c===xr&&(tr===2||tr===9)||c.cancelPendingCommit!==null)&&(k0(c,0),Af(c,Mi,pl,!1)),Ht(c,y),((er&2)===0||c!==xr)&&(c===xr&&((er&2)===0&&(Id|=y),Xr===4&&Af(c,Mi,pl,!1)),Pu(c))}function ID(c,f,y){if((er&6)!==0)throw Error(n(327));var T=!y&&(f&124)===0&&(f&c.expiredLanes)===0||It(c,f),P=T?Pj(c,f):PE(c,f,!0),U=T;do{if(P===0){I0&&!T&&Af(c,f,0,!1);break}else{if(y=c.current.alternate,U&&!Nj(y)){P=PE(c,f,!1),U=!1;continue}if(P===2){if(U=f,c.errorRecoveryDisabledLanes&U)var Y=0;else Y=c.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){f=Y;e:{var le=c;P=a1;var xe=le.current.memoizedState.isDehydrated;if(xe&&(k0(le,Y).flags|=256),Y=PE(le,Y,!1),Y!==2){if(SE&&!xe){le.errorRecoveryDisabledLanes|=U,Id|=U,P=4;break e}U=ea,ea=P,U!==null&&(ea===null?ea=U:ea.push.apply(ea,U))}P=Y}if(U=!1,P!==2)continue}}if(P===1){k0(c,0),Af(c,f,0,!0);break}e:{switch(T=c,U=P,U){case 0:case 1:throw Error(n(345));case 4:if((f&4194048)!==f)break;case 6:Af(T,f,pl,!cf);break e;case 2:ea=null;break;case 3:case 5:break;default:throw Error(n(329))}if((f&62914560)===f&&(P=wE+300-pt(),10<P)){if(Af(T,f,pl,!cf),sn(T,0,!0)!==0)break e;T.timeoutHandle=cP(BD.bind(null,T,y,ea,fv,EE,f,pl,Id,B0,cf,U,2,-0,0),P);break e}BD(T,y,ea,fv,EE,f,pl,Id,B0,cf,U,0,-0,0)}}break}while(!0);Pu(c)}function BD(c,f,y,T,P,U,Y,le,xe,qe,ot,mt,Xe,$e){if(c.timeoutHandle=-1,mt=f.subtreeFlags,(mt&8192||(mt&16785408)===16785408)&&(p1={stylesheets:null,count:0,unsuspend:hX},CD(f),mt=dX(),mt!==null)){c.cancelPendingCommit=mt(qD.bind(null,c,f,U,y,T,P,Y,le,xe,ot,1,Xe,$e)),Af(c,U,Y,!qe);return}qD(c,f,U,y,T,P,Y,le,xe)}function Nj(c){for(var f=c;;){var y=f.tag;if((y===0||y===11||y===15)&&f.flags&16384&&(y=f.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var T=0;T<y.length;T++){var P=y[T],U=P.getSnapshot;P=P.value;try{if(!Qs(U(),P))return!1}catch{return!1}}if(y=f.child,f.subtreeFlags&16384&&y!==null)y.return=f,f=y;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Af(c,f,y,T){f&=~TE,f&=~Id,c.suspendedLanes|=f,c.pingedLanes&=~f,T&&(c.warmLanes|=f),T=c.expirationTimes;for(var P=f;0<P;){var U=31-qt(P),Y=1<<U;T[U]=-1,P&=~Y}y!==0&&ut(c,y,f)}function dv(){return(er&6)===0?(u1(0),!1):!0}function NE(){if(gi!==null){if(tr===0)var c=gi.return;else c=gi,jl=Fc=null,X3(c),D0=null,Jg=0,c=gi;for(;c!==null;)pD(c.alternate,c),c=c.return;gi=null}}function k0(c,f){var y=c.timeoutHandle;y!==-1&&(c.timeoutHandle=-1,$j(y)),y=c.cancelPendingCommit,y!==null&&(c.cancelPendingCommit=null,y()),NE(),xr=c,gi=y=Vl(c.current,null),Mi=f,tr=0,La=null,cf=!1,I0=It(c,f),SE=!1,B0=pl=TE=Id=hf=Xr=0,ea=a1=null,EE=!1,(f&8)!==0&&(f|=f&32);var T=c.entangledLanes;if(T!==0)for(c=c.entanglements,T&=f;0<T;){var P=31-qt(T),U=1<<P;f|=c[P],T&=~U}return Yc=f,y0(),y}function UD(c,f){yt=null,$.H=ev,f===Ru||f===dl?(f=v(),tr=3):f===Vc?(f=v(),tr=4):tr=f===tD?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,La=f,gi===null&&(Xr=1,sv(c,$o(f,c.current)))}function FD(){var c=$.H;return $.H=ev,c===null?ev:c}function kD(){var c=$.A;return $.A=Rj,c}function DE(){Xr=4,cf||(Mi&4194048)!==Mi&&Al.current!==null||(I0=!0),(hf&134217727)===0&&(Id&134217727)===0||xr===null||Af(xr,Mi,pl,!1)}function PE(c,f,y){var T=er;er|=2;var P=FD(),U=kD();(xr!==c||Mi!==f)&&(fv=null,k0(c,f)),f=!1;var Y=Xr;e:do try{if(tr!==0&&gi!==null){var le=gi,xe=La;switch(tr){case 8:NE(),Y=6;break e;case 3:case 2:case 9:case 6:Al.current===null&&(f=!0);var qe=tr;if(tr=0,La=null,G0(c,le,xe,qe),y&&I0){Y=0;break e}break;default:qe=tr,tr=0,La=null,G0(c,le,xe,qe)}}Dj(),Y=Xr;break}catch(ot){UD(c,ot)}while(!0);return f&&c.shellSuspendCounter++,jl=Fc=null,er=T,$.H=P,$.A=U,gi===null&&(xr=null,Mi=0,y0()),Y}function Dj(){for(;gi!==null;)GD(gi)}function Pj(c,f){var y=er;er|=2;var T=FD(),P=kD();xr!==c||Mi!==f?(fv=null,hv=pt()+500,k0(c,f)):I0=It(c,f);e:do try{if(tr!==0&&gi!==null){f=gi;var U=La;t:switch(tr){case 1:tr=0,La=null,G0(c,f,U,1);break;case 2:case 9:if($l(U)){tr=0,La=null,zD(f);break}f=function(){tr!==2&&tr!==9||xr!==c||(tr=7),Pu(c)},U.then(f,f);break e;case 3:tr=7;break e;case 4:tr=5;break e;case 7:$l(U)?(tr=0,La=null,zD(f)):(tr=0,La=null,G0(c,f,U,7));break;case 5:var Y=null;switch(gi.tag){case 26:Y=gi.memoizedState;case 5:case 27:var le=gi;if(!Y||bP(Y)){tr=0,La=null;var xe=le.sibling;if(xe!==null)gi=xe;else{var qe=le.return;qe!==null?(gi=qe,Av(qe)):gi=null}break t}}tr=0,La=null,G0(c,f,U,5);break;case 6:tr=0,La=null,G0(c,f,U,6);break;case 8:NE(),Xr=6;break e;default:throw Error(n(462))}}Lj();break}catch(ot){UD(c,ot)}while(!0);return jl=Fc=null,$.H=T,$.A=P,er=y,gi!==null?0:(xr=null,Mi=0,y0(),Xr)}function Lj(){for(;gi!==null&&!vt();)GD(gi)}function GD(c){var f=dD(c.alternate,c,Yc);c.memoizedProps=c.pendingProps,f===null?Av(c):gi=f}function zD(c){var f=c,y=f.alternate;switch(f.tag){case 15:case 0:f=aD(y,f,f.pendingProps,f.type,void 0,Mi);break;case 11:f=aD(y,f,f.pendingProps,f.type.render,f.ref,Mi);break;case 5:X3(f);default:pD(y,f),f=gi=j2(f,Yc),f=dD(y,f,Yc)}c.memoizedProps=c.pendingProps,f===null?Av(c):gi=f}function G0(c,f,y,T){jl=Fc=null,X3(f),D0=null,Jg=0;var P=f.return;try{if(bj(c,P,f,y,Mi)){Xr=1,sv(c,$o(y,c.current)),gi=null;return}}catch(U){if(P!==null)throw gi=P,U;Xr=1,sv(c,$o(y,c.current)),gi=null;return}f.flags&32768?(Ci||T===1?c=!0:I0||(Mi&536870912)!==0?c=!1:(cf=c=!0,(T===2||T===9||T===3||T===6)&&(T=Al.current,T!==null&&T.tag===13&&(T.flags|=16384))),VD(f,c)):Av(f)}function Av(c){var f=c;do{if((f.flags&32768)!==0){VD(f,cf);return}c=f.return;var y=Tj(f.alternate,f,Yc);if(y!==null){gi=y;return}if(f=f.sibling,f!==null){gi=f;return}gi=f=c}while(f!==null);Xr===0&&(Xr=5)}function VD(c,f){do{var y=Ej(c.alternate,c);if(y!==null){y.flags&=32767,gi=y;return}if(y=c.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!f&&(c=c.sibling,c!==null)){gi=c;return}gi=c=y}while(c!==null);Xr=6,gi=null}function qD(c,f,y,T,P,U,Y,le,xe){c.cancelPendingCommit=null;do pv();while(eo!==0);if((er&6)!==0)throw Error(n(327));if(f!==null){if(f===c.current)throw Error(n(177));if(U=f.lanes|f.childLanes,U|=Gg,Ct(c,y,U,Y,le,xe),c===xr&&(gi=xr=null,Mi=0),U0=f,df=c,F0=y,ME=U,RE=P,LD=T,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,Uj(Lt,function(){return $D(),null})):(c.callbackNode=null,c.callbackPriority=0),T=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||T){T=$.T,$.T=null,P=re.p,re.p=2,Y=er,er|=4;try{wj(c,f,y)}finally{er=Y,re.p=P,$.T=T}}eo=1,HD(),WD(),jD()}}function HD(){if(eo===1){eo=0;var c=df,f=U0,y=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||y){y=$.T,$.T=null;var T=re.p;re.p=2;var P=er;er|=4;try{wD(f,c);var U=HE,Y=Bg(c.containerInfo),le=U.focusedElem,xe=U.selectionRange;if(Y!==le&&le&&le.ownerDocument&&F2(le.ownerDocument.documentElement,le)){if(xe!==null&&Ug(le)){var qe=xe.start,ot=xe.end;if(ot===void 0&&(ot=qe),"selectionStart"in le)le.selectionStart=qe,le.selectionEnd=Math.min(ot,le.value.length);else{var mt=le.ownerDocument||document,Xe=mt&&mt.defaultView||window;if(Xe.getSelection){var $e=Xe.getSelection(),Un=le.textContent.length,Mn=Math.min(xe.start,Un),or=xe.end===void 0?Mn:Math.min(xe.end,Un);!$e.extend&&Mn>or&&(Y=or,or=Mn,Mn=Y);var Oe=Pc(le,Mn),Re=Pc(le,or);if(Oe&&Re&&($e.rangeCount!==1||$e.anchorNode!==Oe.node||$e.anchorOffset!==Oe.offset||$e.focusNode!==Re.node||$e.focusOffset!==Re.offset)){var ze=mt.createRange();ze.setStart(Oe.node,Oe.offset),$e.removeAllRanges(),Mn>or?($e.addRange(ze),$e.extend(Re.node,Re.offset)):(ze.setEnd(Re.node,Re.offset),$e.addRange(ze))}}}}for(mt=[],$e=le;$e=$e.parentNode;)$e.nodeType===1&&mt.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof le.focus=="function"&&le.focus(),le=0;le<mt.length;le++){var ht=mt[le];ht.element.scrollLeft=ht.left,ht.element.scrollTop=ht.top}}Mv=!!qE,HE=qE=null}finally{er=P,re.p=T,$.T=y}}c.current=f,eo=2}}function WD(){if(eo===2){eo=0;var c=df,f=U0,y=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||y){y=$.T,$.T=null;var T=re.p;re.p=2;var P=er;er|=4;try{bD(c,f.alternate,f)}finally{er=P,re.p=T,$.T=y}}eo=3}}function jD(){if(eo===4||eo===3){eo=0,ft();var c=df,f=U0,y=F0,T=LD;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?eo=5:(eo=0,U0=df=null,XD(c,c.pendingLanes));var P=c.pendingLanes;if(P===0&&(ff=null),$n(y),f=f.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(Qe,f,void 0,(f.current.flags&128)===128)}catch{}if(T!==null){f=$.T,P=re.p,re.p=2,$.T=null;try{for(var U=c.onRecoverableError,Y=0;Y<T.length;Y++){var le=T[Y];U(le.value,{componentStack:le.stack})}}finally{$.T=f,re.p=P}}(F0&3)!==0&&pv(),Pu(c),P=c.pendingLanes,(y&4194090)!==0&&(P&42)!==0?c===CE?l1++:(l1=0,CE=c):l1=0,u1(0)}}function XD(c,f){(c.pooledCacheLanes&=f)===0&&(f=c.pooledCache,f!=null&&(c.pooledCache=null,tf(f)))}function pv(c){return HD(),WD(),jD(),$D()}function $D(){if(eo!==5)return!1;var c=df,f=ME;ME=0;var y=$n(F0),T=$.T,P=re.p;try{re.p=32>y?32:y,$.T=null,y=RE,RE=null;var U=df,Y=F0;if(eo=0,U0=df=null,F0=0,(er&6)!==0)throw Error(n(331));var le=er;if(er|=4,DD(U.current),RD(U,U.current,Y,y),er=le,u1(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(Qe,U)}catch{}return!0}finally{re.p=P,$.T=T,XD(c,f)}}function YD(c,f,y){f=$o(y,f),f=aE(c.stateNode,f,2),c=V(c,f,2),c!==null&&(Ht(c,2),Pu(c))}function Ar(c,f,y){if(c.tag===3)YD(c,c,y);else for(;f!==null;){if(f.tag===3){YD(f,c,y);break}else if(f.tag===1){var T=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(ff===null||!ff.has(T))){c=$o(y,c),y=JN(2),T=V(f,y,2),T!==null&&(eD(y,T,f,c),Ht(T,2),Pu(T));break}}f=f.return}}function LE(c,f,y){var T=c.pingCache;if(T===null){T=c.pingCache=new Cj;var P=new Set;T.set(f,P)}else P=T.get(f),P===void 0&&(P=new Set,T.set(f,P));P.has(y)||(SE=!0,P.add(y),c=Oj.bind(null,c,f,y),f.then(c,c))}function Oj(c,f,y){var T=c.pingCache;T!==null&&T.delete(f),c.pingedLanes|=c.suspendedLanes&y,c.warmLanes&=~y,xr===c&&(Mi&y)===y&&(Xr===4||Xr===3&&(Mi&62914560)===Mi&&300>pt()-wE?(er&2)===0&&k0(c,0):TE|=y,B0===Mi&&(B0=0)),Pu(c)}function QD(c,f){f===0&&(f=Ut()),c=Kh(c,f),c!==null&&(Ht(c,f),Pu(c))}function Ij(c){var f=c.memoizedState,y=0;f!==null&&(y=f.retryLane),QD(c,y)}function Bj(c,f){var y=0;switch(c.tag){case 13:var T=c.stateNode,P=c.memoizedState;P!==null&&(y=P.retryLane);break;case 19:T=c.stateNode;break;case 22:T=c.stateNode._retryCache;break;default:throw Error(n(314))}T!==null&&T.delete(f),QD(c,y)}function Uj(c,f){return $t(c,f)}var mv=null,z0=null,OE=!1,gv=!1,IE=!1,Bd=0;function Pu(c){c!==z0&&c.next===null&&(z0===null?mv=z0=c:z0=z0.next=c),gv=!0,OE||(OE=!0,kj())}function u1(c,f){if(!IE&&gv){IE=!0;do for(var y=!1,T=mv;T!==null;){if(c!==0){var P=T.pendingLanes;if(P===0)var U=0;else{var Y=T.suspendedLanes,le=T.pingedLanes;U=(1<<31-qt(42|c)+1)-1,U&=P&~(Y&~le),U=U&201326741?U&201326741|1:U?U|2:0}U!==0&&(y=!0,eP(T,U))}else U=Mi,U=sn(T,T===xr?U:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(U&3)===0||It(T,U)||(y=!0,eP(T,U));T=T.next}while(y);IE=!1}}function Fj(){KD()}function KD(){gv=OE=!1;var c=0;Bd!==0&&(Xj()&&(c=Bd),Bd=0);for(var f=pt(),y=null,T=mv;T!==null;){var P=T.next,U=ZD(T,f);U===0?(T.next=null,y===null?mv=P:y.next=P,P===null&&(z0=y)):(y=T,(c!==0||(U&3)!==0)&&(gv=!0)),T=P}u1(c)}function ZD(c,f){for(var y=c.suspendedLanes,T=c.pingedLanes,P=c.expirationTimes,U=c.pendingLanes&-62914561;0<U;){var Y=31-qt(U),le=1<<Y,xe=P[Y];xe===-1?((le&y)===0||(le&T)!==0)&&(P[Y]=Dn(le,f)):xe<=f&&(c.expiredLanes|=le),U&=~le}if(f=xr,y=Mi,y=sn(c,c===f?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),T=c.callbackNode,y===0||c===f&&(tr===2||tr===9)||c.cancelPendingCommit!==null)return T!==null&&T!==null&&he(T),c.callbackNode=null,c.callbackPriority=0;if((y&3)===0||It(c,y)){if(f=y&-y,f===c.callbackPriority)return f;switch(T!==null&&he(T),$n(y)){case 2:case 8:y=Tt;break;case 32:y=Lt;break;case 268435456:y=pe;break;default:y=Lt}return T=JD.bind(null,c),y=$t(y,T),c.callbackPriority=f,c.callbackNode=y,f}return T!==null&&T!==null&&he(T),c.callbackPriority=2,c.callbackNode=null,2}function JD(c,f){if(eo!==0&&eo!==5)return c.callbackNode=null,c.callbackPriority=0,null;var y=c.callbackNode;if(pv()&&c.callbackNode!==y)return null;var T=Mi;return T=sn(c,c===xr?T:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),T===0?null:(ID(c,T,f),ZD(c,pt()),c.callbackNode!=null&&c.callbackNode===y?JD.bind(null,c):null)}function eP(c,f){if(pv())return null;ID(c,f,!0)}function kj(){Yj(function(){(er&6)!==0?$t(Ft,Fj):KD()})}function BE(){return Bd===0&&(Bd=fe()),Bd}function tP(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:yd(""+c)}function nP(c,f){var y=f.ownerDocument.createElement("input");return y.name=f.name,y.value=f.value,c.id&&y.setAttribute("form",c.id),f.parentNode.insertBefore(y,f),c=new FormData(c),y.parentNode.removeChild(y),c}function Gj(c,f,y,T,P){if(f==="submit"&&y&&y.stateNode===P){var U=tP((P[We]||null).action),Y=T.submitter;Y&&(f=(f=Y[We]||null)?tP(f.formAction):Y.getAttribute("formAction"),f!==null&&(U=f,Y=null));var le=new u0("action","action",null,T,P);c.push({event:le,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Bd!==0){var xe=Y?nP(P,Y):new FormData(P);nE(y,{pending:!0,data:xe,method:P.method,action:U},null,xe)}}else typeof U=="function"&&(le.preventDefault(),xe=Y?nP(P,Y):new FormData(P),nE(y,{pending:!0,data:xe,method:P.method,action:U},U,xe))},currentTarget:P}]})}}for(var UE=0;UE<_0.length;UE++){var FE=_0[UE],zj=FE.toLowerCase(),Vj=FE[0].toUpperCase()+FE.slice(1);Co(zj,"on"+Vj)}Co(G2,"onAnimationEnd"),Co(z2,"onAnimationIteration"),Co(V2,"onAnimationStart"),Co("dblclick","onDoubleClick"),Co("focusin","onFocus"),Co("focusout","onBlur"),Co(q2,"onTransitionRun"),Co(V3,"onTransitionStart"),Co(q3,"onTransitionCancel"),Co(H2,"onTransitionEnd"),ue("onMouseEnter",["mouseout","mouseover"]),ue("onMouseLeave",["mouseout","mouseover"]),ue("onPointerEnter",["pointerout","pointerover"]),ue("onPointerLeave",["pointerout","pointerover"]),kl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kl("onBeforeInput",["compositionend","keypress","textInput","paste"]),kl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var c1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(c1));function iP(c,f){f=(f&4)!==0;for(var y=0;y<c.length;y++){var T=c[y],P=T.event;T=T.listeners;e:{var U=void 0;if(f)for(var Y=T.length-1;0<=Y;Y--){var le=T[Y],xe=le.instance,qe=le.currentTarget;if(le=le.listener,xe!==U&&P.isPropagationStopped())break e;U=le,P.currentTarget=qe;try{U(P)}catch(ot){rv(ot)}P.currentTarget=null,U=xe}else for(Y=0;Y<T.length;Y++){if(le=T[Y],xe=le.instance,qe=le.currentTarget,le=le.listener,xe!==U&&P.isPropagationStopped())break e;U=le,P.currentTarget=qe;try{U(P)}catch(ot){rv(ot)}P.currentTarget=null,U=xe}}}}function _i(c,f){var y=f[rt];y===void 0&&(y=f[rt]=new Set);var T=c+"__bubble";y.has(T)||(rP(f,c,2,!1),y.add(T))}function kE(c,f,y){var T=0;f&&(T|=4),rP(y,c,T,f)}var _v="_reactListening"+Math.random().toString(36).slice(2);function GE(c){if(!c[_v]){c[_v]=!0,$s.forEach(function(y){y!=="selectionchange"&&(qj.has(y)||kE(y,!1,c),kE(y,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[_v]||(f[_v]=!0,kE("selectionchange",!1,f))}}function rP(c,f,y,T){switch(RP(f)){case 2:var P=mX;break;case 8:P=gX;break;default:P=ew}y=P.bind(null,f,y,c),P=void 0,!a0||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(P=!0),T?P!==void 0?c.addEventListener(f,y,{capture:!0,passive:P}):c.addEventListener(f,y,!0):P!==void 0?c.addEventListener(f,y,{passive:P}):c.addEventListener(f,y,!1)}function zE(c,f,y,T,P){var U=T;if((f&1)===0&&(f&2)===0&&T!==null)e:for(;;){if(T===null)return;var Y=T.tag;if(Y===3||Y===4){var le=T.stateNode.containerInfo;if(le===P)break;if(Y===4)for(Y=T.return;Y!==null;){var xe=Y.tag;if((xe===3||xe===4)&&Y.stateNode.containerInfo===P)return;Y=Y.return}for(;le!==null;){if(Y=Tn(le),Y===null)return;if(xe=Y.tag,xe===5||xe===6||xe===26||xe===27){T=U=Y;continue e}le=le.parentNode}}T=T.return}S2(function(){var qe=U,ot=Sg(y),mt=[];e:{var Xe=g0.get(c);if(Xe!==void 0){var $e=u0,Un=c;switch(c){case"keypress":if(Td(y)===0)break e;case"keydown":case"keyup":$e=N3;break;case"focusin":Un="focus",$e=jh;break;case"focusout":Un="blur",$e=jh;break;case"beforeblur":case"afterblur":$e=jh;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=E2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=R3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=L3;break;case G2:case z2:case V2:$e=M2;break;case H2:$e=I3;break;case"scroll":case"scrollend":$e=wc;break;case"wheel":$e=h0;break;case"copy":case"cut":case"paste":$e=c0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=P2;break;case"toggle":case"beforetoggle":$e=F3}var Mn=(f&4)!==0,or=!Mn&&(c==="scroll"||c==="scrollend"),Oe=Mn?Xe!==null?Xe+"Capture":null:Xe;Mn=[];for(var Re=qe,ze;Re!==null;){var ht=Re;if(ze=ht.stateNode,ht=ht.tag,ht!==5&&ht!==26&&ht!==27||ze===null||Oe===null||(ht=xd(Re,Oe),ht!=null&&Mn.push(h1(Re,ht,ze))),or)break;Re=Re.return}0<Mn.length&&(Xe=new $e(Xe,Un,null,y,ot),mt.push({event:Xe,listeners:Mn}))}}if((f&7)===0){e:{if(Xe=c==="mouseover"||c==="pointerover",$e=c==="mouseout"||c==="pointerout",Xe&&y!==bg&&(Un=y.relatedTarget||y.fromElement)&&(Tn(Un)||Un[St]))break e;if(($e||Xe)&&(Xe=ot.window===ot?ot:(Xe=ot.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,$e?(Un=y.relatedTarget||y.toElement,$e=qe,Un=Un?Tn(Un):null,Un!==null&&(or=s(Un),Mn=Un.tag,Un!==or||Mn!==5&&Mn!==27&&Mn!==6)&&(Un=null)):($e=null,Un=qe),$e!==Un)){if(Mn=E2,ht="onMouseLeave",Oe="onMouseEnter",Re="mouse",(c==="pointerout"||c==="pointerover")&&(Mn=P2,ht="onPointerLeave",Oe="onPointerEnter",Re="pointer"),or=$e==null?Xe:ho($e),ze=Un==null?Xe:ho(Un),Xe=new Mn(ht,Re+"leave",$e,y,ot),Xe.target=or,Xe.relatedTarget=ze,ht=null,Tn(ot)===qe&&(Mn=new Mn(Oe,Re+"enter",Un,y,ot),Mn.target=ze,Mn.relatedTarget=or,ht=Mn),or=ht,$e&&Un)t:{for(Mn=$e,Oe=Un,Re=0,ze=Mn;ze;ze=V0(ze))Re++;for(ze=0,ht=Oe;ht;ht=V0(ht))ze++;for(;0<Re-ze;)Mn=V0(Mn),Re--;for(;0<ze-Re;)Oe=V0(Oe),ze--;for(;Re--;){if(Mn===Oe||Oe!==null&&Mn===Oe.alternate)break t;Mn=V0(Mn),Oe=V0(Oe)}Mn=null}else Mn=null;$e!==null&&sP(mt,Xe,$e,Mn,!1),Un!==null&&or!==null&&sP(mt,or,Un,Mn,!0)}}e:{if(Xe=qe?ho(qe):window,$e=Xe.nodeName&&Xe.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Xe.type==="file")var rn=B2;else if(d0(Xe))if(U2)rn=Xo;else{rn=Og;var fi=G3}else $e=Xe.nodeName,!$e||$e.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?qe&&vg(qe.elementType)&&(rn=B2):rn=z3;if(rn&&(rn=rn(c,qe))){$h(mt,rn,y,ot);break e}fi&&fi(c,Xe,qe),c==="focusout"&&qe&&Xe.type==="number"&&qe.memoizedProps.value!=null&&yr(Xe,"number",Xe.value)}switch(fi=qe?ho(qe):window,c){case"focusin":(d0(fi)||fi.contentEditable==="true")&&(Yh=fi,kg=qe,Lc=null);break;case"focusout":Lc=kg=Yh=null;break;case"mousedown":p0=!0;break;case"contextmenu":case"mouseup":case"dragend":p0=!1,m0(mt,y,ot);break;case"selectionchange":if(Fg)break;case"keydown":case"keyup":m0(mt,y,ot)}var An;if(Nc)e:{switch(c){case"compositionstart":var Pn="onCompositionStart";break e;case"compositionend":Pn="onCompositionEnd";break e;case"compositionupdate":Pn="onCompositionUpdate";break e}Pn=void 0}else Xh?f0(c,y)&&(Pn="onCompositionEnd"):c==="keydown"&&y.keyCode===229&&(Pn="onCompositionStart");Pn&&(Rg&&y.locale!=="ko"&&(Xh||Pn!=="onCompositionStart"?Pn==="onCompositionEnd"&&Xh&&(An=Tg()):(sl=ot,Sd="value"in sl?sl.value:sl.textContent,Xh=!0)),fi=yv(qe,Pn),0<fi.length&&(Pn=new zl(Pn,c,null,y,ot),mt.push({event:Pn,listeners:fi}),An?Pn.data=An:(An=Cg(y),An!==null&&(Pn.data=An)))),(An=Mg?O2(c,y):Ng(c,y))&&(Pn=yv(qe,"onBeforeInput"),0<Pn.length&&(fi=new zl("onBeforeInput","beforeinput",null,y,ot),mt.push({event:fi,listeners:Pn}),fi.data=An)),Gj(mt,c,qe,y,ot)}iP(mt,f)})}function h1(c,f,y){return{instance:c,listener:f,currentTarget:y}}function yv(c,f){for(var y=f+"Capture",T=[];c!==null;){var P=c,U=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||U===null||(P=xd(c,y),P!=null&&T.unshift(h1(c,P,U)),P=xd(c,f),P!=null&&T.push(h1(c,P,U))),c.tag===3)return T;c=c.return}return[]}function V0(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function sP(c,f,y,T,P){for(var U=f._reactName,Y=[];y!==null&&y!==T;){var le=y,xe=le.alternate,qe=le.stateNode;if(le=le.tag,xe!==null&&xe===T)break;le!==5&&le!==26&&le!==27||qe===null||(xe=qe,P?(qe=xd(y,U),qe!=null&&Y.unshift(h1(y,qe,xe))):P||(qe=xd(y,U),qe!=null&&Y.push(h1(y,qe,xe)))),y=y.return}Y.length!==0&&c.push({event:f,listeners:Y})}var Hj=/\r\n?/g,Wj=/\u0000|\uFFFD/g;function oP(c){return(typeof c=="string"?c:""+c).replace(Hj,`
`).replace(Wj,"")}function aP(c,f){return f=oP(f),oP(c)===f}function vv(){}function sr(c,f,y,T,P,U){switch(y){case"children":typeof T=="string"?f==="body"||f==="textarea"&&T===""||il(c,T):(typeof T=="number"||typeof T=="bigint")&&f!=="body"&&il(c,""+T);break;case"className":Ot(c,"class",T);break;case"tabIndex":Ot(c,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":Ot(c,y,T);break;case"style":b2(c,T,U);break;case"data":if(f!=="object"){Ot(c,"data",T);break}case"src":case"href":if(T===""&&(f!=="a"||y!=="href")){c.removeAttribute(y);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){c.removeAttribute(y);break}T=yd(""+T),c.setAttribute(y,T);break;case"action":case"formAction":if(typeof T=="function"){c.setAttribute(y,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof U=="function"&&(y==="formAction"?(f!=="input"&&sr(c,f,"name",P.name,P,null),sr(c,f,"formEncType",P.formEncType,P,null),sr(c,f,"formMethod",P.formMethod,P,null),sr(c,f,"formTarget",P.formTarget,P,null)):(sr(c,f,"encType",P.encType,P,null),sr(c,f,"method",P.method,P,null),sr(c,f,"target",P.target,P,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){c.removeAttribute(y);break}T=yd(""+T),c.setAttribute(y,T);break;case"onClick":T!=null&&(c.onclick=vv);break;case"onScroll":T!=null&&_i("scroll",c);break;case"onScrollEnd":T!=null&&_i("scrollend",c);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(n(61));if(y=T.__html,y!=null){if(P.children!=null)throw Error(n(60));c.innerHTML=y}}break;case"multiple":c.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":c.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){c.removeAttribute("xlink:href");break}y=yd(""+T),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",y);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,""+T):c.removeAttribute(y);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,""):c.removeAttribute(y);break;case"capture":case"download":T===!0?c.setAttribute(y,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,T):c.removeAttribute(y);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?c.setAttribute(y,T):c.removeAttribute(y);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?c.removeAttribute(y):c.setAttribute(y,T);break;case"popover":_i("beforetoggle",c),_i("toggle",c),Nt(c,"popover",T);break;case"xlinkActuate":ct(c,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":ct(c,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":ct(c,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":ct(c,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":ct(c,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":ct(c,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":ct(c,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":ct(c,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":ct(c,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":Nt(c,"is",T);break;case"innerText":case"textContent":break;default:(!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(y=dr.get(y)||y,Nt(c,y,T))}}function VE(c,f,y,T,P,U){switch(y){case"style":b2(c,T,U);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(n(61));if(y=T.__html,y!=null){if(P.children!=null)throw Error(n(60));c.innerHTML=y}}break;case"children":typeof T=="string"?il(c,T):(typeof T=="number"||typeof T=="bigint")&&il(c,""+T);break;case"onScroll":T!=null&&_i("scroll",c);break;case"onScrollEnd":T!=null&&_i("scrollend",c);break;case"onClick":T!=null&&(c.onclick=vv);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sc.hasOwnProperty(y))e:{if(y[0]==="o"&&y[1]==="n"&&(P=y.endsWith("Capture"),f=y.slice(2,P?y.length-7:void 0),U=c[We]||null,U=U!=null?U[y]:null,typeof U=="function"&&c.removeEventListener(f,U,P),typeof T=="function")){typeof U!="function"&&U!==null&&(y in c?c[y]=null:c.hasAttribute(y)&&c.removeAttribute(y)),c.addEventListener(f,T,P);break e}y in c?c[y]=T:T===!0?c.setAttribute(y,""):Nt(c,y,T)}}}function to(c,f,y){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_i("error",c),_i("load",c);var T=!1,P=!1,U;for(U in y)if(y.hasOwnProperty(U)){var Y=y[U];if(Y!=null)switch(U){case"src":T=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:sr(c,f,U,Y,y,null)}}P&&sr(c,f,"srcSet",y.srcSet,y,null),T&&sr(c,f,"src",y.src,y,null);return;case"input":_i("invalid",c);var le=U=Y=P=null,xe=null,qe=null;for(T in y)if(y.hasOwnProperty(T)){var ot=y[T];if(ot!=null)switch(T){case"name":P=ot;break;case"type":Y=ot;break;case"checked":xe=ot;break;case"defaultChecked":qe=ot;break;case"value":U=ot;break;case"defaultValue":le=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,f));break;default:sr(c,f,T,ot,y,null)}}ji(c,U,le,xe,qe,Y,P,!1),Wi(c);return;case"select":_i("invalid",c),T=Y=U=null;for(P in y)if(y.hasOwnProperty(P)&&(le=y[P],le!=null))switch(P){case"value":U=le;break;case"defaultValue":Y=le;break;case"multiple":T=le;default:sr(c,f,P,le,y,null)}f=U,y=Y,c.multiple=!!T,f!=null?hi(c,!!T,f,!1):y!=null&&hi(c,!!T,y,!0);return;case"textarea":_i("invalid",c),U=P=T=null;for(Y in y)if(y.hasOwnProperty(Y)&&(le=y[Y],le!=null))switch(Y){case"value":T=le;break;case"defaultValue":P=le;break;case"children":U=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(n(91));break;default:sr(c,f,Y,le,y,null)}vs(c,T,P,U),Wi(c);return;case"option":for(xe in y)if(y.hasOwnProperty(xe)&&(T=y[xe],T!=null))switch(xe){case"selected":c.selected=T&&typeof T!="function"&&typeof T!="symbol";break;default:sr(c,f,xe,T,y,null)}return;case"dialog":_i("beforetoggle",c),_i("toggle",c),_i("cancel",c),_i("close",c);break;case"iframe":case"object":_i("load",c);break;case"video":case"audio":for(T=0;T<c1.length;T++)_i(c1[T],c);break;case"image":_i("error",c),_i("load",c);break;case"details":_i("toggle",c);break;case"embed":case"source":case"link":_i("error",c),_i("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(qe in y)if(y.hasOwnProperty(qe)&&(T=y[qe],T!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:sr(c,f,qe,T,y,null)}return;default:if(vg(f)){for(ot in y)y.hasOwnProperty(ot)&&(T=y[ot],T!==void 0&&VE(c,f,ot,T,y,void 0));return}}for(le in y)y.hasOwnProperty(le)&&(T=y[le],T!=null&&sr(c,f,le,T,y,null))}function jj(c,f,y,T){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,U=null,Y=null,le=null,xe=null,qe=null,ot=null;for($e in y){var mt=y[$e];if(y.hasOwnProperty($e)&&mt!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":xe=mt;default:T.hasOwnProperty($e)||sr(c,f,$e,null,T,mt)}}for(var Xe in T){var $e=T[Xe];if(mt=y[Xe],T.hasOwnProperty(Xe)&&($e!=null||mt!=null))switch(Xe){case"type":U=$e;break;case"name":P=$e;break;case"checked":qe=$e;break;case"defaultChecked":ot=$e;break;case"value":Y=$e;break;case"defaultValue":le=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(n(137,f));break;default:$e!==mt&&sr(c,f,Xe,$e,T,mt)}}nl(c,Y,le,xe,qe,ot,U,P);return;case"select":$e=Y=le=Xe=null;for(U in y)if(xe=y[U],y.hasOwnProperty(U)&&xe!=null)switch(U){case"value":break;case"multiple":$e=xe;default:T.hasOwnProperty(U)||sr(c,f,U,null,T,xe)}for(P in T)if(U=T[P],xe=y[P],T.hasOwnProperty(P)&&(U!=null||xe!=null))switch(P){case"value":Xe=U;break;case"defaultValue":le=U;break;case"multiple":Y=U;default:U!==xe&&sr(c,f,P,U,T,xe)}f=le,y=Y,T=$e,Xe!=null?hi(c,!!y,Xe,!1):!!T!=!!y&&(f!=null?hi(c,!!y,f,!0):hi(c,!!y,y?[]:"",!1));return;case"textarea":$e=Xe=null;for(le in y)if(P=y[le],y.hasOwnProperty(le)&&P!=null&&!T.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:sr(c,f,le,null,T,P)}for(Y in T)if(P=T[Y],U=y[Y],T.hasOwnProperty(Y)&&(P!=null||U!=null))switch(Y){case"value":Xe=P;break;case"defaultValue":$e=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(91));break;default:P!==U&&sr(c,f,Y,P,T,U)}Wr(c,Xe,$e);return;case"option":for(var Un in y)if(Xe=y[Un],y.hasOwnProperty(Un)&&Xe!=null&&!T.hasOwnProperty(Un))switch(Un){case"selected":c.selected=!1;break;default:sr(c,f,Un,null,T,Xe)}for(xe in T)if(Xe=T[xe],$e=y[xe],T.hasOwnProperty(xe)&&Xe!==$e&&(Xe!=null||$e!=null))switch(xe){case"selected":c.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:sr(c,f,xe,Xe,T,$e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mn in y)Xe=y[Mn],y.hasOwnProperty(Mn)&&Xe!=null&&!T.hasOwnProperty(Mn)&&sr(c,f,Mn,null,T,Xe);for(qe in T)if(Xe=T[qe],$e=y[qe],T.hasOwnProperty(qe)&&Xe!==$e&&(Xe!=null||$e!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(n(137,f));break;default:sr(c,f,qe,Xe,T,$e)}return;default:if(vg(f)){for(var or in y)Xe=y[or],y.hasOwnProperty(or)&&Xe!==void 0&&!T.hasOwnProperty(or)&&VE(c,f,or,void 0,T,Xe);for(ot in T)Xe=T[ot],$e=y[ot],!T.hasOwnProperty(ot)||Xe===$e||Xe===void 0&&$e===void 0||VE(c,f,ot,Xe,T,$e);return}}for(var Oe in y)Xe=y[Oe],y.hasOwnProperty(Oe)&&Xe!=null&&!T.hasOwnProperty(Oe)&&sr(c,f,Oe,null,T,Xe);for(mt in T)Xe=T[mt],$e=y[mt],!T.hasOwnProperty(mt)||Xe===$e||Xe==null&&$e==null||sr(c,f,mt,Xe,T,$e)}var qE=null,HE=null;function xv(c){return c.nodeType===9?c:c.ownerDocument}function lP(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uP(c,f){if(c===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&f==="foreignObject"?0:c}function WE(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var jE=null;function Xj(){var c=window.event;return c&&c.type==="popstate"?c===jE?!1:(jE=c,!0):(jE=null,!1)}var cP=typeof setTimeout=="function"?setTimeout:void 0,$j=typeof clearTimeout=="function"?clearTimeout:void 0,hP=typeof Promise=="function"?Promise:void 0,Yj=typeof queueMicrotask=="function"?queueMicrotask:typeof hP<"u"?function(c){return hP.resolve(null).then(c).catch(Qj)}:cP;function Qj(c){setTimeout(function(){throw c})}function pf(c){return c==="head"}function fP(c,f){var y=f,T=0,P=0;do{var U=y.nextSibling;if(c.removeChild(y),U&&U.nodeType===8)if(y=U.data,y==="/$"){if(0<T&&8>T){y=T;var Y=c.ownerDocument;if(y&1&&f1(Y.documentElement),y&2&&f1(Y.body),y&4)for(y=Y.head,f1(y),Y=y.firstChild;Y;){var le=Y.nextSibling,xe=Y.nodeName;Y[ci]||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&Y.rel.toLowerCase()==="stylesheet"||y.removeChild(Y),Y=le}}if(P===0){c.removeChild(U),v1(f);return}P--}else y==="$"||y==="$?"||y==="$!"?P++:T=y.charCodeAt(0)-48;else T=0;y=U}while(y);v1(f)}function XE(c){var f=c.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var y=f;switch(f=f.nextSibling,y.nodeName){case"HTML":case"HEAD":case"BODY":XE(y),hr(y);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(y.rel.toLowerCase()==="stylesheet")continue}c.removeChild(y)}}function Kj(c,f,y,T){for(;c.nodeType===1;){var P=y;if(c.nodeName.toLowerCase()!==f.toLowerCase()){if(!T&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(T){if(!c[ci])switch(f){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(U=c.getAttribute("rel"),U==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(U!==P.rel||c.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||c.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||c.getAttribute("title")!==(P.title==null?null:P.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(U=c.getAttribute("src"),(U!==(P.src==null?null:P.src)||c.getAttribute("type")!==(P.type==null?null:P.type)||c.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&U&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(f==="input"&&c.type==="hidden"){var U=P.name==null?null:""+P.name;if(P.type==="hidden"&&c.getAttribute("name")===U)return c}else return c;if(c=Ql(c.nextSibling),c===null)break}return null}function Zj(c,f,y){if(f==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!y||(c=Ql(c.nextSibling),c===null))return null;return c}function $E(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState==="complete"}function Jj(c,f){var y=c.ownerDocument;if(c.data!=="$?"||y.readyState==="complete")f();else{var T=function(){f(),y.removeEventListener("DOMContentLoaded",T)};y.addEventListener("DOMContentLoaded",T),c._reactRetry=T}}function Ql(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return c}var YE=null;function dP(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var y=c.data;if(y==="$"||y==="$!"||y==="$?"){if(f===0)return c;f--}else y==="/$"&&f++}c=c.previousSibling}return null}function AP(c,f,y){switch(f=xv(y),c){case"html":if(c=f.documentElement,!c)throw Error(n(452));return c;case"head":if(c=f.head,!c)throw Error(n(453));return c;case"body":if(c=f.body,!c)throw Error(n(454));return c;default:throw Error(n(451))}}function f1(c){for(var f=c.attributes;f.length;)c.removeAttributeNode(f[0]);hr(c)}var ml=new Map,pP=new Set;function bv(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var Qc=re.d;re.d={f:eX,r:tX,D:nX,C:iX,L:rX,m:sX,X:aX,S:oX,M:lX};function eX(){var c=Qc.f(),f=dv();return c||f}function tX(c){var f=Zn(c);f!==null&&f.tag===5&&f.type==="form"?IN(f):Qc.r(c)}var q0=typeof document>"u"?null:document;function mP(c,f,y){var T=q0;if(T&&typeof f=="string"&&f){var P=Ji(f);P='link[rel="'+c+'"][href="'+P+'"]',typeof y=="string"&&(P+='[crossorigin="'+y+'"]'),pP.has(P)||(pP.add(P),c={rel:c,crossOrigin:y,href:f},T.querySelector(P)===null&&(f=T.createElement("link"),to(f,"link",c),on(f),T.head.appendChild(f)))}}function nX(c){Qc.D(c),mP("dns-prefetch",c,null)}function iX(c,f){Qc.C(c,f),mP("preconnect",c,f)}function rX(c,f,y){Qc.L(c,f,y);var T=q0;if(T&&c&&f){var P='link[rel="preload"][as="'+Ji(f)+'"]';f==="image"&&y&&y.imageSrcSet?(P+='[imagesrcset="'+Ji(y.imageSrcSet)+'"]',typeof y.imageSizes=="string"&&(P+='[imagesizes="'+Ji(y.imageSizes)+'"]')):P+='[href="'+Ji(c)+'"]';var U=P;switch(f){case"style":U=H0(c);break;case"script":U=W0(c)}ml.has(U)||(c=h({rel:"preload",href:f==="image"&&y&&y.imageSrcSet?void 0:c,as:f},y),ml.set(U,c),T.querySelector(P)!==null||f==="style"&&T.querySelector(d1(U))||f==="script"&&T.querySelector(A1(U))||(f=T.createElement("link"),to(f,"link",c),on(f),T.head.appendChild(f)))}}function sX(c,f){Qc.m(c,f);var y=q0;if(y&&c){var T=f&&typeof f.as=="string"?f.as:"script",P='link[rel="modulepreload"][as="'+Ji(T)+'"][href="'+Ji(c)+'"]',U=P;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":U=W0(c)}if(!ml.has(U)&&(c=h({rel:"modulepreload",href:c},f),ml.set(U,c),y.querySelector(P)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(y.querySelector(A1(U)))return}T=y.createElement("link"),to(T,"link",c),on(T),y.head.appendChild(T)}}}function oX(c,f,y){Qc.S(c,f,y);var T=q0;if(T&&c){var P=ri(T).hoistableStyles,U=H0(c);f=f||"default";var Y=P.get(U);if(!Y){var le={loading:0,preload:null};if(Y=T.querySelector(d1(U)))le.loading=5;else{c=h({rel:"stylesheet",href:c,"data-precedence":f},y),(y=ml.get(U))&&QE(c,y);var xe=Y=T.createElement("link");on(xe),to(xe,"link",c),xe._p=new Promise(function(qe,ot){xe.onload=qe,xe.onerror=ot}),xe.addEventListener("load",function(){le.loading|=1}),xe.addEventListener("error",function(){le.loading|=2}),le.loading|=4,Sv(Y,f,T)}Y={type:"stylesheet",instance:Y,count:1,state:le},P.set(U,Y)}}}function aX(c,f){Qc.X(c,f);var y=q0;if(y&&c){var T=ri(y).hoistableScripts,P=W0(c),U=T.get(P);U||(U=y.querySelector(A1(P)),U||(c=h({src:c,async:!0},f),(f=ml.get(P))&&KE(c,f),U=y.createElement("script"),on(U),to(U,"link",c),y.head.appendChild(U)),U={type:"script",instance:U,count:1,state:null},T.set(P,U))}}function lX(c,f){Qc.M(c,f);var y=q0;if(y&&c){var T=ri(y).hoistableScripts,P=W0(c),U=T.get(P);U||(U=y.querySelector(A1(P)),U||(c=h({src:c,async:!0,type:"module"},f),(f=ml.get(P))&&KE(c,f),U=y.createElement("script"),on(U),to(U,"link",c),y.head.appendChild(U)),U={type:"script",instance:U,count:1,state:null},T.set(P,U))}}function gP(c,f,y,T){var P=(P=Ye.current)?bv(P):null;if(!P)throw Error(n(446));switch(c){case"meta":case"title":return null;case"style":return typeof y.precedence=="string"&&typeof y.href=="string"?(f=H0(y.href),y=ri(P).hoistableStyles,T=y.get(f),T||(T={type:"style",instance:null,count:0,state:null},y.set(f,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(y.rel==="stylesheet"&&typeof y.href=="string"&&typeof y.precedence=="string"){c=H0(y.href);var U=ri(P).hoistableStyles,Y=U.get(c);if(Y||(P=P.ownerDocument||P,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},U.set(c,Y),(U=P.querySelector(d1(c)))&&!U._p&&(Y.instance=U,Y.state.loading=5),ml.has(c)||(y={rel:"preload",as:"style",href:y.href,crossOrigin:y.crossOrigin,integrity:y.integrity,media:y.media,hrefLang:y.hrefLang,referrerPolicy:y.referrerPolicy},ml.set(c,y),U||uX(P,c,y,Y.state))),f&&T===null)throw Error(n(528,""));return Y}if(f&&T!==null)throw Error(n(529,""));return null;case"script":return f=y.async,y=y.src,typeof y=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=W0(y),y=ri(P).hoistableScripts,T=y.get(f),T||(T={type:"script",instance:null,count:0,state:null},y.set(f,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,c))}}function H0(c){return'href="'+Ji(c)+'"'}function d1(c){return'link[rel="stylesheet"]['+c+"]"}function _P(c){return h({},c,{"data-precedence":c.precedence,precedence:null})}function uX(c,f,y,T){c.querySelector('link[rel="preload"][as="style"]['+f+"]")?T.loading=1:(f=c.createElement("link"),T.preload=f,f.addEventListener("load",function(){return T.loading|=1}),f.addEventListener("error",function(){return T.loading|=2}),to(f,"link",y),on(f),c.head.appendChild(f))}function W0(c){return'[src="'+Ji(c)+'"]'}function A1(c){return"script[async]"+c}function yP(c,f,y){if(f.count++,f.instance===null)switch(f.type){case"style":var T=c.querySelector('style[data-href~="'+Ji(y.href)+'"]');if(T)return f.instance=T,on(T),T;var P=h({},y,{"data-href":y.href,"data-precedence":y.precedence,href:null,precedence:null});return T=(c.ownerDocument||c).createElement("style"),on(T),to(T,"style",P),Sv(T,y.precedence,c),f.instance=T;case"stylesheet":P=H0(y.href);var U=c.querySelector(d1(P));if(U)return f.state.loading|=4,f.instance=U,on(U),U;T=_P(y),(P=ml.get(P))&&QE(T,P),U=(c.ownerDocument||c).createElement("link"),on(U);var Y=U;return Y._p=new Promise(function(le,xe){Y.onload=le,Y.onerror=xe}),to(U,"link",T),f.state.loading|=4,Sv(U,y.precedence,c),f.instance=U;case"script":return U=W0(y.src),(P=c.querySelector(A1(U)))?(f.instance=P,on(P),P):(T=y,(P=ml.get(U))&&(T=h({},y),KE(T,P)),c=c.ownerDocument||c,P=c.createElement("script"),on(P),to(P,"link",T),c.head.appendChild(P),f.instance=P);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(T=f.instance,f.state.loading|=4,Sv(T,y.precedence,c));return f.instance}function Sv(c,f,y){for(var T=y.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=T.length?T[T.length-1]:null,U=P,Y=0;Y<T.length;Y++){var le=T[Y];if(le.dataset.precedence===f)U=le;else if(U!==P)break}U?U.parentNode.insertBefore(c,U.nextSibling):(f=y.nodeType===9?y.head:y,f.insertBefore(c,f.firstChild))}function QE(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.title==null&&(c.title=f.title)}function KE(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.integrity==null&&(c.integrity=f.integrity)}var Tv=null;function vP(c,f,y){if(Tv===null){var T=new Map,P=Tv=new Map;P.set(y,T)}else P=Tv,T=P.get(y),T||(T=new Map,P.set(y,T));if(T.has(c))return T;for(T.set(c,null),y=y.getElementsByTagName(c),P=0;P<y.length;P++){var U=y[P];if(!(U[ci]||U[ke]||c==="link"&&U.getAttribute("rel")==="stylesheet")&&U.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=U.getAttribute(f)||"";Y=c+Y;var le=T.get(Y);le?le.push(U):T.set(Y,[U])}}return T}function xP(c,f,y){c=c.ownerDocument||c,c.head.insertBefore(y,f==="title"?c.querySelector("head > title"):null)}function cX(c,f,y){if(y===1||f.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return c=f.disabled,typeof f.precedence=="string"&&c==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function bP(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}var p1=null;function hX(){}function fX(c,f,y){if(p1===null)throw Error(n(475));var T=p1;if(f.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var P=H0(y.href),U=c.querySelector(d1(P));if(U){c=U._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(T.count++,T=Ev.bind(T),c.then(T,T)),f.state.loading|=4,f.instance=U,on(U);return}U=c.ownerDocument||c,y=_P(y),(P=ml.get(P))&&QE(y,P),U=U.createElement("link"),on(U);var Y=U;Y._p=new Promise(function(le,xe){Y.onload=le,Y.onerror=xe}),to(U,"link",y),f.instance=U}T.stylesheets===null&&(T.stylesheets=new Map),T.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(T.count++,f=Ev.bind(T),c.addEventListener("load",f),c.addEventListener("error",f))}}function dX(){if(p1===null)throw Error(n(475));var c=p1;return c.stylesheets&&c.count===0&&ZE(c,c.stylesheets),0<c.count?function(f){var y=setTimeout(function(){if(c.stylesheets&&ZE(c,c.stylesheets),c.unsuspend){var T=c.unsuspend;c.unsuspend=null,T()}},6e4);return c.unsuspend=f,function(){c.unsuspend=null,clearTimeout(y)}}:null}function Ev(){if(this.count--,this.count===0){if(this.stylesheets)ZE(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var wv=null;function ZE(c,f){c.stylesheets=null,c.unsuspend!==null&&(c.count++,wv=new Map,f.forEach(AX,c),wv=null,Ev.call(c))}function AX(c,f){if(!(f.state.loading&4)){var y=wv.get(c);if(y)var T=y.get(null);else{y=new Map,wv.set(c,y);for(var P=c.querySelectorAll("link[data-precedence],style[data-precedence]"),U=0;U<P.length;U++){var Y=P[U];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(y.set(Y.dataset.precedence,Y),T=Y)}T&&y.set(null,T)}P=f.instance,Y=P.getAttribute("data-precedence"),U=y.get(Y)||T,U===T&&y.set(null,P),y.set(Y,P),this.count++,T=Ev.bind(this),P.addEventListener("load",T),P.addEventListener("error",T),U?U.parentNode.insertBefore(P,U.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(P,c.firstChild)),f.state.loading|=4}}var m1={$$typeof:D,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function pX(c,f,y,T,P,U,Y,le){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.hiddenUpdates=xt(null),this.identifierPrefix=T,this.onUncaughtError=P,this.onCaughtError=U,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function SP(c,f,y,T,P,U,Y,le,xe,qe,ot,mt){return c=new pX(c,f,y,Y,le,xe,qe,mt),f=1,U===!0&&(f|=24),U=No(3,null,null,f),c.current=U,U.stateNode=c,f=ns(),f.refCount++,c.pooledCache=f,f.refCount++,U.memoizedState={element:T,isDehydrated:y,cache:f},C(U),c}function TP(c){return c?(c=Oc,c):Oc}function EP(c,f,y,T,P,U){P=TP(P),T.context===null?T.context=P:T.pendingContext=P,T=I(f),T.payload={element:y},U=U===void 0?null:U,U!==null&&(T.callback=U),y=V(c,T,f),y!==null&&(Ia(y,c,f),j(y,c,f))}function wP(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<f?y:f}}function JE(c,f){wP(c,f),(c=c.alternate)&&wP(c,f)}function MP(c){if(c.tag===13){var f=Kh(c,67108864);f!==null&&Ia(f,c,67108864),JE(c,67108864)}}var Mv=!0;function mX(c,f,y,T){var P=$.T;$.T=null;var U=re.p;try{re.p=2,ew(c,f,y,T)}finally{re.p=U,$.T=P}}function gX(c,f,y,T){var P=$.T;$.T=null;var U=re.p;try{re.p=8,ew(c,f,y,T)}finally{re.p=U,$.T=P}}function ew(c,f,y,T){if(Mv){var P=tw(T);if(P===null)zE(c,f,T,Rv,y),CP(c,T);else if(yX(P,c,f,y,T))T.stopPropagation();else if(CP(c,T),f&4&&-1<_X.indexOf(c)){for(;P!==null;){var U=Zn(P);if(U!==null)switch(U.tag){case 3:if(U=U.stateNode,U.current.memoizedState.isDehydrated){var Y=un(U.pendingLanes);if(Y!==0){var le=U;for(le.pendingLanes|=2,le.entangledLanes|=2;Y;){var xe=1<<31-qt(Y);le.entanglements[1]|=xe,Y&=~xe}Pu(U),(er&6)===0&&(hv=pt()+500,u1(0))}}break;case 13:le=Kh(U,2),le!==null&&Ia(le,U,2),dv(),JE(U,2)}if(U=tw(T),U===null&&zE(c,f,T,Rv,y),U===P)break;P=U}P!==null&&T.stopPropagation()}else zE(c,f,T,null,y)}}function tw(c){return c=Sg(c),nw(c)}var Rv=null;function nw(c){if(Rv=null,c=Tn(c),c!==null){var f=s(c);if(f===null)c=null;else{var y=f.tag;if(y===13){if(c=o(f),c!==null)return c;c=null}else if(y===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null)}}return Rv=c,null}function RP(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(et()){case Ft:return 2;case Tt:return 8;case Lt:case _n:return 32;case pe:return 268435456;default:return 32}default:return 32}}var iw=!1,mf=null,gf=null,_f=null,g1=new Map,_1=new Map,yf=[],_X="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function CP(c,f){switch(c){case"focusin":case"focusout":mf=null;break;case"dragenter":case"dragleave":gf=null;break;case"mouseover":case"mouseout":_f=null;break;case"pointerover":case"pointerout":g1.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":_1.delete(f.pointerId)}}function y1(c,f,y,T,P,U){return c===null||c.nativeEvent!==U?(c={blockedOn:f,domEventName:y,eventSystemFlags:T,nativeEvent:U,targetContainers:[P]},f!==null&&(f=Zn(f),f!==null&&MP(f)),c):(c.eventSystemFlags|=T,f=c.targetContainers,P!==null&&f.indexOf(P)===-1&&f.push(P),c)}function yX(c,f,y,T,P){switch(f){case"focusin":return mf=y1(mf,c,f,y,T,P),!0;case"dragenter":return gf=y1(gf,c,f,y,T,P),!0;case"mouseover":return _f=y1(_f,c,f,y,T,P),!0;case"pointerover":var U=P.pointerId;return g1.set(U,y1(g1.get(U)||null,c,f,y,T,P)),!0;case"gotpointercapture":return U=P.pointerId,_1.set(U,y1(_1.get(U)||null,c,f,y,T,P)),!0}return!1}function NP(c){var f=Tn(c.target);if(f!==null){var y=s(f);if(y!==null){if(f=y.tag,f===13){if(f=o(y),f!==null){c.blockedOn=f,Hi(c.priority,function(){if(y.tag===13){var T=Oa();T=hn(T);var P=Kh(y,T);P!==null&&Ia(P,y,T),JE(y,T)}});return}}else if(f===3&&y.stateNode.current.memoizedState.isDehydrated){c.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Cv(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var y=tw(c.nativeEvent);if(y===null){y=c.nativeEvent;var T=new y.constructor(y.type,y);bg=T,y.target.dispatchEvent(T),bg=null}else return f=Zn(y),f!==null&&MP(f),c.blockedOn=y,!1;f.shift()}return!0}function DP(c,f,y){Cv(c)&&y.delete(f)}function vX(){iw=!1,mf!==null&&Cv(mf)&&(mf=null),gf!==null&&Cv(gf)&&(gf=null),_f!==null&&Cv(_f)&&(_f=null),g1.forEach(DP),_1.forEach(DP)}function Nv(c,f){c.blockedOn===f&&(c.blockedOn=null,iw||(iw=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,vX)))}var Dv=null;function PP(c){Dv!==c&&(Dv=c,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Dv===c&&(Dv=null);for(var f=0;f<c.length;f+=3){var y=c[f],T=c[f+1],P=c[f+2];if(typeof T!="function"){if(nw(T||y)===null)continue;break}var U=Zn(y);U!==null&&(c.splice(f,3),f-=3,nE(U,{pending:!0,data:P,method:y.method,action:T},T,P))}}))}function v1(c){function f(xe){return Nv(xe,c)}mf!==null&&Nv(mf,c),gf!==null&&Nv(gf,c),_f!==null&&Nv(_f,c),g1.forEach(f),_1.forEach(f);for(var y=0;y<yf.length;y++){var T=yf[y];T.blockedOn===c&&(T.blockedOn=null)}for(;0<yf.length&&(y=yf[0],y.blockedOn===null);)NP(y),y.blockedOn===null&&yf.shift();if(y=(c.ownerDocument||c).$$reactFormReplay,y!=null)for(T=0;T<y.length;T+=3){var P=y[T],U=y[T+1],Y=P[We]||null;if(typeof U=="function")Y||PP(y);else if(Y){var le=null;if(U&&U.hasAttribute("formAction")){if(P=U,Y=U[We]||null)le=Y.formAction;else if(nw(P)!==null)continue}else le=Y.action;typeof le=="function"?y[T+1]=le:(y.splice(T,3),T-=3),PP(y)}}}function rw(c){this._internalRoot=c}Pv.prototype.render=rw.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(n(409));var y=f.current,T=Oa();EP(y,T,c,f,null,null)},Pv.prototype.unmount=rw.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;EP(c.current,2,null,c,null,null),dv(),f[St]=null}};function Pv(c){this._internalRoot=c}Pv.prototype.unstable_scheduleHydration=function(c){if(c){var f=Bn();c={blockedOn:null,target:c,priority:f};for(var y=0;y<yf.length&&f!==0&&f<yf[y].priority;y++);yf.splice(y,0,c),y===0&&NP(c)}};var LP=e.version;if(LP!=="19.1.0")throw Error(n(527,LP,"19.1.0"));re.findDOMNode=function(c){var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(n(188)):(c=Object.keys(c).join(","),Error(n(268,c)));return c=l(f),c=c!==null?u(c):null,c=c===null?null:c.stateNode,c};var xX={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lv.isDisabled&&Lv.supportsFiber)try{Qe=Lv.inject(xX),nt=Lv}catch{}}return b1.createRoot=function(c,f){if(!r(c))throw Error(n(299));var y=!1,T="",P=YN,U=QN,Y=KN,le=null;return f!=null&&(f.unstable_strictMode===!0&&(y=!0),f.identifierPrefix!==void 0&&(T=f.identifierPrefix),f.onUncaughtError!==void 0&&(P=f.onUncaughtError),f.onCaughtError!==void 0&&(U=f.onCaughtError),f.onRecoverableError!==void 0&&(Y=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(le=f.unstable_transitionCallbacks)),f=SP(c,1,!1,null,null,y,T,P,U,Y,le,null),c[St]=f.current,GE(c),new rw(f)},b1.hydrateRoot=function(c,f,y){if(!r(c))throw Error(n(299));var T=!1,P="",U=YN,Y=QN,le=KN,xe=null,qe=null;return y!=null&&(y.unstable_strictMode===!0&&(T=!0),y.identifierPrefix!==void 0&&(P=y.identifierPrefix),y.onUncaughtError!==void 0&&(U=y.onUncaughtError),y.onCaughtError!==void 0&&(Y=y.onCaughtError),y.onRecoverableError!==void 0&&(le=y.onRecoverableError),y.unstable_transitionCallbacks!==void 0&&(xe=y.unstable_transitionCallbacks),y.formState!==void 0&&(qe=y.formState)),f=SP(c,1,!0,f,y??null,T,P,U,Y,le,xe,qe),f.context=TP(null),y=f.current,T=Oa(),T=hn(T),P=I(T),P.callback=null,V(y,P,T),y=T,f.current.lanes=y,Ht(f,y),Pu(f),c[St]=f.current,GE(c),new Pv(f)},b1.version="19.1.0",b1}var qP;function PX(){if(qP)return aw.exports;qP=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),aw.exports=DX(),aw.exports}var LX=PX();function OX(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function IX(i,e,t){return e=qX(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function HP(i,e){return FX(i)||OX(i,e)||jU(i,e)||zX()}function BX(i){return UX(i)||kX(i)||jU(i)||GX()}function UX(i){if(Array.isArray(i))return LR(i)}function FX(i){if(Array.isArray(i))return i}function kX(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function jU(i,e){if(i){if(typeof i=="string")return LR(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return LR(i,e)}}function LR(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function GX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VX(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function qX(i){var e=VX(i,"string");return typeof e=="symbol"?e:String(e)}var HX=function(e,t){var n=new Set(t);return Object.assign.apply(Object,[{}].concat(BX(Object.entries(e).filter(function(r){var s=HP(r,1),o=s[0];return!n.has(o)}).map(function(r){var s=HP(r,2),o=s[0],a=s[1];return IX({},o,a)}))))};function OR(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function WX(i){if(Array.isArray(i))return i}function jX(i){if(Array.isArray(i))return OR(i)}function XX(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function $X(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function YX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KX(i,e){return WX(i)||$X(i,e)||XU(i,e)||YX()}function WP(i){return jX(i)||XX(i)||XU(i)||QX()}function XU(i,e){if(i){if(typeof i=="string")return OR(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?OR(i,e):void 0}}function ZX(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.wrapperElementType,n=t===void 0?"div":t,r=e.nodeMapper,s=r===void 0?function(h){return h}:r,o=e.methodNames,a=o===void 0?[]:o,l=e.initPropNames,u=l===void 0?[]:l;return On.forwardRef(function(h,d){var _=On.useRef(),x=On.useMemo(function(){var E=Object.fromEntries(u.filter(function(w){return h.hasOwnProperty(w)}).map(function(w){return[w,h[w]]}));return i(E)},[]);jP(function(){x(s(_.current))},On.useLayoutEffect),jP(function(){return x._destructor instanceof Function?x._destructor:void 0});var b=On.useCallback(function(E){for(var w=arguments.length,L=new Array(w>1?w-1:0),D=1;D<w;D++)L[D-1]=arguments[D];return x[E]instanceof Function?x[E].apply(x,L):void 0},[x]),R=On.useRef({});return Object.keys(HX(h,[].concat(WP(a),WP(u)))).filter(function(E){return R.current[E]!==h[E]}).forEach(function(E){return b(E,h[E])}),R.current=h,On.useImperativeHandle(d,function(){return Object.fromEntries(a.map(function(E){return[E,function(){for(var w=arguments.length,L=new Array(w),D=0;D<w;D++)L[D]=arguments[D];return b.apply(void 0,[E].concat(L))}]}))},[b]),wX.createElement(n,{ref:_})})}function jP(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:On.useEffect,t=On.useRef(),n=On.useRef(!1),r=On.useRef(!1),s=On.useState(0),o=KX(s,2);o[0];var a=o[1];n.current&&(r.current=!0),e(function(){return n.current||(t.current=i(),n.current=!0),a(function(l){return l+1}),function(){r.current&&t.current&&t.current()}},[])}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const og="178",Cl={ROTATE:0,DOLLY:1,PAN:2},Up={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},$U=0,IR=1,YU=2,JX=0,P4=1,e$=2,Va=3,ma=0,Zi=1,ss=2,ga=0,Wo=1,hm=2,fm=3,dm=4,Kp=5,bo=100,L4=101,O4=102,QU=103,KU=104,ah=200,I4=201,B4=202,U4=203,k_=204,G_=205,F4=206,k4=207,G4=208,z4=209,V4=210,t$=211,n$=212,i$=213,r$=214,z_=0,V_=1,q_=2,od=3,H_=4,W_=5,j_=6,X_=7,Vy=0,ZU=1,JU=2,_a=0,e9=1,t9=2,n9=3,i9=4,s$=5,r9=6,s9=7,q4=300,oc=301,ac=302,Am=303,pm=304,FA=306,kA=1e3,Xu=1001,GA=1002,br=1003,H4=1004,ph=1005,Ms=1006,Zp=1007,ua=1008,o$=1008,Vr=1009,EA=1010,wA=1011,hu=1012,Hs=1013,mr=1014,os=1015,As=1016,iT=1017,rT=1018,Ya=1020,sT=35902,W4=1021,qy=1022,es=1023,Qa=1026,Ka=1027,Hy=1028,ag=1029,mh=1030,lg=1031,a$=1032,ug=1033,MA=33776,Kf=33777,Zf=33778,Jf=33779,$_=35840,Y_=35841,Q_=35842,K_=35843,Z_=36196,mm=37492,gm=37496,_m=37808,ym=37809,vm=37810,xm=37811,bm=37812,Sm=37813,Tm=37814,Em=37815,wm=37816,Mm=37817,Rm=37818,Cm=37819,Nm=37820,Dm=37821,RA=36492,BR=36494,UR=36495,j4=36283,J_=36284,ey=36285,ty=36286,l$=0,u$=1,XP=2,c$=3200,h$=3201,Mh=0,o9=1,Go="",qs="srgb",pu="srgb-linear",Pm="linear",Qt="srgb",f$=0,nA=7680,d$=7681,A$=7682,p$=7683,m$=34055,g$=34056,_$=5386,y$=512,v$=513,x$=514,b$=515,S$=516,T$=517,E$=518,FR=519,X4=512,oT=513,$4=514,aT=515,Y4=516,Q4=517,K4=518,Z4=519,Fb=35044,Fp=35048,$P="300 es",qo=2e3,lc=2001;class gc{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const mo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let YP=1234567;const b_=Math.PI/180,zA=180/Math.PI;function Ju(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(mo[i&255]+mo[i>>8&255]+mo[i>>16&255]+mo[i>>24&255]+"-"+mo[e&255]+mo[e>>8&255]+"-"+mo[e>>16&15|64]+mo[e>>24&255]+"-"+mo[t&63|128]+mo[t>>8&255]+"-"+mo[t>>16&255]+mo[t>>24&255]+mo[n&255]+mo[n>>8&255]+mo[n>>16&255]+mo[n>>24&255]).toLowerCase()}function ei(i,e,t){return Math.max(e,Math.min(t,i))}function J4(i,e){return(i%e+e)%e}function w$(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function M$(i,e,t){return i!==e?(t-i)/(e-i):0}function S_(i,e,t){return(1-t)*i+t*e}function R$(i,e,t,n){return S_(i,e,1-Math.exp(-t*n))}function C$(i,e=1){return e-Math.abs(J4(i,e*2)-e)}function N$(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function D$(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function P$(i,e){return i+Math.floor(Math.random()*(e-i+1))}function L$(i,e){return i+Math.random()*(e-i)}function O$(i){return i*(.5-Math.random())}function I$(i){i!==void 0&&(YP=i);let e=YP+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function B$(i){return i*b_}function U$(i){return i*zA}function F$(i){return(i&i-1)===0&&i!==0}function k$(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function G$(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function z$(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+n)/2),h=o((e+n)/2),d=s((e-n)/2),_=o((e-n)/2),x=s((n-e)/2),b=o((n-e)/2);switch(r){case"XYX":i.set(a*h,l*d,l*_,a*u);break;case"YZY":i.set(l*_,a*h,l*d,a*u);break;case"ZXZ":i.set(l*d,l*_,a*h,a*u);break;case"XZX":i.set(a*h,l*b,l*x,a*u);break;case"YXY":i.set(l*x,a*h,l*b,a*u);break;case"ZYZ":i.set(l*b,l*x,a*h,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function zo(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function ii(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Lm={DEG2RAD:b_,RAD2DEG:zA,generateUUID:Ju,clamp:ei,euclideanModulo:J4,mapLinear:w$,inverseLerp:M$,lerp:S_,damp:R$,pingpong:C$,smoothstep:N$,smootherstep:D$,randInt:P$,randFloat:L$,randFloatSpread:O$,seededRandom:I$,degToRad:B$,radToDeg:U$,isPowerOfTwo:F$,ceilPowerOfTwo:k$,floorPowerOfTwo:G$,setQuaternionFromProperEuler:z$,normalize:ii,denormalize:zo};class it{constructor(e=0,t=0){it.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=ei(this.x,e.x,t.x),this.y=ei(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=ei(this.x,e,t),this.y=ei(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ei(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class _u{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],u=n[r+1],h=n[r+2],d=n[r+3];const _=s[o+0],x=s[o+1],b=s[o+2],R=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=h,e[t+3]=d;return}if(a===1){e[t+0]=_,e[t+1]=x,e[t+2]=b,e[t+3]=R;return}if(d!==R||l!==_||u!==x||h!==b){let E=1-a;const w=l*_+u*x+h*b+d*R,L=w>=0?1:-1,D=1-w*w;if(D>Number.EPSILON){const B=Math.sqrt(D),G=Math.atan2(B,w*L);E=Math.sin(E*G)/B,a=Math.sin(a*G)/B}const O=a*L;if(l=l*E+_*O,u=u*E+x*O,h=h*E+b*O,d=d*E+R*O,E===1-a){const B=1/Math.sqrt(l*l+u*u+h*h+d*d);l*=B,u*=B,h*=B,d*=B}}e[t]=l,e[t+1]=u,e[t+2]=h,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],u=n[r+2],h=n[r+3],d=s[o],_=s[o+1],x=s[o+2],b=s[o+3];return e[t]=a*b+h*d+l*x-u*_,e[t+1]=l*b+h*_+u*d-a*x,e[t+2]=u*b+h*x+a*_-l*d,e[t+3]=h*b-a*d-l*_-u*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(n/2),h=a(r/2),d=a(s/2),_=l(n/2),x=l(r/2),b=l(s/2);switch(o){case"XYZ":this._x=_*h*d+u*x*b,this._y=u*x*d-_*h*b,this._z=u*h*b+_*x*d,this._w=u*h*d-_*x*b;break;case"YXZ":this._x=_*h*d+u*x*b,this._y=u*x*d-_*h*b,this._z=u*h*b-_*x*d,this._w=u*h*d+_*x*b;break;case"ZXY":this._x=_*h*d-u*x*b,this._y=u*x*d+_*h*b,this._z=u*h*b+_*x*d,this._w=u*h*d-_*x*b;break;case"ZYX":this._x=_*h*d-u*x*b,this._y=u*x*d+_*h*b,this._z=u*h*b-_*x*d,this._w=u*h*d+_*x*b;break;case"YZX":this._x=_*h*d+u*x*b,this._y=u*x*d+_*h*b,this._z=u*h*b-_*x*d,this._w=u*h*d-_*x*b;break;case"XZY":this._x=_*h*d-u*x*b,this._y=u*x*d-_*h*b,this._z=u*h*b+_*x*d,this._w=u*h*d+_*x*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],h=t[6],d=t[10],_=n+a+d;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(h-l)*x,this._y=(s-u)*x,this._z=(o-r)*x}else if(n>a&&n>d){const x=2*Math.sqrt(1+n-a-d);this._w=(h-l)/x,this._x=.25*x,this._y=(r+o)/x,this._z=(s+u)/x}else if(a>d){const x=2*Math.sqrt(1+a-n-d);this._w=(s-u)/x,this._x=(r+o)/x,this._y=.25*x,this._z=(l+h)/x}else{const x=2*Math.sqrt(1+d-n-a);this._w=(o-r)/x,this._x=(s+u)/x,this._y=(l+h)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ei(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,h=t._w;return this._x=n*h+o*a+r*u-s*l,this._y=r*h+o*l+s*a-n*u,this._z=s*h+o*u+n*l-r*a,this._w=o*h-n*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const x=1-t;return this._w=x*o+t*this._w,this._x=x*n+t*this._x,this._y=x*r+t*this._y,this._z=x*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),h=Math.atan2(u,a),d=Math.sin((1-t)*h)/u,_=Math.sin(t*h)/u;return this._w=o*d+this._w*_,this._x=n*d+this._x*_,this._y=r*d+this._y*_,this._z=s*d+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ce{constructor(e=0,t=0,n=0){ce.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(QP.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(QP.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*n),h=2*(a*t-s*r),d=2*(s*n-o*t);return this.x=t+l*u+o*d-a*h,this.y=n+l*h+a*u-s*d,this.z=r+l*d+s*h-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=ei(this.x,e.x,t.x),this.y=ei(this.y,e.y,t.y),this.z=ei(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=ei(this.x,e,t),this.y=ei(this.y,e,t),this.z=ei(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return hw.copy(this).projectOnVector(e),this.sub(hw)}reflect(e){return this.sub(hw.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ei(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const hw=new ce,QP=new _u;class Hn{constructor(e,t,n,r,s,o,a,l,u){Hn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,u)}set(e,t,n,r,s,o,a,l,u){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=t,h[4]=s,h[5]=l,h[6]=n,h[7]=o,h[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],u=n[1],h=n[4],d=n[7],_=n[2],x=n[5],b=n[8],R=r[0],E=r[3],w=r[6],L=r[1],D=r[4],O=r[7],B=r[2],G=r[5],k=r[8];return s[0]=o*R+a*L+l*B,s[3]=o*E+a*D+l*G,s[6]=o*w+a*O+l*k,s[1]=u*R+h*L+d*B,s[4]=u*E+h*D+d*G,s[7]=u*w+h*O+d*k,s[2]=_*R+x*L+b*B,s[5]=_*E+x*D+b*G,s[8]=_*w+x*O+b*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8];return t*o*h-t*a*u-n*s*h+n*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],d=h*o-a*u,_=a*l-h*s,x=u*s-o*l,b=t*d+n*_+r*x;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/b;return e[0]=d*R,e[1]=(r*u-h*n)*R,e[2]=(a*n-r*o)*R,e[3]=_*R,e[4]=(h*t-r*l)*R,e[5]=(r*s-a*t)*R,e[6]=x*R,e[7]=(n*l-u*t)*R,e[8]=(o*t-n*s)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(n*l,n*u,-n*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(fw.makeScale(e,t)),this}rotate(e){return this.premultiply(fw.makeRotation(-e)),this}translate(e,t){return this.premultiply(fw.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const fw=new Hn;function e8(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function ny(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function a9(){const i=ny("canvas");return i.style.display="block",i}const KP={};function Za(i){i in KP||(KP[i]=!0,console.warn(i))}function V$(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}function q$(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function H$(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const ZP=new Hn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),JP=new Hn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function W$(){const i={enabled:!0,workingColorSpace:pu,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===Qt&&(r.r=gh(r.r),r.g=gh(r.g),r.b=gh(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Qt&&(r.r=Jp(r.r),r.g=Jp(r.g),r.b=Jp(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Go?Pm:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return Za("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return Za("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[pu]:{primaries:e,whitePoint:n,transfer:Pm,toXYZ:ZP,fromXYZ:JP,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:qs},outputColorSpaceConfig:{drawingBufferColorSpace:qs}},[qs]:{primaries:e,whitePoint:n,transfer:Qt,toXYZ:ZP,fromXYZ:JP,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:qs}}}),i}const In=W$();function gh(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Jp(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let j0;class j${static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{j0===void 0&&(j0=ny("canvas")),j0.width=e.width,j0.height=e.height;const r=j0.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=j0}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ny("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=gh(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(gh(t[n]/255)*255):t[n]=gh(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let X$=0,t8=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:X$++}),this.uuid=Ju(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(dw(r[o].image)):s.push(dw(r[o]))}else s=dw(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function dw(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?j$.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let $$=0;const Aw=new ce;class ps extends gc{constructor(e=ps.DEFAULT_IMAGE,t=ps.DEFAULT_MAPPING,n=Xu,r=Xu,s=Ms,o=ua,a=es,l=Vr,u=ps.DEFAULT_ANISOTROPY,h=Go){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$$++}),this.uuid=Ju(),this.name="",this.source=new t8(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new it(0,0),this.repeat=new it(1,1),this.center=new it(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Aw).x}get height(){return this.source.getSize(Aw).y}get depth(){return this.source.getSize(Aw).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==q4)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case kA:e.x=e.x-Math.floor(e.x);break;case Xu:e.x=e.x<0?0:1;break;case GA:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case kA:e.y=e.y-Math.floor(e.y);break;case Xu:e.y=e.y<0?0:1;break;case GA:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ps.DEFAULT_IMAGE=null;ps.DEFAULT_MAPPING=q4;ps.DEFAULT_ANISOTROPY=1;class mn{constructor(e=0,t=0,n=0,r=1){mn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,u=l[0],h=l[4],d=l[8],_=l[1],x=l[5],b=l[9],R=l[2],E=l[6],w=l[10];if(Math.abs(h-_)<.01&&Math.abs(d-R)<.01&&Math.abs(b-E)<.01){if(Math.abs(h+_)<.1&&Math.abs(d+R)<.1&&Math.abs(b+E)<.1&&Math.abs(u+x+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(u+1)/2,O=(x+1)/2,B=(w+1)/2,G=(h+_)/4,k=(d+R)/4,z=(b+E)/4;return D>O&&D>B?D<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(D),r=G/n,s=k/n):O>B?O<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(O),n=G/r,s=z/r):B<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(B),n=k/s,r=z/s),this.set(n,r,s,t),this}let L=Math.sqrt((E-b)*(E-b)+(d-R)*(d-R)+(_-h)*(_-h));return Math.abs(L)<.001&&(L=1),this.x=(E-b)/L,this.y=(d-R)/L,this.z=(_-h)/L,this.w=Math.acos((u+x+w-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=ei(this.x,e.x,t.x),this.y=ei(this.y,e.y,t.y),this.z=ei(this.z,e.z,t.z),this.w=ei(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=ei(this.x,e,t),this.y=ei(this.y,e,t),this.z=ei(this.z,e,t),this.w=ei(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(ei(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Fh extends gc{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ms,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new mn(0,0,e,t),this.scissorTest=!1,this.viewport=new mn(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new ps(r);this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Ms,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new t8(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ad extends Fh{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class n8 extends ps{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=br,this.minFilter=br,this.wrapR=Xu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Y$ extends ps{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=br,this.minFilter=br,this.wrapR=Xu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kh{constructor(e=new ce(1/0,1/0,1/0),t=new ce(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Kl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Kl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Kl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Kl):Kl.fromBufferAttribute(s,o),Kl.applyMatrix4(e.matrixWorld),this.expandByPoint(Kl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ov.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Ov.copy(n.boundingBox)),Ov.applyMatrix4(e.matrixWorld),this.union(Ov)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Kl),Kl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(S1),Iv.subVectors(this.max,S1),X0.subVectors(e.a,S1),$0.subVectors(e.b,S1),Y0.subVectors(e.c,S1),xf.subVectors($0,X0),bf.subVectors(Y0,$0),Ud.subVectors(X0,Y0);let t=[0,-xf.z,xf.y,0,-bf.z,bf.y,0,-Ud.z,Ud.y,xf.z,0,-xf.x,bf.z,0,-bf.x,Ud.z,0,-Ud.x,-xf.y,xf.x,0,-bf.y,bf.x,0,-Ud.y,Ud.x,0];return!pw(t,X0,$0,Y0,Iv)||(t=[1,0,0,0,1,0,0,0,1],!pw(t,X0,$0,Y0,Iv))?!1:(Bv.crossVectors(xf,bf),t=[Bv.x,Bv.y,Bv.z],pw(t,X0,$0,Y0,Iv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Kl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Kl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Kc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Kc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Kc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Kc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Kc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Kc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Kc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Kc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Kc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Kc=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce],Kl=new ce,Ov=new kh,X0=new ce,$0=new ce,Y0=new ce,xf=new ce,bf=new ce,Ud=new ce,S1=new ce,Iv=new ce,Bv=new ce,Fd=new ce;function pw(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Fd.fromArray(i,s);const a=r.x*Math.abs(Fd.x)+r.y*Math.abs(Fd.y)+r.z*Math.abs(Fd.z),l=e.dot(Fd),u=t.dot(Fd),h=n.dot(Fd);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>a)return!1}return!0}const Q$=new kh,T1=new ce,mw=new ce;class cd{constructor(e=new ce,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Q$.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;T1.subVectors(e,this.center);const t=T1.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(T1,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(mw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(T1.copy(e.center).add(mw)),this.expandByPoint(T1.copy(e.center).sub(mw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Zc=new ce,gw=new ce,Uv=new ce,Sf=new ce,_w=new ce,Fv=new ce,yw=new ce;class Wy{constructor(e=new ce,t=new ce(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zc.copy(this.origin).addScaledVector(this.direction,t),Zc.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){gw.copy(e).add(t).multiplyScalar(.5),Uv.copy(t).sub(e).normalize(),Sf.copy(this.origin).sub(gw);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Uv),a=Sf.dot(this.direction),l=-Sf.dot(Uv),u=Sf.lengthSq(),h=Math.abs(1-o*o);let d,_,x,b;if(h>0)if(d=o*l-a,_=o*a-l,b=s*h,d>=0)if(_>=-b)if(_<=b){const R=1/h;d*=R,_*=R,x=d*(d+o*_+2*a)+_*(o*d+_+2*l)+u}else _=s,d=Math.max(0,-(o*_+a)),x=-d*d+_*(_+2*l)+u;else _=-s,d=Math.max(0,-(o*_+a)),x=-d*d+_*(_+2*l)+u;else _<=-b?(d=Math.max(0,-(-o*s+a)),_=d>0?-s:Math.min(Math.max(-s,-l),s),x=-d*d+_*(_+2*l)+u):_<=b?(d=0,_=Math.min(Math.max(-s,-l),s),x=_*(_+2*l)+u):(d=Math.max(0,-(o*s+a)),_=d>0?s:Math.min(Math.max(-s,-l),s),x=-d*d+_*(_+2*l)+u);else _=o>0?-s:s,d=Math.max(0,-(o*_+a)),x=-d*d+_*(_+2*l)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(gw).addScaledVector(Uv,_),x}intersectSphere(e,t){Zc.subVectors(e.center,this.origin);const n=Zc.dot(this.direction),r=Zc.dot(Zc)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const u=1/this.direction.x,h=1/this.direction.y,d=1/this.direction.z,_=this.origin;return u>=0?(n=(e.min.x-_.x)*u,r=(e.max.x-_.x)*u):(n=(e.max.x-_.x)*u,r=(e.min.x-_.x)*u),h>=0?(s=(e.min.y-_.y)*h,o=(e.max.y-_.y)*h):(s=(e.max.y-_.y)*h,o=(e.min.y-_.y)*h),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-_.z)*d,l=(e.max.z-_.z)*d):(a=(e.max.z-_.z)*d,l=(e.min.z-_.z)*d),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Zc)!==null}intersectTriangle(e,t,n,r,s){_w.subVectors(t,e),Fv.subVectors(n,e),yw.crossVectors(_w,Fv);let o=this.direction.dot(yw),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Sf.subVectors(this.origin,e);const l=a*this.direction.dot(Fv.crossVectors(Sf,Fv));if(l<0)return null;const u=a*this.direction.dot(_w.cross(Sf));if(u<0||l+u>o)return null;const h=-a*Sf.dot(yw);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Cn{constructor(e,t,n,r,s,o,a,l,u,h,d,_,x,b,R,E){Cn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,l,u,h,d,_,x,b,R,E)}set(e,t,n,r,s,o,a,l,u,h,d,_,x,b,R,E){const w=this.elements;return w[0]=e,w[4]=t,w[8]=n,w[12]=r,w[1]=s,w[5]=o,w[9]=a,w[13]=l,w[2]=u,w[6]=h,w[10]=d,w[14]=_,w[3]=x,w[7]=b,w[11]=R,w[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Cn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Q0.setFromMatrixColumn(e,0).length(),s=1/Q0.setFromMatrixColumn(e,1).length(),o=1/Q0.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),u=Math.sin(r),h=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const _=o*h,x=o*d,b=a*h,R=a*d;t[0]=l*h,t[4]=-l*d,t[8]=u,t[1]=x+b*u,t[5]=_-R*u,t[9]=-a*l,t[2]=R-_*u,t[6]=b+x*u,t[10]=o*l}else if(e.order==="YXZ"){const _=l*h,x=l*d,b=u*h,R=u*d;t[0]=_+R*a,t[4]=b*a-x,t[8]=o*u,t[1]=o*d,t[5]=o*h,t[9]=-a,t[2]=x*a-b,t[6]=R+_*a,t[10]=o*l}else if(e.order==="ZXY"){const _=l*h,x=l*d,b=u*h,R=u*d;t[0]=_-R*a,t[4]=-o*d,t[8]=b+x*a,t[1]=x+b*a,t[5]=o*h,t[9]=R-_*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const _=o*h,x=o*d,b=a*h,R=a*d;t[0]=l*h,t[4]=b*u-x,t[8]=_*u+R,t[1]=l*d,t[5]=R*u+_,t[9]=x*u-b,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const _=o*l,x=o*u,b=a*l,R=a*u;t[0]=l*h,t[4]=R-_*d,t[8]=b*d+x,t[1]=d,t[5]=o*h,t[9]=-a*h,t[2]=-u*h,t[6]=x*d+b,t[10]=_-R*d}else if(e.order==="XZY"){const _=o*l,x=o*u,b=a*l,R=a*u;t[0]=l*h,t[4]=-d,t[8]=u*h,t[1]=_*d+R,t[5]=o*h,t[9]=x*d-b,t[2]=b*d-x,t[6]=a*h,t[10]=R*d+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(K$,e,Z$)}lookAt(e,t,n){const r=this.elements;return Ba.subVectors(e,t),Ba.lengthSq()===0&&(Ba.z=1),Ba.normalize(),Tf.crossVectors(n,Ba),Tf.lengthSq()===0&&(Math.abs(n.z)===1?Ba.x+=1e-4:Ba.z+=1e-4,Ba.normalize(),Tf.crossVectors(n,Ba)),Tf.normalize(),kv.crossVectors(Ba,Tf),r[0]=Tf.x,r[4]=kv.x,r[8]=Ba.x,r[1]=Tf.y,r[5]=kv.y,r[9]=Ba.y,r[2]=Tf.z,r[6]=kv.z,r[10]=Ba.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],u=n[12],h=n[1],d=n[5],_=n[9],x=n[13],b=n[2],R=n[6],E=n[10],w=n[14],L=n[3],D=n[7],O=n[11],B=n[15],G=r[0],k=r[4],z=r[8],F=r[12],q=r[1],H=r[5],Q=r[9],K=r[13],se=r[2],ee=r[6],$=r[10],re=r[14],ae=r[3],_e=r[7],ne=r[11],ye=r[15];return s[0]=o*G+a*q+l*se+u*ae,s[4]=o*k+a*H+l*ee+u*_e,s[8]=o*z+a*Q+l*$+u*ne,s[12]=o*F+a*K+l*re+u*ye,s[1]=h*G+d*q+_*se+x*ae,s[5]=h*k+d*H+_*ee+x*_e,s[9]=h*z+d*Q+_*$+x*ne,s[13]=h*F+d*K+_*re+x*ye,s[2]=b*G+R*q+E*se+w*ae,s[6]=b*k+R*H+E*ee+w*_e,s[10]=b*z+R*Q+E*$+w*ne,s[14]=b*F+R*K+E*re+w*ye,s[3]=L*G+D*q+O*se+B*ae,s[7]=L*k+D*H+O*ee+B*_e,s[11]=L*z+D*Q+O*$+B*ne,s[15]=L*F+D*K+O*re+B*ye,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],h=e[2],d=e[6],_=e[10],x=e[14],b=e[3],R=e[7],E=e[11],w=e[15];return b*(+s*l*d-r*u*d-s*a*_+n*u*_+r*a*x-n*l*x)+R*(+t*l*x-t*u*_+s*o*_-r*o*x+r*u*h-s*l*h)+E*(+t*u*d-t*a*x-s*o*d+n*o*x+s*a*h-n*u*h)+w*(-r*a*h-t*l*d+t*a*_+r*o*d-n*o*_+n*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],h=e[8],d=e[9],_=e[10],x=e[11],b=e[12],R=e[13],E=e[14],w=e[15],L=d*E*u-R*_*u+R*l*x-a*E*x-d*l*w+a*_*w,D=b*_*u-h*E*u-b*l*x+o*E*x+h*l*w-o*_*w,O=h*R*u-b*d*u+b*a*x-o*R*x-h*a*w+o*d*w,B=b*d*l-h*R*l-b*a*_+o*R*_+h*a*E-o*d*E,G=t*L+n*D+r*O+s*B;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/G;return e[0]=L*k,e[1]=(R*_*s-d*E*s-R*r*x+n*E*x+d*r*w-n*_*w)*k,e[2]=(a*E*s-R*l*s+R*r*u-n*E*u-a*r*w+n*l*w)*k,e[3]=(d*l*s-a*_*s-d*r*u+n*_*u+a*r*x-n*l*x)*k,e[4]=D*k,e[5]=(h*E*s-b*_*s+b*r*x-t*E*x-h*r*w+t*_*w)*k,e[6]=(b*l*s-o*E*s-b*r*u+t*E*u+o*r*w-t*l*w)*k,e[7]=(o*_*s-h*l*s+h*r*u-t*_*u-o*r*x+t*l*x)*k,e[8]=O*k,e[9]=(b*d*s-h*R*s-b*n*x+t*R*x+h*n*w-t*d*w)*k,e[10]=(o*R*s-b*a*s+b*n*u-t*R*u-o*n*w+t*a*w)*k,e[11]=(h*a*s-o*d*s-h*n*u+t*d*u+o*n*x-t*a*x)*k,e[12]=B*k,e[13]=(h*R*r-b*d*r+b*n*_-t*R*_-h*n*E+t*d*E)*k,e[14]=(b*a*r-o*R*r-b*n*l+t*R*l+o*n*E-t*a*E)*k,e[15]=(o*d*r-h*a*r+h*n*l-t*d*l-o*n*_+t*a*_)*k,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,u=s*o,h=s*a;return this.set(u*o+n,u*a-r*l,u*l+r*a,0,u*a+r*l,h*a+n,h*l-r*o,0,u*l-r*a,h*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,h=o+o,d=a+a,_=s*u,x=s*h,b=s*d,R=o*h,E=o*d,w=a*d,L=l*u,D=l*h,O=l*d,B=n.x,G=n.y,k=n.z;return r[0]=(1-(R+w))*B,r[1]=(x+O)*B,r[2]=(b-D)*B,r[3]=0,r[4]=(x-O)*G,r[5]=(1-(_+w))*G,r[6]=(E+L)*G,r[7]=0,r[8]=(b+D)*k,r[9]=(E-L)*k,r[10]=(1-(_+R))*k,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Q0.set(r[0],r[1],r[2]).length();const o=Q0.set(r[4],r[5],r[6]).length(),a=Q0.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Zl.copy(this);const u=1/s,h=1/o,d=1/a;return Zl.elements[0]*=u,Zl.elements[1]*=u,Zl.elements[2]*=u,Zl.elements[4]*=h,Zl.elements[5]*=h,Zl.elements[6]*=h,Zl.elements[8]*=d,Zl.elements[9]*=d,Zl.elements[10]*=d,t.setFromRotationMatrix(Zl),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=qo){const l=this.elements,u=2*s/(t-e),h=2*s/(n-r),d=(t+e)/(t-e),_=(n+r)/(n-r);let x,b;if(a===qo)x=-(o+s)/(o-s),b=-2*o*s/(o-s);else if(a===lc)x=-o/(o-s),b=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=h,l[9]=_,l[13]=0,l[2]=0,l[6]=0,l[10]=x,l[14]=b,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=qo){const l=this.elements,u=1/(t-e),h=1/(n-r),d=1/(o-s),_=(t+e)*u,x=(n+r)*h;let b,R;if(a===qo)b=(o+s)*d,R=-2*d;else if(a===lc)b=s*d,R=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-_,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-x,l[2]=0,l[6]=0,l[10]=R,l[14]=-b,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Q0=new ce,Zl=new Cn,K$=new ce(0,0,0),Z$=new ce(1,1,1),Tf=new ce,kv=new ce,Ba=new ce,eL=new Cn,tL=new _u;class ao{constructor(e=0,t=0,n=0,r=ao.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],h=r[9],d=r[2],_=r[6],x=r[10];switch(t){case"XYZ":this._y=Math.asin(ei(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,x),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(_,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ei(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,x),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(ei(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-d,x),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-ei(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(ei(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,x));break;case"XZY":this._z=Math.asin(-ei(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(_,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return eL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(eL,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return tL.setFromEuler(this),this.setFromQuaternion(tL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ao.DEFAULT_ORDER="XYZ";class i8{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let J$=0;const nL=new ce,K0=new _u,Jc=new Cn,Gv=new ce,E1=new ce,eY=new ce,tY=new _u,iL=new ce(1,0,0),rL=new ce(0,1,0),sL=new ce(0,0,1),oL={type:"added"},nY={type:"removed"},Z0={type:"childadded",child:null},vw={type:"childremoved",child:null};class Rr extends gc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:J$++}),this.uuid=Ju(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Rr.DEFAULT_UP.clone();const e=new ce,t=new ao,n=new _u,r=new ce(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Cn},normalMatrix:{value:new Hn}}),this.matrix=new Cn,this.matrixWorld=new Cn,this.matrixAutoUpdate=Rr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Rr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new i8,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return K0.setFromAxisAngle(e,t),this.quaternion.multiply(K0),this}rotateOnWorldAxis(e,t){return K0.setFromAxisAngle(e,t),this.quaternion.premultiply(K0),this}rotateX(e){return this.rotateOnAxis(iL,e)}rotateY(e){return this.rotateOnAxis(rL,e)}rotateZ(e){return this.rotateOnAxis(sL,e)}translateOnAxis(e,t){return nL.copy(e).applyQuaternion(this.quaternion),this.position.add(nL.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(iL,e)}translateY(e){return this.translateOnAxis(rL,e)}translateZ(e){return this.translateOnAxis(sL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Jc.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Gv.copy(e):Gv.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),E1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Jc.lookAt(E1,Gv,this.up):Jc.lookAt(Gv,E1,this.up),this.quaternion.setFromRotationMatrix(Jc),r&&(Jc.extractRotation(r.matrixWorld),K0.setFromRotationMatrix(Jc),this.quaternion.premultiply(K0.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(oL),Z0.child=e,this.dispatchEvent(Z0),Z0.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(nY),vw.child=e,this.dispatchEvent(vw),vw.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Jc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Jc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Jc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(oL),Z0.child=e,this.dispatchEvent(Z0),Z0.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(E1,e,eY),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(E1,tY,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(a=>({...a})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++){const d=l[u];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),h=o(e.images),d=o(e.shapes),_=o(e.skeletons),x=o(e.animations),b=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),u.length>0&&(n.textures=u),h.length>0&&(n.images=h),d.length>0&&(n.shapes=d),_.length>0&&(n.skeletons=_),x.length>0&&(n.animations=x),b.length>0&&(n.nodes=b)}return n.object=r,n;function o(a){const l=[];for(const u in a){const h=a[u];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Rr.DEFAULT_UP=new ce(0,1,0);Rr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Rr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Jl=new ce,eh=new ce,xw=new ce,th=new ce,J0=new ce,ep=new ce,aL=new ce,bw=new ce,Sw=new ce,Tw=new ce,Ew=new mn,ww=new mn,Mw=new mn;class lu{constructor(e=new ce,t=new ce,n=new ce){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Jl.subVectors(e,t),r.cross(Jl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Jl.subVectors(r,t),eh.subVectors(n,t),xw.subVectors(e,t);const o=Jl.dot(Jl),a=Jl.dot(eh),l=Jl.dot(xw),u=eh.dot(eh),h=eh.dot(xw),d=o*u-a*a;if(d===0)return s.set(0,0,0),null;const _=1/d,x=(u*l-a*h)*_,b=(o*h-a*l)*_;return s.set(1-x-b,b,x)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,th)===null?!1:th.x>=0&&th.y>=0&&th.x+th.y<=1}static getInterpolation(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,th)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,th.x),l.addScaledVector(o,th.y),l.addScaledVector(a,th.z),l)}static getInterpolatedAttribute(e,t,n,r,s,o){return Ew.setScalar(0),ww.setScalar(0),Mw.setScalar(0),Ew.fromBufferAttribute(e,t),ww.fromBufferAttribute(e,n),Mw.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(Ew,s.x),o.addScaledVector(ww,s.y),o.addScaledVector(Mw,s.z),o}static isFrontFacing(e,t,n,r){return Jl.subVectors(n,t),eh.subVectors(e,t),Jl.cross(eh).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jl.subVectors(this.c,this.b),eh.subVectors(this.a,this.b),Jl.cross(eh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return lu.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return lu.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return lu.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return lu.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return lu.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;J0.subVectors(r,n),ep.subVectors(s,n),bw.subVectors(e,n);const l=J0.dot(bw),u=ep.dot(bw);if(l<=0&&u<=0)return t.copy(n);Sw.subVectors(e,r);const h=J0.dot(Sw),d=ep.dot(Sw);if(h>=0&&d<=h)return t.copy(r);const _=l*d-h*u;if(_<=0&&l>=0&&h<=0)return o=l/(l-h),t.copy(n).addScaledVector(J0,o);Tw.subVectors(e,s);const x=J0.dot(Tw),b=ep.dot(Tw);if(b>=0&&x<=b)return t.copy(s);const R=x*u-l*b;if(R<=0&&u>=0&&b<=0)return a=u/(u-b),t.copy(n).addScaledVector(ep,a);const E=h*b-x*d;if(E<=0&&d-h>=0&&x-b>=0)return aL.subVectors(s,r),a=(d-h)/(d-h+(x-b)),t.copy(r).addScaledVector(aL,a);const w=1/(E+R+_);return o=R*w,a=_*w,t.copy(n).addScaledVector(J0,o).addScaledVector(ep,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const l9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ef={h:0,s:0,l:0},zv={h:0,s:0,l:0};function Rw(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}let Jt=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=qs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,In.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=In.workingColorSpace){return this.r=e,this.g=t,this.b=n,In.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=In.workingColorSpace){if(e=J4(e,1),t=ei(t,0,1),n=ei(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=Rw(o,s,e+1/3),this.g=Rw(o,s,e),this.b=Rw(o,s,e-1/3)}return In.colorSpaceToWorking(this,r),this}setStyle(e,t=qs){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=qs){const n=l9[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=gh(e.r),this.g=gh(e.g),this.b=gh(e.b),this}copyLinearToSRGB(e){return this.r=Jp(e.r),this.g=Jp(e.g),this.b=Jp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=qs){return In.workingToColorSpace(go.copy(this),e),Math.round(ei(go.r*255,0,255))*65536+Math.round(ei(go.g*255,0,255))*256+Math.round(ei(go.b*255,0,255))}getHexString(e=qs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=In.workingColorSpace){In.workingToColorSpace(go.copy(this),t);const n=go.r,r=go.g,s=go.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,u;const h=(a+o)/2;if(a===o)l=0,u=0;else{const d=o-a;switch(u=h<=.5?d/(o+a):d/(2-o-a),o){case n:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-n)/d+2;break;case s:l=(n-r)/d+4;break}l/=6}return e.h=l,e.s=u,e.l=h,e}getRGB(e,t=In.workingColorSpace){return In.workingToColorSpace(go.copy(this),t),e.r=go.r,e.g=go.g,e.b=go.b,e}getStyle(e=qs){In.workingToColorSpace(go.copy(this),e);const t=go.r,n=go.g,r=go.b;return e!==qs?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Ef),this.setHSL(Ef.h+e,Ef.s+t,Ef.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Ef),e.getHSL(zv);const n=S_(Ef.h,zv.h,t),r=S_(Ef.s,zv.s,t),s=S_(Ef.l,zv.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const go=new Jt;Jt.NAMES=l9;let iY=0;class wo extends gc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:iY++}),this.uuid=Ju(),this.name="",this.type="Material",this.blending=Wo,this.side=ma,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=k_,this.blendDst=G_,this.blendEquation=bo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Jt(0,0,0),this.blendAlpha=0,this.depthFunc=od,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=FR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=nA,this.stencilZFail=nA,this.stencilZPass=nA,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Wo&&(n.blending=this.blending),this.side!==ma&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==k_&&(n.blendSrc=this.blendSrc),this.blendDst!==G_&&(n.blendDst=this.blendDst),this.blendEquation!==bo&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==od&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==FR&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==nA&&(n.stencilFail=this.stencilFail),this.stencilZFail!==nA&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==nA&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class $a extends wo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Jt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ao,this.combine=Vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const fh=rY();function rY(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(n[l]=1024>>-u-14,n[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(n[l]=u+15<<10,n[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,h=0;for(;(u&8388608)===0;)u<<=1,h-=8388608;u&=-8388609,h+=947912704,s[l]=u|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Ua(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=ei(i,-65504,65504),fh.floatView[0]=i;const e=fh.uint32View[0],t=e>>23&511;return fh.baseTable[t]+((e&8388607)>>fh.shiftTable[t])}function Vv(i){const e=i>>10;return fh.uint32View[0]=fh.mantissaTable[fh.offsetTable[e]+(i&1023)]+fh.exponentTable[e],fh.floatView[0]}const cs=new ce,qv=new it;let sY=0;class _r{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:sY++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Fb,this.updateRanges=[],this.gpuType=os,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)qv.fromBufferAttribute(this,t),qv.applyMatrix3(e),this.setXY(t,qv.x,qv.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)cs.fromBufferAttribute(this,t),cs.applyMatrix3(e),this.setXYZ(t,cs.x,cs.y,cs.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)cs.fromBufferAttribute(this,t),cs.applyMatrix4(e),this.setXYZ(t,cs.x,cs.y,cs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cs.fromBufferAttribute(this,t),cs.applyNormalMatrix(e),this.setXYZ(t,cs.x,cs.y,cs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cs.fromBufferAttribute(this,t),cs.transformDirection(e),this.setXYZ(t,cs.x,cs.y,cs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=zo(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ii(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=zo(t,this.array)),t}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=zo(t,this.array)),t}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=zo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=zo(t,this.array)),t}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array),s=ii(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Fb&&(e.usage=this.usage),e}}class r8 extends _r{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class s8 extends _r{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class u9 extends _r{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Vv(this.array[e*this.itemSize]);return this.normalized&&(t=zo(t,this.array)),t}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize]=Ua(t),this}getY(e){let t=Vv(this.array[e*this.itemSize+1]);return this.normalized&&(t=zo(t,this.array)),t}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+1]=Ua(t),this}getZ(e){let t=Vv(this.array[e*this.itemSize+2]);return this.normalized&&(t=zo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+2]=Ua(t),this}getW(e){let t=Vv(this.array[e*this.itemSize+3]);return this.normalized&&(t=zo(t,this.array)),t}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+3]=Ua(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.array[e+0]=Ua(t),this.array[e+1]=Ua(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array)),this.array[e+0]=Ua(t),this.array[e+1]=Ua(n),this.array[e+2]=Ua(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array),s=ii(s,this.array)),this.array[e+0]=Ua(t),this.array[e+1]=Ua(n),this.array[e+2]=Ua(r),this.array[e+3]=Ua(s),this}}class Si extends _r{constructor(e,t,n){super(new Float32Array(e),t,n)}}let oY=0;const gl=new Cn,Cw=new Rr,tp=new ce,Fa=new kh,w1=new kh,Fs=new ce;class Vi extends gc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:oY++}),this.uuid=Ju(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(e8(e)?s8:r8)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Hn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return gl.makeRotationFromQuaternion(e),this.applyMatrix4(gl),this}rotateX(e){return gl.makeRotationX(e),this.applyMatrix4(gl),this}rotateY(e){return gl.makeRotationY(e),this.applyMatrix4(gl),this}rotateZ(e){return gl.makeRotationZ(e),this.applyMatrix4(gl),this}translate(e,t,n){return gl.makeTranslation(e,t,n),this.applyMatrix4(gl),this}scale(e,t,n){return gl.makeScale(e,t,n),this.applyMatrix4(gl),this}lookAt(e){return Cw.lookAt(e),Cw.updateMatrix(),this.applyMatrix4(Cw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tp).negate(),this.translate(tp.x,tp.y,tp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Si(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new kh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ce(-1/0,-1/0,-1/0),new ce(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];Fa.setFromBufferAttribute(s),this.morphTargetsRelative?(Fs.addVectors(this.boundingBox.min,Fa.min),this.boundingBox.expandByPoint(Fs),Fs.addVectors(this.boundingBox.max,Fa.max),this.boundingBox.expandByPoint(Fs)):(this.boundingBox.expandByPoint(Fa.min),this.boundingBox.expandByPoint(Fa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new cd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ce,1/0);return}if(e){const n=this.boundingSphere.center;if(Fa.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];w1.setFromBufferAttribute(a),this.morphTargetsRelative?(Fs.addVectors(Fa.min,w1.min),Fa.expandByPoint(Fs),Fs.addVectors(Fa.max,w1.max),Fa.expandByPoint(Fs)):(Fa.expandByPoint(w1.min),Fa.expandByPoint(w1.max))}Fa.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Fs.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Fs));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,h=a.count;u<h;u++)Fs.fromBufferAttribute(a,u),l&&(tp.fromBufferAttribute(e,u),Fs.add(tp)),r=Math.max(r,n.distanceToSquared(Fs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new _r(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let z=0;z<n.count;z++)a[z]=new ce,l[z]=new ce;const u=new ce,h=new ce,d=new ce,_=new it,x=new it,b=new it,R=new ce,E=new ce;function w(z,F,q){u.fromBufferAttribute(n,z),h.fromBufferAttribute(n,F),d.fromBufferAttribute(n,q),_.fromBufferAttribute(s,z),x.fromBufferAttribute(s,F),b.fromBufferAttribute(s,q),h.sub(u),d.sub(u),x.sub(_),b.sub(_);const H=1/(x.x*b.y-b.x*x.y);isFinite(H)&&(R.copy(h).multiplyScalar(b.y).addScaledVector(d,-x.y).multiplyScalar(H),E.copy(d).multiplyScalar(x.x).addScaledVector(h,-b.x).multiplyScalar(H),a[z].add(R),a[F].add(R),a[q].add(R),l[z].add(E),l[F].add(E),l[q].add(E))}let L=this.groups;L.length===0&&(L=[{start:0,count:e.count}]);for(let z=0,F=L.length;z<F;++z){const q=L[z],H=q.start,Q=q.count;for(let K=H,se=H+Q;K<se;K+=3)w(e.getX(K+0),e.getX(K+1),e.getX(K+2))}const D=new ce,O=new ce,B=new ce,G=new ce;function k(z){B.fromBufferAttribute(r,z),G.copy(B);const F=a[z];D.copy(F),D.sub(B.multiplyScalar(B.dot(F))).normalize(),O.crossVectors(G,F);const H=O.dot(l[z])<0?-1:1;o.setXYZW(z,D.x,D.y,D.z,H)}for(let z=0,F=L.length;z<F;++z){const q=L[z],H=q.start,Q=q.count;for(let K=H,se=H+Q;K<se;K+=3)k(e.getX(K+0)),k(e.getX(K+1)),k(e.getX(K+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new _r(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,x=n.count;_<x;_++)n.setXYZ(_,0,0,0);const r=new ce,s=new ce,o=new ce,a=new ce,l=new ce,u=new ce,h=new ce,d=new ce;if(e)for(let _=0,x=e.count;_<x;_+=3){const b=e.getX(_+0),R=e.getX(_+1),E=e.getX(_+2);r.fromBufferAttribute(t,b),s.fromBufferAttribute(t,R),o.fromBufferAttribute(t,E),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),a.fromBufferAttribute(n,b),l.fromBufferAttribute(n,R),u.fromBufferAttribute(n,E),a.add(h),l.add(h),u.add(h),n.setXYZ(b,a.x,a.y,a.z),n.setXYZ(R,l.x,l.y,l.z),n.setXYZ(E,u.x,u.y,u.z)}else for(let _=0,x=t.count;_<x;_+=3)r.fromBufferAttribute(t,_+0),s.fromBufferAttribute(t,_+1),o.fromBufferAttribute(t,_+2),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),n.setXYZ(_+0,h.x,h.y,h.z),n.setXYZ(_+1,h.x,h.y,h.z),n.setXYZ(_+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Fs.fromBufferAttribute(e,t),Fs.normalize(),e.setXYZ(t,Fs.x,Fs.y,Fs.z)}toNonIndexed(){function e(a,l){const u=a.array,h=a.itemSize,d=a.normalized,_=new u.constructor(l.length*h);let x=0,b=0;for(let R=0,E=l.length;R<E;R++){a.isInterleavedBufferAttribute?x=l[R]*a.data.stride+a.offset:x=l[R]*h;for(let w=0;w<h;w++)_[b++]=u[x++]}return new _r(_,h,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Vi,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,n);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let h=0,d=u.length;h<d;h++){const _=u[h],x=e(_,n);l.push(x)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const u=n[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],h=[];for(let d=0,_=u.length;d<_;d++){const x=u[d];h.push(x.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const u in r){const h=r[u];this.setAttribute(u,h.clone(t))}const s=e.morphAttributes;for(const u in s){const h=[],d=s[u];for(let _=0,x=d.length;_<x;_++)h.push(d[_].clone(t));this.morphAttributes[u]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,h=o.length;u<h;u++){const d=o[u];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const lL=new Cn,kd=new Wy,Hv=new cd,uL=new ce,Wv=new ce,jv=new ce,Xv=new ce,Nw=new ce,$v=new ce,cL=new ce,Yv=new ce;class Ri extends Rr{constructor(e=new Vi,t=new $a){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){$v.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const h=a[l],d=s[l];h!==0&&(Nw.fromBufferAttribute(d,e),o?$v.addScaledVector(Nw,h):$v.addScaledVector(Nw.sub(t),h))}t.add($v)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Hv.copy(n.boundingSphere),Hv.applyMatrix4(s),kd.copy(e.ray).recast(e.near),!(Hv.containsPoint(kd.origin)===!1&&(kd.intersectSphere(Hv,uL)===null||kd.origin.distanceToSquared(uL)>(e.far-e.near)**2))&&(lL.copy(s).invert(),kd.copy(e.ray).applyMatrix4(lL),!(n.boundingBox!==null&&kd.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,kd)))}_computeIntersections(e,t,n){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,h=s.attributes.uv1,d=s.attributes.normal,_=s.groups,x=s.drawRange;if(a!==null)if(Array.isArray(o))for(let b=0,R=_.length;b<R;b++){const E=_[b],w=o[E.materialIndex],L=Math.max(E.start,x.start),D=Math.min(a.count,Math.min(E.start+E.count,x.start+x.count));for(let O=L,B=D;O<B;O+=3){const G=a.getX(O),k=a.getX(O+1),z=a.getX(O+2);r=Qv(this,w,e,n,u,h,d,G,k,z),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,t.push(r))}}else{const b=Math.max(0,x.start),R=Math.min(a.count,x.start+x.count);for(let E=b,w=R;E<w;E+=3){const L=a.getX(E),D=a.getX(E+1),O=a.getX(E+2);r=Qv(this,o,e,n,u,h,d,L,D,O),r&&(r.faceIndex=Math.floor(E/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let b=0,R=_.length;b<R;b++){const E=_[b],w=o[E.materialIndex],L=Math.max(E.start,x.start),D=Math.min(l.count,Math.min(E.start+E.count,x.start+x.count));for(let O=L,B=D;O<B;O+=3){const G=O,k=O+1,z=O+2;r=Qv(this,w,e,n,u,h,d,G,k,z),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,t.push(r))}}else{const b=Math.max(0,x.start),R=Math.min(l.count,x.start+x.count);for(let E=b,w=R;E<w;E+=3){const L=E,D=E+1,O=E+2;r=Qv(this,o,e,n,u,h,d,L,D,O),r&&(r.faceIndex=Math.floor(E/3),t.push(r))}}}}function aY(i,e,t,n,r,s,o,a){let l;if(e.side===Zi?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===ma,a),l===null)return null;Yv.copy(a),Yv.applyMatrix4(i.matrixWorld);const u=t.ray.origin.distanceTo(Yv);return u<t.near||u>t.far?null:{distance:u,point:Yv.clone(),object:i}}function Qv(i,e,t,n,r,s,o,a,l,u){i.getVertexPosition(a,Wv),i.getVertexPosition(l,jv),i.getVertexPosition(u,Xv);const h=aY(i,e,t,n,Wv,jv,Xv,cL);if(h){const d=new ce;lu.getBarycoord(cL,Wv,jv,Xv,d),r&&(h.uv=lu.getInterpolatedAttribute(r,a,l,u,d,new it)),s&&(h.uv1=lu.getInterpolatedAttribute(s,a,l,u,d,new it)),o&&(h.normal=lu.getInterpolatedAttribute(o,a,l,u,d,new ce),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const _={a,b:l,c:u,normal:new ce,materialIndex:0};lu.getNormal(Wv,jv,Xv,_.normal),h.face=_,h.barycoord=d}return h}class hd extends Vi{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],h=[],d=[];let _=0,x=0;b("z","y","x",-1,-1,n,t,e,o,s,0),b("z","y","x",1,-1,n,t,-e,o,s,1),b("x","z","y",1,1,e,n,t,r,o,2),b("x","z","y",1,-1,e,n,-t,r,o,3),b("x","y","z",1,-1,e,t,n,r,s,4),b("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Si(u,3)),this.setAttribute("normal",new Si(h,3)),this.setAttribute("uv",new Si(d,2));function b(R,E,w,L,D,O,B,G,k,z,F){const q=O/k,H=B/z,Q=O/2,K=B/2,se=G/2,ee=k+1,$=z+1;let re=0,ae=0;const _e=new ce;for(let ne=0;ne<$;ne++){const ye=ne*H-K;for(let ve=0;ve<ee;ve++){const Pe=ve*q-Q;_e[R]=Pe*L,_e[E]=ye*D,_e[w]=se,u.push(_e.x,_e.y,_e.z),_e[R]=0,_e[E]=0,_e[w]=G>0?1:-1,h.push(_e.x,_e.y,_e.z),d.push(ve/k),d.push(1-ne/z),re+=1}}for(let ne=0;ne<z;ne++)for(let ye=0;ye<k;ye++){const ve=_+ye+ee*ne,Pe=_+ye+ee*(ne+1),Se=_+(ye+1)+ee*(ne+1),Fe=_+(ye+1)+ee*ne;l.push(ve,Pe,Fe),l.push(Pe,Se,Fe),ae+=6}a.addGroup(x,ae,F),x+=ae,_+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Om(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Oo(i){const e={};for(let t=0;t<i.length;t++){const n=Om(i[t]);for(const r in n)e[r]=n[r]}return e}function lY(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function c9(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:In.workingColorSpace}const lT={clone:Om,merge:Oo};var uY=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,cY=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ya extends wo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=uY,this.fragmentShader=cY,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Om(e.uniforms),this.uniformsGroups=lY(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class jy extends Rr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Cn,this.projectionMatrix=new Cn,this.projectionMatrixInverse=new Cn,this.coordinateSystem=qo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const wf=new ce,hL=new it,fL=new it;class Ws extends jy{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=zA*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(b_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return zA*2*Math.atan(Math.tan(b_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){wf.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(wf.x,wf.y).multiplyScalar(-e/wf.z),wf.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(wf.x,wf.y).multiplyScalar(-e/wf.z)}getViewSize(e,t){return this.getViewBounds(e,hL,fL),t.subVectors(fL,hL)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(b_*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/u,r*=o.width/l,n*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const np=-90,ip=1;class h9 extends Rr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ws(np,ip,e,t);r.layers=this.layers,this.add(r);const s=new Ws(np,ip,e,t);s.layers=this.layers,this.add(s);const o=new Ws(np,ip,e,t);o.layers=this.layers,this.add(o);const a=new Ws(np,ip,e,t);a.layers=this.layers,this.add(a);const l=new Ws(np,ip,e,t);l.layers=this.layers,this.add(l);const u=new Ws(np,ip,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===qo)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===lc)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,h]=this.children,d=e.getRenderTarget(),_=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,u),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,r),e.render(t,h),e.setRenderTarget(d,_,x),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class Xy extends ps{constructor(e=[],t=oc,n,r,s,o,a,l,u,h){super(e,t,n,r,s,o,a,l,u,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class f9 extends ad{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Xy(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new hd(5,5,5),s=new ya({name:"CubemapFromEquirect",uniforms:Om(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Zi,blending:ga});s.uniforms.tEquirect.value=t;const o=new Ri(r,s),a=t.minFilter;return t.minFilter===ua&&(t.minFilter=Ms),new h9(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}let ca=class extends Rr{constructor(){super(),this.isGroup=!0,this.type="Group"}};const hY={type:"move"};class _b{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ca,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ca,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ce,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ce),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ca,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ce,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ce),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const R of e.hand.values()){const E=t.getJointPose(R,n),w=this._getHandJoint(u,R);E!==null&&(w.matrix.fromArray(E.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.matrixWorldNeedsUpdate=!0,w.jointRadius=E.radius),w.visible=E!==null}const h=u.joints["index-finger-tip"],d=u.joints["thumb-tip"],_=h.position.distanceTo(d.position),x=.02,b=.005;u.inputState.pinching&&_>x+b?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&_<=x-b&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(hY)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new ca;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class uT extends Rr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ao,this.environmentIntensity=1,this.environmentRotation=new ao,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class o8{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Fb,this.updateRanges=[],this.version=0,this.uuid=Ju()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ju()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Po=new ce;class $u{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.applyMatrix4(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.applyNormalMatrix(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.transformDirection(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=zo(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ii(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=zo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=zo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=zo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=zo(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),r=ii(r,this.array),s=ii(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new _r(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new $u(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class fY extends wo{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Jt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class dY extends ps{constructor(e=null,t=1,n=1,r,s,o,a,l,u=br,h=br,d,_){super(null,o,a,l,u,h,r,s,d,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ed extends _r{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Dw=new ce,AY=new ce,pY=new Hn;class Gu{constructor(e=new ce(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Dw.subVectors(n,t).cross(AY.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Dw),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||pY.getNormalMatrix(e),r=this.coplanarPoint(Dw).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Gd=new cd,mY=new it(.5,.5),Kv=new ce;class cg{constructor(e=new Gu,t=new Gu,n=new Gu,r=new Gu,s=new Gu,o=new Gu){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=qo){const n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],h=r[5],d=r[6],_=r[7],x=r[8],b=r[9],R=r[10],E=r[11],w=r[12],L=r[13],D=r[14],O=r[15];if(n[0].setComponents(l-s,_-u,E-x,O-w).normalize(),n[1].setComponents(l+s,_+u,E+x,O+w).normalize(),n[2].setComponents(l+o,_+h,E+b,O+L).normalize(),n[3].setComponents(l-o,_-h,E-b,O-L).normalize(),n[4].setComponents(l-a,_-d,E-R,O-D).normalize(),t===qo)n[5].setComponents(l+a,_+d,E+R,O+D).normalize();else if(t===lc)n[5].setComponents(a,d,R,D).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Gd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Gd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gd)}intersectsSprite(e){Gd.center.set(0,0,0);const t=mY.distanceTo(e.center);return Gd.radius=.7071067811865476+t,Gd.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gd)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Kv.x=r.normal.x>0?e.max.x:e.min.x,Kv.y=r.normal.y>0?e.max.y:e.min.y,Kv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Kv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Lu=new Cn,Ou=new cg;class a8{constructor(){this.coordinateSystem=qo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Lu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ou.setFromProjectionMatrix(Lu,this.coordinateSystem),Ou.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Lu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ou.setFromProjectionMatrix(Lu,this.coordinateSystem),Ou.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Lu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ou.setFromProjectionMatrix(Lu,this.coordinateSystem),Ou.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Lu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ou.setFromProjectionMatrix(Lu,this.coordinateSystem),Ou.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Lu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ou.setFromProjectionMatrix(Lu,this.coordinateSystem),Ou.containsPoint(e))return!0}return!1}clone(){return new a8}}class hg extends wo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Jt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const kb=new ce,Gb=new ce,dL=new Cn,M1=new Wy,Zv=new cd,Pw=new ce,AL=new ce;class cT extends Rr{constructor(e=new Vi,t=new hg){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)kb.fromBufferAttribute(t,r-1),Gb.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=kb.distanceTo(Gb);e.setAttribute("lineDistance",new Si(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Zv.copy(n.boundingSphere),Zv.applyMatrix4(r),Zv.radius+=s,e.ray.intersectsSphere(Zv)===!1)return;dL.copy(r).invert(),M1.copy(e.ray).applyMatrix4(dL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,h=n.index,_=n.attributes.position;if(h!==null){const x=Math.max(0,o.start),b=Math.min(h.count,o.start+o.count);for(let R=x,E=b-1;R<E;R+=u){const w=h.getX(R),L=h.getX(R+1),D=Jv(this,e,M1,l,w,L,R);D&&t.push(D)}if(this.isLineLoop){const R=h.getX(b-1),E=h.getX(x),w=Jv(this,e,M1,l,R,E,b-1);w&&t.push(w)}}else{const x=Math.max(0,o.start),b=Math.min(_.count,o.start+o.count);for(let R=x,E=b-1;R<E;R+=u){const w=Jv(this,e,M1,l,R,R+1,R);w&&t.push(w)}if(this.isLineLoop){const R=Jv(this,e,M1,l,b-1,x,b-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function Jv(i,e,t,n,r,s,o){const a=i.geometry.attributes.position;if(kb.fromBufferAttribute(a,r),Gb.fromBufferAttribute(a,s),t.distanceSqToSegment(kb,Gb,Pw,AL)>n)return;Pw.applyMatrix4(i.matrixWorld);const u=e.ray.origin.distanceTo(Pw);if(!(u<e.near||u>e.far))return{distance:u,point:AL.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const pL=new ce,mL=new ce;class d9 extends cT{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)pL.fromBufferAttribute(t,r),mL.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+pL.distanceTo(mL);e.setAttribute("lineDistance",new Si(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class l8 extends wo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Jt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const gL=new Cn,kR=new Wy,ex=new cd,tx=new ce;class gY extends Rr{constructor(e=new Vi,t=new l8){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ex.copy(n.boundingSphere),ex.applyMatrix4(r),ex.radius+=s,e.ray.intersectsSphere(ex)===!1)return;gL.copy(r).invert(),kR.copy(e.ray).applyMatrix4(gL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=n.index,d=n.attributes.position;if(u!==null){const _=Math.max(0,o.start),x=Math.min(u.count,o.start+o.count);for(let b=_,R=x;b<R;b++){const E=u.getX(b);tx.fromBufferAttribute(d,E),_L(tx,E,l,r,e,t,this)}}else{const _=Math.max(0,o.start),x=Math.min(d.count,o.start+o.count);for(let b=_,R=x;b<R;b++)tx.fromBufferAttribute(d,b),_L(tx,b,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function _L(i,e,t,n,r,s,o){const a=kR.distanceSqToPoint(i);if(a<t){const l=new ce;kR.closestPointToPoint(i,l),l.applyMatrix4(n);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class A9 extends ps{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=br,this.minFilter=br,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ja extends ps{constructor(e,t,n=mr,r,s,o,a=br,l=br,u,h=Qa,d=1){if(h!==Qa&&h!==Ka)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const _={width:e,height:t,depth:d};super(_,r,s,o,a,l,h,n,u),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new t8(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class hT extends Vi{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new ce,h=new it;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,_=3;d<=t;d++,_+=3){const x=n+d/t*r;u.x=e*Math.cos(x),u.y=e*Math.sin(x),o.push(u.x,u.y,u.z),a.push(0,0,1),h.x=(o[_]/e+1)/2,h.y=(o[_+1]/e+1)/2,l.push(h.x,h.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new Si(o,3)),this.setAttribute("normal",new Si(a,3)),this.setAttribute("uv",new Si(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class fT extends Vi{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const h=[],d=[],_=[],x=[];let b=0;const R=[],E=n/2;let w=0;L(),o===!1&&(e>0&&D(!0),t>0&&D(!1)),this.setIndex(h),this.setAttribute("position",new Si(d,3)),this.setAttribute("normal",new Si(_,3)),this.setAttribute("uv",new Si(x,2));function L(){const O=new ce,B=new ce;let G=0;const k=(t-e)/n;for(let z=0;z<=s;z++){const F=[],q=z/s,H=q*(t-e)+e;for(let Q=0;Q<=r;Q++){const K=Q/r,se=K*l+a,ee=Math.sin(se),$=Math.cos(se);B.x=H*ee,B.y=-q*n+E,B.z=H*$,d.push(B.x,B.y,B.z),O.set(ee,k,$).normalize(),_.push(O.x,O.y,O.z),x.push(K,1-q),F.push(b++)}R.push(F)}for(let z=0;z<r;z++)for(let F=0;F<s;F++){const q=R[F][z],H=R[F+1][z],Q=R[F+1][z+1],K=R[F][z+1];(e>0||F!==0)&&(h.push(q,H,K),G+=3),(t>0||F!==s-1)&&(h.push(H,Q,K),G+=3)}u.addGroup(w,G,0),w+=G}function D(O){const B=b,G=new it,k=new ce;let z=0;const F=O===!0?e:t,q=O===!0?1:-1;for(let Q=1;Q<=r;Q++)d.push(0,E*q,0),_.push(0,q,0),x.push(.5,.5),b++;const H=b;for(let Q=0;Q<=r;Q++){const se=Q/r*l+a,ee=Math.cos(se),$=Math.sin(se);k.x=F*$,k.y=E*q,k.z=F*ee,d.push(k.x,k.y,k.z),_.push(0,q,0),G.x=ee*.5+.5,G.y=$*.5*q+.5,x.push(G.x,G.y),b++}for(let Q=0;Q<r;Q++){const K=B+Q,se=H+Q;O===!0?h.push(se,se+1,K):h.push(se+1,se,K),z+=3}u.addGroup(w,z,O===!0?1:2),w+=z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fT(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xu{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=n[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const h=n[r],_=n[r+1]-h,x=(o-h)/_;return(r+x)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new it:new ce);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ce,r=[],s=[],o=[],a=new ce,l=new Cn;for(let x=0;x<=e;x++){const b=x/e;r[x]=this.getTangentAt(b,new ce)}s[0]=new ce,o[0]=new ce;let u=Number.MAX_VALUE;const h=Math.abs(r[0].x),d=Math.abs(r[0].y),_=Math.abs(r[0].z);h<=u&&(u=h,n.set(1,0,0)),d<=u&&(u=d,n.set(0,1,0)),_<=u&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let x=1;x<=e;x++){if(s[x]=s[x-1].clone(),o[x]=o[x-1].clone(),a.crossVectors(r[x-1],r[x]),a.length()>Number.EPSILON){a.normalize();const b=Math.acos(ei(r[x-1].dot(r[x]),-1,1));s[x].applyMatrix4(l.makeRotationAxis(a,b))}o[x].crossVectors(r[x],s[x])}if(t===!0){let x=Math.acos(ei(s[0].dot(s[e]),-1,1));x/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(x=-x);for(let b=1;b<=e;b++)s[b].applyMatrix4(l.makeRotationAxis(r[b],x*b)),o[b].crossVectors(r[b],s[b])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class u8 extends xu{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new it){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),d=Math.sin(this.aRotation),_=l-this.aX,x=u-this.aY;l=_*h-x*d+this.aX,u=_*d+x*h+this.aY}return n.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class _Y extends u8{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function c8(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,h,d){let _=(o-s)/u-(a-s)/(u+h)+(a-o)/h,x=(a-o)/h-(l-o)/(h+d)+(l-a)/d;_*=h,x*=h,r(o,a,_,x)},calc:function(s){const o=s*s,a=o*s;return i+e*s+t*o+n*a}}}const nx=new ce,Lw=new c8,Ow=new c8,Iw=new c8;class yY extends xu{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new ce){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,h;this.closed||a>0?u=r[(a-1)%s]:(nx.subVectors(r[0],r[1]).add(r[0]),u=nx);const d=r[a%s],_=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(nx.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=nx),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let b=Math.pow(u.distanceToSquared(d),x),R=Math.pow(d.distanceToSquared(_),x),E=Math.pow(_.distanceToSquared(h),x);R<1e-4&&(R=1),b<1e-4&&(b=R),E<1e-4&&(E=R),Lw.initNonuniformCatmullRom(u.x,d.x,_.x,h.x,b,R,E),Ow.initNonuniformCatmullRom(u.y,d.y,_.y,h.y,b,R,E),Iw.initNonuniformCatmullRom(u.z,d.z,_.z,h.z,b,R,E)}else this.curveType==="catmullrom"&&(Lw.initCatmullRom(u.x,d.x,_.x,h.x,this.tension),Ow.initCatmullRom(u.y,d.y,_.y,h.y,this.tension),Iw.initCatmullRom(u.z,d.z,_.z,h.z,this.tension));return n.set(Lw.calc(l),Ow.calc(l),Iw.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new ce().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function yL(i,e,t,n,r){const s=(n-e)*.5,o=(r-t)*.5,a=i*i,l=i*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*i+t}function vY(i,e){const t=1-i;return t*t*e}function xY(i,e){return 2*(1-i)*i*e}function bY(i,e){return i*i*e}function T_(i,e,t,n){return vY(i,e)+xY(i,t)+bY(i,n)}function SY(i,e){const t=1-i;return t*t*t*e}function TY(i,e){const t=1-i;return 3*t*t*i*e}function EY(i,e){return 3*(1-i)*i*i*e}function wY(i,e){return i*i*i*e}function E_(i,e,t,n,r){return SY(i,e)+TY(i,t)+EY(i,n)+wY(i,r)}class p9 extends xu{constructor(e=new it,t=new it,n=new it,r=new it){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new it){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(E_(e,r.x,s.x,o.x,a.x),E_(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class m9 extends xu{constructor(e=new ce,t=new ce,n=new ce,r=new ce){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ce){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(E_(e,r.x,s.x,o.x,a.x),E_(e,r.y,s.y,o.y,a.y),E_(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class g9 extends xu{constructor(e=new it,t=new it){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new it){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new it){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class MY extends xu{constructor(e=new ce,t=new ce){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ce){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ce){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _9 extends xu{constructor(e=new it,t=new it,n=new it){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new it){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(T_(e,r.x,s.x,o.x),T_(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y9 extends xu{constructor(e=new ce,t=new ce,n=new ce){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ce){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(T_(e,r.x,s.x,o.x),T_(e,r.y,s.y,o.y),T_(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class v9 extends xu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new it){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],h=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return n.set(yL(a,l.x,u.x,h.x,d.x),yL(a,l.y,u.y,h.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new it().fromArray(r))}return this}}var zb=Object.freeze({__proto__:null,ArcCurve:_Y,CatmullRomCurve3:yY,CubicBezierCurve:p9,CubicBezierCurve3:m9,EllipseCurve:u8,LineCurve:g9,LineCurve3:MY,QuadraticBezierCurve:_9,QuadraticBezierCurve3:y9,SplineCurve:v9});class RY extends xu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new zb[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const h=l[u];n&&n.equals(h)||(t.push(h),n=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new zb[r.type]().fromJSON(r))}return this}}let GR=class extends RY{constructor(e){super(),this.type="Path",this.currentPoint=new it,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new g9(this.currentPoint.clone(),new it(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new _9(this.currentPoint.clone(),new it(e,t),new it(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new p9(this.currentPoint.clone(),new it(e,t),new it(n,r),new it(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new v9(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,l){const u=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+u,t+h,n,r,s,o,a,l),this}absellipse(e,t,n,r,s,o,a,l){const u=new u8(e,t,n,r,s,o,a,l);if(this.curves.length>0){const d=u.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(u);const h=u.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class yb extends GR{constructor(e){super(e),this.uuid=Ju(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new GR().fromJSON(r))}return this}}function CY(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=x9(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(n&&(s=OY(i,e,s,t)),i.length>80*t){a=1/0,l=1/0;let h=-1/0,d=-1/0;for(let _=t;_<r;_+=t){const x=i[_],b=i[_+1];x<a&&(a=x),b<l&&(l=b),x>h&&(h=x),b>d&&(d=b)}u=Math.max(h-a,d-l),u=u!==0?32767/u:0}return iy(s,o,t,a,l,u,0),o}function x9(i,e,t,n,r){let s;if(r===WY(i,e,t,n)>0)for(let o=e;o<t;o+=n)s=vL(o/n|0,i[o],i[o+1],s);else for(let o=t-n;o>=e;o-=n)s=vL(o/n|0,i[o],i[o+1],s);return s&&Im(s,s.next)&&(sy(s),s=s.next),s}function VA(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Im(t,t.next)||Gr(t.prev,t,t.next)===0)){if(sy(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function iy(i,e,t,n,r,s,o){if(!i)return;!o&&s&&kY(i,n,r,s);let a=i;for(;i.prev!==i.next;){const l=i.prev,u=i.next;if(s?DY(i,n,r,s):NY(i)){e.push(l.i,i.i,u.i),sy(i),i=u.next,a=u.next;continue}if(i=u,i===a){o?o===1?(i=PY(VA(i),e),iy(i,e,t,n,r,s,2)):o===2&&LY(i,e,t,n,r,s):iy(VA(i),e,t,n,r,s,1);break}}}function NY(i){const e=i.prev,t=i,n=i.next;if(Gr(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,u=n.y,h=Math.min(r,s,o),d=Math.min(a,l,u),_=Math.max(r,s,o),x=Math.max(a,l,u);let b=n.next;for(;b!==e;){if(b.x>=h&&b.x<=_&&b.y>=d&&b.y<=x&&r_(r,a,s,l,o,u,b.x,b.y)&&Gr(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function DY(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Gr(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,h=r.y,d=s.y,_=o.y,x=Math.min(a,l,u),b=Math.min(h,d,_),R=Math.max(a,l,u),E=Math.max(h,d,_),w=zR(x,b,e,t,n),L=zR(R,E,e,t,n);let D=i.prevZ,O=i.nextZ;for(;D&&D.z>=w&&O&&O.z<=L;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=E&&D!==r&&D!==o&&r_(a,h,l,d,u,_,D.x,D.y)&&Gr(D.prev,D,D.next)>=0||(D=D.prevZ,O.x>=x&&O.x<=R&&O.y>=b&&O.y<=E&&O!==r&&O!==o&&r_(a,h,l,d,u,_,O.x,O.y)&&Gr(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;D&&D.z>=w;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=E&&D!==r&&D!==o&&r_(a,h,l,d,u,_,D.x,D.y)&&Gr(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;O&&O.z<=L;){if(O.x>=x&&O.x<=R&&O.y>=b&&O.y<=E&&O!==r&&O!==o&&r_(a,h,l,d,u,_,O.x,O.y)&&Gr(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function PY(i,e){let t=i;do{const n=t.prev,r=t.next.next;!Im(n,r)&&S9(n,t,t.next,r)&&ry(n,r)&&ry(r,n)&&(e.push(n.i,t.i,r.i),sy(t),sy(t.next),t=i=r),t=t.next}while(t!==i);return VA(t)}function LY(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&VY(o,a)){let l=T9(o,a);o=VA(o,o.next),l=VA(l,l.next),iy(o,e,t,n,r,s,0),iy(l,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function OY(i,e,t,n){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,u=x9(i,a,l,n,!1);u===u.next&&(u.steiner=!0),r.push(zY(u))}r.sort(IY);for(let s=0;s<r.length;s++)t=BY(r[s],t);return t}function IY(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function BY(i,e){const t=UY(i,e);if(!t)return e;const n=T9(t,i);return VA(n,n.next),VA(t,t.next)}function UY(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;if(Im(i,t))return t;do{if(Im(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s&&(s=d,o=t.x<t.next.x?t:t.next,d===n))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let h=1/0;t=o;do{if(n>=t.x&&t.x>=l&&n!==t.x&&b9(r<u?n:s,r,l,u,r<u?s:n,r,t.x,t.y)){const d=Math.abs(r-t.y)/(n-t.x);ry(t,i)&&(d<h||d===h&&(t.x>o.x||t.x===o.x&&FY(o,t)))&&(o=t,h=d)}t=t.next}while(t!==a);return o}function FY(i,e){return Gr(i.prev,i,e.prev)<0&&Gr(e.next,i,i.next)<0}function kY(i,e,t,n){let r=i;do r.z===0&&(r.z=zR(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,GY(r)}function GY(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let o=n,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=o}s.nextZ=null,t*=2}while(e>1);return i}function zR(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function zY(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function b9(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function r_(i,e,t,n,r,s,o,a){return!(i===o&&e===a)&&b9(i,e,t,n,r,s,o,a)}function VY(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!qY(i,e)&&(ry(i,e)&&ry(e,i)&&HY(i,e)&&(Gr(i.prev,i,e.prev)||Gr(i,e.prev,e))||Im(i,e)&&Gr(i.prev,i,i.next)>0&&Gr(e.prev,e,e.next)>0)}function Gr(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Im(i,e){return i.x===e.x&&i.y===e.y}function S9(i,e,t,n){const r=rx(Gr(i,e,t)),s=rx(Gr(i,e,n)),o=rx(Gr(t,n,i)),a=rx(Gr(t,n,e));return!!(r!==s&&o!==a||r===0&&ix(i,t,e)||s===0&&ix(i,n,e)||o===0&&ix(t,i,n)||a===0&&ix(t,e,n))}function ix(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function rx(i){return i>0?1:i<0?-1:0}function qY(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&S9(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function ry(i,e){return Gr(i.prev,i,i.next)<0?Gr(i,e,i.next)>=0&&Gr(i,i.prev,e)>=0:Gr(i,e,i.prev)<0||Gr(i,i.next,e)<0}function HY(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function T9(i,e){const t=VR(i.i,i.x,i.y),n=VR(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function vL(i,e,t,n){const r=VR(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function sy(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function VR(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function WY(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class jY{static triangulate(e,t,n=2){return CY(e,t,n)}}class pA{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return pA.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];xL(e),bL(n,e);let o=e.length;t.forEach(xL);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,bL(n,t[l]);const a=jY.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function xL(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function bL(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class h8 extends Vi{constructor(e=new yb([new it(.5,.5),new it(-.5,.5),new it(-.5,-.5),new it(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new Si(r,3)),this.setAttribute("uv",new Si(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:x-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3;const w=t.extrudePath,L=t.UVGenerator!==void 0?t.UVGenerator:XY;let D,O=!1,B,G,k,z;w&&(D=w.getSpacedPoints(h),O=!0,_=!1,B=w.computeFrenetFrames(h,!1),G=new ce,k=new ce,z=new ce),_||(E=0,x=0,b=0,R=0);const F=a.extractPoints(u);let q=F.shape;const H=F.holes;if(!pA.isClockWise(q)){q=q.reverse();for(let he=0,vt=H.length;he<vt;he++){const ft=H[he];pA.isClockWise(ft)&&(H[he]=ft.reverse())}}function K(he){const ft=10000000000000001e-36;let pt=he[0];for(let et=1;et<=he.length;et++){const Ft=et%he.length,Tt=he[Ft],Lt=Tt.x-pt.x,_n=Tt.y-pt.y,pe=Lt*Lt+_n*_n,ie=Math.max(Math.abs(Tt.x),Math.abs(Tt.y),Math.abs(pt.x),Math.abs(pt.y)),Ge=ft*ie*ie;if(pe<=Ge){he.splice(Ft,1),et--;continue}pt=Tt}}K(q),H.forEach(K);const se=H.length,ee=q;for(let he=0;he<se;he++){const vt=H[he];q=q.concat(vt)}function $(he,vt,ft){return vt||console.error("THREE.ExtrudeGeometry: vec does not exist"),he.clone().addScaledVector(vt,ft)}const re=q.length;function ae(he,vt,ft){let pt,et,Ft;const Tt=he.x-vt.x,Lt=he.y-vt.y,_n=ft.x-he.x,pe=ft.y-he.y,ie=Tt*Tt+Lt*Lt,Ge=Tt*pe-Lt*_n;if(Math.abs(Ge)>Number.EPSILON){const Qe=Math.sqrt(ie),nt=Math.sqrt(_n*_n+pe*pe),Ke=vt.x-Lt/Qe,qt=vt.y+Tt/Qe,Bt=ft.x-pe/nt,Zt=ft.y+_n/nt,nn=((Bt-Ke)*pe-(Zt-qt)*_n)/(Tt*pe-Lt*_n);pt=Ke+Tt*nn-he.x,et=qt+Lt*nn-he.y;const _t=pt*pt+et*et;if(_t<=2)return new it(pt,et);Ft=Math.sqrt(_t/2)}else{let Qe=!1;Tt>Number.EPSILON?_n>Number.EPSILON&&(Qe=!0):Tt<-Number.EPSILON?_n<-Number.EPSILON&&(Qe=!0):Math.sign(Lt)===Math.sign(pe)&&(Qe=!0),Qe?(pt=-Lt,et=Tt,Ft=Math.sqrt(ie)):(pt=Tt,et=Lt,Ft=Math.sqrt(ie/2))}return new it(pt/Ft,et/Ft)}const _e=[];for(let he=0,vt=ee.length,ft=vt-1,pt=he+1;he<vt;he++,ft++,pt++)ft===vt&&(ft=0),pt===vt&&(pt=0),_e[he]=ae(ee[he],ee[ft],ee[pt]);const ne=[];let ye,ve=_e.concat();for(let he=0,vt=se;he<vt;he++){const ft=H[he];ye=[];for(let pt=0,et=ft.length,Ft=et-1,Tt=pt+1;pt<et;pt++,Ft++,Tt++)Ft===et&&(Ft=0),Tt===et&&(Tt=0),ye[pt]=ae(ft[pt],ft[Ft],ft[Tt]);ne.push(ye),ve=ve.concat(ye)}let Pe;if(E===0)Pe=pA.triangulateShape(ee,H);else{const he=[],vt=[];for(let ft=0;ft<E;ft++){const pt=ft/E,et=x*Math.cos(pt*Math.PI/2),Ft=b*Math.sin(pt*Math.PI/2)+R;for(let Tt=0,Lt=ee.length;Tt<Lt;Tt++){const _n=$(ee[Tt],_e[Tt],Ft);Gt(_n.x,_n.y,-et),pt===0&&he.push(_n)}for(let Tt=0,Lt=se;Tt<Lt;Tt++){const _n=H[Tt];ye=ne[Tt];const pe=[];for(let ie=0,Ge=_n.length;ie<Ge;ie++){const Qe=$(_n[ie],ye[ie],Ft);Gt(Qe.x,Qe.y,-et),pt===0&&pe.push(Qe)}pt===0&&vt.push(pe)}}Pe=pA.triangulateShape(he,vt)}const Se=Pe.length,Fe=b+R;for(let he=0;he<re;he++){const vt=_?$(q[he],ve[he],Fe):q[he];O?(k.copy(B.normals[0]).multiplyScalar(vt.x),G.copy(B.binormals[0]).multiplyScalar(vt.y),z.copy(D[0]).add(k).add(G),Gt(z.x,z.y,z.z)):Gt(vt.x,vt.y,0)}for(let he=1;he<=h;he++)for(let vt=0;vt<re;vt++){const ft=_?$(q[vt],ve[vt],Fe):q[vt];O?(k.copy(B.normals[he]).multiplyScalar(ft.x),G.copy(B.binormals[he]).multiplyScalar(ft.y),z.copy(D[he]).add(k).add(G),Gt(z.x,z.y,z.z)):Gt(ft.x,ft.y,d/h*he)}for(let he=E-1;he>=0;he--){const vt=he/E,ft=x*Math.cos(vt*Math.PI/2),pt=b*Math.sin(vt*Math.PI/2)+R;for(let et=0,Ft=ee.length;et<Ft;et++){const Tt=$(ee[et],_e[et],pt);Gt(Tt.x,Tt.y,d+ft)}for(let et=0,Ft=H.length;et<Ft;et++){const Tt=H[et];ye=ne[et];for(let Lt=0,_n=Tt.length;Lt<_n;Lt++){const pe=$(Tt[Lt],ye[Lt],pt);O?Gt(pe.x,pe.y+D[h-1].y,D[h-1].x+ft):Gt(pe.x,pe.y,d+ft)}}}Ye(),at();function Ye(){const he=r.length/3;if(_){let vt=0,ft=re*vt;for(let pt=0;pt<Se;pt++){const et=Pe[pt];Dt(et[2]+ft,et[1]+ft,et[0]+ft)}vt=h+E*2,ft=re*vt;for(let pt=0;pt<Se;pt++){const et=Pe[pt];Dt(et[0]+ft,et[1]+ft,et[2]+ft)}}else{for(let vt=0;vt<Se;vt++){const ft=Pe[vt];Dt(ft[2],ft[1],ft[0])}for(let vt=0;vt<Se;vt++){const ft=Pe[vt];Dt(ft[0]+re*h,ft[1]+re*h,ft[2]+re*h)}}n.addGroup(he,r.length/3-he,0)}function at(){const he=r.length/3;let vt=0;At(ee,vt),vt+=ee.length;for(let ft=0,pt=H.length;ft<pt;ft++){const et=H[ft];At(et,vt),vt+=et.length}n.addGroup(he,r.length/3-he,1)}function At(he,vt){let ft=he.length;for(;--ft>=0;){const pt=ft;let et=ft-1;et<0&&(et=he.length-1);for(let Ft=0,Tt=h+E*2;Ft<Tt;Ft++){const Lt=re*Ft,_n=re*(Ft+1),pe=vt+pt+Lt,ie=vt+et+Lt,Ge=vt+et+_n,Qe=vt+pt+_n;Nn(pe,ie,Ge,Qe)}}}function Gt(he,vt,ft){l.push(he),l.push(vt),l.push(ft)}function Dt(he,vt,ft){bn(he),bn(vt),bn(ft);const pt=r.length/3,et=L.generateTopUV(n,r,pt-3,pt-2,pt-1);$t(et[0]),$t(et[1]),$t(et[2])}function Nn(he,vt,ft,pt){bn(he),bn(vt),bn(pt),bn(vt),bn(ft),bn(pt);const et=r.length/3,Ft=L.generateSideWallUV(n,r,et-6,et-3,et-2,et-1);$t(Ft[0]),$t(Ft[1]),$t(Ft[3]),$t(Ft[1]),$t(Ft[2]),$t(Ft[3])}function bn(he){r.push(l[he*3+0]),r.push(l[he*3+1]),r.push(l[he*3+2])}function $t(he){s.push(he.x),s.push(he.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return $Y(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];n.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new zb[r.type]().fromJSON(r)),new h8(n,e.options)}}const XY={generateTopUV:function(i,e,t,n,r){const s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],u=e[r*3],h=e[r*3+1];return[new it(s,o),new it(a,l),new it(u,h)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[n*3],h=e[n*3+1],d=e[n*3+2],_=e[r*3],x=e[r*3+1],b=e[r*3+2],R=e[s*3],E=e[s*3+1],w=e[s*3+2];return Math.abs(a-h)<Math.abs(o-u)?[new it(o,1-l),new it(u,1-d),new it(_,1-b),new it(R,1-w)]:[new it(a,1-l),new it(h,1-d),new it(x,1-b),new it(E,1-w)]}};function $Y(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class $y extends Vi{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),u=a+1,h=l+1,d=e/a,_=t/l,x=[],b=[],R=[],E=[];for(let w=0;w<h;w++){const L=w*_-o;for(let D=0;D<u;D++){const O=D*d-s;b.push(O,-L,0),R.push(0,0,1),E.push(D/a),E.push(1-w/l)}}for(let w=0;w<l;w++)for(let L=0;L<a;L++){const D=L+u*w,O=L+u*(w+1),B=L+1+u*(w+1),G=L+1+u*w;x.push(D,O,G),x.push(O,B,G)}this.setIndex(x),this.setAttribute("position",new Si(b,3)),this.setAttribute("normal",new Si(R,3)),this.setAttribute("uv",new Si(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $y(e.width,e.height,e.widthSegments,e.heightSegments)}}class _c extends Vi{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let u=0;const h=[],d=new ce,_=new ce,x=[],b=[],R=[],E=[];for(let w=0;w<=n;w++){const L=[],D=w/n;let O=0;w===0&&o===0?O=.5/t:w===n&&l===Math.PI&&(O=-.5/t);for(let B=0;B<=t;B++){const G=B/t;d.x=-e*Math.cos(r+G*s)*Math.sin(o+D*a),d.y=e*Math.cos(o+D*a),d.z=e*Math.sin(r+G*s)*Math.sin(o+D*a),b.push(d.x,d.y,d.z),_.copy(d).normalize(),R.push(_.x,_.y,_.z),E.push(G+O,1-D),L.push(u++)}h.push(L)}for(let w=0;w<n;w++)for(let L=0;L<t;L++){const D=h[w][L+1],O=h[w][L],B=h[w+1][L],G=h[w+1][L+1];(w!==0||o>0)&&x.push(D,O,G),(w!==n-1||l<Math.PI)&&x.push(O,B,G)}this.setIndex(x),this.setAttribute("position",new Si(b,3)),this.setAttribute("normal",new Si(R,3)),this.setAttribute("uv",new Si(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _c(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class f8 extends Vi{constructor(e=new y9(new ce(-1,-1,0),new ce(-1,1,0),new ce(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ce,l=new ce,u=new it;let h=new ce;const d=[],_=[],x=[],b=[];R(),this.setIndex(b),this.setAttribute("position",new Si(d,3)),this.setAttribute("normal",new Si(_,3)),this.setAttribute("uv",new Si(x,2));function R(){for(let D=0;D<t;D++)E(D);E(s===!1?t:0),L(),w()}function E(D){h=e.getPointAt(D/t,h);const O=o.normals[D],B=o.binormals[D];for(let G=0;G<=r;G++){const k=G/r*Math.PI*2,z=Math.sin(k),F=-Math.cos(k);l.x=F*O.x+z*B.x,l.y=F*O.y+z*B.y,l.z=F*O.z+z*B.z,l.normalize(),_.push(l.x,l.y,l.z),a.x=h.x+n*l.x,a.y=h.y+n*l.y,a.z=h.z+n*l.z,d.push(a.x,a.y,a.z)}}function w(){for(let D=1;D<=t;D++)for(let O=1;O<=r;O++){const B=(r+1)*(D-1)+(O-1),G=(r+1)*D+(O-1),k=(r+1)*D+O,z=(r+1)*(D-1)+O;b.push(B,G,z),b.push(G,k,z)}}function L(){for(let D=0;D<=t;D++)for(let O=0;O<=r;O++)u.x=D/t,u.y=O/r,x.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new f8(new zb[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class YY extends Vi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new ce,s=new ce;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,h=l.length;u<h;++u){const d=l[u],_=d.start,x=d.count;for(let b=_,R=_+x;b<R;b+=3)for(let E=0;E<3;E++){const w=a.getX(b+E),L=a.getX(b+(E+1)%3);r.fromBufferAttribute(o,w),s.fromBufferAttribute(o,L),SL(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const h=3*a+u,d=3*a+(u+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,d),SL(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Si(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function SL(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}class QY extends wo{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Jt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class E9 extends wo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Jt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ao,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class KY extends E9{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new it(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ei(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Jt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Jt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Jt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class w9 extends wo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Jt(16777215),this.specular=new Jt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ao,this.combine=Vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ZY extends wo{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Jt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class JY extends wo{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Gh extends wo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Jt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ao,this.combine=Vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eQ extends wo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=c$,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tQ extends wo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class nQ extends wo{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Jt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mh,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iQ extends hg{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const w_={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class rQ{constructor(e,t,n){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,d){return u.push(h,d),this},this.removeHandler=function(h){const d=u.indexOf(h);return d!==-1&&u.splice(d,2),this},this.getHandler=function(h){for(let d=0,_=u.length;d<_;d+=2){const x=u[d],b=u[d+1];if(x.global&&(x.lastIndex=0),x.test(h))return b}return null}}}const sQ=new rQ;class Yy{constructor(e){this.manager=e!==void 0?e:sQ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Yy.DEFAULT_MATERIAL_NAME="__DEFAULT";const nh={};class oQ extends Error{constructor(e,t){super(e),this.response=t}}class aQ extends Yy{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=w_.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(nh[e]!==void 0){nh[e].push({onLoad:t,onProgress:n,onError:r});return}nh[e]=[],nh[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const h=nh[e],d=u.body.getReader(),_=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),x=_?parseInt(_):0,b=x!==0;let R=0;const E=new ReadableStream({start(w){L();function L(){d.read().then(({done:D,value:O})=>{if(D)w.close();else{R+=O.byteLength;const B=new ProgressEvent("progress",{lengthComputable:b,loaded:R,total:x});for(let G=0,k=h.length;G<k;G++){const z=h[G];z.onProgress&&z.onProgress(B)}w.enqueue(O),L()}},D=>{w.error(D)})}}});return new Response(E)}else throw new oQ(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return u.json();default:if(a==="")return u.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),_=d&&d[1]?d[1].toLowerCase():void 0,x=new TextDecoder(_);return u.arrayBuffer().then(b=>x.decode(b))}}}).then(u=>{w_.add(`file:${e}`,u);const h=nh[e];delete nh[e];for(let d=0,_=h.length;d<_;d++){const x=h[d];x.onLoad&&x.onLoad(u)}}).catch(u=>{const h=nh[e];if(h===void 0)throw this.manager.itemError(e),u;delete nh[e];for(let d=0,_=h.length;d<_;d++){const x=h[d];x.onError&&x.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}const rp=new WeakMap;class lQ extends Yy{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=w_.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0);else{let d=rp.get(o);d===void 0&&(d=[],rp.set(o,d)),d.push({onLoad:t,onError:r})}return o}const a=ny("img");function l(){h(),t&&t(this);const d=rp.get(this)||[];for(let _=0;_<d.length;_++){const x=d[_];x.onLoad&&x.onLoad(this)}rp.delete(this),s.manager.itemEnd(e)}function u(d){h(),r&&r(d),w_.remove(`image:${e}`);const _=rp.get(this)||[];for(let x=0;x<_.length;x++){const b=_[x];b.onError&&b.onError(d)}rp.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),w_.add(`image:${e}`,a),s.manager.itemStart(e),a.src=e,a}}class d8 extends Yy{constructor(e){super(e)}load(e,t,n,r){const s=new ps,o=new lQ(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class KA extends Rr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Jt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class uQ extends KA{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Jt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Bw=new Cn,TL=new ce,EL=new ce;class A8{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new it(512,512),this.mapType=Vr,this.map=null,this.mapPass=null,this.matrix=new Cn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cg,this._frameExtents=new it(1,1),this._viewportCount=1,this._viewports=[new mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;TL.setFromMatrixPosition(e.matrixWorld),t.position.copy(TL),EL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(EL),t.updateMatrixWorld(),Bw.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bw),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Bw)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class cQ extends A8{constructor(){super(new Ws(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=zA*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class p8 extends KA{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Rr.DEFAULT_UP),this.updateMatrix(),this.target=new Rr,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new cQ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const wL=new Cn,R1=new ce,Uw=new ce;class hQ extends A8{constructor(){super(new Ws(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new it(4,2),this._viewportCount=6,this._viewports=[new mn(2,1,1,1),new mn(0,1,1,1),new mn(3,1,1,1),new mn(1,1,1,1),new mn(3,0,1,1),new mn(1,0,1,1)],this._cubeDirections=[new ce(1,0,0),new ce(-1,0,0),new ce(0,0,1),new ce(0,0,-1),new ce(0,1,0),new ce(0,-1,0)],this._cubeUps=[new ce(0,1,0),new ce(0,1,0),new ce(0,1,0),new ce(0,1,0),new ce(0,0,1),new ce(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),R1.setFromMatrixPosition(e.matrixWorld),n.position.copy(R1),Uw.copy(n.position),Uw.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Uw),n.updateMatrixWorld(),r.makeTranslation(-R1.x,-R1.y,-R1.z),wL.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wL)}}class fQ extends KA{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new hQ}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Qy extends jy{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class dQ extends A8{constructor(){super(new Qy(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class M9 extends KA{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rr.DEFAULT_UP),this.updateMatrix(),this.target=new Rr,this.shadow=new dQ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class m8 extends KA{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class AQ extends KA{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class pQ{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ce)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class mQ extends KA{constructor(e=new pQ,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class gQ extends Vi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class R9 extends Ws{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class C9{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}class Vb extends o8{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const ML=new Cn;class _Q{constructor(e,t,n=0,r=1/0){this.ray=new Wy(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new i8,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ML.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ML),this}intersectObject(e,t=!0,n=[]){return qR(e,this,n,t),n.sort(RL),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)qR(e[r],this,n,t);return n.sort(RL),n}}function RL(i,e){return i.distance-e.distance}function qR(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let o=0,a=s.length;o<a;o++)qR(s[o],e,t,!0)}}class CL{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=ei(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ei(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class dT{constructor(e,t,n,r){dT.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const NL=new ce,sx=new ce;class yQ{constructor(e=new ce,t=new ce){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){NL.subVectors(e,this.start),sx.subVectors(this.end,this.start);const n=sx.dot(sx);let s=sx.dot(NL)/n;return t&&(s=ei(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class vQ{constructor(){this.type="ShapePath",this.color=new Jt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new GR,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(w){const L=[];for(let D=0,O=w.length;D<O;D++){const B=w[D],G=new yb;G.curves=B.curves,L.push(G)}return L}function n(w,L){const D=L.length;let O=!1;for(let B=D-1,G=0;G<D;B=G++){let k=L[B],z=L[G],F=z.x-k.x,q=z.y-k.y;if(Math.abs(q)>Number.EPSILON){if(q<0&&(k=L[G],F=-F,z=L[B],q=-q),w.y<k.y||w.y>z.y)continue;if(w.y===k.y){if(w.x===k.x)return!0}else{const H=q*(w.x-k.x)-F*(w.y-k.y);if(H===0)return!0;if(H<0)continue;O=!O}}else{if(w.y!==k.y)continue;if(z.x<=w.x&&w.x<=k.x||k.x<=w.x&&w.x<=z.x)return!0}}return O}const r=pA.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new yb,l.curves=a.curves,u.push(l),u;let h=!r(s[0].getPoints());h=e?!h:h;const d=[],_=[];let x=[],b=0,R;_[b]=void 0,x[b]=[];for(let w=0,L=s.length;w<L;w++)a=s[w],R=a.getPoints(),o=r(R),o=e?!o:o,o?(!h&&_[b]&&b++,_[b]={s:new yb,p:R},_[b].s.curves=a.curves,h&&b++,x[b]=[]):x[b].push({h:a,p:R[0]});if(!_[0])return t(s);if(_.length>1){let w=!1,L=0;for(let D=0,O=_.length;D<O;D++)d[D]=[];for(let D=0,O=_.length;D<O;D++){const B=x[D];for(let G=0;G<B.length;G++){const k=B[G];let z=!0;for(let F=0;F<_.length;F++)n(k.p,_[F].p)&&(D!==F&&L++,z?(z=!1,d[F].push(k)):w=!0);z&&d[D].push(k)}}L>0&&w===!1&&(x=d)}let E;for(let w=0,L=_.length;w<L;w++){l=_[w].s,u.push(l),E=x[w];for(let D=0,O=E.length;D<O;D++)l.holes.push(E[D].h)}return u}}class g8 extends gc{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function DL(i,e,t,n){const r=xQ(n);switch(t){case W4:return i*e;case Hy:return i*e/r.components*r.byteLength;case ag:return i*e/r.components*r.byteLength;case mh:return i*e*2/r.components*r.byteLength;case lg:return i*e*2/r.components*r.byteLength;case qy:return i*e*3/r.components*r.byteLength;case es:return i*e*4/r.components*r.byteLength;case ug:return i*e*4/r.components*r.byteLength;case MA:case Kf:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Zf:case Jf:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Y_:case K_:return Math.max(i,16)*Math.max(e,8)/4;case $_:case Q_:return Math.max(i,8)*Math.max(e,8)/2;case Z_:case mm:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case gm:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case _m:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case ym:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case vm:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case xm:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case bm:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Sm:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Tm:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Em:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case wm:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Mm:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Rm:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Cm:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Nm:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Dm:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case RA:case BR:case UR:return Math.ceil(i/4)*Math.ceil(e/4)*16;case j4:case J_:return Math.ceil(i/4)*Math.ceil(e/4)*8;case ey:case ty:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function xQ(i){switch(i){case Vr:case EA:return{byteLength:1,components:1};case hu:case wA:case As:return{byteLength:2,components:1};case iT:case rT:return{byteLength:2,components:4};case mr:case Hs:case os:return{byteLength:4,components:1};case sT:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:og}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=og);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function N9(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function bQ(i){const e=new WeakMap;function t(a,l){const u=a.array,h=a.usage,d=u.byteLength,_=i.createBuffer();i.bindBuffer(l,_),i.bufferData(l,u,h),a.onUploadCallback();let x;if(u instanceof Float32Array)x=i.FLOAT;else if(typeof Float16Array<"u"&&u instanceof Float16Array)x=i.HALF_FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?x=i.HALF_FLOAT:x=i.UNSIGNED_SHORT;else if(u instanceof Int16Array)x=i.SHORT;else if(u instanceof Uint32Array)x=i.UNSIGNED_INT;else if(u instanceof Int32Array)x=i.INT;else if(u instanceof Int8Array)x=i.BYTE;else if(u instanceof Uint8Array)x=i.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)x=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:_,type:x,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:d}}function n(a,l,u){const h=l.array,d=l.updateRanges;if(i.bindBuffer(u,a),d.length===0)i.bufferSubData(u,0,h);else{d.sort((x,b)=>x.start-b.start);let _=0;for(let x=1;x<d.length;x++){const b=d[_],R=d[x];R.start<=b.start+b.count+1?b.count=Math.max(b.count,R.start+R.count-b.start):(++_,d[_]=R)}d.length=_+1;for(let x=0,b=d.length;x<b;x++){const R=d[x];i.bufferSubData(u,R.start*h.BYTES_PER_ELEMENT,h,R.start,R.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(i.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const h=e.get(a);(!h||h.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,t(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(u.buffer,a,l),u.version=a.version}}return{get:r,remove:s,update:o}}var SQ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,TQ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,EQ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,wQ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,MQ=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,RQ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,CQ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,NQ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,DQ=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,PQ=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,LQ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,OQ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,IQ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,BQ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,UQ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,FQ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,kQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,GQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,zQ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,VQ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,qQ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,HQ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,WQ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,jQ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,XQ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$Q=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,YQ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,QQ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,KQ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ZQ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,JQ="gl_FragColor = linearToOutputTexel( gl_FragColor );",eK=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,tK=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,nK=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,iK=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,rK=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,sK=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,oK=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,aK=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,lK=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,uK=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,cK=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,hK=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,fK=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,dK=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,AK=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,pK=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,mK=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,gK=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,_K=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,yK=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,vK=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,xK=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,bK=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,SK=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,TK=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,EK=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,wK=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,MK=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,RK=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,CK=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,NK=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,DK=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,PK=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,LK=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,OK=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,IK=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,BK=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,UK=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,FK=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,kK=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,GK=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,zK=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,VK=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,qK=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HK=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,WK=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,jK=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,XK=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,$K=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,YK=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,QK=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,KK=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ZK=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,JK=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,eZ=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,tZ=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,nZ=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,iZ=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,rZ=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,sZ=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,oZ=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,aZ=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,lZ=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,uZ=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,cZ=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hZ=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,fZ=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,dZ=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,AZ=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,pZ=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,mZ=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,gZ=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,_Z=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,yZ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vZ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,xZ=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const bZ=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,SZ=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TZ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,EZ=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wZ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,MZ=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RZ=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,CZ=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,NZ=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,DZ=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,PZ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,LZ=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,OZ=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,IZ=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,BZ=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,UZ=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FZ=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kZ=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GZ=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,zZ=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VZ=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,qZ=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,HZ=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WZ=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jZ=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,XZ=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$Z=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YZ=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QZ=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,KZ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ZZ=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JZ=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,eJ=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,tJ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Qn={alphahash_fragment:SQ,alphahash_pars_fragment:TQ,alphamap_fragment:EQ,alphamap_pars_fragment:wQ,alphatest_fragment:MQ,alphatest_pars_fragment:RQ,aomap_fragment:CQ,aomap_pars_fragment:NQ,batching_pars_vertex:DQ,batching_vertex:PQ,begin_vertex:LQ,beginnormal_vertex:OQ,bsdfs:IQ,iridescence_fragment:BQ,bumpmap_pars_fragment:UQ,clipping_planes_fragment:FQ,clipping_planes_pars_fragment:kQ,clipping_planes_pars_vertex:GQ,clipping_planes_vertex:zQ,color_fragment:VQ,color_pars_fragment:qQ,color_pars_vertex:HQ,color_vertex:WQ,common:jQ,cube_uv_reflection_fragment:XQ,defaultnormal_vertex:$Q,displacementmap_pars_vertex:YQ,displacementmap_vertex:QQ,emissivemap_fragment:KQ,emissivemap_pars_fragment:ZQ,colorspace_fragment:JQ,colorspace_pars_fragment:eK,envmap_fragment:tK,envmap_common_pars_fragment:nK,envmap_pars_fragment:iK,envmap_pars_vertex:rK,envmap_physical_pars_fragment:pK,envmap_vertex:sK,fog_vertex:oK,fog_pars_vertex:aK,fog_fragment:lK,fog_pars_fragment:uK,gradientmap_pars_fragment:cK,lightmap_pars_fragment:hK,lights_lambert_fragment:fK,lights_lambert_pars_fragment:dK,lights_pars_begin:AK,lights_toon_fragment:mK,lights_toon_pars_fragment:gK,lights_phong_fragment:_K,lights_phong_pars_fragment:yK,lights_physical_fragment:vK,lights_physical_pars_fragment:xK,lights_fragment_begin:bK,lights_fragment_maps:SK,lights_fragment_end:TK,logdepthbuf_fragment:EK,logdepthbuf_pars_fragment:wK,logdepthbuf_pars_vertex:MK,logdepthbuf_vertex:RK,map_fragment:CK,map_pars_fragment:NK,map_particle_fragment:DK,map_particle_pars_fragment:PK,metalnessmap_fragment:LK,metalnessmap_pars_fragment:OK,morphinstance_vertex:IK,morphcolor_vertex:BK,morphnormal_vertex:UK,morphtarget_pars_vertex:FK,morphtarget_vertex:kK,normal_fragment_begin:GK,normal_fragment_maps:zK,normal_pars_fragment:VK,normal_pars_vertex:qK,normal_vertex:HK,normalmap_pars_fragment:WK,clearcoat_normal_fragment_begin:jK,clearcoat_normal_fragment_maps:XK,clearcoat_pars_fragment:$K,iridescence_pars_fragment:YK,opaque_fragment:QK,packing:KK,premultiplied_alpha_fragment:ZK,project_vertex:JK,dithering_fragment:eZ,dithering_pars_fragment:tZ,roughnessmap_fragment:nZ,roughnessmap_pars_fragment:iZ,shadowmap_pars_fragment:rZ,shadowmap_pars_vertex:sZ,shadowmap_vertex:oZ,shadowmask_pars_fragment:aZ,skinbase_vertex:lZ,skinning_pars_vertex:uZ,skinning_vertex:cZ,skinnormal_vertex:hZ,specularmap_fragment:fZ,specularmap_pars_fragment:dZ,tonemapping_fragment:AZ,tonemapping_pars_fragment:pZ,transmission_fragment:mZ,transmission_pars_fragment:gZ,uv_pars_fragment:_Z,uv_pars_vertex:yZ,uv_vertex:vZ,worldpos_vertex:xZ,background_vert:bZ,background_frag:SZ,backgroundCube_vert:TZ,backgroundCube_frag:EZ,cube_vert:wZ,cube_frag:MZ,depth_vert:RZ,depth_frag:CZ,distanceRGBA_vert:NZ,distanceRGBA_frag:DZ,equirect_vert:PZ,equirect_frag:LZ,linedashed_vert:OZ,linedashed_frag:IZ,meshbasic_vert:BZ,meshbasic_frag:UZ,meshlambert_vert:FZ,meshlambert_frag:kZ,meshmatcap_vert:GZ,meshmatcap_frag:zZ,meshnormal_vert:VZ,meshnormal_frag:qZ,meshphong_vert:HZ,meshphong_frag:WZ,meshphysical_vert:jZ,meshphysical_frag:XZ,meshtoon_vert:$Z,meshtoon_frag:YZ,points_vert:QZ,points_frag:KZ,shadow_vert:ZZ,shadow_frag:JZ,sprite_vert:eJ,sprite_frag:tJ},zt={common:{diffuse:{value:new Jt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Hn},alphaMap:{value:null},alphaMapTransform:{value:new Hn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Hn}},envmap:{envMap:{value:null},envMapRotation:{value:new Hn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Hn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Hn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Hn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Hn},normalScale:{value:new it(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Hn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Hn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Hn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Hn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Jt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Jt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Hn},alphaTest:{value:0},uvTransform:{value:new Hn}},sprite:{diffuse:{value:new Jt(16777215)},opacity:{value:1},center:{value:new it(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Hn},alphaMap:{value:null},alphaMapTransform:{value:new Hn},alphaTest:{value:0}}},ia={basic:{uniforms:Oo([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:Oo([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,zt.lights,{emissive:{value:new Jt(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:Oo([zt.common,zt.specularmap,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,zt.lights,{emissive:{value:new Jt(0)},specular:{value:new Jt(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:Oo([zt.common,zt.envmap,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.roughnessmap,zt.metalnessmap,zt.fog,zt.lights,{emissive:{value:new Jt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:Oo([zt.common,zt.aomap,zt.lightmap,zt.emissivemap,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.gradientmap,zt.fog,zt.lights,{emissive:{value:new Jt(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:Oo([zt.common,zt.bumpmap,zt.normalmap,zt.displacementmap,zt.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:Oo([zt.points,zt.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:Oo([zt.common,zt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:Oo([zt.common,zt.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:Oo([zt.common,zt.bumpmap,zt.normalmap,zt.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.meshnormal_vert,fragmentShader:Qn.meshnormal_frag},sprite:{uniforms:Oo([zt.sprite,zt.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new Hn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Hn}},vertexShader:Qn.backgroundCube_vert,fragmentShader:Qn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:Oo([zt.common,zt.displacementmap,{referencePosition:{value:new ce},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:Oo([zt.lights,zt.fog,{color:{value:new Jt(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};ia.physical={uniforms:Oo([ia.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Hn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Hn},clearcoatNormalScale:{value:new it(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Hn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Hn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Hn},sheen:{value:0},sheenColor:{value:new Jt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Hn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Hn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Hn},transmissionSamplerSize:{value:new it},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Hn},attenuationDistance:{value:0},attenuationColor:{value:new Jt(0)},specularColor:{value:new Jt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Hn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Hn},anisotropyVector:{value:new it},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Hn}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag};const ox={r:0,b:0,g:0},zd=new ao,nJ=new Cn;function iJ(i,e,t,n,r,s,o){const a=new Jt(0);let l=s===!0?0:1,u,h,d=null,_=0,x=null;function b(D){let O=D.isScene===!0?D.background:null;return O&&O.isTexture&&(O=(D.backgroundBlurriness>0?t:e).get(O)),O}function R(D){let O=!1;const B=b(D);B===null?w(a,l):B&&B.isColor&&(w(B,1),O=!0);const G=i.xr.getEnvironmentBlendMode();G==="additive"?n.buffers.color.setClear(0,0,0,1,o):G==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||O)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function E(D,O){const B=b(O);B&&(B.isCubeTexture||B.mapping===FA)?(h===void 0&&(h=new Ri(new hd(1,1,1),new ya({name:"BackgroundCubeMaterial",uniforms:Om(ia.backgroundCube.uniforms),vertexShader:ia.backgroundCube.vertexShader,fragmentShader:ia.backgroundCube.fragmentShader,side:Zi,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(G,k,z){this.matrixWorld.copyPosition(z.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),zd.copy(O.backgroundRotation),zd.x*=-1,zd.y*=-1,zd.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(zd.y*=-1,zd.z*=-1),h.material.uniforms.envMap.value=B,h.material.uniforms.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=O.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(nJ.makeRotationFromEuler(zd)),h.material.toneMapped=In.getTransfer(B.colorSpace)!==Qt,(d!==B||_!==B.version||x!==i.toneMapping)&&(h.material.needsUpdate=!0,d=B,_=B.version,x=i.toneMapping),h.layers.enableAll(),D.unshift(h,h.geometry,h.material,0,0,null)):B&&B.isTexture&&(u===void 0&&(u=new Ri(new $y(2,2),new ya({name:"BackgroundMaterial",uniforms:Om(ia.background.uniforms),vertexShader:ia.background.vertexShader,fragmentShader:ia.background.fragmentShader,side:ma,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=B,u.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,u.material.toneMapped=In.getTransfer(B.colorSpace)!==Qt,B.matrixAutoUpdate===!0&&B.updateMatrix(),u.material.uniforms.uvTransform.value.copy(B.matrix),(d!==B||_!==B.version||x!==i.toneMapping)&&(u.material.needsUpdate=!0,d=B,_=B.version,x=i.toneMapping),u.layers.enableAll(),D.unshift(u,u.geometry,u.material,0,0,null))}function w(D,O){D.getRGB(ox,c9(i)),n.buffers.color.setClear(ox.r,ox.g,ox.b,O,o)}function L(){h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return a},setClearColor:function(D,O=1){a.set(D),l=O,w(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(D){l=D,w(a,l)},render:R,addToRenderList:E,dispose:L}}function rJ(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=_(null);let s=r,o=!1;function a(q,H,Q,K,se){let ee=!1;const $=d(K,Q,H);s!==$&&(s=$,u(s.object)),ee=x(q,K,Q,se),ee&&b(q,K,Q,se),se!==null&&e.update(se,i.ELEMENT_ARRAY_BUFFER),(ee||o)&&(o=!1,O(q,H,Q,K),se!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(se).buffer))}function l(){return i.createVertexArray()}function u(q){return i.bindVertexArray(q)}function h(q){return i.deleteVertexArray(q)}function d(q,H,Q){const K=Q.wireframe===!0;let se=n[q.id];se===void 0&&(se={},n[q.id]=se);let ee=se[H.id];ee===void 0&&(ee={},se[H.id]=ee);let $=ee[K];return $===void 0&&($=_(l()),ee[K]=$),$}function _(q){const H=[],Q=[],K=[];for(let se=0;se<t;se++)H[se]=0,Q[se]=0,K[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:Q,attributeDivisors:K,object:q,attributes:{},index:null}}function x(q,H,Q,K){const se=s.attributes,ee=H.attributes;let $=0;const re=Q.getAttributes();for(const ae in re)if(re[ae].location>=0){const ne=se[ae];let ye=ee[ae];if(ye===void 0&&(ae==="instanceMatrix"&&q.instanceMatrix&&(ye=q.instanceMatrix),ae==="instanceColor"&&q.instanceColor&&(ye=q.instanceColor)),ne===void 0||ne.attribute!==ye||ye&&ne.data!==ye.data)return!0;$++}return s.attributesNum!==$||s.index!==K}function b(q,H,Q,K){const se={},ee=H.attributes;let $=0;const re=Q.getAttributes();for(const ae in re)if(re[ae].location>=0){let ne=ee[ae];ne===void 0&&(ae==="instanceMatrix"&&q.instanceMatrix&&(ne=q.instanceMatrix),ae==="instanceColor"&&q.instanceColor&&(ne=q.instanceColor));const ye={};ye.attribute=ne,ne&&ne.data&&(ye.data=ne.data),se[ae]=ye,$++}s.attributes=se,s.attributesNum=$,s.index=K}function R(){const q=s.newAttributes;for(let H=0,Q=q.length;H<Q;H++)q[H]=0}function E(q){w(q,0)}function w(q,H){const Q=s.newAttributes,K=s.enabledAttributes,se=s.attributeDivisors;Q[q]=1,K[q]===0&&(i.enableVertexAttribArray(q),K[q]=1),se[q]!==H&&(i.vertexAttribDivisor(q,H),se[q]=H)}function L(){const q=s.newAttributes,H=s.enabledAttributes;for(let Q=0,K=H.length;Q<K;Q++)H[Q]!==q[Q]&&(i.disableVertexAttribArray(Q),H[Q]=0)}function D(q,H,Q,K,se,ee,$){$===!0?i.vertexAttribIPointer(q,H,Q,se,ee):i.vertexAttribPointer(q,H,Q,K,se,ee)}function O(q,H,Q,K){R();const se=K.attributes,ee=Q.getAttributes(),$=H.defaultAttributeValues;for(const re in ee){const ae=ee[re];if(ae.location>=0){let _e=se[re];if(_e===void 0&&(re==="instanceMatrix"&&q.instanceMatrix&&(_e=q.instanceMatrix),re==="instanceColor"&&q.instanceColor&&(_e=q.instanceColor)),_e!==void 0){const ne=_e.normalized,ye=_e.itemSize,ve=e.get(_e);if(ve===void 0)continue;const Pe=ve.buffer,Se=ve.type,Fe=ve.bytesPerElement,Ye=Se===i.INT||Se===i.UNSIGNED_INT||_e.gpuType===Hs;if(_e.isInterleavedBufferAttribute){const at=_e.data,At=at.stride,Gt=_e.offset;if(at.isInstancedInterleavedBuffer){for(let Dt=0;Dt<ae.locationSize;Dt++)w(ae.location+Dt,at.meshPerAttribute);q.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=at.meshPerAttribute*at.count)}else for(let Dt=0;Dt<ae.locationSize;Dt++)E(ae.location+Dt);i.bindBuffer(i.ARRAY_BUFFER,Pe);for(let Dt=0;Dt<ae.locationSize;Dt++)D(ae.location+Dt,ye/ae.locationSize,Se,ne,At*Fe,(Gt+ye/ae.locationSize*Dt)*Fe,Ye)}else{if(_e.isInstancedBufferAttribute){for(let at=0;at<ae.locationSize;at++)w(ae.location+at,_e.meshPerAttribute);q.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let at=0;at<ae.locationSize;at++)E(ae.location+at);i.bindBuffer(i.ARRAY_BUFFER,Pe);for(let at=0;at<ae.locationSize;at++)D(ae.location+at,ye/ae.locationSize,Se,ne,ye*Fe,ye/ae.locationSize*at*Fe,Ye)}}else if($!==void 0){const ne=$[re];if(ne!==void 0)switch(ne.length){case 2:i.vertexAttrib2fv(ae.location,ne);break;case 3:i.vertexAttrib3fv(ae.location,ne);break;case 4:i.vertexAttrib4fv(ae.location,ne);break;default:i.vertexAttrib1fv(ae.location,ne)}}}}L()}function B(){z();for(const q in n){const H=n[q];for(const Q in H){const K=H[Q];for(const se in K)h(K[se].object),delete K[se];delete H[Q]}delete n[q]}}function G(q){if(n[q.id]===void 0)return;const H=n[q.id];for(const Q in H){const K=H[Q];for(const se in K)h(K[se].object),delete K[se];delete H[Q]}delete n[q.id]}function k(q){for(const H in n){const Q=n[H];if(Q[q.id]===void 0)continue;const K=Q[q.id];for(const se in K)h(K[se].object),delete K[se];delete Q[q.id]}}function z(){F(),o=!0,s!==r&&(s=r,u(s.object))}function F(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:z,resetDefaultState:F,dispose:B,releaseStatesOfGeometry:G,releaseStatesOfProgram:k,initAttributes:R,enableAttribute:E,disableUnusedAttributes:L}}function sJ(i,e,t){let n;function r(u){n=u}function s(u,h){i.drawArrays(n,u,h),t.update(h,n,1)}function o(u,h,d){d!==0&&(i.drawArraysInstanced(n,u,h,d),t.update(h,n,d))}function a(u,h,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,u,0,h,0,d);let x=0;for(let b=0;b<d;b++)x+=h[b];t.update(x,n,1)}function l(u,h,d,_){if(d===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let b=0;b<u.length;b++)o(u[b],h[b],_[b]);else{x.multiDrawArraysInstancedWEBGL(n,u,0,h,0,_,0,d);let b=0;for(let R=0;R<d;R++)b+=h[R]*_[R];t.update(b,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function oJ(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(k){return!(k!==es&&n.convert(k)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(k){const z=k===As&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==Vr&&n.convert(k)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==os&&!z)}function l(k){if(k==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const h=l(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const d=t.logarithmicDepthBuffer===!0,_=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),x=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=i.getParameter(i.MAX_TEXTURE_SIZE),E=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),w=i.getParameter(i.MAX_VERTEX_ATTRIBS),L=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),D=i.getParameter(i.MAX_VARYING_VECTORS),O=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),B=b>0,G=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:d,reverseDepthBuffer:_,maxTextures:x,maxVertexTextures:b,maxTextureSize:R,maxCubemapSize:E,maxAttributes:w,maxVertexUniforms:L,maxVaryings:D,maxFragmentUniforms:O,vertexTextures:B,maxSamples:G}}function aJ(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Gu,a=new Hn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,_){const x=d.length!==0||_||n!==0||r;return r=_,n=d.length,x},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,_){t=h(d,_,0)},this.setState=function(d,_,x){const b=d.clippingPlanes,R=d.clipIntersection,E=d.clipShadows,w=i.get(d);if(!r||b===null||b.length===0||s&&!E)s?h(null):u();else{const L=s?0:n,D=L*4;let O=w.clippingState||null;l.value=O,O=h(b,_,D,x);for(let B=0;B!==D;++B)O[B]=t[B];w.clippingState=O,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=L}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(d,_,x,b){const R=d!==null?d.length:0;let E=null;if(R!==0){if(E=l.value,b!==!0||E===null){const w=x+R*4,L=_.matrixWorldInverse;a.getNormalMatrix(L),(E===null||E.length<w)&&(E=new Float32Array(w));for(let D=0,O=x;D!==R;++D,O+=4)o.copy(d[D]).applyMatrix4(L,a),o.normal.toArray(E,O),E[O+3]=o.constant}l.value=E,l.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,E}}function lJ(i){let e=new WeakMap;function t(o,a){return a===Am?o.mapping=oc:a===pm&&(o.mapping=ac),o}function n(o){if(o&&o.isTexture){const a=o.mapping;if(a===Am||a===pm)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new f9(l.height);return u.fromEquirectangularTexture(i,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const kp=4,PL=[.125,.215,.35,.446,.526,.582],lA=20,Fw=new Qy,LL=new Jt;let kw=null,Gw=0,zw=0,Vw=!1;const iA=(1+Math.sqrt(5))/2,sp=1/iA,OL=[new ce(-iA,sp,0),new ce(iA,sp,0),new ce(-sp,0,iA),new ce(sp,0,iA),new ce(0,iA,-sp),new ce(0,iA,sp),new ce(-1,1,-1),new ce(1,1,-1),new ce(-1,1,1),new ce(1,1,1)],uJ=new ce;let IL=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,s={}){const{size:o=256,position:a=uJ}=s;kw=this._renderer.getRenderTarget(),Gw=this._renderer.getActiveCubeFace(),zw=this._renderer.getActiveMipmapLevel(),Vw=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,r,l,a),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=FL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=UL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(kw,Gw,zw),this._renderer.xr.enabled=Vw,e.scissorTest=!1,ax(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===oc||e.mapping===ac?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),kw=this._renderer.getRenderTarget(),Gw=this._renderer.getActiveCubeFace(),zw=this._renderer.getActiveMipmapLevel(),Vw=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ms,minFilter:Ms,generateMipmaps:!1,type:As,format:es,colorSpace:pu,depthBuffer:!1},r=BL(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=BL(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=cJ(s)),this._blurMaterial=hJ(s,e,t)}return r}_compileMaterial(e){const t=new Ri(this._lodPlanes[0],e);this._renderer.compile(t,Fw)}_sceneToCubeUV(e,t,n,r,s){const l=new Ws(90,1,t,n),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,_=d.autoClear,x=d.toneMapping;d.getClearColor(LL),d.toneMapping=_a,d.autoClear=!1;const b=new $a({name:"PMREM.Background",side:Zi,depthWrite:!1,depthTest:!1}),R=new Ri(new hd,b);let E=!1;const w=e.background;w?w.isColor&&(b.color.copy(w),e.background=null,E=!0):(b.color.copy(LL),E=!0);for(let L=0;L<6;L++){const D=L%3;D===0?(l.up.set(0,u[L],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+h[L],s.y,s.z)):D===1?(l.up.set(0,0,u[L]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+h[L],s.z)):(l.up.set(0,u[L],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+h[L]));const O=this._cubeSize;ax(r,D*O,L>2?O:0,O,O),d.setRenderTarget(r),E&&d.render(R,l),d.render(e,l)}R.geometry.dispose(),R.material.dispose(),d.toneMapping=x,d.autoClear=_,e.background=w}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===oc||e.mapping===ac;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=FL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=UL());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ri(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;ax(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,Fw)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=OL[(r-s-1)%OL.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,d=new Ri(this._lodPlanes[r],u),_=u.uniforms,x=this._sizeLods[n]-1,b=isFinite(s)?Math.PI/(2*x):2*Math.PI/(2*lA-1),R=s/b,E=isFinite(s)?1+Math.floor(h*R):lA;E>lA&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${lA}`);const w=[];let L=0;for(let k=0;k<lA;++k){const z=k/R,F=Math.exp(-z*z/2);w.push(F),k===0?L+=F:k<E&&(L+=2*F)}for(let k=0;k<w.length;k++)w[k]=w[k]/L;_.envMap.value=e.texture,_.samples.value=E,_.weights.value=w,_.latitudinal.value=o==="latitudinal",a&&(_.poleAxis.value=a);const{_lodMax:D}=this;_.dTheta.value=b,_.mipInt.value=D-n;const O=this._sizeLods[r],B=3*O*(r>D-kp?r-D+kp:0),G=4*(this._cubeSize-O);ax(t,B,G,3*O,2*O),l.setRenderTarget(t),l.render(d,Fw)}};function cJ(i){const e=[],t=[],n=[];let r=i;const s=i-kp+1+PL.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-kp?l=PL[o-i+kp-1]:o===0&&(l=0),n.push(l);const u=1/(a-2),h=-u,d=1+u,_=[h,h,d,h,d,d,h,h,d,d,h,d],x=6,b=6,R=3,E=2,w=1,L=new Float32Array(R*b*x),D=new Float32Array(E*b*x),O=new Float32Array(w*b*x);for(let G=0;G<x;G++){const k=G%3*2/3-1,z=G>2?0:-1,F=[k,z,0,k+2/3,z,0,k+2/3,z+1,0,k,z,0,k+2/3,z+1,0,k,z+1,0];L.set(F,R*b*G),D.set(_,E*b*G);const q=[G,G,G,G,G,G];O.set(q,w*b*G)}const B=new Vi;B.setAttribute("position",new _r(L,R)),B.setAttribute("uv",new _r(D,E)),B.setAttribute("faceIndex",new _r(O,w)),e.push(B),r>kp&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function BL(i,e,t){const n=new ad(i,e,t);return n.texture.mapping=FA,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function ax(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function hJ(i,e,t){const n=new Float32Array(lA),r=new ce(0,1,0);return new ya({name:"SphericalGaussianBlur",defines:{n:lA,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:_8(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function UL(){return new ya({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_8(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function FL(){return new ya({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_8(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function _8(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function fJ(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const l=a.mapping,u=l===Am||l===pm,h=l===oc||l===ac;if(u||h){let d=e.get(a);const _=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==_)return t===null&&(t=new IL(i)),d=u?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{const x=a.image;return u&&x&&x.height>0||h&&x&&r(x)?(t===null&&(t=new IL(i)),d=u?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let l=0;const u=6;for(let h=0;h<u;h++)a[h]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function dJ(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&Za("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function AJ(i,e,t,n){const r={},s=new WeakMap;function o(d){const _=d.target;_.index!==null&&e.remove(_.index);for(const b in _.attributes)e.remove(_.attributes[b]);_.removeEventListener("dispose",o),delete r[_.id];const x=s.get(_);x&&(e.remove(x),s.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function a(d,_){return r[_.id]===!0||(_.addEventListener("dispose",o),r[_.id]=!0,t.memory.geometries++),_}function l(d){const _=d.attributes;for(const x in _)e.update(_[x],i.ARRAY_BUFFER)}function u(d){const _=[],x=d.index,b=d.attributes.position;let R=0;if(x!==null){const L=x.array;R=x.version;for(let D=0,O=L.length;D<O;D+=3){const B=L[D+0],G=L[D+1],k=L[D+2];_.push(B,G,G,k,k,B)}}else if(b!==void 0){const L=b.array;R=b.version;for(let D=0,O=L.length/3-1;D<O;D+=3){const B=D+0,G=D+1,k=D+2;_.push(B,G,G,k,k,B)}}else return;const E=new(e8(_)?s8:r8)(_,1);E.version=R;const w=s.get(d);w&&e.remove(w),s.set(d,E)}function h(d){const _=s.get(d);if(_){const x=d.index;x!==null&&_.version<x.version&&u(d)}else u(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:h}}function pJ(i,e,t){let n;function r(_){n=_}let s,o;function a(_){s=_.type,o=_.bytesPerElement}function l(_,x){i.drawElements(n,x,s,_*o),t.update(x,n,1)}function u(_,x,b){b!==0&&(i.drawElementsInstanced(n,x,s,_*o,b),t.update(x,n,b))}function h(_,x,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,s,_,0,b);let E=0;for(let w=0;w<b;w++)E+=x[w];t.update(E,n,1)}function d(_,x,b,R){if(b===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let w=0;w<_.length;w++)u(_[w]/o,x[w],R[w]);else{E.multiDrawElementsInstancedWEBGL(n,x,0,s,_,0,R,0,b);let w=0;for(let L=0;L<b;L++)w+=x[L]*R[L];t.update(w,n,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=h,this.renderMultiDrawInstances=d}function mJ(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function gJ(i,e,t){const n=new WeakMap,r=new mn;function s(o,a,l){const u=o.morphTargetInfluences,h=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=h!==void 0?h.length:0;let _=n.get(a);if(_===void 0||_.count!==d){let q=function(){z.dispose(),n.delete(a),a.removeEventListener("dispose",q)};var x=q;_!==void 0&&_.texture.dispose();const b=a.morphAttributes.position!==void 0,R=a.morphAttributes.normal!==void 0,E=a.morphAttributes.color!==void 0,w=a.morphAttributes.position||[],L=a.morphAttributes.normal||[],D=a.morphAttributes.color||[];let O=0;b===!0&&(O=1),R===!0&&(O=2),E===!0&&(O=3);let B=a.attributes.position.count*O,G=1;B>e.maxTextureSize&&(G=Math.ceil(B/e.maxTextureSize),B=e.maxTextureSize);const k=new Float32Array(B*G*4*d),z=new n8(k,B,G,d);z.type=os,z.needsUpdate=!0;const F=O*4;for(let H=0;H<d;H++){const Q=w[H],K=L[H],se=D[H],ee=B*G*4*H;for(let $=0;$<Q.count;$++){const re=$*F;b===!0&&(r.fromBufferAttribute(Q,$),k[ee+re+0]=r.x,k[ee+re+1]=r.y,k[ee+re+2]=r.z,k[ee+re+3]=0),R===!0&&(r.fromBufferAttribute(K,$),k[ee+re+4]=r.x,k[ee+re+5]=r.y,k[ee+re+6]=r.z,k[ee+re+7]=0),E===!0&&(r.fromBufferAttribute(se,$),k[ee+re+8]=r.x,k[ee+re+9]=r.y,k[ee+re+10]=r.z,k[ee+re+11]=se.itemSize===4?r.w:1)}}_={count:d,texture:z,size:new it(B,G)},n.set(a,_),a.addEventListener("dispose",q)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let b=0;for(let E=0;E<u.length;E++)b+=u[E];const R=a.morphTargetsRelative?1:1-b;l.getUniforms().setValue(i,"morphTargetBaseInfluence",R),l.getUniforms().setValue(i,"morphTargetInfluences",u)}l.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:s}}function _J(i,e,t,n){let r=new WeakMap;function s(l){const u=n.render.frame,h=l.geometry,d=e.get(l,h);if(r.get(d)!==u&&(e.update(d),r.set(d,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const _=l.skeleton;r.get(_)!==u&&(_.update(),r.set(_,u))}return d}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const D9=new ps,kL=new Ja(1,1),P9=new n8,L9=new Y$,O9=new Xy,GL=[],zL=[],VL=new Float32Array(16),qL=new Float32Array(9),HL=new Float32Array(4);function fg(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=GL[r];if(s===void 0&&(s=new Float32Array(r),GL[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Cs(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Ns(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function AT(i,e){let t=zL[e];t===void 0&&(t=new Int32Array(e),zL[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function yJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function vJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cs(t,e))return;i.uniform2fv(this.addr,e),Ns(t,e)}}function xJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Cs(t,e))return;i.uniform3fv(this.addr,e),Ns(t,e)}}function bJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cs(t,e))return;i.uniform4fv(this.addr,e),Ns(t,e)}}function SJ(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Cs(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ns(t,e)}else{if(Cs(t,n))return;HL.set(n),i.uniformMatrix2fv(this.addr,!1,HL),Ns(t,n)}}function TJ(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Cs(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ns(t,e)}else{if(Cs(t,n))return;qL.set(n),i.uniformMatrix3fv(this.addr,!1,qL),Ns(t,n)}}function EJ(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Cs(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ns(t,e)}else{if(Cs(t,n))return;VL.set(n),i.uniformMatrix4fv(this.addr,!1,VL),Ns(t,n)}}function wJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function MJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cs(t,e))return;i.uniform2iv(this.addr,e),Ns(t,e)}}function RJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Cs(t,e))return;i.uniform3iv(this.addr,e),Ns(t,e)}}function CJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cs(t,e))return;i.uniform4iv(this.addr,e),Ns(t,e)}}function NJ(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function DJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cs(t,e))return;i.uniform2uiv(this.addr,e),Ns(t,e)}}function PJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Cs(t,e))return;i.uniform3uiv(this.addr,e),Ns(t,e)}}function LJ(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cs(t,e))return;i.uniform4uiv(this.addr,e),Ns(t,e)}}function OJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(kL.compareFunction=aT,s=kL):s=D9,t.setTexture2D(e||s,r)}function IJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||L9,r)}function BJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||O9,r)}function UJ(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||P9,r)}function FJ(i){switch(i){case 5126:return yJ;case 35664:return vJ;case 35665:return xJ;case 35666:return bJ;case 35674:return SJ;case 35675:return TJ;case 35676:return EJ;case 5124:case 35670:return wJ;case 35667:case 35671:return MJ;case 35668:case 35672:return RJ;case 35669:case 35673:return CJ;case 5125:return NJ;case 36294:return DJ;case 36295:return PJ;case 36296:return LJ;case 35678:case 36198:case 36298:case 36306:case 35682:return OJ;case 35679:case 36299:case 36307:return IJ;case 35680:case 36300:case 36308:case 36293:return BJ;case 36289:case 36303:case 36311:case 36292:return UJ}}function kJ(i,e){i.uniform1fv(this.addr,e)}function GJ(i,e){const t=fg(e,this.size,2);i.uniform2fv(this.addr,t)}function zJ(i,e){const t=fg(e,this.size,3);i.uniform3fv(this.addr,t)}function VJ(i,e){const t=fg(e,this.size,4);i.uniform4fv(this.addr,t)}function qJ(i,e){const t=fg(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function HJ(i,e){const t=fg(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function WJ(i,e){const t=fg(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function jJ(i,e){i.uniform1iv(this.addr,e)}function XJ(i,e){i.uniform2iv(this.addr,e)}function $J(i,e){i.uniform3iv(this.addr,e)}function YJ(i,e){i.uniform4iv(this.addr,e)}function QJ(i,e){i.uniform1uiv(this.addr,e)}function KJ(i,e){i.uniform2uiv(this.addr,e)}function ZJ(i,e){i.uniform3uiv(this.addr,e)}function JJ(i,e){i.uniform4uiv(this.addr,e)}function eee(i,e,t){const n=this.cache,r=e.length,s=AT(t,r);Cs(n,s)||(i.uniform1iv(this.addr,s),Ns(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||D9,s[o])}function tee(i,e,t){const n=this.cache,r=e.length,s=AT(t,r);Cs(n,s)||(i.uniform1iv(this.addr,s),Ns(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||L9,s[o])}function nee(i,e,t){const n=this.cache,r=e.length,s=AT(t,r);Cs(n,s)||(i.uniform1iv(this.addr,s),Ns(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||O9,s[o])}function iee(i,e,t){const n=this.cache,r=e.length,s=AT(t,r);Cs(n,s)||(i.uniform1iv(this.addr,s),Ns(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||P9,s[o])}function ree(i){switch(i){case 5126:return kJ;case 35664:return GJ;case 35665:return zJ;case 35666:return VJ;case 35674:return qJ;case 35675:return HJ;case 35676:return WJ;case 5124:case 35670:return jJ;case 35667:case 35671:return XJ;case 35668:case 35672:return $J;case 35669:case 35673:return YJ;case 5125:return QJ;case 36294:return KJ;case 36295:return ZJ;case 36296:return JJ;case 35678:case 36198:case 36298:case 36306:case 35682:return eee;case 35679:case 36299:case 36307:return tee;case 35680:case 36300:case 36308:case 36293:return nee;case 36289:case 36303:case 36311:case 36292:return iee}}class see{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=FJ(t.type)}}class oee{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=ree(t.type)}}class aee{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const qw=/(\w+)(\])?(\[|\.)?/g;function WL(i,e){i.seq.push(e),i.map[e.id]=e}function lee(i,e,t){const n=i.name,r=n.length;for(qw.lastIndex=0;;){const s=qw.exec(n),o=qw.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){WL(t,u===void 0?new see(a,i,e):new oee(a,i,e));break}else{let d=t.map[a];d===void 0&&(d=new aee(a),WL(t,d)),t=d}}}class vb{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);lee(s,o,this)}}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function jL(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const uee=37297;let cee=0;function hee(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}const XL=new Hn;function fee(i){In._getMatrix(XL,In.workingColorSpace,i);const e=`mat3( ${XL.elements.map(t=>t.toFixed(4))} )`;switch(In.getTransfer(i)){case Pm:return[e,"LinearTransferOETF"];case Qt:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function $L(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+hee(i.getShaderSource(e),o)}else return r}function dee(i,e){const t=fee(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function Aee(i,e){let t;switch(e){case e9:t="Linear";break;case t9:t="Reinhard";break;case n9:t="Cineon";break;case i9:t="ACESFilmic";break;case r9:t="AgX";break;case s9:t="Neutral";break;case s$:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const lx=new ce;function pee(){In.getLuminanceCoefficients(lx);const i=lx.x.toFixed(4),e=lx.y.toFixed(4),t=lx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function mee(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(s_).join(`
`)}function gee(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function _ee(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function s_(i){return i!==""}function YL(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function QL(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const yee=/^[ \t]*#include +<([\w\d./]+)>/gm;function HR(i){return i.replace(yee,xee)}const vee=new Map;function xee(i,e){let t=Qn[e];if(t===void 0){const n=vee.get(e);if(n!==void 0)t=Qn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return HR(t)}const bee=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function KL(i){return i.replace(bee,See)}function See(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function ZL(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Tee(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===P4?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===e$?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Va&&(e="SHADOWMAP_TYPE_VSM"),e}function Eee(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case oc:case ac:e="ENVMAP_TYPE_CUBE";break;case FA:e="ENVMAP_TYPE_CUBE_UV";break}return e}function wee(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case ac:e="ENVMAP_MODE_REFRACTION";break}return e}function Mee(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Vy:e="ENVMAP_BLENDING_MULTIPLY";break;case ZU:e="ENVMAP_BLENDING_MIX";break;case JU:e="ENVMAP_BLENDING_ADD";break}return e}function Ree(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function Cee(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=Tee(t),u=Eee(t),h=wee(t),d=Mee(t),_=Ree(t),x=mee(t),b=gee(s),R=r.createProgram();let E,w,L=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(s_).join(`
`),E.length>0&&(E+=`
`),w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(s_).join(`
`),w.length>0&&(w+=`
`)):(E=[ZL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(s_).join(`
`),w=[ZL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==_a?"#define TONE_MAPPING":"",t.toneMapping!==_a?Qn.tonemapping_pars_fragment:"",t.toneMapping!==_a?Aee("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Qn.colorspace_pars_fragment,dee("linearToOutputTexel",t.outputColorSpace),pee(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(s_).join(`
`)),o=HR(o),o=YL(o,t),o=QL(o,t),a=HR(a),a=YL(a,t),a=QL(a,t),o=KL(o),a=KL(a),t.isRawShaderMaterial!==!0&&(L=`#version 300 es
`,E=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,w=["#define varying in",t.glslVersion===$P?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===$P?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const D=L+E+o,O=L+w+a,B=jL(r,r.VERTEX_SHADER,D),G=jL(r,r.FRAGMENT_SHADER,O);r.attachShader(R,B),r.attachShader(R,G),t.index0AttributeName!==void 0?r.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(R,0,"position"),r.linkProgram(R);function k(H){if(i.debug.checkShaderErrors){const Q=r.getProgramInfoLog(R).trim(),K=r.getShaderInfoLog(B).trim(),se=r.getShaderInfoLog(G).trim();let ee=!0,$=!0;if(r.getProgramParameter(R,r.LINK_STATUS)===!1)if(ee=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,R,B,G);else{const re=$L(r,B,"vertex"),ae=$L(r,G,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(R,r.VALIDATE_STATUS)+`

Material Name: `+H.name+`
Material Type: `+H.type+`

Program Info Log: `+Q+`
`+re+`
`+ae)}else Q!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Q):(K===""||se==="")&&($=!1);$&&(H.diagnostics={runnable:ee,programLog:Q,vertexShader:{log:K,prefix:E},fragmentShader:{log:se,prefix:w}})}r.deleteShader(B),r.deleteShader(G),z=new vb(r,R),F=_ee(r,R)}let z;this.getUniforms=function(){return z===void 0&&k(this),z};let F;this.getAttributes=function(){return F===void 0&&k(this),F};let q=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return q===!1&&(q=r.getProgramParameter(R,uee)),q},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=cee++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=B,this.fragmentShader=G,this}let Nee=0;class Dee{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new Pee(e),t.set(e,n)),n}}class Pee{constructor(e){this.id=Nee++,this.code=e,this.usedTimes=0}}function Lee(i,e,t,n,r,s,o){const a=new i8,l=new Dee,u=new Set,h=[],d=r.logarithmicDepthBuffer,_=r.vertexTextures;let x=r.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(F){return u.add(F),F===0?"uv":`uv${F}`}function E(F,q,H,Q,K){const se=Q.fog,ee=K.geometry,$=F.isMeshStandardMaterial?Q.environment:null,re=(F.isMeshStandardMaterial?t:e).get(F.envMap||$),ae=re&&re.mapping===FA?re.image.height:null,_e=b[F.type];F.precision!==null&&(x=r.getMaxPrecision(F.precision),x!==F.precision&&console.warn("THREE.WebGLProgram.getParameters:",F.precision,"not supported, using",x,"instead."));const ne=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,ye=ne!==void 0?ne.length:0;let ve=0;ee.morphAttributes.position!==void 0&&(ve=1),ee.morphAttributes.normal!==void 0&&(ve=2),ee.morphAttributes.color!==void 0&&(ve=3);let Pe,Se,Fe,Ye;if(_e){const Bn=ia[_e];Pe=Bn.vertexShader,Se=Bn.fragmentShader}else Pe=F.vertexShader,Se=F.fragmentShader,l.update(F),Fe=l.getVertexShaderID(F),Ye=l.getFragmentShaderID(F);const at=i.getRenderTarget(),At=i.state.buffers.depth.getReversed(),Gt=K.isInstancedMesh===!0,Dt=K.isBatchedMesh===!0,Nn=!!F.map,bn=!!F.matcap,$t=!!re,he=!!F.aoMap,vt=!!F.lightMap,ft=!!F.bumpMap,pt=!!F.normalMap,et=!!F.displacementMap,Ft=!!F.emissiveMap,Tt=!!F.metalnessMap,Lt=!!F.roughnessMap,_n=F.anisotropy>0,pe=F.clearcoat>0,ie=F.dispersion>0,Ge=F.iridescence>0,Qe=F.sheen>0,nt=F.transmission>0,Ke=_n&&!!F.anisotropyMap,qt=pe&&!!F.clearcoatMap,Bt=pe&&!!F.clearcoatNormalMap,Zt=pe&&!!F.clearcoatRoughnessMap,nn=Ge&&!!F.iridescenceMap,_t=Ge&&!!F.iridescenceThicknessMap,jt=Qe&&!!F.sheenColorMap,un=Qe&&!!F.sheenRoughnessMap,sn=!!F.specularMap,It=!!F.specularColorMap,Dn=!!F.specularIntensityMap,fe=nt&&!!F.transmissionMap,Ut=nt&&!!F.thicknessMap,xt=!!F.gradientMap,Ht=!!F.alphaMap,Ct=F.alphaTest>0,ut=!!F.alphaHash,kt=!!F.extensions;let hn=_a;F.toneMapped&&(at===null||at.isXRRenderTarget===!0)&&(hn=i.toneMapping);const $n={shaderID:_e,shaderType:F.type,shaderName:F.name,vertexShader:Pe,fragmentShader:Se,defines:F.defines,customVertexShaderID:Fe,customFragmentShaderID:Ye,isRawShaderMaterial:F.isRawShaderMaterial===!0,glslVersion:F.glslVersion,precision:x,batching:Dt,batchingColor:Dt&&K._colorsTexture!==null,instancing:Gt,instancingColor:Gt&&K.instanceColor!==null,instancingMorph:Gt&&K.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:at===null?i.outputColorSpace:at.isXRRenderTarget===!0?at.texture.colorSpace:pu,alphaToCoverage:!!F.alphaToCoverage,map:Nn,matcap:bn,envMap:$t,envMapMode:$t&&re.mapping,envMapCubeUVHeight:ae,aoMap:he,lightMap:vt,bumpMap:ft,normalMap:pt,displacementMap:_&&et,emissiveMap:Ft,normalMapObjectSpace:pt&&F.normalMapType===o9,normalMapTangentSpace:pt&&F.normalMapType===Mh,metalnessMap:Tt,roughnessMap:Lt,anisotropy:_n,anisotropyMap:Ke,clearcoat:pe,clearcoatMap:qt,clearcoatNormalMap:Bt,clearcoatRoughnessMap:Zt,dispersion:ie,iridescence:Ge,iridescenceMap:nn,iridescenceThicknessMap:_t,sheen:Qe,sheenColorMap:jt,sheenRoughnessMap:un,specularMap:sn,specularColorMap:It,specularIntensityMap:Dn,transmission:nt,transmissionMap:fe,thicknessMap:Ut,gradientMap:xt,opaque:F.transparent===!1&&F.blending===Wo&&F.alphaToCoverage===!1,alphaMap:Ht,alphaTest:Ct,alphaHash:ut,combine:F.combine,mapUv:Nn&&R(F.map.channel),aoMapUv:he&&R(F.aoMap.channel),lightMapUv:vt&&R(F.lightMap.channel),bumpMapUv:ft&&R(F.bumpMap.channel),normalMapUv:pt&&R(F.normalMap.channel),displacementMapUv:et&&R(F.displacementMap.channel),emissiveMapUv:Ft&&R(F.emissiveMap.channel),metalnessMapUv:Tt&&R(F.metalnessMap.channel),roughnessMapUv:Lt&&R(F.roughnessMap.channel),anisotropyMapUv:Ke&&R(F.anisotropyMap.channel),clearcoatMapUv:qt&&R(F.clearcoatMap.channel),clearcoatNormalMapUv:Bt&&R(F.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Zt&&R(F.clearcoatRoughnessMap.channel),iridescenceMapUv:nn&&R(F.iridescenceMap.channel),iridescenceThicknessMapUv:_t&&R(F.iridescenceThicknessMap.channel),sheenColorMapUv:jt&&R(F.sheenColorMap.channel),sheenRoughnessMapUv:un&&R(F.sheenRoughnessMap.channel),specularMapUv:sn&&R(F.specularMap.channel),specularColorMapUv:It&&R(F.specularColorMap.channel),specularIntensityMapUv:Dn&&R(F.specularIntensityMap.channel),transmissionMapUv:fe&&R(F.transmissionMap.channel),thicknessMapUv:Ut&&R(F.thicknessMap.channel),alphaMapUv:Ht&&R(F.alphaMap.channel),vertexTangents:!!ee.attributes.tangent&&(pt||_n),vertexColors:F.vertexColors,vertexAlphas:F.vertexColors===!0&&!!ee.attributes.color&&ee.attributes.color.itemSize===4,pointsUvs:K.isPoints===!0&&!!ee.attributes.uv&&(Nn||Ht),fog:!!se,useFog:F.fog===!0,fogExp2:!!se&&se.isFogExp2,flatShading:F.flatShading===!0&&F.wireframe===!1,sizeAttenuation:F.sizeAttenuation===!0,logarithmicDepthBuffer:d,reverseDepthBuffer:At,skinning:K.isSkinnedMesh===!0,morphTargets:ee.morphAttributes.position!==void 0,morphNormals:ee.morphAttributes.normal!==void 0,morphColors:ee.morphAttributes.color!==void 0,morphTargetsCount:ye,morphTextureStride:ve,numDirLights:q.directional.length,numPointLights:q.point.length,numSpotLights:q.spot.length,numSpotLightMaps:q.spotLightMap.length,numRectAreaLights:q.rectArea.length,numHemiLights:q.hemi.length,numDirLightShadows:q.directionalShadowMap.length,numPointLightShadows:q.pointShadowMap.length,numSpotLightShadows:q.spotShadowMap.length,numSpotLightShadowsWithMaps:q.numSpotLightShadowsWithMaps,numLightProbes:q.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:F.dithering,shadowMapEnabled:i.shadowMap.enabled&&H.length>0,shadowMapType:i.shadowMap.type,toneMapping:hn,decodeVideoTexture:Nn&&F.map.isVideoTexture===!0&&In.getTransfer(F.map.colorSpace)===Qt,decodeVideoTextureEmissive:Ft&&F.emissiveMap.isVideoTexture===!0&&In.getTransfer(F.emissiveMap.colorSpace)===Qt,premultipliedAlpha:F.premultipliedAlpha,doubleSided:F.side===ss,flipSided:F.side===Zi,useDepthPacking:F.depthPacking>=0,depthPacking:F.depthPacking||0,index0AttributeName:F.index0AttributeName,extensionClipCullDistance:kt&&F.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(kt&&F.extensions.multiDraw===!0||Dt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:F.customProgramCacheKey()};return $n.vertexUv1s=u.has(1),$n.vertexUv2s=u.has(2),$n.vertexUv3s=u.has(3),u.clear(),$n}function w(F){const q=[];if(F.shaderID?q.push(F.shaderID):(q.push(F.customVertexShaderID),q.push(F.customFragmentShaderID)),F.defines!==void 0)for(const H in F.defines)q.push(H),q.push(F.defines[H]);return F.isRawShaderMaterial===!1&&(L(q,F),D(q,F),q.push(i.outputColorSpace)),q.push(F.customProgramCacheKey),q.join()}function L(F,q){F.push(q.precision),F.push(q.outputColorSpace),F.push(q.envMapMode),F.push(q.envMapCubeUVHeight),F.push(q.mapUv),F.push(q.alphaMapUv),F.push(q.lightMapUv),F.push(q.aoMapUv),F.push(q.bumpMapUv),F.push(q.normalMapUv),F.push(q.displacementMapUv),F.push(q.emissiveMapUv),F.push(q.metalnessMapUv),F.push(q.roughnessMapUv),F.push(q.anisotropyMapUv),F.push(q.clearcoatMapUv),F.push(q.clearcoatNormalMapUv),F.push(q.clearcoatRoughnessMapUv),F.push(q.iridescenceMapUv),F.push(q.iridescenceThicknessMapUv),F.push(q.sheenColorMapUv),F.push(q.sheenRoughnessMapUv),F.push(q.specularMapUv),F.push(q.specularColorMapUv),F.push(q.specularIntensityMapUv),F.push(q.transmissionMapUv),F.push(q.thicknessMapUv),F.push(q.combine),F.push(q.fogExp2),F.push(q.sizeAttenuation),F.push(q.morphTargetsCount),F.push(q.morphAttributeCount),F.push(q.numDirLights),F.push(q.numPointLights),F.push(q.numSpotLights),F.push(q.numSpotLightMaps),F.push(q.numHemiLights),F.push(q.numRectAreaLights),F.push(q.numDirLightShadows),F.push(q.numPointLightShadows),F.push(q.numSpotLightShadows),F.push(q.numSpotLightShadowsWithMaps),F.push(q.numLightProbes),F.push(q.shadowMapType),F.push(q.toneMapping),F.push(q.numClippingPlanes),F.push(q.numClipIntersection),F.push(q.depthPacking)}function D(F,q){a.disableAll(),q.supportsVertexTextures&&a.enable(0),q.instancing&&a.enable(1),q.instancingColor&&a.enable(2),q.instancingMorph&&a.enable(3),q.matcap&&a.enable(4),q.envMap&&a.enable(5),q.normalMapObjectSpace&&a.enable(6),q.normalMapTangentSpace&&a.enable(7),q.clearcoat&&a.enable(8),q.iridescence&&a.enable(9),q.alphaTest&&a.enable(10),q.vertexColors&&a.enable(11),q.vertexAlphas&&a.enable(12),q.vertexUv1s&&a.enable(13),q.vertexUv2s&&a.enable(14),q.vertexUv3s&&a.enable(15),q.vertexTangents&&a.enable(16),q.anisotropy&&a.enable(17),q.alphaHash&&a.enable(18),q.batching&&a.enable(19),q.dispersion&&a.enable(20),q.batchingColor&&a.enable(21),q.gradientMap&&a.enable(22),F.push(a.mask),a.disableAll(),q.fog&&a.enable(0),q.useFog&&a.enable(1),q.flatShading&&a.enable(2),q.logarithmicDepthBuffer&&a.enable(3),q.reverseDepthBuffer&&a.enable(4),q.skinning&&a.enable(5),q.morphTargets&&a.enable(6),q.morphNormals&&a.enable(7),q.morphColors&&a.enable(8),q.premultipliedAlpha&&a.enable(9),q.shadowMapEnabled&&a.enable(10),q.doubleSided&&a.enable(11),q.flipSided&&a.enable(12),q.useDepthPacking&&a.enable(13),q.dithering&&a.enable(14),q.transmission&&a.enable(15),q.sheen&&a.enable(16),q.opaque&&a.enable(17),q.pointsUvs&&a.enable(18),q.decodeVideoTexture&&a.enable(19),q.decodeVideoTextureEmissive&&a.enable(20),q.alphaToCoverage&&a.enable(21),F.push(a.mask)}function O(F){const q=b[F.type];let H;if(q){const Q=ia[q];H=lT.clone(Q.uniforms)}else H=F.uniforms;return H}function B(F,q){let H;for(let Q=0,K=h.length;Q<K;Q++){const se=h[Q];if(se.cacheKey===q){H=se,++H.usedTimes;break}}return H===void 0&&(H=new Cee(i,q,F,s),h.push(H)),H}function G(F){if(--F.usedTimes===0){const q=h.indexOf(F);h[q]=h[h.length-1],h.pop(),F.destroy()}}function k(F){l.remove(F)}function z(){l.dispose()}return{getParameters:E,getProgramCacheKey:w,getUniforms:O,acquireProgram:B,releaseProgram:G,releaseShaderCache:k,programs:h,dispose:z}}function Oee(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let a=i.get(o);return a===void 0&&(a={},i.set(o,a)),a}function n(o){i.delete(o)}function r(o,a,l){i.get(o)[a]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function Iee(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function JL(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function e7(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(d,_,x,b,R,E){let w=i[e];return w===void 0?(w={id:d.id,object:d,geometry:_,material:x,groupOrder:b,renderOrder:d.renderOrder,z:R,group:E},i[e]=w):(w.id=d.id,w.object=d,w.geometry=_,w.material=x,w.groupOrder=b,w.renderOrder=d.renderOrder,w.z=R,w.group=E),e++,w}function a(d,_,x,b,R,E){const w=o(d,_,x,b,R,E);x.transmission>0?n.push(w):x.transparent===!0?r.push(w):t.push(w)}function l(d,_,x,b,R,E){const w=o(d,_,x,b,R,E);x.transmission>0?n.unshift(w):x.transparent===!0?r.unshift(w):t.unshift(w)}function u(d,_){t.length>1&&t.sort(d||Iee),n.length>1&&n.sort(_||JL),r.length>1&&r.sort(_||JL)}function h(){for(let d=e,_=i.length;d<_;d++){const x=i[d];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:u}}function Bee(){let i=new WeakMap;function e(n,r){const s=i.get(n);let o;return s===void 0?(o=new e7,i.set(n,[o])):r>=s.length?(o=new e7,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function Uee(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ce,color:new Jt};break;case"SpotLight":t={position:new ce,direction:new ce,color:new Jt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ce,color:new Jt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ce,skyColor:new Jt,groundColor:new Jt};break;case"RectAreaLight":t={color:new Jt,position:new ce,halfWidth:new ce,halfHeight:new ce};break}return i[e.id]=t,t}}}function Fee(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let kee=0;function Gee(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function zee(i){const e=new Uee,t=Fee(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)n.probe.push(new ce);const r=new ce,s=new Cn,o=new Cn;function a(u){let h=0,d=0,_=0;for(let F=0;F<9;F++)n.probe[F].set(0,0,0);let x=0,b=0,R=0,E=0,w=0,L=0,D=0,O=0,B=0,G=0,k=0;u.sort(Gee);for(let F=0,q=u.length;F<q;F++){const H=u[F],Q=H.color,K=H.intensity,se=H.distance,ee=H.shadow&&H.shadow.map?H.shadow.map.texture:null;if(H.isAmbientLight)h+=Q.r*K,d+=Q.g*K,_+=Q.b*K;else if(H.isLightProbe){for(let $=0;$<9;$++)n.probe[$].addScaledVector(H.sh.coefficients[$],K);k++}else if(H.isDirectionalLight){const $=e.get(H);if($.color.copy(H.color).multiplyScalar(H.intensity),H.castShadow){const re=H.shadow,ae=t.get(H);ae.shadowIntensity=re.intensity,ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,n.directionalShadow[x]=ae,n.directionalShadowMap[x]=ee,n.directionalShadowMatrix[x]=H.shadow.matrix,L++}n.directional[x]=$,x++}else if(H.isSpotLight){const $=e.get(H);$.position.setFromMatrixPosition(H.matrixWorld),$.color.copy(Q).multiplyScalar(K),$.distance=se,$.coneCos=Math.cos(H.angle),$.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),$.decay=H.decay,n.spot[R]=$;const re=H.shadow;if(H.map&&(n.spotLightMap[B]=H.map,B++,re.updateMatrices(H),H.castShadow&&G++),n.spotLightMatrix[R]=re.matrix,H.castShadow){const ae=t.get(H);ae.shadowIntensity=re.intensity,ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,n.spotShadow[R]=ae,n.spotShadowMap[R]=ee,O++}R++}else if(H.isRectAreaLight){const $=e.get(H);$.color.copy(Q).multiplyScalar(K),$.halfWidth.set(H.width*.5,0,0),$.halfHeight.set(0,H.height*.5,0),n.rectArea[E]=$,E++}else if(H.isPointLight){const $=e.get(H);if($.color.copy(H.color).multiplyScalar(H.intensity),$.distance=H.distance,$.decay=H.decay,H.castShadow){const re=H.shadow,ae=t.get(H);ae.shadowIntensity=re.intensity,ae.shadowBias=re.bias,ae.shadowNormalBias=re.normalBias,ae.shadowRadius=re.radius,ae.shadowMapSize=re.mapSize,ae.shadowCameraNear=re.camera.near,ae.shadowCameraFar=re.camera.far,n.pointShadow[b]=ae,n.pointShadowMap[b]=ee,n.pointShadowMatrix[b]=H.shadow.matrix,D++}n.point[b]=$,b++}else if(H.isHemisphereLight){const $=e.get(H);$.skyColor.copy(H.color).multiplyScalar(K),$.groundColor.copy(H.groundColor).multiplyScalar(K),n.hemi[w]=$,w++}}E>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=zt.LTC_FLOAT_1,n.rectAreaLTC2=zt.LTC_FLOAT_2):(n.rectAreaLTC1=zt.LTC_HALF_1,n.rectAreaLTC2=zt.LTC_HALF_2)),n.ambient[0]=h,n.ambient[1]=d,n.ambient[2]=_;const z=n.hash;(z.directionalLength!==x||z.pointLength!==b||z.spotLength!==R||z.rectAreaLength!==E||z.hemiLength!==w||z.numDirectionalShadows!==L||z.numPointShadows!==D||z.numSpotShadows!==O||z.numSpotMaps!==B||z.numLightProbes!==k)&&(n.directional.length=x,n.spot.length=R,n.rectArea.length=E,n.point.length=b,n.hemi.length=w,n.directionalShadow.length=L,n.directionalShadowMap.length=L,n.pointShadow.length=D,n.pointShadowMap.length=D,n.spotShadow.length=O,n.spotShadowMap.length=O,n.directionalShadowMatrix.length=L,n.pointShadowMatrix.length=D,n.spotLightMatrix.length=O+B-G,n.spotLightMap.length=B,n.numSpotLightShadowsWithMaps=G,n.numLightProbes=k,z.directionalLength=x,z.pointLength=b,z.spotLength=R,z.rectAreaLength=E,z.hemiLength=w,z.numDirectionalShadows=L,z.numPointShadows=D,z.numSpotShadows=O,z.numSpotMaps=B,z.numLightProbes=k,n.version=kee++)}function l(u,h){let d=0,_=0,x=0,b=0,R=0;const E=h.matrixWorldInverse;for(let w=0,L=u.length;w<L;w++){const D=u[w];if(D.isDirectionalLight){const O=n.directional[d];O.direction.setFromMatrixPosition(D.matrixWorld),r.setFromMatrixPosition(D.target.matrixWorld),O.direction.sub(r),O.direction.transformDirection(E),d++}else if(D.isSpotLight){const O=n.spot[x];O.position.setFromMatrixPosition(D.matrixWorld),O.position.applyMatrix4(E),O.direction.setFromMatrixPosition(D.matrixWorld),r.setFromMatrixPosition(D.target.matrixWorld),O.direction.sub(r),O.direction.transformDirection(E),x++}else if(D.isRectAreaLight){const O=n.rectArea[b];O.position.setFromMatrixPosition(D.matrixWorld),O.position.applyMatrix4(E),o.identity(),s.copy(D.matrixWorld),s.premultiply(E),o.extractRotation(s),O.halfWidth.set(D.width*.5,0,0),O.halfHeight.set(0,D.height*.5,0),O.halfWidth.applyMatrix4(o),O.halfHeight.applyMatrix4(o),b++}else if(D.isPointLight){const O=n.point[_];O.position.setFromMatrixPosition(D.matrixWorld),O.position.applyMatrix4(E),_++}else if(D.isHemisphereLight){const O=n.hemi[R];O.direction.setFromMatrixPosition(D.matrixWorld),O.direction.transformDirection(E),R++}}}return{setup:a,setupView:l,state:n}}function t7(i){const e=new zee(i),t=[],n=[];function r(h){u.camera=h,t.length=0,n.length=0}function s(h){t.push(h)}function o(h){n.push(h)}function a(){e.setup(t)}function l(h){e.setupView(t,h)}const u={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:u,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function Vee(i){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new t7(i),e.set(r,[a])):s>=o.length?(a=new t7(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}const qee=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Hee=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Wee(i,e,t){let n=new cg;const r=new it,s=new it,o=new mn,a=new eQ({depthPacking:h$}),l=new tQ,u={},h=t.maxTextureSize,d={[ma]:Zi,[Zi]:ma,[ss]:ss},_=new ya({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new it},radius:{value:4}},vertexShader:qee,fragmentShader:Hee}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const b=new Vi;b.setAttribute("position",new _r(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new Ri(b,_),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=P4;let w=this.type;this.render=function(G,k,z){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||G.length===0)return;const F=i.getRenderTarget(),q=i.getActiveCubeFace(),H=i.getActiveMipmapLevel(),Q=i.state;Q.setBlending(ga),Q.buffers.color.setClear(1,1,1,1),Q.buffers.depth.setTest(!0),Q.setScissorTest(!1);const K=w!==Va&&this.type===Va,se=w===Va&&this.type!==Va;for(let ee=0,$=G.length;ee<$;ee++){const re=G[ee],ae=re.shadow;if(ae===void 0){console.warn("THREE.WebGLShadowMap:",re,"has no shadow.");continue}if(ae.autoUpdate===!1&&ae.needsUpdate===!1)continue;r.copy(ae.mapSize);const _e=ae.getFrameExtents();if(r.multiply(_e),s.copy(ae.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/_e.x),r.x=s.x*_e.x,ae.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/_e.y),r.y=s.y*_e.y,ae.mapSize.y=s.y)),ae.map===null||K===!0||se===!0){const ye=this.type!==Va?{minFilter:br,magFilter:br}:{};ae.map!==null&&ae.map.dispose(),ae.map=new ad(r.x,r.y,ye),ae.map.texture.name=re.name+".shadowMap",ae.camera.updateProjectionMatrix()}i.setRenderTarget(ae.map),i.clear();const ne=ae.getViewportCount();for(let ye=0;ye<ne;ye++){const ve=ae.getViewport(ye);o.set(s.x*ve.x,s.y*ve.y,s.x*ve.z,s.y*ve.w),Q.viewport(o),ae.updateMatrices(re,ye),n=ae.getFrustum(),O(k,z,ae.camera,re,this.type)}ae.isPointLightShadow!==!0&&this.type===Va&&L(ae,z),ae.needsUpdate=!1}w=this.type,E.needsUpdate=!1,i.setRenderTarget(F,q,H)};function L(G,k){const z=e.update(R);_.defines.VSM_SAMPLES!==G.blurSamples&&(_.defines.VSM_SAMPLES=G.blurSamples,x.defines.VSM_SAMPLES=G.blurSamples,_.needsUpdate=!0,x.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new ad(r.x,r.y)),_.uniforms.shadow_pass.value=G.map.texture,_.uniforms.resolution.value=G.mapSize,_.uniforms.radius.value=G.radius,i.setRenderTarget(G.mapPass),i.clear(),i.renderBufferDirect(k,null,z,_,R,null),x.uniforms.shadow_pass.value=G.mapPass.texture,x.uniforms.resolution.value=G.mapSize,x.uniforms.radius.value=G.radius,i.setRenderTarget(G.map),i.clear(),i.renderBufferDirect(k,null,z,x,R,null)}function D(G,k,z,F){let q=null;const H=z.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(H!==void 0)q=H;else if(q=z.isPointLight===!0?l:a,i.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0||k.alphaToCoverage===!0){const Q=q.uuid,K=k.uuid;let se=u[Q];se===void 0&&(se={},u[Q]=se);let ee=se[K];ee===void 0&&(ee=q.clone(),se[K]=ee,k.addEventListener("dispose",B)),q=ee}if(q.visible=k.visible,q.wireframe=k.wireframe,F===Va?q.side=k.shadowSide!==null?k.shadowSide:k.side:q.side=k.shadowSide!==null?k.shadowSide:d[k.side],q.alphaMap=k.alphaMap,q.alphaTest=k.alphaToCoverage===!0?.5:k.alphaTest,q.map=k.map,q.clipShadows=k.clipShadows,q.clippingPlanes=k.clippingPlanes,q.clipIntersection=k.clipIntersection,q.displacementMap=k.displacementMap,q.displacementScale=k.displacementScale,q.displacementBias=k.displacementBias,q.wireframeLinewidth=k.wireframeLinewidth,q.linewidth=k.linewidth,z.isPointLight===!0&&q.isMeshDistanceMaterial===!0){const Q=i.properties.get(q);Q.light=z}return q}function O(G,k,z,F,q){if(G.visible===!1)return;if(G.layers.test(k.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&q===Va)&&(!G.frustumCulled||n.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(z.matrixWorldInverse,G.matrixWorld);const K=e.update(G),se=G.material;if(Array.isArray(se)){const ee=K.groups;for(let $=0,re=ee.length;$<re;$++){const ae=ee[$],_e=se[ae.materialIndex];if(_e&&_e.visible){const ne=D(G,_e,F,q);G.onBeforeShadow(i,G,k,z,K,ne,ae),i.renderBufferDirect(z,null,K,ne,G,ae),G.onAfterShadow(i,G,k,z,K,ne,ae)}}}else if(se.visible){const ee=D(G,se,F,q);G.onBeforeShadow(i,G,k,z,K,ee,null),i.renderBufferDirect(z,null,K,ee,G,null),G.onAfterShadow(i,G,k,z,K,ee,null)}}const Q=G.children;for(let K=0,se=Q.length;K<se;K++)O(Q[K],k,z,F,q)}function B(G){G.target.removeEventListener("dispose",B);for(const z in u){const F=u[z],q=G.target.uuid;q in F&&(F[q].dispose(),delete F[q])}}}const jee={[z_]:V_,[q_]:j_,[H_]:X_,[od]:W_,[V_]:z_,[j_]:q_,[X_]:H_,[W_]:od};function Xee(i,e){function t(){let fe=!1;const Ut=new mn;let xt=null;const Ht=new mn(0,0,0,0);return{setMask:function(Ct){xt!==Ct&&!fe&&(i.colorMask(Ct,Ct,Ct,Ct),xt=Ct)},setLocked:function(Ct){fe=Ct},setClear:function(Ct,ut,kt,hn,$n){$n===!0&&(Ct*=hn,ut*=hn,kt*=hn),Ut.set(Ct,ut,kt,hn),Ht.equals(Ut)===!1&&(i.clearColor(Ct,ut,kt,hn),Ht.copy(Ut))},reset:function(){fe=!1,xt=null,Ht.set(-1,0,0,0)}}}function n(){let fe=!1,Ut=!1,xt=null,Ht=null,Ct=null;return{setReversed:function(ut){if(Ut!==ut){const kt=e.get("EXT_clip_control");ut?kt.clipControlEXT(kt.LOWER_LEFT_EXT,kt.ZERO_TO_ONE_EXT):kt.clipControlEXT(kt.LOWER_LEFT_EXT,kt.NEGATIVE_ONE_TO_ONE_EXT),Ut=ut;const hn=Ct;Ct=null,this.setClear(hn)}},getReversed:function(){return Ut},setTest:function(ut){ut?at(i.DEPTH_TEST):At(i.DEPTH_TEST)},setMask:function(ut){xt!==ut&&!fe&&(i.depthMask(ut),xt=ut)},setFunc:function(ut){if(Ut&&(ut=jee[ut]),Ht!==ut){switch(ut){case z_:i.depthFunc(i.NEVER);break;case V_:i.depthFunc(i.ALWAYS);break;case q_:i.depthFunc(i.LESS);break;case od:i.depthFunc(i.LEQUAL);break;case H_:i.depthFunc(i.EQUAL);break;case W_:i.depthFunc(i.GEQUAL);break;case j_:i.depthFunc(i.GREATER);break;case X_:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Ht=ut}},setLocked:function(ut){fe=ut},setClear:function(ut){Ct!==ut&&(Ut&&(ut=1-ut),i.clearDepth(ut),Ct=ut)},reset:function(){fe=!1,xt=null,Ht=null,Ct=null,Ut=!1}}}function r(){let fe=!1,Ut=null,xt=null,Ht=null,Ct=null,ut=null,kt=null,hn=null,$n=null;return{setTest:function(Bn){fe||(Bn?at(i.STENCIL_TEST):At(i.STENCIL_TEST))},setMask:function(Bn){Ut!==Bn&&!fe&&(i.stencilMask(Bn),Ut=Bn)},setFunc:function(Bn,Hi,Ti){(xt!==Bn||Ht!==Hi||Ct!==Ti)&&(i.stencilFunc(Bn,Hi,Ti),xt=Bn,Ht=Hi,Ct=Ti)},setOp:function(Bn,Hi,Ti){(ut!==Bn||kt!==Hi||hn!==Ti)&&(i.stencilOp(Bn,Hi,Ti),ut=Bn,kt=Hi,hn=Ti)},setLocked:function(Bn){fe=Bn},setClear:function(Bn){$n!==Bn&&(i.clearStencil(Bn),$n=Bn)},reset:function(){fe=!1,Ut=null,xt=null,Ht=null,Ct=null,ut=null,kt=null,hn=null,$n=null}}}const s=new t,o=new n,a=new r,l=new WeakMap,u=new WeakMap;let h={},d={},_=new WeakMap,x=[],b=null,R=!1,E=null,w=null,L=null,D=null,O=null,B=null,G=null,k=new Jt(0,0,0),z=0,F=!1,q=null,H=null,Q=null,K=null,se=null;const ee=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let $=!1,re=0;const ae=i.getParameter(i.VERSION);ae.indexOf("WebGL")!==-1?(re=parseFloat(/^WebGL (\d)/.exec(ae)[1]),$=re>=1):ae.indexOf("OpenGL ES")!==-1&&(re=parseFloat(/^OpenGL ES (\d)/.exec(ae)[1]),$=re>=2);let _e=null,ne={};const ye=i.getParameter(i.SCISSOR_BOX),ve=i.getParameter(i.VIEWPORT),Pe=new mn().fromArray(ye),Se=new mn().fromArray(ve);function Fe(fe,Ut,xt,Ht){const Ct=new Uint8Array(4),ut=i.createTexture();i.bindTexture(fe,ut),i.texParameteri(fe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(fe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let kt=0;kt<xt;kt++)fe===i.TEXTURE_3D||fe===i.TEXTURE_2D_ARRAY?i.texImage3D(Ut,0,i.RGBA,1,1,Ht,0,i.RGBA,i.UNSIGNED_BYTE,Ct):i.texImage2D(Ut+kt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Ct);return ut}const Ye={};Ye[i.TEXTURE_2D]=Fe(i.TEXTURE_2D,i.TEXTURE_2D,1),Ye[i.TEXTURE_CUBE_MAP]=Fe(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ye[i.TEXTURE_2D_ARRAY]=Fe(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ye[i.TEXTURE_3D]=Fe(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),at(i.DEPTH_TEST),o.setFunc(od),ft(!1),pt(IR),at(i.CULL_FACE),he(ga);function at(fe){h[fe]!==!0&&(i.enable(fe),h[fe]=!0)}function At(fe){h[fe]!==!1&&(i.disable(fe),h[fe]=!1)}function Gt(fe,Ut){return d[fe]!==Ut?(i.bindFramebuffer(fe,Ut),d[fe]=Ut,fe===i.DRAW_FRAMEBUFFER&&(d[i.FRAMEBUFFER]=Ut),fe===i.FRAMEBUFFER&&(d[i.DRAW_FRAMEBUFFER]=Ut),!0):!1}function Dt(fe,Ut){let xt=x,Ht=!1;if(fe){xt=_.get(Ut),xt===void 0&&(xt=[],_.set(Ut,xt));const Ct=fe.textures;if(xt.length!==Ct.length||xt[0]!==i.COLOR_ATTACHMENT0){for(let ut=0,kt=Ct.length;ut<kt;ut++)xt[ut]=i.COLOR_ATTACHMENT0+ut;xt.length=Ct.length,Ht=!0}}else xt[0]!==i.BACK&&(xt[0]=i.BACK,Ht=!0);Ht&&i.drawBuffers(xt)}function Nn(fe){return b!==fe?(i.useProgram(fe),b=fe,!0):!1}const bn={[bo]:i.FUNC_ADD,[L4]:i.FUNC_SUBTRACT,[O4]:i.FUNC_REVERSE_SUBTRACT};bn[QU]=i.MIN,bn[KU]=i.MAX;const $t={[ah]:i.ZERO,[I4]:i.ONE,[B4]:i.SRC_COLOR,[k_]:i.SRC_ALPHA,[V4]:i.SRC_ALPHA_SATURATE,[G4]:i.DST_COLOR,[F4]:i.DST_ALPHA,[U4]:i.ONE_MINUS_SRC_COLOR,[G_]:i.ONE_MINUS_SRC_ALPHA,[z4]:i.ONE_MINUS_DST_COLOR,[k4]:i.ONE_MINUS_DST_ALPHA,[t$]:i.CONSTANT_COLOR,[n$]:i.ONE_MINUS_CONSTANT_COLOR,[i$]:i.CONSTANT_ALPHA,[r$]:i.ONE_MINUS_CONSTANT_ALPHA};function he(fe,Ut,xt,Ht,Ct,ut,kt,hn,$n,Bn){if(fe===ga){R===!0&&(At(i.BLEND),R=!1);return}if(R===!1&&(at(i.BLEND),R=!0),fe!==Kp){if(fe!==E||Bn!==F){if((w!==bo||O!==bo)&&(i.blendEquation(i.FUNC_ADD),w=bo,O=bo),Bn)switch(fe){case Wo:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case hm:i.blendFunc(i.ONE,i.ONE);break;case fm:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case dm:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}else switch(fe){case Wo:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case hm:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case fm:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case dm:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}L=null,D=null,B=null,G=null,k.set(0,0,0),z=0,E=fe,F=Bn}return}Ct=Ct||Ut,ut=ut||xt,kt=kt||Ht,(Ut!==w||Ct!==O)&&(i.blendEquationSeparate(bn[Ut],bn[Ct]),w=Ut,O=Ct),(xt!==L||Ht!==D||ut!==B||kt!==G)&&(i.blendFuncSeparate($t[xt],$t[Ht],$t[ut],$t[kt]),L=xt,D=Ht,B=ut,G=kt),(hn.equals(k)===!1||$n!==z)&&(i.blendColor(hn.r,hn.g,hn.b,$n),k.copy(hn),z=$n),E=fe,F=!1}function vt(fe,Ut){fe.side===ss?At(i.CULL_FACE):at(i.CULL_FACE);let xt=fe.side===Zi;Ut&&(xt=!xt),ft(xt),fe.blending===Wo&&fe.transparent===!1?he(ga):he(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.blendColor,fe.blendAlpha,fe.premultipliedAlpha),o.setFunc(fe.depthFunc),o.setTest(fe.depthTest),o.setMask(fe.depthWrite),s.setMask(fe.colorWrite);const Ht=fe.stencilWrite;a.setTest(Ht),Ht&&(a.setMask(fe.stencilWriteMask),a.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),a.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),Ft(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),fe.alphaToCoverage===!0?at(i.SAMPLE_ALPHA_TO_COVERAGE):At(i.SAMPLE_ALPHA_TO_COVERAGE)}function ft(fe){q!==fe&&(fe?i.frontFace(i.CW):i.frontFace(i.CCW),q=fe)}function pt(fe){fe!==$U?(at(i.CULL_FACE),fe!==H&&(fe===IR?i.cullFace(i.BACK):fe===YU?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):At(i.CULL_FACE),H=fe}function et(fe){fe!==Q&&($&&i.lineWidth(fe),Q=fe)}function Ft(fe,Ut,xt){fe?(at(i.POLYGON_OFFSET_FILL),(K!==Ut||se!==xt)&&(i.polygonOffset(Ut,xt),K=Ut,se=xt)):At(i.POLYGON_OFFSET_FILL)}function Tt(fe){fe?at(i.SCISSOR_TEST):At(i.SCISSOR_TEST)}function Lt(fe){fe===void 0&&(fe=i.TEXTURE0+ee-1),_e!==fe&&(i.activeTexture(fe),_e=fe)}function _n(fe,Ut,xt){xt===void 0&&(_e===null?xt=i.TEXTURE0+ee-1:xt=_e);let Ht=ne[xt];Ht===void 0&&(Ht={type:void 0,texture:void 0},ne[xt]=Ht),(Ht.type!==fe||Ht.texture!==Ut)&&(_e!==xt&&(i.activeTexture(xt),_e=xt),i.bindTexture(fe,Ut||Ye[fe]),Ht.type=fe,Ht.texture=Ut)}function pe(){const fe=ne[_e];fe!==void 0&&fe.type!==void 0&&(i.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)}function ie(){try{i.compressedTexImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ge(){try{i.compressedTexImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Qe(){try{i.texSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function nt(){try{i.texSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ke(){try{i.compressedTexSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function qt(){try{i.compressedTexSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Bt(){try{i.texStorage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Zt(){try{i.texStorage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function nn(){try{i.texImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function _t(){try{i.texImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function jt(fe){Pe.equals(fe)===!1&&(i.scissor(fe.x,fe.y,fe.z,fe.w),Pe.copy(fe))}function un(fe){Se.equals(fe)===!1&&(i.viewport(fe.x,fe.y,fe.z,fe.w),Se.copy(fe))}function sn(fe,Ut){let xt=u.get(Ut);xt===void 0&&(xt=new WeakMap,u.set(Ut,xt));let Ht=xt.get(fe);Ht===void 0&&(Ht=i.getUniformBlockIndex(Ut,fe.name),xt.set(fe,Ht))}function It(fe,Ut){const Ht=u.get(Ut).get(fe);l.get(Ut)!==Ht&&(i.uniformBlockBinding(Ut,Ht,fe.__bindingPointIndex),l.set(Ut,Ht))}function Dn(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),h={},_e=null,ne={},d={},_=new WeakMap,x=[],b=null,R=!1,E=null,w=null,L=null,D=null,O=null,B=null,G=null,k=new Jt(0,0,0),z=0,F=!1,q=null,H=null,Q=null,K=null,se=null,Pe.set(0,0,i.canvas.width,i.canvas.height),Se.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:at,disable:At,bindFramebuffer:Gt,drawBuffers:Dt,useProgram:Nn,setBlending:he,setMaterial:vt,setFlipSided:ft,setCullFace:pt,setLineWidth:et,setPolygonOffset:Ft,setScissorTest:Tt,activeTexture:Lt,bindTexture:_n,unbindTexture:pe,compressedTexImage2D:ie,compressedTexImage3D:Ge,texImage2D:nn,texImage3D:_t,updateUBOMapping:sn,uniformBlockBinding:It,texStorage2D:Bt,texStorage3D:Zt,texSubImage2D:Qe,texSubImage3D:nt,compressedTexSubImage2D:Ke,compressedTexSubImage3D:qt,scissor:jt,viewport:un,reset:Dn}}function $ee(i,e,t,n,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new it,h=new WeakMap;let d;const _=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(pe,ie){return x?new OffscreenCanvas(pe,ie):ny("canvas")}function R(pe,ie,Ge){let Qe=1;const nt=_n(pe);if((nt.width>Ge||nt.height>Ge)&&(Qe=Ge/Math.max(nt.width,nt.height)),Qe<1)if(typeof HTMLImageElement<"u"&&pe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&pe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&pe instanceof ImageBitmap||typeof VideoFrame<"u"&&pe instanceof VideoFrame){const Ke=Math.floor(Qe*nt.width),qt=Math.floor(Qe*nt.height);d===void 0&&(d=b(Ke,qt));const Bt=ie?b(Ke,qt):d;return Bt.width=Ke,Bt.height=qt,Bt.getContext("2d").drawImage(pe,0,0,Ke,qt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+nt.width+"x"+nt.height+") to ("+Ke+"x"+qt+")."),Bt}else return"data"in pe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+nt.width+"x"+nt.height+")."),pe;return pe}function E(pe){return pe.generateMipmaps}function w(pe){i.generateMipmap(pe)}function L(pe){return pe.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:pe.isWebGL3DRenderTarget?i.TEXTURE_3D:pe.isWebGLArrayRenderTarget||pe.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function D(pe,ie,Ge,Qe,nt=!1){if(pe!==null){if(i[pe]!==void 0)return i[pe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+pe+"'")}let Ke=ie;if(ie===i.RED&&(Ge===i.FLOAT&&(Ke=i.R32F),Ge===i.HALF_FLOAT&&(Ke=i.R16F),Ge===i.UNSIGNED_BYTE&&(Ke=i.R8)),ie===i.RED_INTEGER&&(Ge===i.UNSIGNED_BYTE&&(Ke=i.R8UI),Ge===i.UNSIGNED_SHORT&&(Ke=i.R16UI),Ge===i.UNSIGNED_INT&&(Ke=i.R32UI),Ge===i.BYTE&&(Ke=i.R8I),Ge===i.SHORT&&(Ke=i.R16I),Ge===i.INT&&(Ke=i.R32I)),ie===i.RG&&(Ge===i.FLOAT&&(Ke=i.RG32F),Ge===i.HALF_FLOAT&&(Ke=i.RG16F),Ge===i.UNSIGNED_BYTE&&(Ke=i.RG8)),ie===i.RG_INTEGER&&(Ge===i.UNSIGNED_BYTE&&(Ke=i.RG8UI),Ge===i.UNSIGNED_SHORT&&(Ke=i.RG16UI),Ge===i.UNSIGNED_INT&&(Ke=i.RG32UI),Ge===i.BYTE&&(Ke=i.RG8I),Ge===i.SHORT&&(Ke=i.RG16I),Ge===i.INT&&(Ke=i.RG32I)),ie===i.RGB_INTEGER&&(Ge===i.UNSIGNED_BYTE&&(Ke=i.RGB8UI),Ge===i.UNSIGNED_SHORT&&(Ke=i.RGB16UI),Ge===i.UNSIGNED_INT&&(Ke=i.RGB32UI),Ge===i.BYTE&&(Ke=i.RGB8I),Ge===i.SHORT&&(Ke=i.RGB16I),Ge===i.INT&&(Ke=i.RGB32I)),ie===i.RGBA_INTEGER&&(Ge===i.UNSIGNED_BYTE&&(Ke=i.RGBA8UI),Ge===i.UNSIGNED_SHORT&&(Ke=i.RGBA16UI),Ge===i.UNSIGNED_INT&&(Ke=i.RGBA32UI),Ge===i.BYTE&&(Ke=i.RGBA8I),Ge===i.SHORT&&(Ke=i.RGBA16I),Ge===i.INT&&(Ke=i.RGBA32I)),ie===i.RGB&&Ge===i.UNSIGNED_INT_5_9_9_9_REV&&(Ke=i.RGB9_E5),ie===i.RGBA){const qt=nt?Pm:In.getTransfer(Qe);Ge===i.FLOAT&&(Ke=i.RGBA32F),Ge===i.HALF_FLOAT&&(Ke=i.RGBA16F),Ge===i.UNSIGNED_BYTE&&(Ke=qt===Qt?i.SRGB8_ALPHA8:i.RGBA8),Ge===i.UNSIGNED_SHORT_4_4_4_4&&(Ke=i.RGBA4),Ge===i.UNSIGNED_SHORT_5_5_5_1&&(Ke=i.RGB5_A1)}return(Ke===i.R16F||Ke===i.R32F||Ke===i.RG16F||Ke===i.RG32F||Ke===i.RGBA16F||Ke===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Ke}function O(pe,ie){let Ge;return pe?ie===null||ie===mr||ie===Ya?Ge=i.DEPTH24_STENCIL8:ie===os?Ge=i.DEPTH32F_STENCIL8:ie===hu&&(Ge=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ie===null||ie===mr||ie===Ya?Ge=i.DEPTH_COMPONENT24:ie===os?Ge=i.DEPTH_COMPONENT32F:ie===hu&&(Ge=i.DEPTH_COMPONENT16),Ge}function B(pe,ie){return E(pe)===!0||pe.isFramebufferTexture&&pe.minFilter!==br&&pe.minFilter!==Ms?Math.log2(Math.max(ie.width,ie.height))+1:pe.mipmaps!==void 0&&pe.mipmaps.length>0?pe.mipmaps.length:pe.isCompressedTexture&&Array.isArray(pe.image)?ie.mipmaps.length:1}function G(pe){const ie=pe.target;ie.removeEventListener("dispose",G),z(ie),ie.isVideoTexture&&h.delete(ie)}function k(pe){const ie=pe.target;ie.removeEventListener("dispose",k),q(ie)}function z(pe){const ie=n.get(pe);if(ie.__webglInit===void 0)return;const Ge=pe.source,Qe=_.get(Ge);if(Qe){const nt=Qe[ie.__cacheKey];nt.usedTimes--,nt.usedTimes===0&&F(pe),Object.keys(Qe).length===0&&_.delete(Ge)}n.remove(pe)}function F(pe){const ie=n.get(pe);i.deleteTexture(ie.__webglTexture);const Ge=pe.source,Qe=_.get(Ge);delete Qe[ie.__cacheKey],o.memory.textures--}function q(pe){const ie=n.get(pe);if(pe.depthTexture&&(pe.depthTexture.dispose(),n.remove(pe.depthTexture)),pe.isWebGLCubeRenderTarget)for(let Qe=0;Qe<6;Qe++){if(Array.isArray(ie.__webglFramebuffer[Qe]))for(let nt=0;nt<ie.__webglFramebuffer[Qe].length;nt++)i.deleteFramebuffer(ie.__webglFramebuffer[Qe][nt]);else i.deleteFramebuffer(ie.__webglFramebuffer[Qe]);ie.__webglDepthbuffer&&i.deleteRenderbuffer(ie.__webglDepthbuffer[Qe])}else{if(Array.isArray(ie.__webglFramebuffer))for(let Qe=0;Qe<ie.__webglFramebuffer.length;Qe++)i.deleteFramebuffer(ie.__webglFramebuffer[Qe]);else i.deleteFramebuffer(ie.__webglFramebuffer);if(ie.__webglDepthbuffer&&i.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&i.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Qe=0;Qe<ie.__webglColorRenderbuffer.length;Qe++)ie.__webglColorRenderbuffer[Qe]&&i.deleteRenderbuffer(ie.__webglColorRenderbuffer[Qe]);ie.__webglDepthRenderbuffer&&i.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}const Ge=pe.textures;for(let Qe=0,nt=Ge.length;Qe<nt;Qe++){const Ke=n.get(Ge[Qe]);Ke.__webglTexture&&(i.deleteTexture(Ke.__webglTexture),o.memory.textures--),n.remove(Ge[Qe])}n.remove(pe)}let H=0;function Q(){H=0}function K(){const pe=H;return pe>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+pe+" texture units while this GPU supports only "+r.maxTextures),H+=1,pe}function se(pe){const ie=[];return ie.push(pe.wrapS),ie.push(pe.wrapT),ie.push(pe.wrapR||0),ie.push(pe.magFilter),ie.push(pe.minFilter),ie.push(pe.anisotropy),ie.push(pe.internalFormat),ie.push(pe.format),ie.push(pe.type),ie.push(pe.generateMipmaps),ie.push(pe.premultiplyAlpha),ie.push(pe.flipY),ie.push(pe.unpackAlignment),ie.push(pe.colorSpace),ie.join()}function ee(pe,ie){const Ge=n.get(pe);if(pe.isVideoTexture&&Tt(pe),pe.isRenderTargetTexture===!1&&pe.version>0&&Ge.__version!==pe.version){const Qe=pe.image;if(Qe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Qe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ye(Ge,pe,ie);return}}t.bindTexture(i.TEXTURE_2D,Ge.__webglTexture,i.TEXTURE0+ie)}function $(pe,ie){const Ge=n.get(pe);if(pe.version>0&&Ge.__version!==pe.version){Ye(Ge,pe,ie);return}t.bindTexture(i.TEXTURE_2D_ARRAY,Ge.__webglTexture,i.TEXTURE0+ie)}function re(pe,ie){const Ge=n.get(pe);if(pe.version>0&&Ge.__version!==pe.version){Ye(Ge,pe,ie);return}t.bindTexture(i.TEXTURE_3D,Ge.__webglTexture,i.TEXTURE0+ie)}function ae(pe,ie){const Ge=n.get(pe);if(pe.version>0&&Ge.__version!==pe.version){at(Ge,pe,ie);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Ge.__webglTexture,i.TEXTURE0+ie)}const _e={[kA]:i.REPEAT,[Xu]:i.CLAMP_TO_EDGE,[GA]:i.MIRRORED_REPEAT},ne={[br]:i.NEAREST,[H4]:i.NEAREST_MIPMAP_NEAREST,[ph]:i.NEAREST_MIPMAP_LINEAR,[Ms]:i.LINEAR,[Zp]:i.LINEAR_MIPMAP_NEAREST,[ua]:i.LINEAR_MIPMAP_LINEAR},ye={[X4]:i.NEVER,[Z4]:i.ALWAYS,[oT]:i.LESS,[aT]:i.LEQUAL,[$4]:i.EQUAL,[K4]:i.GEQUAL,[Y4]:i.GREATER,[Q4]:i.NOTEQUAL};function ve(pe,ie){if(ie.type===os&&e.has("OES_texture_float_linear")===!1&&(ie.magFilter===Ms||ie.magFilter===Zp||ie.magFilter===ph||ie.magFilter===ua||ie.minFilter===Ms||ie.minFilter===Zp||ie.minFilter===ph||ie.minFilter===ua)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(pe,i.TEXTURE_WRAP_S,_e[ie.wrapS]),i.texParameteri(pe,i.TEXTURE_WRAP_T,_e[ie.wrapT]),(pe===i.TEXTURE_3D||pe===i.TEXTURE_2D_ARRAY)&&i.texParameteri(pe,i.TEXTURE_WRAP_R,_e[ie.wrapR]),i.texParameteri(pe,i.TEXTURE_MAG_FILTER,ne[ie.magFilter]),i.texParameteri(pe,i.TEXTURE_MIN_FILTER,ne[ie.minFilter]),ie.compareFunction&&(i.texParameteri(pe,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(pe,i.TEXTURE_COMPARE_FUNC,ye[ie.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ie.magFilter===br||ie.minFilter!==ph&&ie.minFilter!==ua||ie.type===os&&e.has("OES_texture_float_linear")===!1)return;if(ie.anisotropy>1||n.get(ie).__currentAnisotropy){const Ge=e.get("EXT_texture_filter_anisotropic");i.texParameterf(pe,Ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ie.anisotropy,r.getMaxAnisotropy())),n.get(ie).__currentAnisotropy=ie.anisotropy}}}function Pe(pe,ie){let Ge=!1;pe.__webglInit===void 0&&(pe.__webglInit=!0,ie.addEventListener("dispose",G));const Qe=ie.source;let nt=_.get(Qe);nt===void 0&&(nt={},_.set(Qe,nt));const Ke=se(ie);if(Ke!==pe.__cacheKey){nt[Ke]===void 0&&(nt[Ke]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,Ge=!0),nt[Ke].usedTimes++;const qt=nt[pe.__cacheKey];qt!==void 0&&(nt[pe.__cacheKey].usedTimes--,qt.usedTimes===0&&F(ie)),pe.__cacheKey=Ke,pe.__webglTexture=nt[Ke].texture}return Ge}function Se(pe,ie,Ge){return Math.floor(Math.floor(pe/Ge)/ie)}function Fe(pe,ie,Ge,Qe){const Ke=pe.updateRanges;if(Ke.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,ie.width,ie.height,Ge,Qe,ie.data);else{Ke.sort((_t,jt)=>_t.start-jt.start);let qt=0;for(let _t=1;_t<Ke.length;_t++){const jt=Ke[qt],un=Ke[_t],sn=jt.start+jt.count,It=Se(un.start,ie.width,4),Dn=Se(jt.start,ie.width,4);un.start<=sn+1&&It===Dn&&Se(un.start+un.count-1,ie.width,4)===It?jt.count=Math.max(jt.count,un.start+un.count-jt.start):(++qt,Ke[qt]=un)}Ke.length=qt+1;const Bt=i.getParameter(i.UNPACK_ROW_LENGTH),Zt=i.getParameter(i.UNPACK_SKIP_PIXELS),nn=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,ie.width);for(let _t=0,jt=Ke.length;_t<jt;_t++){const un=Ke[_t],sn=Math.floor(un.start/4),It=Math.ceil(un.count/4),Dn=sn%ie.width,fe=Math.floor(sn/ie.width),Ut=It,xt=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,Dn),i.pixelStorei(i.UNPACK_SKIP_ROWS,fe),t.texSubImage2D(i.TEXTURE_2D,0,Dn,fe,Ut,xt,Ge,Qe,ie.data)}pe.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,Bt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Zt),i.pixelStorei(i.UNPACK_SKIP_ROWS,nn)}}function Ye(pe,ie,Ge){let Qe=i.TEXTURE_2D;(ie.isDataArrayTexture||ie.isCompressedArrayTexture)&&(Qe=i.TEXTURE_2D_ARRAY),ie.isData3DTexture&&(Qe=i.TEXTURE_3D);const nt=Pe(pe,ie),Ke=ie.source;t.bindTexture(Qe,pe.__webglTexture,i.TEXTURE0+Ge);const qt=n.get(Ke);if(Ke.version!==qt.__version||nt===!0){t.activeTexture(i.TEXTURE0+Ge);const Bt=In.getPrimaries(In.workingColorSpace),Zt=ie.colorSpace===Go?null:In.getPrimaries(ie.colorSpace),nn=ie.colorSpace===Go||Bt===Zt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ie.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ie.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,nn);let _t=R(ie.image,!1,r.maxTextureSize);_t=Lt(ie,_t);const jt=s.convert(ie.format,ie.colorSpace),un=s.convert(ie.type);let sn=D(ie.internalFormat,jt,un,ie.colorSpace,ie.isVideoTexture);ve(Qe,ie);let It;const Dn=ie.mipmaps,fe=ie.isVideoTexture!==!0,Ut=qt.__version===void 0||nt===!0,xt=Ke.dataReady,Ht=B(ie,_t);if(ie.isDepthTexture)sn=O(ie.format===Ka,ie.type),Ut&&(fe?t.texStorage2D(i.TEXTURE_2D,1,sn,_t.width,_t.height):t.texImage2D(i.TEXTURE_2D,0,sn,_t.width,_t.height,0,jt,un,null));else if(ie.isDataTexture)if(Dn.length>0){fe&&Ut&&t.texStorage2D(i.TEXTURE_2D,Ht,sn,Dn[0].width,Dn[0].height);for(let Ct=0,ut=Dn.length;Ct<ut;Ct++)It=Dn[Ct],fe?xt&&t.texSubImage2D(i.TEXTURE_2D,Ct,0,0,It.width,It.height,jt,un,It.data):t.texImage2D(i.TEXTURE_2D,Ct,sn,It.width,It.height,0,jt,un,It.data);ie.generateMipmaps=!1}else fe?(Ut&&t.texStorage2D(i.TEXTURE_2D,Ht,sn,_t.width,_t.height),xt&&Fe(ie,_t,jt,un)):t.texImage2D(i.TEXTURE_2D,0,sn,_t.width,_t.height,0,jt,un,_t.data);else if(ie.isCompressedTexture)if(ie.isCompressedArrayTexture){fe&&Ut&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Ht,sn,Dn[0].width,Dn[0].height,_t.depth);for(let Ct=0,ut=Dn.length;Ct<ut;Ct++)if(It=Dn[Ct],ie.format!==es)if(jt!==null)if(fe){if(xt)if(ie.layerUpdates.size>0){const kt=DL(It.width,It.height,ie.format,ie.type);for(const hn of ie.layerUpdates){const $n=It.data.subarray(hn*kt/It.data.BYTES_PER_ELEMENT,(hn+1)*kt/It.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ct,0,0,hn,It.width,It.height,1,jt,$n)}ie.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ct,0,0,0,It.width,It.height,_t.depth,jt,It.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Ct,sn,It.width,It.height,_t.depth,0,It.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else fe?xt&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Ct,0,0,0,It.width,It.height,_t.depth,jt,un,It.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Ct,sn,It.width,It.height,_t.depth,0,jt,un,It.data)}else{fe&&Ut&&t.texStorage2D(i.TEXTURE_2D,Ht,sn,Dn[0].width,Dn[0].height);for(let Ct=0,ut=Dn.length;Ct<ut;Ct++)It=Dn[Ct],ie.format!==es?jt!==null?fe?xt&&t.compressedTexSubImage2D(i.TEXTURE_2D,Ct,0,0,It.width,It.height,jt,It.data):t.compressedTexImage2D(i.TEXTURE_2D,Ct,sn,It.width,It.height,0,It.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):fe?xt&&t.texSubImage2D(i.TEXTURE_2D,Ct,0,0,It.width,It.height,jt,un,It.data):t.texImage2D(i.TEXTURE_2D,Ct,sn,It.width,It.height,0,jt,un,It.data)}else if(ie.isDataArrayTexture)if(fe){if(Ut&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Ht,sn,_t.width,_t.height,_t.depth),xt)if(ie.layerUpdates.size>0){const Ct=DL(_t.width,_t.height,ie.format,ie.type);for(const ut of ie.layerUpdates){const kt=_t.data.subarray(ut*Ct/_t.data.BYTES_PER_ELEMENT,(ut+1)*Ct/_t.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,ut,_t.width,_t.height,1,jt,un,kt)}ie.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,_t.width,_t.height,_t.depth,jt,un,_t.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,sn,_t.width,_t.height,_t.depth,0,jt,un,_t.data);else if(ie.isData3DTexture)fe?(Ut&&t.texStorage3D(i.TEXTURE_3D,Ht,sn,_t.width,_t.height,_t.depth),xt&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,_t.width,_t.height,_t.depth,jt,un,_t.data)):t.texImage3D(i.TEXTURE_3D,0,sn,_t.width,_t.height,_t.depth,0,jt,un,_t.data);else if(ie.isFramebufferTexture){if(Ut)if(fe)t.texStorage2D(i.TEXTURE_2D,Ht,sn,_t.width,_t.height);else{let Ct=_t.width,ut=_t.height;for(let kt=0;kt<Ht;kt++)t.texImage2D(i.TEXTURE_2D,kt,sn,Ct,ut,0,jt,un,null),Ct>>=1,ut>>=1}}else if(Dn.length>0){if(fe&&Ut){const Ct=_n(Dn[0]);t.texStorage2D(i.TEXTURE_2D,Ht,sn,Ct.width,Ct.height)}for(let Ct=0,ut=Dn.length;Ct<ut;Ct++)It=Dn[Ct],fe?xt&&t.texSubImage2D(i.TEXTURE_2D,Ct,0,0,jt,un,It):t.texImage2D(i.TEXTURE_2D,Ct,sn,jt,un,It);ie.generateMipmaps=!1}else if(fe){if(Ut){const Ct=_n(_t);t.texStorage2D(i.TEXTURE_2D,Ht,sn,Ct.width,Ct.height)}xt&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,jt,un,_t)}else t.texImage2D(i.TEXTURE_2D,0,sn,jt,un,_t);E(ie)&&w(Qe),qt.__version=Ke.version,ie.onUpdate&&ie.onUpdate(ie)}pe.__version=ie.version}function at(pe,ie,Ge){if(ie.image.length!==6)return;const Qe=Pe(pe,ie),nt=ie.source;t.bindTexture(i.TEXTURE_CUBE_MAP,pe.__webglTexture,i.TEXTURE0+Ge);const Ke=n.get(nt);if(nt.version!==Ke.__version||Qe===!0){t.activeTexture(i.TEXTURE0+Ge);const qt=In.getPrimaries(In.workingColorSpace),Bt=ie.colorSpace===Go?null:In.getPrimaries(ie.colorSpace),Zt=ie.colorSpace===Go||qt===Bt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ie.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ie.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Zt);const nn=ie.isCompressedTexture||ie.image[0].isCompressedTexture,_t=ie.image[0]&&ie.image[0].isDataTexture,jt=[];for(let ut=0;ut<6;ut++)!nn&&!_t?jt[ut]=R(ie.image[ut],!0,r.maxCubemapSize):jt[ut]=_t?ie.image[ut].image:ie.image[ut],jt[ut]=Lt(ie,jt[ut]);const un=jt[0],sn=s.convert(ie.format,ie.colorSpace),It=s.convert(ie.type),Dn=D(ie.internalFormat,sn,It,ie.colorSpace),fe=ie.isVideoTexture!==!0,Ut=Ke.__version===void 0||Qe===!0,xt=nt.dataReady;let Ht=B(ie,un);ve(i.TEXTURE_CUBE_MAP,ie);let Ct;if(nn){fe&&Ut&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Ht,Dn,un.width,un.height);for(let ut=0;ut<6;ut++){Ct=jt[ut].mipmaps;for(let kt=0;kt<Ct.length;kt++){const hn=Ct[kt];ie.format!==es?sn!==null?fe?xt&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt,0,0,hn.width,hn.height,sn,hn.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt,Dn,hn.width,hn.height,0,hn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fe?xt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt,0,0,hn.width,hn.height,sn,It,hn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt,Dn,hn.width,hn.height,0,sn,It,hn.data)}}}else{if(Ct=ie.mipmaps,fe&&Ut){Ct.length>0&&Ht++;const ut=_n(jt[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Ht,Dn,ut.width,ut.height)}for(let ut=0;ut<6;ut++)if(_t){fe?xt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,jt[ut].width,jt[ut].height,sn,It,jt[ut].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,Dn,jt[ut].width,jt[ut].height,0,sn,It,jt[ut].data);for(let kt=0;kt<Ct.length;kt++){const $n=Ct[kt].image[ut].image;fe?xt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt+1,0,0,$n.width,$n.height,sn,It,$n.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt+1,Dn,$n.width,$n.height,0,sn,It,$n.data)}}else{fe?xt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,sn,It,jt[ut]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,Dn,sn,It,jt[ut]);for(let kt=0;kt<Ct.length;kt++){const hn=Ct[kt];fe?xt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt+1,0,0,sn,It,hn.image[ut]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,kt+1,Dn,sn,It,hn.image[ut])}}}E(ie)&&w(i.TEXTURE_CUBE_MAP),Ke.__version=nt.version,ie.onUpdate&&ie.onUpdate(ie)}pe.__version=ie.version}function At(pe,ie,Ge,Qe,nt,Ke){const qt=s.convert(Ge.format,Ge.colorSpace),Bt=s.convert(Ge.type),Zt=D(Ge.internalFormat,qt,Bt,Ge.colorSpace),nn=n.get(ie),_t=n.get(Ge);if(_t.__renderTarget=ie,!nn.__hasExternalTextures){const jt=Math.max(1,ie.width>>Ke),un=Math.max(1,ie.height>>Ke);nt===i.TEXTURE_3D||nt===i.TEXTURE_2D_ARRAY?t.texImage3D(nt,Ke,Zt,jt,un,ie.depth,0,qt,Bt,null):t.texImage2D(nt,Ke,Zt,jt,un,0,qt,Bt,null)}t.bindFramebuffer(i.FRAMEBUFFER,pe),Ft(ie)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Qe,nt,_t.__webglTexture,0,et(ie)):(nt===i.TEXTURE_2D||nt>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&nt<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Qe,nt,_t.__webglTexture,Ke),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Gt(pe,ie,Ge){if(i.bindRenderbuffer(i.RENDERBUFFER,pe),ie.depthBuffer){const Qe=ie.depthTexture,nt=Qe&&Qe.isDepthTexture?Qe.type:null,Ke=O(ie.stencilBuffer,nt),qt=ie.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Bt=et(ie);Ft(ie)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Bt,Ke,ie.width,ie.height):Ge?i.renderbufferStorageMultisample(i.RENDERBUFFER,Bt,Ke,ie.width,ie.height):i.renderbufferStorage(i.RENDERBUFFER,Ke,ie.width,ie.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,qt,i.RENDERBUFFER,pe)}else{const Qe=ie.textures;for(let nt=0;nt<Qe.length;nt++){const Ke=Qe[nt],qt=s.convert(Ke.format,Ke.colorSpace),Bt=s.convert(Ke.type),Zt=D(Ke.internalFormat,qt,Bt,Ke.colorSpace),nn=et(ie);Ge&&Ft(ie)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,nn,Zt,ie.width,ie.height):Ft(ie)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,nn,Zt,ie.width,ie.height):i.renderbufferStorage(i.RENDERBUFFER,Zt,ie.width,ie.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Dt(pe,ie){if(ie&&ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,pe),!(ie.depthTexture&&ie.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Qe=n.get(ie.depthTexture);Qe.__renderTarget=ie,(!Qe.__webglTexture||ie.depthTexture.image.width!==ie.width||ie.depthTexture.image.height!==ie.height)&&(ie.depthTexture.image.width=ie.width,ie.depthTexture.image.height=ie.height,ie.depthTexture.needsUpdate=!0),ee(ie.depthTexture,0);const nt=Qe.__webglTexture,Ke=et(ie);if(ie.depthTexture.format===Qa)Ft(ie)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,nt,0,Ke):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,nt,0);else if(ie.depthTexture.format===Ka)Ft(ie)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,nt,0,Ke):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,nt,0);else throw new Error("Unknown depthTexture format")}function Nn(pe){const ie=n.get(pe),Ge=pe.isWebGLCubeRenderTarget===!0;if(ie.__boundDepthTexture!==pe.depthTexture){const Qe=pe.depthTexture;if(ie.__depthDisposeCallback&&ie.__depthDisposeCallback(),Qe){const nt=()=>{delete ie.__boundDepthTexture,delete ie.__depthDisposeCallback,Qe.removeEventListener("dispose",nt)};Qe.addEventListener("dispose",nt),ie.__depthDisposeCallback=nt}ie.__boundDepthTexture=Qe}if(pe.depthTexture&&!ie.__autoAllocateDepthBuffer){if(Ge)throw new Error("target.depthTexture not supported in Cube render targets");const Qe=pe.texture.mipmaps;Qe&&Qe.length>0?Dt(ie.__webglFramebuffer[0],pe):Dt(ie.__webglFramebuffer,pe)}else if(Ge){ie.__webglDepthbuffer=[];for(let Qe=0;Qe<6;Qe++)if(t.bindFramebuffer(i.FRAMEBUFFER,ie.__webglFramebuffer[Qe]),ie.__webglDepthbuffer[Qe]===void 0)ie.__webglDepthbuffer[Qe]=i.createRenderbuffer(),Gt(ie.__webglDepthbuffer[Qe],pe,!1);else{const nt=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ke=ie.__webglDepthbuffer[Qe];i.bindRenderbuffer(i.RENDERBUFFER,Ke),i.framebufferRenderbuffer(i.FRAMEBUFFER,nt,i.RENDERBUFFER,Ke)}}else{const Qe=pe.texture.mipmaps;if(Qe&&Qe.length>0?t.bindFramebuffer(i.FRAMEBUFFER,ie.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,ie.__webglFramebuffer),ie.__webglDepthbuffer===void 0)ie.__webglDepthbuffer=i.createRenderbuffer(),Gt(ie.__webglDepthbuffer,pe,!1);else{const nt=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ke=ie.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Ke),i.framebufferRenderbuffer(i.FRAMEBUFFER,nt,i.RENDERBUFFER,Ke)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function bn(pe,ie,Ge){const Qe=n.get(pe);ie!==void 0&&At(Qe.__webglFramebuffer,pe,pe.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Ge!==void 0&&Nn(pe)}function $t(pe){const ie=pe.texture,Ge=n.get(pe),Qe=n.get(ie);pe.addEventListener("dispose",k);const nt=pe.textures,Ke=pe.isWebGLCubeRenderTarget===!0,qt=nt.length>1;if(qt||(Qe.__webglTexture===void 0&&(Qe.__webglTexture=i.createTexture()),Qe.__version=ie.version,o.memory.textures++),Ke){Ge.__webglFramebuffer=[];for(let Bt=0;Bt<6;Bt++)if(ie.mipmaps&&ie.mipmaps.length>0){Ge.__webglFramebuffer[Bt]=[];for(let Zt=0;Zt<ie.mipmaps.length;Zt++)Ge.__webglFramebuffer[Bt][Zt]=i.createFramebuffer()}else Ge.__webglFramebuffer[Bt]=i.createFramebuffer()}else{if(ie.mipmaps&&ie.mipmaps.length>0){Ge.__webglFramebuffer=[];for(let Bt=0;Bt<ie.mipmaps.length;Bt++)Ge.__webglFramebuffer[Bt]=i.createFramebuffer()}else Ge.__webglFramebuffer=i.createFramebuffer();if(qt)for(let Bt=0,Zt=nt.length;Bt<Zt;Bt++){const nn=n.get(nt[Bt]);nn.__webglTexture===void 0&&(nn.__webglTexture=i.createTexture(),o.memory.textures++)}if(pe.samples>0&&Ft(pe)===!1){Ge.__webglMultisampledFramebuffer=i.createFramebuffer(),Ge.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer);for(let Bt=0;Bt<nt.length;Bt++){const Zt=nt[Bt];Ge.__webglColorRenderbuffer[Bt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Ge.__webglColorRenderbuffer[Bt]);const nn=s.convert(Zt.format,Zt.colorSpace),_t=s.convert(Zt.type),jt=D(Zt.internalFormat,nn,_t,Zt.colorSpace,pe.isXRRenderTarget===!0),un=et(pe);i.renderbufferStorageMultisample(i.RENDERBUFFER,un,jt,pe.width,pe.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Bt,i.RENDERBUFFER,Ge.__webglColorRenderbuffer[Bt])}i.bindRenderbuffer(i.RENDERBUFFER,null),pe.depthBuffer&&(Ge.__webglDepthRenderbuffer=i.createRenderbuffer(),Gt(Ge.__webglDepthRenderbuffer,pe,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Ke){t.bindTexture(i.TEXTURE_CUBE_MAP,Qe.__webglTexture),ve(i.TEXTURE_CUBE_MAP,ie);for(let Bt=0;Bt<6;Bt++)if(ie.mipmaps&&ie.mipmaps.length>0)for(let Zt=0;Zt<ie.mipmaps.length;Zt++)At(Ge.__webglFramebuffer[Bt][Zt],pe,ie,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Bt,Zt);else At(Ge.__webglFramebuffer[Bt],pe,ie,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Bt,0);E(ie)&&w(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(qt){for(let Bt=0,Zt=nt.length;Bt<Zt;Bt++){const nn=nt[Bt],_t=n.get(nn);t.bindTexture(i.TEXTURE_2D,_t.__webglTexture),ve(i.TEXTURE_2D,nn),At(Ge.__webglFramebuffer,pe,nn,i.COLOR_ATTACHMENT0+Bt,i.TEXTURE_2D,0),E(nn)&&w(i.TEXTURE_2D)}t.unbindTexture()}else{let Bt=i.TEXTURE_2D;if((pe.isWebGL3DRenderTarget||pe.isWebGLArrayRenderTarget)&&(Bt=pe.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Bt,Qe.__webglTexture),ve(Bt,ie),ie.mipmaps&&ie.mipmaps.length>0)for(let Zt=0;Zt<ie.mipmaps.length;Zt++)At(Ge.__webglFramebuffer[Zt],pe,ie,i.COLOR_ATTACHMENT0,Bt,Zt);else At(Ge.__webglFramebuffer,pe,ie,i.COLOR_ATTACHMENT0,Bt,0);E(ie)&&w(Bt),t.unbindTexture()}pe.depthBuffer&&Nn(pe)}function he(pe){const ie=pe.textures;for(let Ge=0,Qe=ie.length;Ge<Qe;Ge++){const nt=ie[Ge];if(E(nt)){const Ke=L(pe),qt=n.get(nt).__webglTexture;t.bindTexture(Ke,qt),w(Ke),t.unbindTexture()}}}const vt=[],ft=[];function pt(pe){if(pe.samples>0){if(Ft(pe)===!1){const ie=pe.textures,Ge=pe.width,Qe=pe.height;let nt=i.COLOR_BUFFER_BIT;const Ke=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,qt=n.get(pe),Bt=ie.length>1;if(Bt)for(let nn=0;nn<ie.length;nn++)t.bindFramebuffer(i.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+nn,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,qt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+nn,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,qt.__webglMultisampledFramebuffer);const Zt=pe.texture.mipmaps;Zt&&Zt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,qt.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,qt.__webglFramebuffer);for(let nn=0;nn<ie.length;nn++){if(pe.resolveDepthBuffer&&(pe.depthBuffer&&(nt|=i.DEPTH_BUFFER_BIT),pe.stencilBuffer&&pe.resolveStencilBuffer&&(nt|=i.STENCIL_BUFFER_BIT)),Bt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,qt.__webglColorRenderbuffer[nn]);const _t=n.get(ie[nn]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,_t,0)}i.blitFramebuffer(0,0,Ge,Qe,0,0,Ge,Qe,nt,i.NEAREST),l===!0&&(vt.length=0,ft.length=0,vt.push(i.COLOR_ATTACHMENT0+nn),pe.depthBuffer&&pe.resolveDepthBuffer===!1&&(vt.push(Ke),ft.push(Ke),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,ft)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,vt))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Bt)for(let nn=0;nn<ie.length;nn++){t.bindFramebuffer(i.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+nn,i.RENDERBUFFER,qt.__webglColorRenderbuffer[nn]);const _t=n.get(ie[nn]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,qt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+nn,i.TEXTURE_2D,_t,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,qt.__webglMultisampledFramebuffer)}else if(pe.depthBuffer&&pe.resolveDepthBuffer===!1&&l){const ie=pe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[ie])}}}function et(pe){return Math.min(r.maxSamples,pe.samples)}function Ft(pe){const ie=n.get(pe);return pe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ie.__useRenderToTexture!==!1}function Tt(pe){const ie=o.render.frame;h.get(pe)!==ie&&(h.set(pe,ie),pe.update())}function Lt(pe,ie){const Ge=pe.colorSpace,Qe=pe.format,nt=pe.type;return pe.isCompressedTexture===!0||pe.isVideoTexture===!0||Ge!==pu&&Ge!==Go&&(In.getTransfer(Ge)===Qt?(Qe!==es||nt!==Vr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ge)),ie}function _n(pe){return typeof HTMLImageElement<"u"&&pe instanceof HTMLImageElement?(u.width=pe.naturalWidth||pe.width,u.height=pe.naturalHeight||pe.height):typeof VideoFrame<"u"&&pe instanceof VideoFrame?(u.width=pe.displayWidth,u.height=pe.displayHeight):(u.width=pe.width,u.height=pe.height),u}this.allocateTextureUnit=K,this.resetTextureUnits=Q,this.setTexture2D=ee,this.setTexture2DArray=$,this.setTexture3D=re,this.setTextureCube=ae,this.rebindTextures=bn,this.setupRenderTarget=$t,this.updateRenderTargetMipmap=he,this.updateMultisampleRenderTarget=pt,this.setupDepthRenderbuffer=Nn,this.setupFrameBufferTexture=At,this.useMultisampledRTT=Ft}function Yee(i,e){function t(n,r=Go){let s;const o=In.getTransfer(r);if(n===Vr)return i.UNSIGNED_BYTE;if(n===iT)return i.UNSIGNED_SHORT_4_4_4_4;if(n===rT)return i.UNSIGNED_SHORT_5_5_5_1;if(n===sT)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===EA)return i.BYTE;if(n===wA)return i.SHORT;if(n===hu)return i.UNSIGNED_SHORT;if(n===Hs)return i.INT;if(n===mr)return i.UNSIGNED_INT;if(n===os)return i.FLOAT;if(n===As)return i.HALF_FLOAT;if(n===W4)return i.ALPHA;if(n===qy)return i.RGB;if(n===es)return i.RGBA;if(n===Qa)return i.DEPTH_COMPONENT;if(n===Ka)return i.DEPTH_STENCIL;if(n===Hy)return i.RED;if(n===ag)return i.RED_INTEGER;if(n===mh)return i.RG;if(n===lg)return i.RG_INTEGER;if(n===ug)return i.RGBA_INTEGER;if(n===MA||n===Kf||n===Zf||n===Jf)if(o===Qt)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===MA)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Kf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Zf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Jf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===MA)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Kf)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Zf)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Jf)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===$_||n===Y_||n===Q_||n===K_)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===$_)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Y_)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Q_)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===K_)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Z_||n===mm||n===gm)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===Z_||n===mm)return o===Qt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===gm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===_m||n===ym||n===vm||n===xm||n===bm||n===Sm||n===Tm||n===Em||n===wm||n===Mm||n===Rm||n===Cm||n===Nm||n===Dm)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===_m)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ym)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===vm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===xm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===bm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Sm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Tm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Em)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===wm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Mm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Rm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Cm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Nm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Dm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===RA||n===BR||n===UR)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===RA)return o===Qt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===BR)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===UR)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===j4||n===J_||n===ey||n===ty)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===RA)return s.COMPRESSED_RED_RGTC1_EXT;if(n===J_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ey)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===ty)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Ya?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const Qee=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Kee=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Zee{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new ps,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ya({vertexShader:Qee,fragmentShader:Kee,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ri(new $y(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Jee extends gc{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,h=null,d=null,_=null,x=null,b=null;const R=new Zee,E=t.getContextAttributes();let w=null,L=null;const D=[],O=[],B=new it;let G=null;const k=new Ws;k.viewport=new mn;const z=new Ws;z.viewport=new mn;const F=[k,z],q=new R9;let H=null,Q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Se){let Fe=D[Se];return Fe===void 0&&(Fe=new _b,D[Se]=Fe),Fe.getTargetRaySpace()},this.getControllerGrip=function(Se){let Fe=D[Se];return Fe===void 0&&(Fe=new _b,D[Se]=Fe),Fe.getGripSpace()},this.getHand=function(Se){let Fe=D[Se];return Fe===void 0&&(Fe=new _b,D[Se]=Fe),Fe.getHandSpace()};function K(Se){const Fe=O.indexOf(Se.inputSource);if(Fe===-1)return;const Ye=D[Fe];Ye!==void 0&&(Ye.update(Se.inputSource,Se.frame,u||o),Ye.dispatchEvent({type:Se.type,data:Se.inputSource}))}function se(){r.removeEventListener("select",K),r.removeEventListener("selectstart",K),r.removeEventListener("selectend",K),r.removeEventListener("squeeze",K),r.removeEventListener("squeezestart",K),r.removeEventListener("squeezeend",K),r.removeEventListener("end",se),r.removeEventListener("inputsourceschange",ee);for(let Se=0;Se<D.length;Se++){const Fe=O[Se];Fe!==null&&(O[Se]=null,D[Se].disconnect(Fe))}H=null,Q=null,R.reset(),e.setRenderTarget(w),x=null,_=null,d=null,r=null,L=null,Pe.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(B.width,B.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Se){s=Se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Se){a=Se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(Se){u=Se},this.getBaseLayer=function(){return _!==null?_:x},this.getBinding=function(){return d},this.getFrame=function(){return b},this.getSession=function(){return r},this.setSession=async function(Se){if(r=Se,r!==null){if(w=e.getRenderTarget(),r.addEventListener("select",K),r.addEventListener("selectstart",K),r.addEventListener("selectend",K),r.addEventListener("squeeze",K),r.addEventListener("squeezestart",K),r.addEventListener("squeezeend",K),r.addEventListener("end",se),r.addEventListener("inputsourceschange",ee),E.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(B),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ye=null,at=null,At=null;E.depth&&(At=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ye=E.stencil?Ka:Qa,at=E.stencil?Ya:mr);const Gt={colorFormat:t.RGBA8,depthFormat:At,scaleFactor:s};d=new XRWebGLBinding(r,t),_=d.createProjectionLayer(Gt),r.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),L=new ad(_.textureWidth,_.textureHeight,{format:es,type:Vr,depthTexture:new Ja(_.textureWidth,_.textureHeight,at,void 0,void 0,void 0,void 0,void 0,void 0,Ye),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const Ye={antialias:E.antialias,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:s};x=new XRWebGLLayer(r,t,Ye),r.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),L=new ad(x.framebufferWidth,x.framebufferHeight,{format:es,type:Vr,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}L.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),Pe.setContext(r),Pe.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return R.getDepthTexture()};function ee(Se){for(let Fe=0;Fe<Se.removed.length;Fe++){const Ye=Se.removed[Fe],at=O.indexOf(Ye);at>=0&&(O[at]=null,D[at].disconnect(Ye))}for(let Fe=0;Fe<Se.added.length;Fe++){const Ye=Se.added[Fe];let at=O.indexOf(Ye);if(at===-1){for(let Gt=0;Gt<D.length;Gt++)if(Gt>=O.length){O.push(Ye),at=Gt;break}else if(O[Gt]===null){O[Gt]=Ye,at=Gt;break}if(at===-1)break}const At=D[at];At&&At.connect(Ye)}}const $=new ce,re=new ce;function ae(Se,Fe,Ye){$.setFromMatrixPosition(Fe.matrixWorld),re.setFromMatrixPosition(Ye.matrixWorld);const at=$.distanceTo(re),At=Fe.projectionMatrix.elements,Gt=Ye.projectionMatrix.elements,Dt=At[14]/(At[10]-1),Nn=At[14]/(At[10]+1),bn=(At[9]+1)/At[5],$t=(At[9]-1)/At[5],he=(At[8]-1)/At[0],vt=(Gt[8]+1)/Gt[0],ft=Dt*he,pt=Dt*vt,et=at/(-he+vt),Ft=et*-he;if(Fe.matrixWorld.decompose(Se.position,Se.quaternion,Se.scale),Se.translateX(Ft),Se.translateZ(et),Se.matrixWorld.compose(Se.position,Se.quaternion,Se.scale),Se.matrixWorldInverse.copy(Se.matrixWorld).invert(),At[10]===-1)Se.projectionMatrix.copy(Fe.projectionMatrix),Se.projectionMatrixInverse.copy(Fe.projectionMatrixInverse);else{const Tt=Dt+et,Lt=Nn+et,_n=ft-Ft,pe=pt+(at-Ft),ie=bn*Nn/Lt*Tt,Ge=$t*Nn/Lt*Tt;Se.projectionMatrix.makePerspective(_n,pe,ie,Ge,Tt,Lt),Se.projectionMatrixInverse.copy(Se.projectionMatrix).invert()}}function _e(Se,Fe){Fe===null?Se.matrixWorld.copy(Se.matrix):Se.matrixWorld.multiplyMatrices(Fe.matrixWorld,Se.matrix),Se.matrixWorldInverse.copy(Se.matrixWorld).invert()}this.updateCamera=function(Se){if(r===null)return;let Fe=Se.near,Ye=Se.far;R.texture!==null&&(R.depthNear>0&&(Fe=R.depthNear),R.depthFar>0&&(Ye=R.depthFar)),q.near=z.near=k.near=Fe,q.far=z.far=k.far=Ye,(H!==q.near||Q!==q.far)&&(r.updateRenderState({depthNear:q.near,depthFar:q.far}),H=q.near,Q=q.far),k.layers.mask=Se.layers.mask|2,z.layers.mask=Se.layers.mask|4,q.layers.mask=k.layers.mask|z.layers.mask;const at=Se.parent,At=q.cameras;_e(q,at);for(let Gt=0;Gt<At.length;Gt++)_e(At[Gt],at);At.length===2?ae(q,k,z):q.projectionMatrix.copy(k.projectionMatrix),ne(Se,q,at)};function ne(Se,Fe,Ye){Ye===null?Se.matrix.copy(Fe.matrixWorld):(Se.matrix.copy(Ye.matrixWorld),Se.matrix.invert(),Se.matrix.multiply(Fe.matrixWorld)),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Se.updateMatrixWorld(!0),Se.projectionMatrix.copy(Fe.projectionMatrix),Se.projectionMatrixInverse.copy(Fe.projectionMatrixInverse),Se.isPerspectiveCamera&&(Se.fov=zA*2*Math.atan(1/Se.projectionMatrix.elements[5]),Se.zoom=1)}this.getCamera=function(){return q},this.getFoveation=function(){if(!(_===null&&x===null))return l},this.setFoveation=function(Se){l=Se,_!==null&&(_.fixedFoveation=Se),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=Se)},this.hasDepthSensing=function(){return R.texture!==null},this.getDepthSensingMesh=function(){return R.getMesh(q)};let ye=null;function ve(Se,Fe){if(h=Fe.getViewerPose(u||o),b=Fe,h!==null){const Ye=h.views;x!==null&&(e.setRenderTargetFramebuffer(L,x.framebuffer),e.setRenderTarget(L));let at=!1;Ye.length!==q.cameras.length&&(q.cameras.length=0,at=!0);for(let Dt=0;Dt<Ye.length;Dt++){const Nn=Ye[Dt];let bn=null;if(x!==null)bn=x.getViewport(Nn);else{const he=d.getViewSubImage(_,Nn);bn=he.viewport,Dt===0&&(e.setRenderTargetTextures(L,he.colorTexture,he.depthStencilTexture),e.setRenderTarget(L))}let $t=F[Dt];$t===void 0&&($t=new Ws,$t.layers.enable(Dt),$t.viewport=new mn,F[Dt]=$t),$t.matrix.fromArray(Nn.transform.matrix),$t.matrix.decompose($t.position,$t.quaternion,$t.scale),$t.projectionMatrix.fromArray(Nn.projectionMatrix),$t.projectionMatrixInverse.copy($t.projectionMatrix).invert(),$t.viewport.set(bn.x,bn.y,bn.width,bn.height),Dt===0&&(q.matrix.copy($t.matrix),q.matrix.decompose(q.position,q.quaternion,q.scale)),at===!0&&q.cameras.push($t)}const At=r.enabledFeatures;if(At&&At.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&d){const Dt=d.getDepthInformation(Ye[0]);Dt&&Dt.isValid&&Dt.texture&&R.init(e,Dt,r.renderState)}}for(let Ye=0;Ye<D.length;Ye++){const at=O[Ye],At=D[Ye];at!==null&&At!==void 0&&At.update(at,Fe,u||o)}ye&&ye(Se,Fe),Fe.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Fe}),b=null}const Pe=new N9;Pe.setAnimationLoop(ve),this.setAnimationLoop=function(Se){ye=Se},this.dispose=function(){}}}const Vd=new ao,ete=new Cn;function tte(i,e){function t(E,w){E.matrixAutoUpdate===!0&&E.updateMatrix(),w.value.copy(E.matrix)}function n(E,w){w.color.getRGB(E.fogColor.value,c9(i)),w.isFog?(E.fogNear.value=w.near,E.fogFar.value=w.far):w.isFogExp2&&(E.fogDensity.value=w.density)}function r(E,w,L,D,O){w.isMeshBasicMaterial||w.isMeshLambertMaterial?s(E,w):w.isMeshToonMaterial?(s(E,w),d(E,w)):w.isMeshPhongMaterial?(s(E,w),h(E,w)):w.isMeshStandardMaterial?(s(E,w),_(E,w),w.isMeshPhysicalMaterial&&x(E,w,O)):w.isMeshMatcapMaterial?(s(E,w),b(E,w)):w.isMeshDepthMaterial?s(E,w):w.isMeshDistanceMaterial?(s(E,w),R(E,w)):w.isMeshNormalMaterial?s(E,w):w.isLineBasicMaterial?(o(E,w),w.isLineDashedMaterial&&a(E,w)):w.isPointsMaterial?l(E,w,L,D):w.isSpriteMaterial?u(E,w):w.isShadowMaterial?(E.color.value.copy(w.color),E.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}function s(E,w){E.opacity.value=w.opacity,w.color&&E.diffuse.value.copy(w.color),w.emissive&&E.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(E.map.value=w.map,t(w.map,E.mapTransform)),w.alphaMap&&(E.alphaMap.value=w.alphaMap,t(w.alphaMap,E.alphaMapTransform)),w.bumpMap&&(E.bumpMap.value=w.bumpMap,t(w.bumpMap,E.bumpMapTransform),E.bumpScale.value=w.bumpScale,w.side===Zi&&(E.bumpScale.value*=-1)),w.normalMap&&(E.normalMap.value=w.normalMap,t(w.normalMap,E.normalMapTransform),E.normalScale.value.copy(w.normalScale),w.side===Zi&&E.normalScale.value.negate()),w.displacementMap&&(E.displacementMap.value=w.displacementMap,t(w.displacementMap,E.displacementMapTransform),E.displacementScale.value=w.displacementScale,E.displacementBias.value=w.displacementBias),w.emissiveMap&&(E.emissiveMap.value=w.emissiveMap,t(w.emissiveMap,E.emissiveMapTransform)),w.specularMap&&(E.specularMap.value=w.specularMap,t(w.specularMap,E.specularMapTransform)),w.alphaTest>0&&(E.alphaTest.value=w.alphaTest);const L=e.get(w),D=L.envMap,O=L.envMapRotation;D&&(E.envMap.value=D,Vd.copy(O),Vd.x*=-1,Vd.y*=-1,Vd.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(Vd.y*=-1,Vd.z*=-1),E.envMapRotation.value.setFromMatrix4(ete.makeRotationFromEuler(Vd)),E.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=w.reflectivity,E.ior.value=w.ior,E.refractionRatio.value=w.refractionRatio),w.lightMap&&(E.lightMap.value=w.lightMap,E.lightMapIntensity.value=w.lightMapIntensity,t(w.lightMap,E.lightMapTransform)),w.aoMap&&(E.aoMap.value=w.aoMap,E.aoMapIntensity.value=w.aoMapIntensity,t(w.aoMap,E.aoMapTransform))}function o(E,w){E.diffuse.value.copy(w.color),E.opacity.value=w.opacity,w.map&&(E.map.value=w.map,t(w.map,E.mapTransform))}function a(E,w){E.dashSize.value=w.dashSize,E.totalSize.value=w.dashSize+w.gapSize,E.scale.value=w.scale}function l(E,w,L,D){E.diffuse.value.copy(w.color),E.opacity.value=w.opacity,E.size.value=w.size*L,E.scale.value=D*.5,w.map&&(E.map.value=w.map,t(w.map,E.uvTransform)),w.alphaMap&&(E.alphaMap.value=w.alphaMap,t(w.alphaMap,E.alphaMapTransform)),w.alphaTest>0&&(E.alphaTest.value=w.alphaTest)}function u(E,w){E.diffuse.value.copy(w.color),E.opacity.value=w.opacity,E.rotation.value=w.rotation,w.map&&(E.map.value=w.map,t(w.map,E.mapTransform)),w.alphaMap&&(E.alphaMap.value=w.alphaMap,t(w.alphaMap,E.alphaMapTransform)),w.alphaTest>0&&(E.alphaTest.value=w.alphaTest)}function h(E,w){E.specular.value.copy(w.specular),E.shininess.value=Math.max(w.shininess,1e-4)}function d(E,w){w.gradientMap&&(E.gradientMap.value=w.gradientMap)}function _(E,w){E.metalness.value=w.metalness,w.metalnessMap&&(E.metalnessMap.value=w.metalnessMap,t(w.metalnessMap,E.metalnessMapTransform)),E.roughness.value=w.roughness,w.roughnessMap&&(E.roughnessMap.value=w.roughnessMap,t(w.roughnessMap,E.roughnessMapTransform)),w.envMap&&(E.envMapIntensity.value=w.envMapIntensity)}function x(E,w,L){E.ior.value=w.ior,w.sheen>0&&(E.sheenColor.value.copy(w.sheenColor).multiplyScalar(w.sheen),E.sheenRoughness.value=w.sheenRoughness,w.sheenColorMap&&(E.sheenColorMap.value=w.sheenColorMap,t(w.sheenColorMap,E.sheenColorMapTransform)),w.sheenRoughnessMap&&(E.sheenRoughnessMap.value=w.sheenRoughnessMap,t(w.sheenRoughnessMap,E.sheenRoughnessMapTransform))),w.clearcoat>0&&(E.clearcoat.value=w.clearcoat,E.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(E.clearcoatMap.value=w.clearcoatMap,t(w.clearcoatMap,E.clearcoatMapTransform)),w.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap,t(w.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),w.clearcoatNormalMap&&(E.clearcoatNormalMap.value=w.clearcoatNormalMap,t(w.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),w.side===Zi&&E.clearcoatNormalScale.value.negate())),w.dispersion>0&&(E.dispersion.value=w.dispersion),w.iridescence>0&&(E.iridescence.value=w.iridescence,E.iridescenceIOR.value=w.iridescenceIOR,E.iridescenceThicknessMinimum.value=w.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=w.iridescenceThicknessRange[1],w.iridescenceMap&&(E.iridescenceMap.value=w.iridescenceMap,t(w.iridescenceMap,E.iridescenceMapTransform)),w.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=w.iridescenceThicknessMap,t(w.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),w.transmission>0&&(E.transmission.value=w.transmission,E.transmissionSamplerMap.value=L.texture,E.transmissionSamplerSize.value.set(L.width,L.height),w.transmissionMap&&(E.transmissionMap.value=w.transmissionMap,t(w.transmissionMap,E.transmissionMapTransform)),E.thickness.value=w.thickness,w.thicknessMap&&(E.thicknessMap.value=w.thicknessMap,t(w.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=w.attenuationDistance,E.attenuationColor.value.copy(w.attenuationColor)),w.anisotropy>0&&(E.anisotropyVector.value.set(w.anisotropy*Math.cos(w.anisotropyRotation),w.anisotropy*Math.sin(w.anisotropyRotation)),w.anisotropyMap&&(E.anisotropyMap.value=w.anisotropyMap,t(w.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=w.specularIntensity,E.specularColor.value.copy(w.specularColor),w.specularColorMap&&(E.specularColorMap.value=w.specularColorMap,t(w.specularColorMap,E.specularColorMapTransform)),w.specularIntensityMap&&(E.specularIntensityMap.value=w.specularIntensityMap,t(w.specularIntensityMap,E.specularIntensityMapTransform))}function b(E,w){w.matcap&&(E.matcap.value=w.matcap)}function R(E,w){const L=e.get(w).light;E.referencePosition.value.setFromMatrixPosition(L.matrixWorld),E.nearDistance.value=L.shadow.camera.near,E.farDistance.value=L.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function nte(i,e,t,n){let r={},s={},o=[];const a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(L,D){const O=D.program;n.uniformBlockBinding(L,O)}function u(L,D){let O=r[L.id];O===void 0&&(b(L),O=h(L),r[L.id]=O,L.addEventListener("dispose",E));const B=D.program;n.updateUBOMapping(L,B);const G=e.render.frame;s[L.id]!==G&&(_(L),s[L.id]=G)}function h(L){const D=d();L.__bindingPointIndex=D;const O=i.createBuffer(),B=L.__size,G=L.usage;return i.bindBuffer(i.UNIFORM_BUFFER,O),i.bufferData(i.UNIFORM_BUFFER,B,G),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,D,O),O}function d(){for(let L=0;L<a;L++)if(o.indexOf(L)===-1)return o.push(L),L;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(L){const D=r[L.id],O=L.uniforms,B=L.__cache;i.bindBuffer(i.UNIFORM_BUFFER,D);for(let G=0,k=O.length;G<k;G++){const z=Array.isArray(O[G])?O[G]:[O[G]];for(let F=0,q=z.length;F<q;F++){const H=z[F];if(x(H,G,F,B)===!0){const Q=H.__offset,K=Array.isArray(H.value)?H.value:[H.value];let se=0;for(let ee=0;ee<K.length;ee++){const $=K[ee],re=R($);typeof $=="number"||typeof $=="boolean"?(H.__data[0]=$,i.bufferSubData(i.UNIFORM_BUFFER,Q+se,H.__data)):$.isMatrix3?(H.__data[0]=$.elements[0],H.__data[1]=$.elements[1],H.__data[2]=$.elements[2],H.__data[3]=0,H.__data[4]=$.elements[3],H.__data[5]=$.elements[4],H.__data[6]=$.elements[5],H.__data[7]=0,H.__data[8]=$.elements[6],H.__data[9]=$.elements[7],H.__data[10]=$.elements[8],H.__data[11]=0):($.toArray(H.__data,se),se+=re.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,Q,H.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function x(L,D,O,B){const G=L.value,k=D+"_"+O;if(B[k]===void 0)return typeof G=="number"||typeof G=="boolean"?B[k]=G:B[k]=G.clone(),!0;{const z=B[k];if(typeof G=="number"||typeof G=="boolean"){if(z!==G)return B[k]=G,!0}else if(z.equals(G)===!1)return z.copy(G),!0}return!1}function b(L){const D=L.uniforms;let O=0;const B=16;for(let k=0,z=D.length;k<z;k++){const F=Array.isArray(D[k])?D[k]:[D[k]];for(let q=0,H=F.length;q<H;q++){const Q=F[q],K=Array.isArray(Q.value)?Q.value:[Q.value];for(let se=0,ee=K.length;se<ee;se++){const $=K[se],re=R($),ae=O%B,_e=ae%re.boundary,ne=ae+_e;O+=_e,ne!==0&&B-ne<re.storage&&(O+=B-ne),Q.__data=new Float32Array(re.storage/Float32Array.BYTES_PER_ELEMENT),Q.__offset=O,O+=re.storage}}}const G=O%B;return G>0&&(O+=B-G),L.__size=O,L.__cache={},this}function R(L){const D={boundary:0,storage:0};return typeof L=="number"||typeof L=="boolean"?(D.boundary=4,D.storage=4):L.isVector2?(D.boundary=8,D.storage=8):L.isVector3||L.isColor?(D.boundary=16,D.storage=12):L.isVector4?(D.boundary=16,D.storage=16):L.isMatrix3?(D.boundary=48,D.storage=48):L.isMatrix4?(D.boundary=64,D.storage=64):L.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",L),D}function E(L){const D=L.target;D.removeEventListener("dispose",E);const O=o.indexOf(D.__bindingPointIndex);o.splice(O,1),i.deleteBuffer(r[D.id]),delete r[D.id],delete s[D.id]}function w(){for(const L in r)i.deleteBuffer(r[L]);o=[],r={},s={}}return{bind:l,update:u,dispose:w}}class ite{constructor(e={}){const{canvas:t=a9(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:d=!1,reverseDepthBuffer:_=!1}=e;this.isWebGLRenderer=!0;let x;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=n.getContextAttributes().alpha}else x=o;const b=new Uint32Array(4),R=new Int32Array(4);let E=null,w=null;const L=[],D=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=_a,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const O=this;let B=!1;this._outputColorSpace=qs;let G=0,k=0,z=null,F=-1,q=null;const H=new mn,Q=new mn;let K=null;const se=new Jt(0);let ee=0,$=t.width,re=t.height,ae=1,_e=null,ne=null;const ye=new mn(0,0,$,re),ve=new mn(0,0,$,re);let Pe=!1;const Se=new cg;let Fe=!1,Ye=!1;const at=new Cn,At=new Cn,Gt=new ce,Dt=new mn,Nn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let bn=!1;function $t(){return z===null?ae:1}let he=n;function vt(ue,De){return t.getContext(ue,De)}try{const ue={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${og}`),t.addEventListener("webglcontextlost",Ht,!1),t.addEventListener("webglcontextrestored",Ct,!1),t.addEventListener("webglcontextcreationerror",ut,!1),he===null){const De="webgl2";if(he=vt(De,ue),he===null)throw vt(De)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ue){throw console.error("THREE.WebGLRenderer: "+ue.message),ue}let ft,pt,et,Ft,Tt,Lt,_n,pe,ie,Ge,Qe,nt,Ke,qt,Bt,Zt,nn,_t,jt,un,sn,It,Dn,fe;function Ut(){ft=new dJ(he),ft.init(),It=new Yee(he,ft),pt=new oJ(he,ft,e,It),et=new Xee(he,ft),pt.reverseDepthBuffer&&_&&et.buffers.depth.setReversed(!0),Ft=new mJ(he),Tt=new Oee,Lt=new $ee(he,ft,et,Tt,pt,It,Ft),_n=new lJ(O),pe=new fJ(O),ie=new bQ(he),Dn=new rJ(he,ie),Ge=new AJ(he,ie,Ft,Dn),Qe=new _J(he,Ge,ie,Ft),jt=new gJ(he,pt,Lt),Zt=new aJ(Tt),nt=new Lee(O,_n,pe,ft,pt,Dn,Zt),Ke=new tte(O,Tt),qt=new Bee,Bt=new Vee(ft),_t=new iJ(O,_n,pe,et,Qe,x,l),nn=new Wee(O,Qe,pt),fe=new nte(he,Ft,pt,et),un=new sJ(he,ft,Ft),sn=new pJ(he,ft,Ft),Ft.programs=nt.programs,O.capabilities=pt,O.extensions=ft,O.properties=Tt,O.renderLists=qt,O.shadowMap=nn,O.state=et,O.info=Ft}Ut();const xt=new Jee(O,he);this.xr=xt,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){const ue=ft.get("WEBGL_lose_context");ue&&ue.loseContext()},this.forceContextRestore=function(){const ue=ft.get("WEBGL_lose_context");ue&&ue.restoreContext()},this.getPixelRatio=function(){return ae},this.setPixelRatio=function(ue){ue!==void 0&&(ae=ue,this.setSize($,re,!1))},this.getSize=function(ue){return ue.set($,re)},this.setSize=function(ue,De,je=!0){if(xt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}$=ue,re=De,t.width=Math.floor(ue*ae),t.height=Math.floor(De*ae),je===!0&&(t.style.width=ue+"px",t.style.height=De+"px"),this.setViewport(0,0,ue,De)},this.getDrawingBufferSize=function(ue){return ue.set($*ae,re*ae).floor()},this.setDrawingBufferSize=function(ue,De,je){$=ue,re=De,ae=je,t.width=Math.floor(ue*je),t.height=Math.floor(De*je),this.setViewport(0,0,ue,De)},this.getCurrentViewport=function(ue){return ue.copy(H)},this.getViewport=function(ue){return ue.copy(ye)},this.setViewport=function(ue,De,je,He){ue.isVector4?ye.set(ue.x,ue.y,ue.z,ue.w):ye.set(ue,De,je,He),et.viewport(H.copy(ye).multiplyScalar(ae).round())},this.getScissor=function(ue){return ue.copy(ve)},this.setScissor=function(ue,De,je,He){ue.isVector4?ve.set(ue.x,ue.y,ue.z,ue.w):ve.set(ue,De,je,He),et.scissor(Q.copy(ve).multiplyScalar(ae).round())},this.getScissorTest=function(){return Pe},this.setScissorTest=function(ue){et.setScissorTest(Pe=ue)},this.setOpaqueSort=function(ue){_e=ue},this.setTransparentSort=function(ue){ne=ue},this.getClearColor=function(ue){return ue.copy(_t.getClearColor())},this.setClearColor=function(){_t.setClearColor(...arguments)},this.getClearAlpha=function(){return _t.getClearAlpha()},this.setClearAlpha=function(){_t.setClearAlpha(...arguments)},this.clear=function(ue=!0,De=!0,je=!0){let He=0;if(ue){let Ie=!1;if(z!==null){const Nt=z.texture.format;Ie=Nt===ug||Nt===lg||Nt===ag}if(Ie){const Nt=z.texture.type,Ot=Nt===Vr||Nt===mr||Nt===hu||Nt===Ya||Nt===iT||Nt===rT,ct=_t.getClearColor(),te=_t.getClearAlpha(),Rt=ct.r,yn=ct.g,cn=ct.b;Ot?(b[0]=Rt,b[1]=yn,b[2]=cn,b[3]=te,he.clearBufferuiv(he.COLOR,0,b)):(R[0]=Rt,R[1]=yn,R[2]=cn,R[3]=te,he.clearBufferiv(he.COLOR,0,R))}else He|=he.COLOR_BUFFER_BIT}De&&(He|=he.DEPTH_BUFFER_BIT),je&&(He|=he.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),he.clear(He)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ht,!1),t.removeEventListener("webglcontextrestored",Ct,!1),t.removeEventListener("webglcontextcreationerror",ut,!1),_t.dispose(),qt.dispose(),Bt.dispose(),Tt.dispose(),_n.dispose(),pe.dispose(),Qe.dispose(),Dn.dispose(),fe.dispose(),nt.dispose(),xt.dispose(),xt.removeEventListener("sessionstart",ke),xt.removeEventListener("sessionend",We),St.stop()};function Ht(ue){ue.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function Ct(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const ue=Ft.autoReset,De=nn.enabled,je=nn.autoUpdate,He=nn.needsUpdate,Ie=nn.type;Ut(),Ft.autoReset=ue,nn.enabled=De,nn.autoUpdate=je,nn.needsUpdate=He,nn.type=Ie}function ut(ue){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ue.statusMessage)}function kt(ue){const De=ue.target;De.removeEventListener("dispose",kt),hn(De)}function hn(ue){$n(ue),Tt.remove(ue)}function $n(ue){const De=Tt.get(ue).programs;De!==void 0&&(De.forEach(function(je){nt.releaseProgram(je)}),ue.isShaderMaterial&&nt.releaseShaderCache(ue))}this.renderBufferDirect=function(ue,De,je,He,Ie,Nt){De===null&&(De=Nn);const Ot=Ie.isMesh&&Ie.matrixWorld.determinant()<0,ct=ho(ue,De,je,He,Ie);et.setMaterial(He,Ot);let te=je.index,Rt=1;if(He.wireframe===!0){if(te=Ge.getWireframeAttribute(je),te===void 0)return;Rt=2}const yn=je.drawRange,cn=je.attributes.position;let ni=yn.start*Rt,Pi=(yn.start+yn.count)*Rt;Nt!==null&&(ni=Math.max(ni,Nt.start*Rt),Pi=Math.min(Pi,(Nt.start+Nt.count)*Rt)),te!==null?(ni=Math.max(ni,0),Pi=Math.min(Pi,te.count)):cn!=null&&(ni=Math.max(ni,0),Pi=Math.min(Pi,cn.count));const fr=Pi-ni;if(fr<0||fr===1/0)return;Dn.setup(Ie,He,ct,je,te);let Z,Li=un;if(te!==null&&(Z=ie.get(te),Li=sn,Li.setIndex(Z)),Ie.isMesh)He.wireframe===!0?(et.setLineWidth(He.wireframeLinewidth*$t()),Li.setMode(he.LINES)):Li.setMode(he.TRIANGLES);else if(Ie.isLine){let vn=He.linewidth;vn===void 0&&(vn=1),et.setLineWidth(vn*$t()),Ie.isLineSegments?Li.setMode(he.LINES):Ie.isLineLoop?Li.setMode(he.LINE_LOOP):Li.setMode(he.LINE_STRIP)}else Ie.isPoints?Li.setMode(he.POINTS):Ie.isSprite&&Li.setMode(he.TRIANGLES);if(Ie.isBatchedMesh)if(Ie._multiDrawInstances!==null)Za("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Li.renderMultiDrawInstances(Ie._multiDrawStarts,Ie._multiDrawCounts,Ie._multiDrawCount,Ie._multiDrawInstances);else if(ft.get("WEBGL_multi_draw"))Li.renderMultiDraw(Ie._multiDrawStarts,Ie._multiDrawCounts,Ie._multiDrawCount);else{const vn=Ie._multiDrawStarts,Wi=Ie._multiDrawCounts,mi=Ie._multiDrawCount,ls=te?ie.get(te).bytesPerElement:1,Su=Tt.get(He).currentProgram.getUniforms();for(let Ji=0;Ji<mi;Ji++)Su.setValue(he,"_gl_DrawID",Ji),Li.render(vn[Ji]/ls,Wi[Ji])}else if(Ie.isInstancedMesh)Li.renderInstances(ni,fr,Ie.count);else if(je.isInstancedBufferGeometry){const vn=je._maxInstanceCount!==void 0?je._maxInstanceCount:1/0,Wi=Math.min(je.instanceCount,vn);Li.renderInstances(ni,fr,Wi)}else Li.render(ni,fr)};function Bn(ue,De,je){ue.transparent===!0&&ue.side===ss&&ue.forceSinglePass===!1?(ue.side=Zi,ue.needsUpdate=!0,hr(ue,De,je),ue.side=ma,ue.needsUpdate=!0,hr(ue,De,je),ue.side=ss):hr(ue,De,je)}this.compile=function(ue,De,je=null){je===null&&(je=ue),w=Bt.get(je),w.init(De),D.push(w),je.traverseVisible(function(Ie){Ie.isLight&&Ie.layers.test(De.layers)&&(w.pushLight(Ie),Ie.castShadow&&w.pushShadow(Ie))}),ue!==je&&ue.traverseVisible(function(Ie){Ie.isLight&&Ie.layers.test(De.layers)&&(w.pushLight(Ie),Ie.castShadow&&w.pushShadow(Ie))}),w.setupLights();const He=new Set;return ue.traverse(function(Ie){if(!(Ie.isMesh||Ie.isPoints||Ie.isLine||Ie.isSprite))return;const Nt=Ie.material;if(Nt)if(Array.isArray(Nt))for(let Ot=0;Ot<Nt.length;Ot++){const ct=Nt[Ot];Bn(ct,je,Ie),He.add(ct)}else Bn(Nt,je,Ie),He.add(Nt)}),w=D.pop(),He},this.compileAsync=function(ue,De,je=null){const He=this.compile(ue,De,je);return new Promise(Ie=>{function Nt(){if(He.forEach(function(Ot){Tt.get(Ot).currentProgram.isReady()&&He.delete(Ot)}),He.size===0){Ie(ue);return}setTimeout(Nt,10)}ft.get("KHR_parallel_shader_compile")!==null?Nt():setTimeout(Nt,10)})};let Hi=null;function Ti(ue){Hi&&Hi(ue)}function ke(){St.stop()}function We(){St.start()}const St=new N9;St.setAnimationLoop(Ti),typeof self<"u"&&St.setContext(self),this.setAnimationLoop=function(ue){Hi=ue,xt.setAnimationLoop(ue),ue===null?St.stop():St.start()},xt.addEventListener("sessionstart",ke),xt.addEventListener("sessionend",We),this.render=function(ue,De){if(De!==void 0&&De.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;if(ue.matrixWorldAutoUpdate===!0&&ue.updateMatrixWorld(),De.parent===null&&De.matrixWorldAutoUpdate===!0&&De.updateMatrixWorld(),xt.enabled===!0&&xt.isPresenting===!0&&(xt.cameraAutoUpdate===!0&&xt.updateCamera(De),De=xt.getCamera()),ue.isScene===!0&&ue.onBeforeRender(O,ue,De,z),w=Bt.get(ue,D.length),w.init(De),D.push(w),At.multiplyMatrices(De.projectionMatrix,De.matrixWorldInverse),Se.setFromProjectionMatrix(At),Ye=this.localClippingEnabled,Fe=Zt.init(this.clippingPlanes,Ye),E=qt.get(ue,L.length),E.init(),L.push(E),xt.enabled===!0&&xt.isPresenting===!0){const Nt=O.xr.getDepthSensingMesh();Nt!==null&&rt(Nt,De,-1/0,O.sortObjects)}rt(ue,De,0,O.sortObjects),E.finish(),O.sortObjects===!0&&E.sort(_e,ne),bn=xt.enabled===!1||xt.isPresenting===!1||xt.hasDepthSensing()===!1,bn&&_t.addToRenderList(E,ue),this.info.render.frame++,Fe===!0&&Zt.beginShadows();const je=w.state.shadowsArray;nn.render(je,ue,De),Fe===!0&&Zt.endShadows(),this.info.autoReset===!0&&this.info.reset();const He=E.opaque,Ie=E.transmissive;if(w.setupLights(),De.isArrayCamera){const Nt=De.cameras;if(Ie.length>0)for(let Ot=0,ct=Nt.length;Ot<ct;Ot++){const te=Nt[Ot];J(He,Ie,ue,te)}bn&&_t.render(ue);for(let Ot=0,ct=Nt.length;Ot<ct;Ot++){const te=Nt[Ot];p(E,ue,te,te.viewport)}}else Ie.length>0&&J(He,Ie,ue,De),bn&&_t.render(ue),p(E,ue,De);z!==null&&k===0&&(Lt.updateMultisampleRenderTarget(z),Lt.updateRenderTargetMipmap(z)),ue.isScene===!0&&ue.onAfterRender(O,ue,De),Dn.resetDefaultState(),F=-1,q=null,D.pop(),D.length>0?(w=D[D.length-1],Fe===!0&&Zt.setGlobalState(O.clippingPlanes,w.state.camera)):w=null,L.pop(),L.length>0?E=L[L.length-1]:E=null};function rt(ue,De,je,He){if(ue.visible===!1)return;if(ue.layers.test(De.layers)){if(ue.isGroup)je=ue.renderOrder;else if(ue.isLOD)ue.autoUpdate===!0&&ue.update(De);else if(ue.isLight)w.pushLight(ue),ue.castShadow&&w.pushShadow(ue);else if(ue.isSprite){if(!ue.frustumCulled||Se.intersectsSprite(ue)){He&&Dt.setFromMatrixPosition(ue.matrixWorld).applyMatrix4(At);const Ot=Qe.update(ue),ct=ue.material;ct.visible&&E.push(ue,Ot,ct,je,Dt.z,null)}}else if((ue.isMesh||ue.isLine||ue.isPoints)&&(!ue.frustumCulled||Se.intersectsObject(ue))){const Ot=Qe.update(ue),ct=ue.material;if(He&&(ue.boundingSphere!==void 0?(ue.boundingSphere===null&&ue.computeBoundingSphere(),Dt.copy(ue.boundingSphere.center)):(Ot.boundingSphere===null&&Ot.computeBoundingSphere(),Dt.copy(Ot.boundingSphere.center)),Dt.applyMatrix4(ue.matrixWorld).applyMatrix4(At)),Array.isArray(ct)){const te=Ot.groups;for(let Rt=0,yn=te.length;Rt<yn;Rt++){const cn=te[Rt],ni=ct[cn.materialIndex];ni&&ni.visible&&E.push(ue,Ot,ni,je,Dt.z,cn)}}else ct.visible&&E.push(ue,Ot,ct,je,Dt.z,null)}}const Nt=ue.children;for(let Ot=0,ct=Nt.length;Ot<ct;Ot++)rt(Nt[Ot],De,je,He)}function p(ue,De,je,He){const Ie=ue.opaque,Nt=ue.transmissive,Ot=ue.transparent;w.setupLightsView(je),Fe===!0&&Zt.setGlobalState(O.clippingPlanes,je),He&&et.viewport(H.copy(He)),Ie.length>0&&ti(Ie,De,je),Nt.length>0&&ti(Nt,De,je),Ot.length>0&&ti(Ot,De,je),et.buffers.depth.setTest(!0),et.buffers.depth.setMask(!0),et.buffers.color.setMask(!0),et.setPolygonOffset(!1)}function J(ue,De,je,He){if((je.isScene===!0?je.overrideMaterial:null)!==null)return;w.state.transmissionRenderTarget[He.id]===void 0&&(w.state.transmissionRenderTarget[He.id]=new ad(1,1,{generateMipmaps:!0,type:ft.has("EXT_color_buffer_half_float")||ft.has("EXT_color_buffer_float")?As:Vr,minFilter:ua,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:In.workingColorSpace}));const Nt=w.state.transmissionRenderTarget[He.id],Ot=He.viewport||H;Nt.setSize(Ot.z*O.transmissionResolutionScale,Ot.w*O.transmissionResolutionScale);const ct=O.getRenderTarget(),te=O.getActiveCubeFace(),Rt=O.getActiveMipmapLevel();O.setRenderTarget(Nt),O.getClearColor(se),ee=O.getClearAlpha(),ee<1&&O.setClearColor(16777215,.5),O.clear(),bn&&_t.render(je);const yn=O.toneMapping;O.toneMapping=_a;const cn=He.viewport;if(He.viewport!==void 0&&(He.viewport=void 0),w.setupLightsView(He),Fe===!0&&Zt.setGlobalState(O.clippingPlanes,He),ti(ue,je,He),Lt.updateMultisampleRenderTarget(Nt),Lt.updateRenderTargetMipmap(Nt),ft.has("WEBGL_multisampled_render_to_texture")===!1){let ni=!1;for(let Pi=0,fr=De.length;Pi<fr;Pi++){const Z=De[Pi],Li=Z.object,vn=Z.geometry,Wi=Z.material,mi=Z.group;if(Wi.side===ss&&Li.layers.test(He.layers)){const ls=Wi.side;Wi.side=Zi,Wi.needsUpdate=!0,ci(Li,je,He,vn,Wi,mi),Wi.side=ls,Wi.needsUpdate=!0,ni=!0}}ni===!0&&(Lt.updateMultisampleRenderTarget(Nt),Lt.updateRenderTargetMipmap(Nt))}O.setRenderTarget(ct,te,Rt),O.setClearColor(se,ee),cn!==void 0&&(He.viewport=cn),O.toneMapping=yn}function ti(ue,De,je){const He=De.isScene===!0?De.overrideMaterial:null;for(let Ie=0,Nt=ue.length;Ie<Nt;Ie++){const Ot=ue[Ie],ct=Ot.object,te=Ot.geometry,Rt=Ot.group;let yn=Ot.material;yn.allowOverride===!0&&He!==null&&(yn=He),ct.layers.test(je.layers)&&ci(ct,De,je,te,yn,Rt)}}function ci(ue,De,je,He,Ie,Nt){ue.onBeforeRender(O,De,je,He,Ie,Nt),ue.modelViewMatrix.multiplyMatrices(je.matrixWorldInverse,ue.matrixWorld),ue.normalMatrix.getNormalMatrix(ue.modelViewMatrix),Ie.onBeforeRender(O,De,je,He,ue,Nt),Ie.transparent===!0&&Ie.side===ss&&Ie.forceSinglePass===!1?(Ie.side=Zi,Ie.needsUpdate=!0,O.renderBufferDirect(je,De,He,Ie,ue,Nt),Ie.side=ma,Ie.needsUpdate=!0,O.renderBufferDirect(je,De,He,Ie,ue,Nt),Ie.side=ss):O.renderBufferDirect(je,De,He,Ie,ue,Nt),ue.onAfterRender(O,De,je,He,Ie,Nt)}function hr(ue,De,je){De.isScene!==!0&&(De=Nn);const He=Tt.get(ue),Ie=w.state.lights,Nt=w.state.shadowsArray,Ot=Ie.state.version,ct=nt.getParameters(ue,Ie.state,Nt,De,je),te=nt.getProgramCacheKey(ct);let Rt=He.programs;He.environment=ue.isMeshStandardMaterial?De.environment:null,He.fog=De.fog,He.envMap=(ue.isMeshStandardMaterial?pe:_n).get(ue.envMap||He.environment),He.envMapRotation=He.environment!==null&&ue.envMap===null?De.environmentRotation:ue.envMapRotation,Rt===void 0&&(ue.addEventListener("dispose",kt),Rt=new Map,He.programs=Rt);let yn=Rt.get(te);if(yn!==void 0){if(He.currentProgram===yn&&He.lightsStateVersion===Ot)return Zn(ue,ct),yn}else ct.uniforms=nt.getUniforms(ue),ue.onBeforeCompile(ct,O),yn=nt.acquireProgram(ct,te),Rt.set(te,yn),He.uniforms=ct.uniforms;const cn=He.uniforms;return(!ue.isShaderMaterial&&!ue.isRawShaderMaterial||ue.clipping===!0)&&(cn.clippingPlanes=Zt.uniform),Zn(ue,ct),He.needsLights=on(ue),He.lightsStateVersion=Ot,He.needsLights&&(cn.ambientLightColor.value=Ie.state.ambient,cn.lightProbe.value=Ie.state.probe,cn.directionalLights.value=Ie.state.directional,cn.directionalLightShadows.value=Ie.state.directionalShadow,cn.spotLights.value=Ie.state.spot,cn.spotLightShadows.value=Ie.state.spotShadow,cn.rectAreaLights.value=Ie.state.rectArea,cn.ltc_1.value=Ie.state.rectAreaLTC1,cn.ltc_2.value=Ie.state.rectAreaLTC2,cn.pointLights.value=Ie.state.point,cn.pointLightShadows.value=Ie.state.pointShadow,cn.hemisphereLights.value=Ie.state.hemi,cn.directionalShadowMap.value=Ie.state.directionalShadowMap,cn.directionalShadowMatrix.value=Ie.state.directionalShadowMatrix,cn.spotShadowMap.value=Ie.state.spotShadowMap,cn.spotLightMatrix.value=Ie.state.spotLightMatrix,cn.spotLightMap.value=Ie.state.spotLightMap,cn.pointShadowMap.value=Ie.state.pointShadowMap,cn.pointShadowMatrix.value=Ie.state.pointShadowMatrix),He.currentProgram=yn,He.uniformsList=null,yn}function Tn(ue){if(ue.uniformsList===null){const De=ue.currentProgram.getUniforms();ue.uniformsList=vb.seqWithValue(De.seq,ue.uniforms)}return ue.uniformsList}function Zn(ue,De){const je=Tt.get(ue);je.outputColorSpace=De.outputColorSpace,je.batching=De.batching,je.batchingColor=De.batchingColor,je.instancing=De.instancing,je.instancingColor=De.instancingColor,je.instancingMorph=De.instancingMorph,je.skinning=De.skinning,je.morphTargets=De.morphTargets,je.morphNormals=De.morphNormals,je.morphColors=De.morphColors,je.morphTargetsCount=De.morphTargetsCount,je.numClippingPlanes=De.numClippingPlanes,je.numIntersection=De.numClipIntersection,je.vertexAlphas=De.vertexAlphas,je.vertexTangents=De.vertexTangents,je.toneMapping=De.toneMapping}function ho(ue,De,je,He,Ie){De.isScene!==!0&&(De=Nn),Lt.resetTextureUnits();const Nt=De.fog,Ot=He.isMeshStandardMaterial?De.environment:null,ct=z===null?O.outputColorSpace:z.isXRRenderTarget===!0?z.texture.colorSpace:pu,te=(He.isMeshStandardMaterial?pe:_n).get(He.envMap||Ot),Rt=He.vertexColors===!0&&!!je.attributes.color&&je.attributes.color.itemSize===4,yn=!!je.attributes.tangent&&(!!He.normalMap||He.anisotropy>0),cn=!!je.morphAttributes.position,ni=!!je.morphAttributes.normal,Pi=!!je.morphAttributes.color;let fr=_a;He.toneMapped&&(z===null||z.isXRRenderTarget===!0)&&(fr=O.toneMapping);const Z=je.morphAttributes.position||je.morphAttributes.normal||je.morphAttributes.color,Li=Z!==void 0?Z.length:0,vn=Tt.get(He),Wi=w.state.lights;if(Fe===!0&&(Ye===!0||ue!==q)){const Wr=ue===q&&He.id===F;Zt.setState(He,ue,Wr)}let mi=!1;He.version===vn.__version?(vn.needsLights&&vn.lightsStateVersion!==Wi.state.version||vn.outputColorSpace!==ct||Ie.isBatchedMesh&&vn.batching===!1||!Ie.isBatchedMesh&&vn.batching===!0||Ie.isBatchedMesh&&vn.batchingColor===!0&&Ie.colorTexture===null||Ie.isBatchedMesh&&vn.batchingColor===!1&&Ie.colorTexture!==null||Ie.isInstancedMesh&&vn.instancing===!1||!Ie.isInstancedMesh&&vn.instancing===!0||Ie.isSkinnedMesh&&vn.skinning===!1||!Ie.isSkinnedMesh&&vn.skinning===!0||Ie.isInstancedMesh&&vn.instancingColor===!0&&Ie.instanceColor===null||Ie.isInstancedMesh&&vn.instancingColor===!1&&Ie.instanceColor!==null||Ie.isInstancedMesh&&vn.instancingMorph===!0&&Ie.morphTexture===null||Ie.isInstancedMesh&&vn.instancingMorph===!1&&Ie.morphTexture!==null||vn.envMap!==te||He.fog===!0&&vn.fog!==Nt||vn.numClippingPlanes!==void 0&&(vn.numClippingPlanes!==Zt.numPlanes||vn.numIntersection!==Zt.numIntersection)||vn.vertexAlphas!==Rt||vn.vertexTangents!==yn||vn.morphTargets!==cn||vn.morphNormals!==ni||vn.morphColors!==Pi||vn.toneMapping!==fr||vn.morphTargetsCount!==Li)&&(mi=!0):(mi=!0,vn.__version=He.version);let ls=vn.currentProgram;mi===!0&&(ls=hr(He,De,Ie));let Su=!1,Ji=!1,nl=!1;const ji=ls.getUniforms(),yr=vn.uniforms;if(et.useProgram(ls.program)&&(Su=!0,Ji=!0,nl=!0),He.id!==F&&(F=He.id,Ji=!0),Su||q!==ue){et.buffers.depth.getReversed()?(at.copy(ue.projectionMatrix),q$(at),H$(at),ji.setValue(he,"projectionMatrix",at)):ji.setValue(he,"projectionMatrix",ue.projectionMatrix),ji.setValue(he,"viewMatrix",ue.matrixWorldInverse);const vs=ji.map.cameraPosition;vs!==void 0&&vs.setValue(he,Gt.setFromMatrixPosition(ue.matrixWorld)),pt.logarithmicDepthBuffer&&ji.setValue(he,"logDepthBufFC",2/(Math.log(ue.far+1)/Math.LN2)),(He.isMeshPhongMaterial||He.isMeshToonMaterial||He.isMeshLambertMaterial||He.isMeshBasicMaterial||He.isMeshStandardMaterial||He.isShaderMaterial)&&ji.setValue(he,"isOrthographic",ue.isOrthographicCamera===!0),q!==ue&&(q=ue,Ji=!0,nl=!0)}if(Ie.isSkinnedMesh){ji.setOptional(he,Ie,"bindMatrix"),ji.setOptional(he,Ie,"bindMatrixInverse");const Wr=Ie.skeleton;Wr&&(Wr.boneTexture===null&&Wr.computeBoneTexture(),ji.setValue(he,"boneTexture",Wr.boneTexture,Lt))}Ie.isBatchedMesh&&(ji.setOptional(he,Ie,"batchingTexture"),ji.setValue(he,"batchingTexture",Ie._matricesTexture,Lt),ji.setOptional(he,Ie,"batchingIdTexture"),ji.setValue(he,"batchingIdTexture",Ie._indirectTexture,Lt),ji.setOptional(he,Ie,"batchingColorTexture"),Ie._colorsTexture!==null&&ji.setValue(he,"batchingColorTexture",Ie._colorsTexture,Lt));const hi=je.morphAttributes;if((hi.position!==void 0||hi.normal!==void 0||hi.color!==void 0)&&jt.update(Ie,je,ls),(Ji||vn.receiveShadow!==Ie.receiveShadow)&&(vn.receiveShadow=Ie.receiveShadow,ji.setValue(he,"receiveShadow",Ie.receiveShadow)),He.isMeshGouraudMaterial&&He.envMap!==null&&(yr.envMap.value=te,yr.flipEnvMap.value=te.isCubeTexture&&te.isRenderTargetTexture===!1?-1:1),He.isMeshStandardMaterial&&He.envMap===null&&De.environment!==null&&(yr.envMapIntensity.value=De.environmentIntensity),Ji&&(ji.setValue(he,"toneMappingExposure",O.toneMappingExposure),vn.needsLights&&ri(yr,nl),Nt&&He.fog===!0&&Ke.refreshFogUniforms(yr,Nt),Ke.refreshMaterialUniforms(yr,He,ae,re,w.state.transmissionRenderTarget[ue.id]),vb.upload(he,Tn(vn),yr,Lt)),He.isShaderMaterial&&He.uniformsNeedUpdate===!0&&(vb.upload(he,Tn(vn),yr,Lt),He.uniformsNeedUpdate=!1),He.isSpriteMaterial&&ji.setValue(he,"center",Ie.center),ji.setValue(he,"modelViewMatrix",Ie.modelViewMatrix),ji.setValue(he,"normalMatrix",Ie.normalMatrix),ji.setValue(he,"modelMatrix",Ie.matrixWorld),He.isShaderMaterial||He.isRawShaderMaterial){const Wr=He.uniformsGroups;for(let vs=0,il=Wr.length;vs<il;vs++){const rl=Wr[vs];fe.update(rl,ls),fe.bind(rl,ls)}}return ls}function ri(ue,De){ue.ambientLightColor.needsUpdate=De,ue.lightProbe.needsUpdate=De,ue.directionalLights.needsUpdate=De,ue.directionalLightShadows.needsUpdate=De,ue.pointLights.needsUpdate=De,ue.pointLightShadows.needsUpdate=De,ue.spotLights.needsUpdate=De,ue.spotLightShadows.needsUpdate=De,ue.rectAreaLights.needsUpdate=De,ue.hemisphereLights.needsUpdate=De}function on(ue){return ue.isMeshLambertMaterial||ue.isMeshToonMaterial||ue.isMeshPhongMaterial||ue.isMeshStandardMaterial||ue.isShadowMaterial||ue.isShaderMaterial&&ue.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return z},this.setRenderTargetTextures=function(ue,De,je){const He=Tt.get(ue);He.__autoAllocateDepthBuffer=ue.resolveDepthBuffer===!1,He.__autoAllocateDepthBuffer===!1&&(He.__useRenderToTexture=!1),Tt.get(ue.texture).__webglTexture=De,Tt.get(ue.depthTexture).__webglTexture=He.__autoAllocateDepthBuffer?void 0:je,He.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ue,De){const je=Tt.get(ue);je.__webglFramebuffer=De,je.__useDefaultFramebuffer=De===void 0};const $s=he.createFramebuffer();this.setRenderTarget=function(ue,De=0,je=0){z=ue,G=De,k=je;let He=!0,Ie=null,Nt=!1,Ot=!1;if(ue){const te=Tt.get(ue);if(te.__useDefaultFramebuffer!==void 0)et.bindFramebuffer(he.FRAMEBUFFER,null),He=!1;else if(te.__webglFramebuffer===void 0)Lt.setupRenderTarget(ue);else if(te.__hasExternalTextures)Lt.rebindTextures(ue,Tt.get(ue.texture).__webglTexture,Tt.get(ue.depthTexture).__webglTexture);else if(ue.depthBuffer){const cn=ue.depthTexture;if(te.__boundDepthTexture!==cn){if(cn!==null&&Tt.has(cn)&&(ue.width!==cn.image.width||ue.height!==cn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Lt.setupDepthRenderbuffer(ue)}}const Rt=ue.texture;(Rt.isData3DTexture||Rt.isDataArrayTexture||Rt.isCompressedArrayTexture)&&(Ot=!0);const yn=Tt.get(ue).__webglFramebuffer;ue.isWebGLCubeRenderTarget?(Array.isArray(yn[De])?Ie=yn[De][je]:Ie=yn[De],Nt=!0):ue.samples>0&&Lt.useMultisampledRTT(ue)===!1?Ie=Tt.get(ue).__webglMultisampledFramebuffer:Array.isArray(yn)?Ie=yn[je]:Ie=yn,H.copy(ue.viewport),Q.copy(ue.scissor),K=ue.scissorTest}else H.copy(ye).multiplyScalar(ae).floor(),Q.copy(ve).multiplyScalar(ae).floor(),K=Pe;if(je!==0&&(Ie=$s),et.bindFramebuffer(he.FRAMEBUFFER,Ie)&&He&&et.drawBuffers(ue,Ie),et.viewport(H),et.scissor(Q),et.setScissorTest(K),Nt){const te=Tt.get(ue.texture);he.framebufferTexture2D(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_CUBE_MAP_POSITIVE_X+De,te.__webglTexture,je)}else if(Ot){const te=Tt.get(ue.texture),Rt=De;he.framebufferTextureLayer(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,te.__webglTexture,je,Rt)}else if(ue!==null&&je!==0){const te=Tt.get(ue.texture);he.framebufferTexture2D(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_2D,te.__webglTexture,je)}F=-1},this.readRenderTargetPixels=function(ue,De,je,He,Ie,Nt,Ot,ct=0){if(!(ue&&ue.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let te=Tt.get(ue).__webglFramebuffer;if(ue.isWebGLCubeRenderTarget&&Ot!==void 0&&(te=te[Ot]),te){et.bindFramebuffer(he.FRAMEBUFFER,te);try{const Rt=ue.textures[ct],yn=Rt.format,cn=Rt.type;if(!pt.textureFormatReadable(yn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!pt.textureTypeReadable(cn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}De>=0&&De<=ue.width-He&&je>=0&&je<=ue.height-Ie&&(ue.textures.length>1&&he.readBuffer(he.COLOR_ATTACHMENT0+ct),he.readPixels(De,je,He,Ie,It.convert(yn),It.convert(cn),Nt))}finally{const Rt=z!==null?Tt.get(z).__webglFramebuffer:null;et.bindFramebuffer(he.FRAMEBUFFER,Rt)}}},this.readRenderTargetPixelsAsync=async function(ue,De,je,He,Ie,Nt,Ot,ct=0){if(!(ue&&ue.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let te=Tt.get(ue).__webglFramebuffer;if(ue.isWebGLCubeRenderTarget&&Ot!==void 0&&(te=te[Ot]),te)if(De>=0&&De<=ue.width-He&&je>=0&&je<=ue.height-Ie){et.bindFramebuffer(he.FRAMEBUFFER,te);const Rt=ue.textures[ct],yn=Rt.format,cn=Rt.type;if(!pt.textureFormatReadable(yn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!pt.textureTypeReadable(cn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const ni=he.createBuffer();he.bindBuffer(he.PIXEL_PACK_BUFFER,ni),he.bufferData(he.PIXEL_PACK_BUFFER,Nt.byteLength,he.STREAM_READ),ue.textures.length>1&&he.readBuffer(he.COLOR_ATTACHMENT0+ct),he.readPixels(De,je,He,Ie,It.convert(yn),It.convert(cn),0);const Pi=z!==null?Tt.get(z).__webglFramebuffer:null;et.bindFramebuffer(he.FRAMEBUFFER,Pi);const fr=he.fenceSync(he.SYNC_GPU_COMMANDS_COMPLETE,0);return he.flush(),await V$(he,fr,4),he.bindBuffer(he.PIXEL_PACK_BUFFER,ni),he.getBufferSubData(he.PIXEL_PACK_BUFFER,0,Nt),he.deleteBuffer(ni),he.deleteSync(fr),Nt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ue,De=null,je=0){const He=Math.pow(2,-je),Ie=Math.floor(ue.image.width*He),Nt=Math.floor(ue.image.height*He),Ot=De!==null?De.x:0,ct=De!==null?De.y:0;Lt.setTexture2D(ue,0),he.copyTexSubImage2D(he.TEXTURE_2D,je,0,0,Ot,ct,Ie,Nt),et.unbindTexture()};const Sc=he.createFramebuffer(),kl=he.createFramebuffer();this.copyTextureToTexture=function(ue,De,je=null,He=null,Ie=0,Nt=null){Nt===null&&(Ie!==0?(Za("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Nt=Ie,Ie=0):Nt=0);let Ot,ct,te,Rt,yn,cn,ni,Pi,fr;const Z=ue.isCompressedTexture?ue.mipmaps[Nt]:ue.image;if(je!==null)Ot=je.max.x-je.min.x,ct=je.max.y-je.min.y,te=je.isBox3?je.max.z-je.min.z:1,Rt=je.min.x,yn=je.min.y,cn=je.isBox3?je.min.z:0;else{const hi=Math.pow(2,-Ie);Ot=Math.floor(Z.width*hi),ct=Math.floor(Z.height*hi),ue.isDataArrayTexture?te=Z.depth:ue.isData3DTexture?te=Math.floor(Z.depth*hi):te=1,Rt=0,yn=0,cn=0}He!==null?(ni=He.x,Pi=He.y,fr=He.z):(ni=0,Pi=0,fr=0);const Li=It.convert(De.format),vn=It.convert(De.type);let Wi;De.isData3DTexture?(Lt.setTexture3D(De,0),Wi=he.TEXTURE_3D):De.isDataArrayTexture||De.isCompressedArrayTexture?(Lt.setTexture2DArray(De,0),Wi=he.TEXTURE_2D_ARRAY):(Lt.setTexture2D(De,0),Wi=he.TEXTURE_2D),he.pixelStorei(he.UNPACK_FLIP_Y_WEBGL,De.flipY),he.pixelStorei(he.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),he.pixelStorei(he.UNPACK_ALIGNMENT,De.unpackAlignment);const mi=he.getParameter(he.UNPACK_ROW_LENGTH),ls=he.getParameter(he.UNPACK_IMAGE_HEIGHT),Su=he.getParameter(he.UNPACK_SKIP_PIXELS),Ji=he.getParameter(he.UNPACK_SKIP_ROWS),nl=he.getParameter(he.UNPACK_SKIP_IMAGES);he.pixelStorei(he.UNPACK_ROW_LENGTH,Z.width),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,Z.height),he.pixelStorei(he.UNPACK_SKIP_PIXELS,Rt),he.pixelStorei(he.UNPACK_SKIP_ROWS,yn),he.pixelStorei(he.UNPACK_SKIP_IMAGES,cn);const ji=ue.isDataArrayTexture||ue.isData3DTexture,yr=De.isDataArrayTexture||De.isData3DTexture;if(ue.isDepthTexture){const hi=Tt.get(ue),Wr=Tt.get(De),vs=Tt.get(hi.__renderTarget),il=Tt.get(Wr.__renderTarget);et.bindFramebuffer(he.READ_FRAMEBUFFER,vs.__webglFramebuffer),et.bindFramebuffer(he.DRAW_FRAMEBUFFER,il.__webglFramebuffer);for(let rl=0;rl<te;rl++)ji&&(he.framebufferTextureLayer(he.READ_FRAMEBUFFER,he.COLOR_ATTACHMENT0,Tt.get(ue).__webglTexture,Ie,cn+rl),he.framebufferTextureLayer(he.DRAW_FRAMEBUFFER,he.COLOR_ATTACHMENT0,Tt.get(De).__webglTexture,Nt,fr+rl)),he.blitFramebuffer(Rt,yn,Ot,ct,ni,Pi,Ot,ct,he.DEPTH_BUFFER_BIT,he.NEAREST);et.bindFramebuffer(he.READ_FRAMEBUFFER,null),et.bindFramebuffer(he.DRAW_FRAMEBUFFER,null)}else if(Ie!==0||ue.isRenderTargetTexture||Tt.has(ue)){const hi=Tt.get(ue),Wr=Tt.get(De);et.bindFramebuffer(he.READ_FRAMEBUFFER,Sc),et.bindFramebuffer(he.DRAW_FRAMEBUFFER,kl);for(let vs=0;vs<te;vs++)ji?he.framebufferTextureLayer(he.READ_FRAMEBUFFER,he.COLOR_ATTACHMENT0,hi.__webglTexture,Ie,cn+vs):he.framebufferTexture2D(he.READ_FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_2D,hi.__webglTexture,Ie),yr?he.framebufferTextureLayer(he.DRAW_FRAMEBUFFER,he.COLOR_ATTACHMENT0,Wr.__webglTexture,Nt,fr+vs):he.framebufferTexture2D(he.DRAW_FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_2D,Wr.__webglTexture,Nt),Ie!==0?he.blitFramebuffer(Rt,yn,Ot,ct,ni,Pi,Ot,ct,he.COLOR_BUFFER_BIT,he.NEAREST):yr?he.copyTexSubImage3D(Wi,Nt,ni,Pi,fr+vs,Rt,yn,Ot,ct):he.copyTexSubImage2D(Wi,Nt,ni,Pi,Rt,yn,Ot,ct);et.bindFramebuffer(he.READ_FRAMEBUFFER,null),et.bindFramebuffer(he.DRAW_FRAMEBUFFER,null)}else yr?ue.isDataTexture||ue.isData3DTexture?he.texSubImage3D(Wi,Nt,ni,Pi,fr,Ot,ct,te,Li,vn,Z.data):De.isCompressedArrayTexture?he.compressedTexSubImage3D(Wi,Nt,ni,Pi,fr,Ot,ct,te,Li,Z.data):he.texSubImage3D(Wi,Nt,ni,Pi,fr,Ot,ct,te,Li,vn,Z):ue.isDataTexture?he.texSubImage2D(he.TEXTURE_2D,Nt,ni,Pi,Ot,ct,Li,vn,Z.data):ue.isCompressedTexture?he.compressedTexSubImage2D(he.TEXTURE_2D,Nt,ni,Pi,Z.width,Z.height,Li,Z.data):he.texSubImage2D(he.TEXTURE_2D,Nt,ni,Pi,Ot,ct,Li,vn,Z);he.pixelStorei(he.UNPACK_ROW_LENGTH,mi),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,ls),he.pixelStorei(he.UNPACK_SKIP_PIXELS,Su),he.pixelStorei(he.UNPACK_SKIP_ROWS,Ji),he.pixelStorei(he.UNPACK_SKIP_IMAGES,nl),Nt===0&&De.generateMipmaps&&he.generateMipmap(Wi),et.unbindTexture()},this.copyTextureToTexture3D=function(ue,De,je=null,He=null,Ie=0){return Za('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ue,De,je,He,Ie)},this.initRenderTarget=function(ue){Tt.get(ue).__webglFramebuffer===void 0&&Lt.setupRenderTarget(ue)},this.initTexture=function(ue){ue.isCubeTexture?Lt.setTextureCube(ue,0):ue.isData3DTexture?Lt.setTexture3D(ue,0):ue.isDataArrayTexture||ue.isCompressedArrayTexture?Lt.setTexture2DArray(ue,0):Lt.setTexture2D(ue,0),et.unbindTexture()},this.resetState=function(){G=0,k=0,z=null,et.reset(),Dn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return qo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=In._getDrawingBufferColorSpace(e),t.unpackColorSpace=In._getUnpackColorSpace()}}class rte extends Rr{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new it(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const op=new ce,n7=new Cn,i7=new Cn,r7=new ce,s7=new ce;class ste{constructor(e={}){const t=this;let n,r,s,o;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:n,height:r}},this.render=function(b,R){b.matrixWorldAutoUpdate===!0&&b.updateMatrixWorld(),R.parent===null&&R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),n7.copy(R.matrixWorldInverse),i7.multiplyMatrices(R.projectionMatrix,n7),h(b,b,R),x(b)},this.setSize=function(b,R){n=b,r=R,s=n/2,o=r/2,l.style.width=b+"px",l.style.height=R+"px"};function u(b){b.isCSS2DObject&&(b.element.style.display="none");for(let R=0,E=b.children.length;R<E;R++)u(b.children[R])}function h(b,R,E){if(b.visible===!1){u(b);return}if(b.isCSS2DObject){op.setFromMatrixPosition(b.matrixWorld),op.applyMatrix4(i7);const w=op.z>=-1&&op.z<=1&&b.layers.test(E.layers)===!0,L=b.element;L.style.display=w===!0?"":"none",w===!0&&(b.onBeforeRender(t,R,E),L.style.transform="translate("+-100*b.center.x+"%,"+-100*b.center.y+"%)translate("+(op.x*s+s)+"px,"+(-op.y*o+o)+"px)",L.parentNode!==l&&l.appendChild(L),b.onAfterRender(t,R,E));const D={distanceToCameraSquared:d(E,b)};a.objects.set(b,D)}for(let w=0,L=b.children.length;w<L;w++)h(b.children[w],R,E)}function d(b,R){return r7.setFromMatrixPosition(b.matrixWorld),s7.setFromMatrixPosition(R.matrixWorld),r7.distanceToSquared(s7)}function _(b){const R=[];return b.traverseVisible(function(E){E.isCSS2DObject&&R.push(E)}),R}function x(b){const R=_(b).sort(function(w,L){if(w.renderOrder!==L.renderOrder)return L.renderOrder-w.renderOrder;const D=a.objects.get(w).distanceToCameraSquared,O=a.objects.get(L).distanceToCameraSquared;return D-O}),E=R.length;for(let w=0,L=R.length;w<L;w++)R[w].element.style.zIndex=E-w}}}function WR(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var ote=typeof global=="object"&&global&&global.Object===Object&&global,ate=typeof self=="object"&&self&&self.Object===Object&&self,I9=ote||ate||Function("return this")(),Hw=function(){return I9.Date.now()},lte=/\s/;function ute(i){for(var e=i.length;e--&&lte.test(i.charAt(e)););return e}var cte=/^\s+/;function hte(i){return i&&i.slice(0,ute(i)+1).replace(cte,"")}var qb=I9.Symbol,B9=Object.prototype,fte=B9.hasOwnProperty,dte=B9.toString,C1=qb?qb.toStringTag:void 0;function Ate(i){var e=fte.call(i,C1),t=i[C1];try{i[C1]=void 0;var n=!0}catch{}var r=dte.call(i);return n&&(e?i[C1]=t:delete i[C1]),r}var pte=Object.prototype,mte=pte.toString;function gte(i){return mte.call(i)}var _te="[object Null]",yte="[object Undefined]",o7=qb?qb.toStringTag:void 0;function vte(i){return i==null?i===void 0?yte:_te:o7&&o7 in Object(i)?Ate(i):gte(i)}function xte(i){return i!=null&&typeof i=="object"}var bte="[object Symbol]";function Ste(i){return typeof i=="symbol"||xte(i)&&vte(i)==bte}var a7=NaN,Tte=/^[-+]0x[0-9a-f]+$/i,Ete=/^0b[01]+$/i,wte=/^0o[0-7]+$/i,Mte=parseInt;function l7(i){if(typeof i=="number")return i;if(Ste(i))return a7;if(WR(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=WR(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=hte(i);var t=Ete.test(i);return t||wte.test(i)?Mte(i.slice(2),t?2:8):Tte.test(i)?a7:+i}var Rte="Expected a function",Cte=Math.max,Nte=Math.min;function Dte(i,e,t){var n,r,s,o,a,l,u=0,h=!1,d=!1,_=!0;if(typeof i!="function")throw new TypeError(Rte);e=l7(e)||0,WR(t)&&(h=!!t.leading,d="maxWait"in t,s=d?Cte(l7(t.maxWait)||0,e):s,_="trailing"in t?!!t.trailing:_);function x(G){var k=n,z=r;return n=r=void 0,u=G,o=i.apply(z,k),o}function b(G){return u=G,a=setTimeout(w,e),h?x(G):o}function R(G){var k=G-l,z=G-u,F=e-k;return d?Nte(F,s-z):F}function E(G){var k=G-l,z=G-u;return l===void 0||k>=e||k<0||d&&z>=s}function w(){var G=Hw();if(E(G))return L(G);a=setTimeout(w,R(G))}function L(G){return a=void 0,_&&n?x(G):(n=r=void 0,o)}function D(){a!==void 0&&clearTimeout(a),u=0,n=l=r=a=void 0}function O(){return a===void 0?o:L(Hw())}function B(){var G=Hw(),k=E(G);if(n=arguments,r=this,l=G,k){if(a===void 0)return b(l);if(d)return clearTimeout(a),a=setTimeout(w,e),x(l)}return a===void 0&&(a=setTimeout(w,e)),o}return B.cancel=D,B.flush=O,B}function u7(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function Pte(i){if(Array.isArray(i))return i}function Lte(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Ote(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function Ite(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Bte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ute(i,e){return Pte(i)||Ite(i,e)||Fte(i,e)||Bte()}function Fte(i,e){if(i){if(typeof i=="string")return u7(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u7(i,e):void 0}}var kte=Ote(function i(e,t){var n=t.default,r=n===void 0?null:n,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,l=a===void 0?function(u,h){}:a;Lte(this,i),this.name=e,this.defaultVal=r,this.triggerUpdate=o,this.onChange=l});function Ds(i){var e=i.stateInit,t=e===void 0?function(){return{}}:e,n=i.props,r=n===void 0?{}:n,s=i.methods,o=s===void 0?{}:s,a=i.aliases,l=a===void 0?{}:a,u=i.init,h=u===void 0?function(){}:u,d=i.update,_=d===void 0?function(){}:d,x=Object.keys(r).map(function(b){return new kte(b,r[b])});return function b(){for(var R=arguments.length,E=new Array(R),w=0;w<R;w++)E[w]=arguments[w];var L=!!(this instanceof b&&this.constructor),D=L?E.shift():void 0,O=E[0],B=O===void 0?{}:O,G=Object.assign({},t instanceof Function?t(B):t,{initialised:!1}),k={};function z(H){return F(H,B),q(),z}var F=function(Q,K){h.call(z,Q,G,K),G.initialised=!0},q=Dte(function(){G.initialised&&(_.call(z,G,k),k={})},1);return x.forEach(function(H){z[H.name]=Q(H);function Q(K){var se=K.name,ee=K.triggerUpdate,$=ee===void 0?!1:ee,re=K.onChange,ae=re===void 0?function(ye,ve){}:re,_e=K.defaultVal,ne=_e===void 0?null:_e;return function(ye){var ve=G[se];if(!arguments.length)return ve;var Pe=ye===void 0?ne:ye;return G[se]=Pe,ae.call(z,Pe,G,ve),!k.hasOwnProperty(se)&&(k[se]=ve),$&&q(),z}}}),Object.keys(o).forEach(function(H){z[H]=function(){for(var Q,K=arguments.length,se=new Array(K),ee=0;ee<K;ee++)se[ee]=arguments[ee];return(Q=o[H]).call.apply(Q,[z,G].concat(se))}}),Object.entries(l).forEach(function(H){var Q=Ute(H,2),K=Q[0],se=Q[1];return z[K]=z[se]}),z.resetProps=function(){return x.forEach(function(H){z[H.name](H.defaultVal)}),z},z.resetProps(),G._rerender=q,L&&D&&z(D),z}}var ms=Object.freeze({Linear:Object.freeze({None:function(i){return i},In:function(i){return i},Out:function(i){return i},InOut:function(i){return i}}),Quadratic:Object.freeze({In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}}),Cubic:Object.freeze({In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}}),Quartic:Object.freeze({In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}}),Quintic:Object.freeze({In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}}),Sinusoidal:Object.freeze({In:function(i){return 1-Math.sin((1-i)*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))}}),Exponential:Object.freeze({In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}}),Circular:Object.freeze({In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}}),Elastic:Object.freeze({In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(i){var e=1.70158;return i===1?1:i*i*((e+1)*i-e)},Out:function(i){var e=1.70158;return i===0?0:--i*i*((e+1)*i+e)+1},InOut:function(i){var e=2.5949095;return(i*=2)<1?.5*(i*i*((e+1)*i-e)):.5*((i-=2)*i*((e+1)*i+e)+2)}}),Bounce:Object.freeze({In:function(i){return 1-ms.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?ms.Bounce.In(i*2)*.5:ms.Bounce.Out(i*2-1)*.5+.5}}),generatePow:function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:function(e){return Math.pow(e,i)},Out:function(e){return 1-Math.pow(1-e,i)},InOut:function(e){return e<.5?Math.pow(e*2,i)/2:(1-Math.pow(2-e*2,i))/2+.5}}}}),o_=function(){return performance.now()},pT=function(){function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,s=t;r<s.length;r++){var o=s[r];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},i.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var s=r[n];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},i.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},i.prototype.update=function(e,t){e===void 0&&(e=o_()),t===void 0&&(t=!0);var n=Object.keys(this._tweens);if(n.length!==0)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var s=this._tweens[n[r]],o=!t;s&&s.update(e,o)===!1&&!t&&this.remove(s)}n=Object.keys(this._tweensAddedDuringUpdate)}},i}(),jR={Linear:function(i,e){var t=i.length-1,n=t*e,r=Math.floor(n),s=jR.Utils.Linear;return e<0?s(i[0],i[1],n):e>1?s(i[t],i[t-1],t-n):s(i[r],i[r+1>t?t:r+1],n-r)},Utils:{Linear:function(i,e,t){return(e-i)*t+i}}},U9=function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i}(),XR=new pT,Mo=function(){function i(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ms.Linear.None,this._interpolationFunction=jR.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=U9.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=XR,XR.add(this))}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.getDuration=function(){return this._duration},i.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},i.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},i.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},i.prototype.start=function(e,t){if(e===void 0&&(e=o_()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},i.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},i.prototype._setupProperties=function(e,t,n,r,s){for(var o in n){var a=e[o],l=Array.isArray(a),u=l?"array":typeof a,h=!l&&Array.isArray(n[o]);if(!(u==="undefined"||u==="function")){if(h){var d=n[o];if(d.length===0)continue;for(var _=[a],x=0,b=d.length;x<b;x+=1){var R=this._handleRelativeValue(a,d[x]);if(isNaN(R)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}_.push(R)}h&&(n[o]=_)}if((u==="object"||l)&&a&&!h){t[o]=l?[]:{};var E=a;for(var w in E)t[o][w]=E[w];r[o]=l?[]:{};var d=n[o];if(!this._isDynamic){var L={};for(var w in d)L[w]=d[w];n[o]=d=L}this._setupProperties(E,t[o],d,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),h?r[o]=n[o].slice().reverse():r[o]=t[o]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},i.prototype.pause=function(e){return e===void 0&&(e=o_()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},i.prototype.resume=function(e){return e===void 0&&(e=o_()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},i.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},i.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},i.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},i.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},i.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},i.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},i.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},i.prototype.easing=function(e){return e===void 0&&(e=ms.Linear.None),this._easingFunction=e,this},i.prototype.interpolation=function(e){return e===void 0&&(e=jR.Linear),this._interpolationFunction=e,this},i.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},i.prototype.onStart=function(e){return this._onStartCallback=e,this},i.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},i.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},i.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},i.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},i.prototype.onStop=function(e){return this._onStopCallback=e,this},i.prototype.update=function(e,t){var n=this,r;if(e===void 0&&(e=o_()),t===void 0&&(t=i.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),l=this._duration+this._repeat*a,u=function(){if(n._duration===0||o>l)return 1;var R=Math.trunc(o/a),E=o-R*a,w=Math.min(E/n._duration,1);return w===0&&o===n._duration?1:w},h=u(),d=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var _=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=_);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*_,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var x=0,b=this._chainedTweens.length;x<b;x++)this._chainedTweens[x].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(e,t,n,r){for(var s in n)if(t[s]!==void 0){var o=t[s]||0,a=n[s],l=Array.isArray(e[s]),u=Array.isArray(a),h=!l&&u;h?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},i.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},i.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},i.autoStartOnUpdate=!1,i}();U9.nextId;var uc=XR;uc.getAll.bind(uc);uc.removeAll.bind(uc);uc.add.bind(uc);uc.remove.bind(uc);uc.update.bind(uc);function Gte(i){const e=+this._x.call(null,i),t=+this._y.call(null,i),n=+this._z.call(null,i);return F9(this.cover(e,t,n),e,t,n,i)}function F9(i,e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n))return i;var s,o=i._root,a={data:r},l=i._x0,u=i._y0,h=i._z0,d=i._x1,_=i._y1,x=i._z1,b,R,E,w,L,D,O,B,G,k,z;if(!o)return i._root=a,i;for(;o.length;)if((O=e>=(b=(l+d)/2))?l=b:d=b,(B=t>=(R=(u+_)/2))?u=R:_=R,(G=n>=(E=(h+x)/2))?h=E:x=E,s=o,!(o=o[k=G<<2|B<<1|O]))return s[k]=a,i;if(w=+i._x.call(null,o.data),L=+i._y.call(null,o.data),D=+i._z.call(null,o.data),e===w&&t===L&&n===D)return a.next=o,s?s[k]=a:i._root=a,i;do s=s?s[k]=new Array(8):i._root=new Array(8),(O=e>=(b=(l+d)/2))?l=b:d=b,(B=t>=(R=(u+_)/2))?u=R:_=R,(G=n>=(E=(h+x)/2))?h=E:x=E;while((k=G<<2|B<<1|O)===(z=(D>=E)<<2|(L>=R)<<1|w>=b));return s[z]=o,s[k]=a,i}function zte(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,t=new Float64Array(e),n=new Float64Array(e),r=new Float64Array(e);let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,h=-1/0;for(let d=0,_,x,b,R;d<e;++d)isNaN(x=+this._x.call(null,_=i[d]))||isNaN(b=+this._y.call(null,_))||isNaN(R=+this._z.call(null,_))||(t[d]=x,n[d]=b,r[d]=R,x<s&&(s=x),x>l&&(l=x),b<o&&(o=b),b>u&&(u=b),R<a&&(a=R),R>h&&(h=R));if(s>l||o>u||a>h)return this;this.cover(s,o,a).cover(l,u,h);for(let d=0;d<e;++d)F9(this,t[d],n[d],r[d],i[d]);return this}function Vte(i,e,t){if(isNaN(i=+i)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._z0,o=this._x1,a=this._y1,l=this._z1;if(isNaN(n))o=(n=Math.floor(i))+1,a=(r=Math.floor(e))+1,l=(s=Math.floor(t))+1;else{for(var u=o-n||1,h=this._root,d,_;n>i||i>=o||r>e||e>=a||s>t||t>=l;)switch(_=(t<s)<<2|(e<r)<<1|i<n,d=new Array(8),d[_]=h,h=d,u*=2,_){case 0:o=n+u,a=r+u,l=s+u;break;case 1:n=o-u,a=r+u,l=s+u;break;case 2:o=n+u,r=a-u,l=s+u;break;case 3:n=o-u,r=a-u,l=s+u;break;case 4:o=n+u,a=r+u,s=l-u;break;case 5:n=o-u,a=r+u,s=l-u;break;case 6:o=n+u,r=a-u,s=l-u;break;case 7:n=o-u,r=a-u,s=l-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=n,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this}function qte(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function Hte(i){return arguments.length?this.cover(+i[0][0],+i[0][1],+i[0][2]).cover(+i[1][0],+i[1][1],+i[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function pr(i,e,t,n,r,s,o){this.node=i,this.x0=e,this.y0=t,this.z0=n,this.x1=r,this.y1=s,this.z1=o}function Wte(i,e,t,n){var r,s=this._x0,o=this._y0,a=this._z0,l,u,h,d,_,x,b=this._x1,R=this._y1,E=this._z1,w=[],L=this._root,D,O;for(L&&w.push(new pr(L,s,o,a,b,R,E)),n==null?n=1/0:(s=i-n,o=e-n,a=t-n,b=i+n,R=e+n,E=t+n,n*=n);D=w.pop();)if(!(!(L=D.node)||(l=D.x0)>b||(u=D.y0)>R||(h=D.z0)>E||(d=D.x1)<s||(_=D.y1)<o||(x=D.z1)<a))if(L.length){var B=(l+d)/2,G=(u+_)/2,k=(h+x)/2;w.push(new pr(L[7],B,G,k,d,_,x),new pr(L[6],l,G,k,B,_,x),new pr(L[5],B,u,k,d,G,x),new pr(L[4],l,u,k,B,G,x),new pr(L[3],B,G,h,d,_,k),new pr(L[2],l,G,h,B,_,k),new pr(L[1],B,u,h,d,G,k),new pr(L[0],l,u,h,B,G,k)),(O=(t>=k)<<2|(e>=G)<<1|i>=B)&&(D=w[w.length-1],w[w.length-1]=w[w.length-1-O],w[w.length-1-O]=D)}else{var z=i-+this._x.call(null,L.data),F=e-+this._y.call(null,L.data),q=t-+this._z.call(null,L.data),H=z*z+F*F+q*q;if(H<n){var Q=Math.sqrt(n=H);s=i-Q,o=e-Q,a=t-Q,b=i+Q,R=e+Q,E=t+Q,r=L.data}}return r}const jte=(i,e,t,n,r,s)=>Math.sqrt((i-n)**2+(e-r)**2+(t-s)**2);function Xte(i,e,t,n){const r=[],s=i-n,o=e-n,a=t-n,l=i+n,u=e+n,h=t+n;return this.visit((d,_,x,b,R,E,w)=>{if(!d.length)do{const L=d.data;jte(i,e,t,this._x(L),this._y(L),this._z(L))<=n&&r.push(L)}while(d=d.next);return _>l||x>u||b>h||R<s||E<o||w<a}),r}function $te(i){if(isNaN(_=+this._x.call(null,i))||isNaN(x=+this._y.call(null,i))||isNaN(b=+this._z.call(null,i)))return this;var e,t=this._root,n,r,s,o=this._x0,a=this._y0,l=this._z0,u=this._x1,h=this._y1,d=this._z1,_,x,b,R,E,w,L,D,O,B,G;if(!t)return this;if(t.length)for(;;){if((L=_>=(R=(o+u)/2))?o=R:u=R,(D=x>=(E=(a+h)/2))?a=E:h=E,(O=b>=(w=(l+d)/2))?l=w:d=w,e=t,!(t=t[B=O<<2|D<<1|L]))return this;if(!t.length)break;(e[B+1&7]||e[B+2&7]||e[B+3&7]||e[B+4&7]||e[B+5&7]||e[B+6&7]||e[B+7&7])&&(n=e,G=B)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[B]=s:delete e[B],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[G]=t:this._root=t),this):(this._root=s,this)}function Yte(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}function Qte(){return this._root}function Kte(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function Zte(i){var e=[],t,n=this._root,r,s,o,a,l,u,h;for(n&&e.push(new pr(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!i(n=t.node,s=t.x0,o=t.y0,a=t.z0,l=t.x1,u=t.y1,h=t.z1)&&n.length){var d=(s+l)/2,_=(o+u)/2,x=(a+h)/2;(r=n[7])&&e.push(new pr(r,d,_,x,l,u,h)),(r=n[6])&&e.push(new pr(r,s,_,x,d,u,h)),(r=n[5])&&e.push(new pr(r,d,o,x,l,_,h)),(r=n[4])&&e.push(new pr(r,s,o,x,d,_,h)),(r=n[3])&&e.push(new pr(r,d,_,a,l,u,x)),(r=n[2])&&e.push(new pr(r,s,_,a,d,u,x)),(r=n[1])&&e.push(new pr(r,d,o,a,l,_,x)),(r=n[0])&&e.push(new pr(r,s,o,a,d,_,x))}return this}function Jte(i){var e=[],t=[],n;for(this._root&&e.push(new pr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var r=n.node;if(r.length){var s,o=n.x0,a=n.y0,l=n.z0,u=n.x1,h=n.y1,d=n.z1,_=(o+u)/2,x=(a+h)/2,b=(l+d)/2;(s=r[0])&&e.push(new pr(s,o,a,l,_,x,b)),(s=r[1])&&e.push(new pr(s,_,a,l,u,x,b)),(s=r[2])&&e.push(new pr(s,o,x,l,_,h,b)),(s=r[3])&&e.push(new pr(s,_,x,l,u,h,b)),(s=r[4])&&e.push(new pr(s,o,a,b,_,x,d)),(s=r[5])&&e.push(new pr(s,_,a,b,u,x,d)),(s=r[6])&&e.push(new pr(s,o,x,b,_,h,d)),(s=r[7])&&e.push(new pr(s,_,x,b,u,h,d))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function ene(i){return i[0]}function tne(i){return arguments.length?(this._x=i,this):this._x}function nne(i){return i[1]}function ine(i){return arguments.length?(this._y=i,this):this._y}function rne(i){return i[2]}function sne(i){return arguments.length?(this._z=i,this):this._z}function k9(i,e,t,n){var r=new y8(e??ene,t??nne,n??rne,NaN,NaN,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}function y8(i,e,t,n,r,s,o,a,l){this._x=i,this._y=e,this._z=t,this._x0=n,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this._root=void 0}function c7(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var lo=k9.prototype=y8.prototype;lo.copy=function(){var i=new y8(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=c7(e),i;for(t=[{source:e,target:i._root=new Array(8)}];e=t.pop();)for(var r=0;r<8;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(8)}):e.target[r]=c7(n));return i};lo.add=Gte;lo.addAll=zte;lo.cover=Vte;lo.data=qte;lo.extent=Hte;lo.find=Wte;lo.findAllWithinRadius=Xte;lo.remove=$te;lo.removeAll=Yte;lo.root=Qte;lo.size=Kte;lo.visit=Zte;lo.visitAfter=Jte;lo.x=tne;lo.y=ine;lo.z=sne;function xb(i,e){return i==null||e==null?NaN:i<e?-1:i>e?1:i>=e?0:NaN}function one(i,e){return i==null||e==null?NaN:e<i?-1:e>i?1:e>=i?0:NaN}function G9(i){let e,t,n;i.length!==2?(e=xb,t=(a,l)=>xb(i(a),l),n=(a,l)=>i(a)-l):(e=i===xb||i===one?i:ane,t=i,n=i);function r(a,l,u=0,h=a.length){if(u<h){if(e(l,l)!==0)return h;do{const d=u+h>>>1;t(a[d],l)<0?u=d+1:h=d}while(u<h)}return u}function s(a,l,u=0,h=a.length){if(u<h){if(e(l,l)!==0)return h;do{const d=u+h>>>1;t(a[d],l)<=0?u=d+1:h=d}while(u<h)}return u}function o(a,l,u=0,h=a.length){const d=r(a,l,u,h-1);return d>u&&n(a[d-1],l)>-n(a[d],l)?d-1:d}return{left:r,center:o,right:s}}function ane(){return 0}function lne(i){return i===null?NaN:+i}const une=G9(xb),z9=une.right;G9(lne).center;function Hb(i,e){let t,n;if(e===void 0)for(const r of i)r!=null&&(t===void 0?r>=r&&(t=n=r):(t>r&&(t=r),n<r&&(n=r)));else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(t===void 0?s>=s&&(t=n=s):(t>s&&(t=s),n<s&&(n=s)))}return[t,n]}class _h{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t=this._n,n,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(n=o,r=e[--t],o=n+r,s=r-(o-n),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,n=o+r,r==n-o&&(o=n))}return o}}const cne=Math.sqrt(50),hne=Math.sqrt(10),fne=Math.sqrt(2);function Wb(i,e,t){const n=(e-i)/Math.max(0,t),r=Math.floor(Math.log10(n)),s=n/Math.pow(10,r),o=s>=cne?10:s>=hne?5:s>=fne?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(i*u),l=Math.round(e*u),a/u<i&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(i/u),l=Math.round(e/u),a*u<i&&++a,l*u>e&&--l),l<a&&.5<=t&&t<2?Wb(i,e,t*2):[a,l,u]}function dne(i,e,t){if(e=+e,i=+i,t=+t,!(t>0))return[];if(i===e)return[i];const n=e<i,[r,s,o]=n?Wb(e,i,t):Wb(i,e,t);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(n)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function $R(i,e,t){return e=+e,i=+i,t=+t,Wb(i,e,t)[2]}function Ane(i,e,t){e=+e,i=+i,t=+t;const n=e<i,r=n?$R(e,i,t):$R(i,e,t);return(n?-1:1)*(r<0?1/-r:r)}function pne(i,e){let t;for(const n of i)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);return t}function mne(i,e){let t=0,n=0;if(e===void 0)for(let r of i)r!=null&&(r=+r)>=r&&(++t,n+=r);else{let r=-1;for(let s of i)(s=e(s,++r,i))!=null&&(s=+s)>=s&&(++t,n+=s)}if(t)return n/t}function*gne(i){for(const e of i)yield*e}function oy(i){return Array.from(gne(i))}function Gp(i,e,t){i=+i,e=+e,t=(r=arguments.length)<2?(e=i,i=0,1):r<3?1:+t;for(var n=-1,r=Math.max(0,Math.ceil((e-i)/t))|0,s=new Array(r);++n<r;)s[n]=i+n*t;return s}function _ne(i,e){let t=0;for(let n of i)(n=+n)&&(t+=n);return t}function V9(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i);break}return this}function v8(i,e,t){i.prototype=e.prototype=t,t.constructor=i}function q9(i,e){var t=Object.create(i.prototype);for(var n in e)t[n]=e[n];return t}function Ky(){}var ay=.7,jb=1/ay,em="\\s*([+-]?\\d+)\\s*",ly="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ec="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yne=/^#([0-9a-f]{3,8})$/,vne=new RegExp(`^rgb\\(${em},${em},${em}\\)$`),xne=new RegExp(`^rgb\\(${ec},${ec},${ec}\\)$`),bne=new RegExp(`^rgba\\(${em},${em},${em},${ly}\\)$`),Sne=new RegExp(`^rgba\\(${ec},${ec},${ec},${ly}\\)$`),Tne=new RegExp(`^hsl\\(${ly},${ec},${ec}\\)$`),Ene=new RegExp(`^hsla\\(${ly},${ec},${ec},${ly}\\)$`),h7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};v8(Ky,qA,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:f7,formatHex:f7,formatHex8:wne,formatHsl:Mne,formatRgb:d7,toString:d7});function f7(){return this.rgb().formatHex()}function wne(){return this.rgb().formatHex8()}function Mne(){return H9(this).formatHsl()}function d7(){return this.rgb().formatRgb()}function qA(i){var e,t;return i=(i+"").trim().toLowerCase(),(e=yne.exec(i))?(t=e[1].length,e=parseInt(e[1],16),t===6?A7(e):t===3?new ha(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?ux(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?ux(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=vne.exec(i))?new ha(e[1],e[2],e[3],1):(e=xne.exec(i))?new ha(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=bne.exec(i))?ux(e[1],e[2],e[3],e[4]):(e=Sne.exec(i))?ux(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Tne.exec(i))?g7(e[1],e[2]/100,e[3]/100,1):(e=Ene.exec(i))?g7(e[1],e[2]/100,e[3]/100,e[4]):h7.hasOwnProperty(i)?A7(h7[i]):i==="transparent"?new ha(NaN,NaN,NaN,0):null}function A7(i){return new ha(i>>16&255,i>>8&255,i&255,1)}function ux(i,e,t,n){return n<=0&&(i=e=t=NaN),new ha(i,e,t,n)}function Rne(i){return i instanceof Ky||(i=qA(i)),i?(i=i.rgb(),new ha(i.r,i.g,i.b,i.opacity)):new ha}function YR(i,e,t,n){return arguments.length===1?Rne(i):new ha(i,e,t,n??1)}function ha(i,e,t,n){this.r=+i,this.g=+e,this.b=+t,this.opacity=+n}v8(ha,YR,q9(Ky,{brighter(i){return i=i==null?jb:Math.pow(jb,i),new ha(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=i==null?ay:Math.pow(ay,i),new ha(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new ha(CA(this.r),CA(this.g),CA(this.b),Xb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:p7,formatHex:p7,formatHex8:Cne,formatRgb:m7,toString:m7}));function p7(){return`#${mA(this.r)}${mA(this.g)}${mA(this.b)}`}function Cne(){return`#${mA(this.r)}${mA(this.g)}${mA(this.b)}${mA((isNaN(this.opacity)?1:this.opacity)*255)}`}function m7(){const i=Xb(this.opacity);return`${i===1?"rgb(":"rgba("}${CA(this.r)}, ${CA(this.g)}, ${CA(this.b)}${i===1?")":`, ${i})`}`}function Xb(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function CA(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function mA(i){return i=CA(i),(i<16?"0":"")+i.toString(16)}function g7(i,e,t,n){return n<=0?i=e=t=NaN:t<=0||t>=1?i=e=NaN:e<=0&&(i=NaN),new uu(i,e,t,n)}function H9(i){if(i instanceof uu)return new uu(i.h,i.s,i.l,i.opacity);if(i instanceof Ky||(i=qA(i)),!i)return new uu;if(i instanceof uu)return i;i=i.rgb();var e=i.r/255,t=i.g/255,n=i.b/255,r=Math.min(e,t,n),s=Math.max(e,t,n),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(t-n)/a+(t<n)*6:t===s?o=(n-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new uu(o,a,l,i.opacity)}function Nne(i,e,t,n){return arguments.length===1?H9(i):new uu(i,e,t,n??1)}function uu(i,e,t,n){this.h=+i,this.s=+e,this.l=+t,this.opacity=+n}v8(uu,Nne,q9(Ky,{brighter(i){return i=i==null?jb:Math.pow(jb,i),new uu(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=i==null?ay:Math.pow(ay,i),new uu(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+(this.h<0)*360,e=isNaN(i)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,r=2*t-n;return new ha(Ww(i>=240?i-240:i+120,r,n),Ww(i,r,n),Ww(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new uu(_7(this.h),cx(this.s),cx(this.l),Xb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=Xb(this.opacity);return`${i===1?"hsl(":"hsla("}${_7(this.h)}, ${cx(this.s)*100}%, ${cx(this.l)*100}%${i===1?")":`, ${i})`}`}}));function _7(i){return i=(i||0)%360,i<0?i+360:i}function cx(i){return Math.max(0,Math.min(1,i||0))}function Ww(i,e,t){return(i<60?e+(t-e)*i/60:i<180?t:i<240?e+(t-e)*(240-i)/60:e)*255}const x8=i=>()=>i;function Dne(i,e){return function(t){return i+t*e}}function Pne(i,e,t){return i=Math.pow(i,t),e=Math.pow(e,t)-i,t=1/t,function(n){return Math.pow(i+n*e,t)}}function Lne(i){return(i=+i)==1?W9:function(e,t){return t-e?Pne(e,t,i):x8(isNaN(e)?t:e)}}function W9(i,e){var t=e-i;return t?Dne(i,t):x8(isNaN(i)?e:i)}const y7=function i(e){var t=Lne(e);function n(r,s){var o=t((r=YR(r)).r,(s=YR(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),u=W9(r.opacity,s.opacity);return function(h){return r.r=o(h),r.g=a(h),r.b=l(h),r.opacity=u(h),r+""}}return n.gamma=i,n}(1);function j9(i,e){e||(e=[]);var t=i?Math.min(e.length,i.length):0,n=e.slice(),r;return function(s){for(r=0;r<t;++r)n[r]=i[r]*(1-s)+e[r]*s;return n}}function X9(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function One(i,e){return(X9(e)?j9:$9)(i,e)}function $9(i,e){var t=e?e.length:0,n=i?Math.min(t,i.length):0,r=new Array(n),s=new Array(t),o;for(o=0;o<n;++o)r[o]=b8(i[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<n;++o)s[o]=r[o](a);return s}}function Ine(i,e){var t=new Date;return i=+i,e=+e,function(n){return t.setTime(i*(1-n)+e*n),t}}function uy(i,e){return i=+i,e=+e,function(t){return i*(1-t)+e*t}}function Bne(i,e){var t={},n={},r;(i===null||typeof i!="object")&&(i={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in i?t[r]=b8(i[r],e[r]):n[r]=e[r];return function(s){for(r in t)n[r]=t[r](s);return n}}var QR=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jw=new RegExp(QR.source,"g");function Une(i){return function(){return i}}function Fne(i){return function(e){return i(e)+""}}function kne(i,e){var t=QR.lastIndex=jw.lastIndex=0,n,r,s,o=-1,a=[],l=[];for(i=i+"",e=e+"";(n=QR.exec(i))&&(r=jw.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:uy(n,r)})),t=jw.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?Fne(l[0].x):Une(e):(e=l.length,function(u){for(var h=0,d;h<e;++h)a[(d=l[h]).i]=d.x(u);return a.join("")})}function b8(i,e){var t=typeof e,n;return e==null||t==="boolean"?x8(e):(t==="number"?uy:t==="string"?(n=qA(e))?(e=n,y7):kne:e instanceof qA?y7:e instanceof Date?Ine:X9(e)?j9:Array.isArray(e)?$9:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Bne:uy)(i,e)}function Gne(i,e){return i=+i,e=+e,function(t){return Math.round(i*(1-t)+e*t)}}function zne(i){return function(){return i}}function Vne(i){return+i}var v7=[0,1];function zp(i){return i}function KR(i,e){return(e-=i=+i)?function(t){return(t-i)/e}:zne(isNaN(e)?NaN:.5)}function qne(i,e){var t;return i>e&&(t=i,i=e,e=t),function(n){return Math.max(i,Math.min(e,n))}}function Hne(i,e,t){var n=i[0],r=i[1],s=e[0],o=e[1];return r<n?(n=KR(r,n),s=t(o,s)):(n=KR(n,r),s=t(s,o)),function(a){return s(n(a))}}function Wne(i,e,t){var n=Math.min(i.length,e.length)-1,r=new Array(n),s=new Array(n),o=-1;for(i[n]<i[0]&&(i=i.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=KR(i[o],i[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=z9(i,a,1,n)-1;return s[l](r[l](a))}}function jne(i,e){return e.domain(i.domain()).range(i.range()).interpolate(i.interpolate()).clamp(i.clamp()).unknown(i.unknown())}function Xne(){var i=v7,e=v7,t=b8,n,r,s,o=zp,a,l,u;function h(){var _=Math.min(i.length,e.length);return o!==zp&&(o=qne(i[0],i[_-1])),a=_>2?Wne:Hne,l=u=null,d}function d(_){return _==null||isNaN(_=+_)?s:(l||(l=a(i.map(n),e,t)))(n(o(_)))}return d.invert=function(_){return o(r((u||(u=a(e,i.map(n),uy)))(_)))},d.domain=function(_){return arguments.length?(i=Array.from(_,Vne),h()):i.slice()},d.range=function(_){return arguments.length?(e=Array.from(_),h()):e.slice()},d.rangeRound=function(_){return e=Array.from(_),t=Gne,h()},d.clamp=function(_){return arguments.length?(o=_?!0:zp,h()):o!==zp},d.interpolate=function(_){return arguments.length?(t=_,h()):t},d.unknown=function(_){return arguments.length?(s=_,d):s},function(_,x){return n=_,r=x,h()}}function $ne(){return Xne()(zp,zp)}function Yne(i){return Math.abs(i=Math.round(i))>=1e21?i.toLocaleString("en").replace(/,/g,""):i.toString(10)}function $b(i,e){if((t=(i=e?i.toExponential(e-1):i.toExponential()).indexOf("e"))<0)return null;var t,n=i.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+i.slice(t+1)]}function Bm(i){return i=$b(Math.abs(i)),i?i[1]:NaN}function Qne(i,e){return function(t,n){for(var r=t.length,s=[],o=0,a=i[0],l=0;r>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>n));)a=i[o=(o+1)%i.length];return s.reverse().join(e)}}function Kne(i){return function(e){return e.replace(/[0-9]/g,function(t){return i[+t]})}}var Zne=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yb(i){if(!(e=Zne.exec(i)))throw new Error("invalid format: "+i);var e;return new S8({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Yb.prototype=S8.prototype;function S8(i){this.fill=i.fill===void 0?" ":i.fill+"",this.align=i.align===void 0?">":i.align+"",this.sign=i.sign===void 0?"-":i.sign+"",this.symbol=i.symbol===void 0?"":i.symbol+"",this.zero=!!i.zero,this.width=i.width===void 0?void 0:+i.width,this.comma=!!i.comma,this.precision=i.precision===void 0?void 0:+i.precision,this.trim=!!i.trim,this.type=i.type===void 0?"":i.type+""}S8.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jne(i){e:for(var e=i.length,t=1,n=-1,r;t<e;++t)switch(i[t]){case".":n=r=t;break;case"0":n===0&&(n=t),r=t;break;default:if(!+i[t])break e;n>0&&(n=0);break}return n>0?i.slice(0,n)+i.slice(r+1):i}var Y9;function eie(i,e){var t=$b(i,e);if(!t)return i+"";var n=t[0],r=t[1],s=r-(Y9=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+$b(i,Math.max(0,e+s-1))[0]}function x7(i,e){var t=$b(i,e);if(!t)return i+"";var n=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}const b7={"%":(i,e)=>(i*100).toFixed(e),b:i=>Math.round(i).toString(2),c:i=>i+"",d:Yne,e:(i,e)=>i.toExponential(e),f:(i,e)=>i.toFixed(e),g:(i,e)=>i.toPrecision(e),o:i=>Math.round(i).toString(8),p:(i,e)=>x7(i*100,e),r:x7,s:eie,X:i=>Math.round(i).toString(16).toUpperCase(),x:i=>Math.round(i).toString(16)};function S7(i){return i}var T7=Array.prototype.map,E7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function tie(i){var e=i.grouping===void 0||i.thousands===void 0?S7:Qne(T7.call(i.grouping,Number),i.thousands+""),t=i.currency===void 0?"":i.currency[0]+"",n=i.currency===void 0?"":i.currency[1]+"",r=i.decimal===void 0?".":i.decimal+"",s=i.numerals===void 0?S7:Kne(T7.call(i.numerals,String)),o=i.percent===void 0?"%":i.percent+"",a=i.minus===void 0?"":i.minus+"",l=i.nan===void 0?"NaN":i.nan+"";function u(d){d=Yb(d);var _=d.fill,x=d.align,b=d.sign,R=d.symbol,E=d.zero,w=d.width,L=d.comma,D=d.precision,O=d.trim,B=d.type;B==="n"?(L=!0,B="g"):b7[B]||(D===void 0&&(D=12),O=!0,B="g"),(E||_==="0"&&x==="=")&&(E=!0,_="0",x="=");var G=R==="$"?t:R==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",k=R==="$"?n:/[%p]/.test(B)?o:"",z=b7[B],F=/[defgprs%]/.test(B);D=D===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,D)):Math.max(0,Math.min(20,D));function q(H){var Q=G,K=k,se,ee,$;if(B==="c")K=z(H)+K,H="";else{H=+H;var re=H<0||1/H<0;if(H=isNaN(H)?l:z(Math.abs(H),D),O&&(H=Jne(H)),re&&+H==0&&b!=="+"&&(re=!1),Q=(re?b==="("?b:a:b==="-"||b==="("?"":b)+Q,K=(B==="s"?E7[8+Y9/3]:"")+K+(re&&b==="("?")":""),F){for(se=-1,ee=H.length;++se<ee;)if($=H.charCodeAt(se),48>$||$>57){K=($===46?r+H.slice(se+1):H.slice(se))+K,H=H.slice(0,se);break}}}L&&!E&&(H=e(H,1/0));var ae=Q.length+H.length+K.length,_e=ae<w?new Array(w-ae+1).join(_):"";switch(L&&E&&(H=e(_e+H,_e.length?w-K.length:1/0),_e=""),x){case"<":H=Q+H+K+_e;break;case"=":H=Q+_e+H+K;break;case"^":H=_e.slice(0,ae=_e.length>>1)+Q+H+K+_e.slice(ae);break;default:H=_e+Q+H+K;break}return s(H)}return q.toString=function(){return d+""},q}function h(d,_){var x=u((d=Yb(d),d.type="f",d)),b=Math.max(-8,Math.min(8,Math.floor(Bm(_)/3)))*3,R=Math.pow(10,-b),E=E7[8+b/3];return function(w){return x(R*w)+E}}return{format:u,formatPrefix:h}}var hx,Q9,K9;nie({thousands:",",grouping:[3],currency:["$",""]});function nie(i){return hx=tie(i),Q9=hx.format,K9=hx.formatPrefix,hx}function iie(i){return Math.max(0,-Bm(Math.abs(i)))}function rie(i,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bm(e)/3)))*3-Bm(Math.abs(i)))}function sie(i,e){return i=Math.abs(i),e=Math.abs(e)-i,Math.max(0,Bm(e)-Bm(i))+1}function oie(i,e,t,n){var r=Ane(i,e,t),s;switch(n=Yb(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(i),Math.abs(e));return n.precision==null&&!isNaN(s=rie(r,o))&&(n.precision=s),K9(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=sie(r,Math.max(Math.abs(i),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=iie(r))&&(n.precision=s-(n.type==="%")*2);break}}return Q9(n)}function Z9(i){var e=i.domain;return i.ticks=function(t){var n=e();return dne(n[0],n[n.length-1],t??10)},i.tickFormat=function(t,n){var r=e();return oie(r[0],r[r.length-1],t??10,n)},i.nice=function(t){t==null&&(t=10);var n=e(),r=0,s=n.length-1,o=n[r],a=n[s],l,u,h=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);h-- >0;){if(u=$R(o,a,t),u===l)return n[r]=o,n[s]=a,e(n);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return i},i}function Rh(){var i=$ne();return i.copy=function(){return jne(i,Rh())},V9.apply(i,arguments),Z9(i)}function J9(){var i=0,e=1,t=1,n=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[z9(n,l,0,t)]:s}function a(){var l=-1;for(n=new Array(t);++l<t;)n[l]=((l+1)*e-(l-t)*i)/(t+1);return o}return o.domain=function(l){return arguments.length?([i,e]=l,i=+i,e=+e,a()):[i,e]},o.range=function(l){return arguments.length?(t=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[i,n[0]]:u>=t?[n[t-1],e]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return J9().domain([i,e]).range(r).unknown(s)},V9.apply(Z9(o),arguments)}var pi=1e-6,Qb=1e-12,Ni=Math.PI,fa=Ni/2,Kb=Ni/4,el=Ni*2,Kr=180/Ni,Wn=Ni/180,cr=Math.abs,T8=Math.atan,Pl=Math.atan2,Jn=Math.cos,fx=Math.ceil,aie=Math.exp,ZR=Math.hypot,lie=Math.log,Fn=Math.sin,uie=Math.sign||function(i){return i>0?1:i<0?-1:0},Ch=Math.sqrt,cie=Math.tan;function hie(i){return i>1?0:i<-1?Ni:Math.acos(i)}function Nh(i){return i>1?fa:i<-1?-fa:Math.asin(i)}function w7(i){return(i=Fn(i/2))*i}function So(){}function Zb(i,e){i&&R7.hasOwnProperty(i.type)&&R7[i.type](i,e)}var M7={Feature:function(i,e){Zb(i.geometry,e)},FeatureCollection:function(i,e){for(var t=i.features,n=-1,r=t.length;++n<r;)Zb(t[n].geometry,e)}},R7={Sphere:function(i,e){e.sphere()},Point:function(i,e){i=i.coordinates,e.point(i[0],i[1],i[2])},MultiPoint:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)i=t[n],e.point(i[0],i[1],i[2])},LineString:function(i,e){JR(i.coordinates,e,0)},MultiLineString:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)JR(t[n],e,0)},Polygon:function(i,e){C7(i.coordinates,e)},MultiPolygon:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)C7(t[n],e)},GeometryCollection:function(i,e){for(var t=i.geometries,n=-1,r=t.length;++n<r;)Zb(t[n],e)}};function JR(i,e,t){var n=-1,r=i.length-t,s;for(e.lineStart();++n<r;)s=i[n],e.point(s[0],s[1],s[2]);e.lineEnd()}function C7(i,e){var t=-1,n=i.length;for(e.polygonStart();++t<n;)JR(i[t],e,1);e.polygonEnd()}function mT(i,e){i&&M7.hasOwnProperty(i.type)?M7[i.type](i,e):Zb(i,e)}var Jb=new _h,N7=new _h,eF,tF,eC,tC,nC,Dh={point:So,lineStart:So,lineEnd:So,polygonStart:function(){Jb=new _h,Dh.lineStart=fie,Dh.lineEnd=die},polygonEnd:function(){var i=+Jb;N7.add(i<0?el+i:i),this.lineStart=this.lineEnd=this.point=So},sphere:function(){N7.add(el)}};function fie(){Dh.point=Aie}function die(){nF(eF,tF)}function Aie(i,e){Dh.point=nF,eF=i,tF=e,i*=Wn,e*=Wn,eC=i,tC=Jn(e=e/2+Kb),nC=Fn(e)}function nF(i,e){i*=Wn,e*=Wn,e=e/2+Kb;var t=i-eC,n=t>=0?1:-1,r=n*t,s=Jn(e),o=Fn(e),a=nC*o,l=tC*s+a*Jn(r),u=a*n*Fn(r);Jb.add(Pl(u,l)),eC=i,tC=s,nC=o}function eS(i){return[Pl(i[1],i[0]),Nh(i[2])]}function HA(i){var e=i[0],t=i[1],n=Jn(t);return[n*Jn(e),n*Fn(e),Fn(t)]}function dx(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Um(i,e){return[i[1]*e[2]-i[2]*e[1],i[2]*e[0]-i[0]*e[2],i[0]*e[1]-i[1]*e[0]]}function Xw(i,e){i[0]+=e[0],i[1]+=e[1],i[2]+=e[2]}function Ax(i,e){return[i[0]*e,i[1]*e,i[2]*e]}function tS(i){var e=Ch(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]/=e,i[1]/=e,i[2]/=e}var kr,ra,Yr,ja,rA,iF,rF,tm,M_,zf,Ph,lh={point:iC,lineStart:D7,lineEnd:P7,polygonStart:function(){lh.point=oF,lh.lineStart=pie,lh.lineEnd=mie,M_=new _h,Dh.polygonStart()},polygonEnd:function(){Dh.polygonEnd(),lh.point=iC,lh.lineStart=D7,lh.lineEnd=P7,Jb<0?(kr=-(Yr=180),ra=-(ja=90)):M_>pi?ja=90:M_<-pi&&(ra=-90),Ph[0]=kr,Ph[1]=Yr},sphere:function(){kr=-(Yr=180),ra=-(ja=90)}};function iC(i,e){zf.push(Ph=[kr=i,Yr=i]),e<ra&&(ra=e),e>ja&&(ja=e)}function sF(i,e){var t=HA([i*Wn,e*Wn]);if(tm){var n=Um(tm,t),r=[n[1],-n[0],0],s=Um(r,n);tS(s),s=eS(s);var o=i-rA,a=o>0?1:-1,l=s[0]*Kr*a,u,h=cr(o)>180;h^(a*rA<l&&l<a*i)?(u=s[1]*Kr,u>ja&&(ja=u)):(l=(l+360)%360-180,h^(a*rA<l&&l<a*i)?(u=-s[1]*Kr,u<ra&&(ra=u)):(e<ra&&(ra=e),e>ja&&(ja=e))),h?i<rA?qa(kr,i)>qa(kr,Yr)&&(Yr=i):qa(i,Yr)>qa(kr,Yr)&&(kr=i):Yr>=kr?(i<kr&&(kr=i),i>Yr&&(Yr=i)):i>rA?qa(kr,i)>qa(kr,Yr)&&(Yr=i):qa(i,Yr)>qa(kr,Yr)&&(kr=i)}else zf.push(Ph=[kr=i,Yr=i]);e<ra&&(ra=e),e>ja&&(ja=e),tm=t,rA=i}function D7(){lh.point=sF}function P7(){Ph[0]=kr,Ph[1]=Yr,lh.point=iC,tm=null}function oF(i,e){if(tm){var t=i-rA;M_.add(cr(t)>180?t+(t>0?360:-360):t)}else iF=i,rF=e;Dh.point(i,e),sF(i,e)}function pie(){Dh.lineStart()}function mie(){oF(iF,rF),Dh.lineEnd(),cr(M_)>pi&&(kr=-(Yr=180)),Ph[0]=kr,Ph[1]=Yr,tm=null}function qa(i,e){return(e-=i)<0?e+360:e}function gie(i,e){return i[0]-e[0]}function L7(i,e){return i[0]<=i[1]?i[0]<=e&&e<=i[1]:e<i[0]||i[1]<e}function aF(i){var e,t,n,r,s,o,a;if(ja=Yr=-(kr=ra=1/0),zf=[],mT(i,lh),t=zf.length){for(zf.sort(gie),e=1,n=zf[0],s=[n];e<t;++e)r=zf[e],L7(n,r[0])||L7(n,r[1])?(qa(n[0],r[1])>qa(n[0],n[1])&&(n[1]=r[1]),qa(r[0],n[1])>qa(n[0],n[1])&&(n[0]=r[0])):s.push(n=r);for(o=-1/0,t=s.length-1,e=0,n=s[t];e<=t;n=r,++e)r=s[e],(a=qa(n[1],r[0]))>o&&(o=a,kr=r[0],Yr=n[1])}return zf=Ph=null,kr===1/0||ra===1/0?[[NaN,NaN],[NaN,NaN]]:[[kr,ra],[Yr,ja]]}var a_,nS,iS,rS,sS,oS,aS,lS,rC,sC,oC,lF,uF,Bo,Uo,Fo,fu={sphere:So,point:E8,lineStart:O7,lineEnd:I7,polygonStart:function(){fu.lineStart=vie,fu.lineEnd=xie},polygonEnd:function(){fu.lineStart=O7,fu.lineEnd=I7}};function E8(i,e){i*=Wn,e*=Wn;var t=Jn(e);Zy(t*Jn(i),t*Fn(i),Fn(e))}function Zy(i,e,t){++a_,iS+=(i-iS)/a_,rS+=(e-rS)/a_,sS+=(t-sS)/a_}function O7(){fu.point=_ie}function _ie(i,e){i*=Wn,e*=Wn;var t=Jn(e);Bo=t*Jn(i),Uo=t*Fn(i),Fo=Fn(e),fu.point=yie,Zy(Bo,Uo,Fo)}function yie(i,e){i*=Wn,e*=Wn;var t=Jn(e),n=t*Jn(i),r=t*Fn(i),s=Fn(e),o=Pl(Ch((o=Uo*s-Fo*r)*o+(o=Fo*n-Bo*s)*o+(o=Bo*r-Uo*n)*o),Bo*n+Uo*r+Fo*s);nS+=o,oS+=o*(Bo+(Bo=n)),aS+=o*(Uo+(Uo=r)),lS+=o*(Fo+(Fo=s)),Zy(Bo,Uo,Fo)}function I7(){fu.point=E8}function vie(){fu.point=bie}function xie(){cF(lF,uF),fu.point=E8}function bie(i,e){lF=i,uF=e,i*=Wn,e*=Wn,fu.point=cF;var t=Jn(e);Bo=t*Jn(i),Uo=t*Fn(i),Fo=Fn(e),Zy(Bo,Uo,Fo)}function cF(i,e){i*=Wn,e*=Wn;var t=Jn(e),n=t*Jn(i),r=t*Fn(i),s=Fn(e),o=Uo*s-Fo*r,a=Fo*n-Bo*s,l=Bo*r-Uo*n,u=ZR(o,a,l),h=Nh(u),d=u&&-h/u;rC.add(d*o),sC.add(d*a),oC.add(d*l),nS+=h,oS+=h*(Bo+(Bo=n)),aS+=h*(Uo+(Uo=r)),lS+=h*(Fo+(Fo=s)),Zy(Bo,Uo,Fo)}function B7(i){a_=nS=iS=rS=sS=oS=aS=lS=0,rC=new _h,sC=new _h,oC=new _h,mT(i,fu);var e=+rC,t=+sC,n=+oC,r=ZR(e,t,n);return r<Qb&&(e=oS,t=aS,n=lS,nS<pi&&(e=iS,t=rS,n=sS),r=ZR(e,t,n),r<Qb)?[NaN,NaN]:[Pl(t,e)*Kr,Nh(n/r)*Kr]}function aC(i,e){function t(n,r){return n=i(n,r),e(n[0],n[1])}return i.invert&&e.invert&&(t.invert=function(n,r){return n=e.invert(n,r),n&&i.invert(n[0],n[1])}),t}function lC(i,e){return cr(i)>Ni&&(i-=Math.round(i/el)*el),[i,e]}lC.invert=lC;function hF(i,e,t){return(i%=el)?e||t?aC(F7(i),k7(e,t)):F7(i):e||t?k7(e,t):lC}function U7(i){return function(e,t){return e+=i,cr(e)>Ni&&(e-=Math.round(e/el)*el),[e,t]}}function F7(i){var e=U7(i);return e.invert=U7(-i),e}function k7(i,e){var t=Jn(i),n=Fn(i),r=Jn(e),s=Fn(e);function o(a,l){var u=Jn(l),h=Jn(a)*u,d=Fn(a)*u,_=Fn(l),x=_*t+h*n;return[Pl(d*r-x*s,h*t-_*n),Nh(x*r+d*s)]}return o.invert=function(a,l){var u=Jn(l),h=Jn(a)*u,d=Fn(a)*u,_=Fn(l),x=_*r-d*s;return[Pl(d*r+_*s,h*t+x*n),Nh(x*t-h*n)]},o}function Sie(i){i=hF(i[0]*Wn,i[1]*Wn,i.length>2?i[2]*Wn:0);function e(t){return t=i(t[0]*Wn,t[1]*Wn),t[0]*=Kr,t[1]*=Kr,t}return e.invert=function(t){return t=i.invert(t[0]*Wn,t[1]*Wn),t[0]*=Kr,t[1]*=Kr,t},e}function Tie(i,e,t,n,r,s){if(t){var o=Jn(e),a=Fn(e),l=n*t;r==null?(r=e+n*el,s=e-l/2):(r=G7(o,r),s=G7(o,s),(n>0?r<s:r>s)&&(r+=n*el));for(var u,h=r;n>0?h>s:h<s;h-=l)u=eS([o,-a*Jn(h),-a*Fn(h)]),i.point(u[0],u[1])}}function G7(i,e){e=HA(e),e[0]-=i,tS(e);var t=hie(-e[1]);return((-e[2]<0?-t:t)+el-pi)%el}function fF(){var i=[],e;return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){i.push(e=[])},lineEnd:So,rejoin:function(){i.length>1&&i.push(i.pop().concat(i.shift()))},result:function(){var t=i;return i=[],e=null,t}}}function bb(i,e){return cr(i[0]-e[0])<pi&&cr(i[1]-e[1])<pi}function px(i,e,t,n){this.x=i,this.z=e,this.o=t,this.e=n,this.v=!1,this.n=this.p=null}function dF(i,e,t,n,r){var s=[],o=[],a,l;if(i.forEach(function(b){if(!((R=b.length-1)<=0)){var R,E=b[0],w=b[R],L;if(bb(E,w)){if(!E[2]&&!w[2]){for(r.lineStart(),a=0;a<R;++a)r.point((E=b[a])[0],E[1]);r.lineEnd();return}w[0]+=2*pi}s.push(L=new px(E,b,null,!0)),o.push(L.o=new px(E,null,L,!1)),s.push(L=new px(w,b,null,!1)),o.push(L.o=new px(w,null,L,!0))}}),!!s.length){for(o.sort(e),z7(s),z7(o),a=0,l=o.length;a<l;++a)o[a].e=t=!t;for(var u=s[0],h,d;;){for(var _=u,x=!0;_.v;)if((_=_.n)===u)return;h=_.z,r.lineStart();do{if(_.v=_.o.v=!0,_.e){if(x)for(a=0,l=h.length;a<l;++a)r.point((d=h[a])[0],d[1]);else n(_.x,_.n.x,1,r);_=_.n}else{if(x)for(h=_.p.z,a=h.length-1;a>=0;--a)r.point((d=h[a])[0],d[1]);else n(_.x,_.p.x,-1,r);_=_.p}_=_.o,h=_.z,x=!x}while(!_.v);r.lineEnd()}}}function z7(i){if(e=i.length){for(var e,t=0,n=i[0],r;++t<e;)n.n=r=i[t],r.p=n,n=r;n.n=r=i[0],r.p=n}}function $w(i){return cr(i[0])<=Ni?i[0]:uie(i[0])*((cr(i[0])+Ni)%el-Ni)}function AF(i,e){var t=$w(e),n=e[1],r=Fn(n),s=[Fn(t),-Jn(t),0],o=0,a=0,l=new _h;r===1?n=fa+pi:r===-1&&(n=-fa-pi);for(var u=0,h=i.length;u<h;++u)if(_=(d=i[u]).length)for(var d,_,x=d[_-1],b=$w(x),R=x[1]/2+Kb,E=Fn(R),w=Jn(R),L=0;L<_;++L,b=O,E=G,w=k,x=D){var D=d[L],O=$w(D),B=D[1]/2+Kb,G=Fn(B),k=Jn(B),z=O-b,F=z>=0?1:-1,q=F*z,H=q>Ni,Q=E*G;if(l.add(Pl(Q*F*Fn(q),w*k+Q*Jn(q))),o+=H?z+F*el:z,H^b>=t^O>=t){var K=Um(HA(x),HA(D));tS(K);var se=Um(s,K);tS(se);var ee=(H^z>=0?-1:1)*Nh(se[2]);(n>ee||n===ee&&(K[0]||K[1]))&&(a+=H^z>=0?1:-1)}}return(o<-pi||o<pi&&l<-Qb)^a&1}function pF(i,e,t,n){return function(r){var s=e(r),o=fF(),a=e(o),l=!1,u,h,d,_={point:x,lineStart:R,lineEnd:E,polygonStart:function(){_.point=w,_.lineStart=L,_.lineEnd=D,h=[],u=[]},polygonEnd:function(){_.point=x,_.lineStart=R,_.lineEnd=E,h=oy(h);var O=AF(u,n);h.length?(l||(r.polygonStart(),l=!0),dF(h,wie,O,t,r)):O&&(l||(r.polygonStart(),l=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),h=u=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function x(O,B){i(O,B)&&r.point(O,B)}function b(O,B){s.point(O,B)}function R(){_.point=b,s.lineStart()}function E(){_.point=x,s.lineEnd()}function w(O,B){d.push([O,B]),a.point(O,B)}function L(){a.lineStart(),d=[]}function D(){w(d[0][0],d[0][1]),a.lineEnd();var O=a.clean(),B=o.result(),G,k=B.length,z,F,q;if(d.pop(),u.push(d),d=null,!!k){if(O&1){if(F=B[0],(z=F.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),G=0;G<z;++G)r.point((q=F[G])[0],q[1]);r.lineEnd()}return}k>1&&O&2&&B.push(B.pop().concat(B.shift())),h.push(B.filter(Eie))}}return _}}function Eie(i){return i.length>1}function wie(i,e){return((i=i.x)[0]<0?i[1]-fa-pi:fa-i[1])-((e=e.x)[0]<0?e[1]-fa-pi:fa-e[1])}const V7=pF(function(){return!0},Mie,Cie,[-Ni,-fa]);function Mie(i){var e=NaN,t=NaN,n=NaN,r;return{lineStart:function(){i.lineStart(),r=1},point:function(s,o){var a=s>0?Ni:-Ni,l=cr(s-e);cr(l-Ni)<pi?(i.point(e,t=(t+o)/2>0?fa:-fa),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(a,t),i.point(s,t),r=0):n!==a&&l>=Ni&&(cr(e-n)<pi&&(e-=n*pi),cr(s-a)<pi&&(s-=a*pi),t=Rie(e,t,s,o),i.point(n,t),i.lineEnd(),i.lineStart(),i.point(a,t),r=0),i.point(e=s,t=o),n=a},lineEnd:function(){i.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function Rie(i,e,t,n){var r,s,o=Fn(i-t);return cr(o)>pi?T8((Fn(e)*(s=Jn(n))*Fn(t)-Fn(n)*(r=Jn(e))*Fn(i))/(r*s*o)):(e+n)/2}function Cie(i,e,t,n){var r;if(i==null)r=t*fa,n.point(-Ni,r),n.point(0,r),n.point(Ni,r),n.point(Ni,0),n.point(Ni,-r),n.point(0,-r),n.point(-Ni,-r),n.point(-Ni,0),n.point(-Ni,r);else if(cr(i[0]-e[0])>pi){var s=i[0]<e[0]?Ni:-Ni;r=t*s/2,n.point(-s,r),n.point(0,r),n.point(s,r)}else n.point(e[0],e[1])}function Nie(i){var e=Jn(i),t=2*Wn,n=e>0,r=cr(e)>pi;function s(h,d,_,x){Tie(x,i,t,_,h,d)}function o(h,d){return Jn(h)*Jn(d)>e}function a(h){var d,_,x,b,R;return{lineStart:function(){b=x=!1,R=1},point:function(E,w){var L=[E,w],D,O=o(E,w),B=n?O?0:u(E,w):O?u(E+(E<0?Ni:-Ni),w):0;if(!d&&(b=x=O)&&h.lineStart(),O!==x&&(D=l(d,L),(!D||bb(d,D)||bb(L,D))&&(L[2]=1)),O!==x)R=0,O?(h.lineStart(),D=l(L,d),h.point(D[0],D[1])):(D=l(d,L),h.point(D[0],D[1],2),h.lineEnd()),d=D;else if(r&&d&&n^O){var G;!(B&_)&&(G=l(L,d,!0))&&(R=0,n?(h.lineStart(),h.point(G[0][0],G[0][1]),h.point(G[1][0],G[1][1]),h.lineEnd()):(h.point(G[1][0],G[1][1]),h.lineEnd(),h.lineStart(),h.point(G[0][0],G[0][1],3)))}O&&(!d||!bb(d,L))&&h.point(L[0],L[1]),d=L,x=O,_=B},lineEnd:function(){x&&h.lineEnd(),d=null},clean:function(){return R|(b&&x)<<1}}}function l(h,d,_){var x=HA(h),b=HA(d),R=[1,0,0],E=Um(x,b),w=dx(E,E),L=E[0],D=w-L*L;if(!D)return!_&&h;var O=e*w/D,B=-e*L/D,G=Um(R,E),k=Ax(R,O),z=Ax(E,B);Xw(k,z);var F=G,q=dx(k,F),H=dx(F,F),Q=q*q-H*(dx(k,k)-1);if(!(Q<0)){var K=Ch(Q),se=Ax(F,(-q-K)/H);if(Xw(se,k),se=eS(se),!_)return se;var ee=h[0],$=d[0],re=h[1],ae=d[1],_e;$<ee&&(_e=ee,ee=$,$=_e);var ne=$-ee,ye=cr(ne-Ni)<pi,ve=ye||ne<pi;if(!ye&&ae<re&&(_e=re,re=ae,ae=_e),ve?ye?re+ae>0^se[1]<(cr(se[0]-ee)<pi?re:ae):re<=se[1]&&se[1]<=ae:ne>Ni^(ee<=se[0]&&se[0]<=$)){var Pe=Ax(F,(-q+K)/H);return Xw(Pe,k),[se,eS(Pe)]}}}function u(h,d){var _=n?i:Ni-i,x=0;return h<-_?x|=1:h>_&&(x|=2),d<-_?x|=4:d>_&&(x|=8),x}return pF(o,a,s,n?[0,-i]:[-Ni,i-Ni])}function Die(i,e,t,n,r,s){var o=i[0],a=i[1],l=e[0],u=e[1],h=0,d=1,_=l-o,x=u-a,b;if(b=t-o,!(!_&&b>0)){if(b/=_,_<0){if(b<h)return;b<d&&(d=b)}else if(_>0){if(b>d)return;b>h&&(h=b)}if(b=r-o,!(!_&&b<0)){if(b/=_,_<0){if(b>d)return;b>h&&(h=b)}else if(_>0){if(b<h)return;b<d&&(d=b)}if(b=n-a,!(!x&&b>0)){if(b/=x,x<0){if(b<h)return;b<d&&(d=b)}else if(x>0){if(b>d)return;b>h&&(h=b)}if(b=s-a,!(!x&&b<0)){if(b/=x,x<0){if(b>d)return;b>h&&(h=b)}else if(x>0){if(b<h)return;b<d&&(d=b)}return h>0&&(i[0]=o+h*_,i[1]=a+h*x),d<1&&(e[0]=o+d*_,e[1]=a+d*x),!0}}}}}var l_=1e9,mx=-l_;function Pie(i,e,t,n){function r(u,h){return i<=u&&u<=t&&e<=h&&h<=n}function s(u,h,d,_){var x=0,b=0;if(u==null||(x=o(u,d))!==(b=o(h,d))||l(u,h)<0^d>0)do _.point(x===0||x===3?i:t,x>1?n:e);while((x=(x+d+4)%4)!==b);else _.point(h[0],h[1])}function o(u,h){return cr(u[0]-i)<pi?h>0?0:3:cr(u[0]-t)<pi?h>0?2:1:cr(u[1]-e)<pi?h>0?1:0:h>0?3:2}function a(u,h){return l(u.x,h.x)}function l(u,h){var d=o(u,1),_=o(h,1);return d!==_?d-_:d===0?h[1]-u[1]:d===1?u[0]-h[0]:d===2?u[1]-h[1]:h[0]-u[0]}return function(u){var h=u,d=fF(),_,x,b,R,E,w,L,D,O,B,G,k={point:z,lineStart:Q,lineEnd:K,polygonStart:q,polygonEnd:H};function z(ee,$){r(ee,$)&&h.point(ee,$)}function F(){for(var ee=0,$=0,re=x.length;$<re;++$)for(var ae=x[$],_e=1,ne=ae.length,ye=ae[0],ve,Pe,Se=ye[0],Fe=ye[1];_e<ne;++_e)ve=Se,Pe=Fe,ye=ae[_e],Se=ye[0],Fe=ye[1],Pe<=n?Fe>n&&(Se-ve)*(n-Pe)>(Fe-Pe)*(i-ve)&&++ee:Fe<=n&&(Se-ve)*(n-Pe)<(Fe-Pe)*(i-ve)&&--ee;return ee}function q(){h=d,_=[],x=[],G=!0}function H(){var ee=F(),$=G&&ee,re=(_=oy(_)).length;($||re)&&(u.polygonStart(),$&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),re&&dF(_,a,ee,s,u),u.polygonEnd()),h=u,_=x=b=null}function Q(){k.point=se,x&&x.push(b=[]),B=!0,O=!1,L=D=NaN}function K(){_&&(se(R,E),w&&O&&d.rejoin(),_.push(d.result())),k.point=z,O&&h.lineEnd()}function se(ee,$){var re=r(ee,$);if(x&&b.push([ee,$]),B)R=ee,E=$,w=re,B=!1,re&&(h.lineStart(),h.point(ee,$));else if(re&&O)h.point(ee,$);else{var ae=[L=Math.max(mx,Math.min(l_,L)),D=Math.max(mx,Math.min(l_,D))],_e=[ee=Math.max(mx,Math.min(l_,ee)),$=Math.max(mx,Math.min(l_,$))];Die(ae,_e,i,e,t,n)?(O||(h.lineStart(),h.point(ae[0],ae[1])),h.point(_e[0],_e[1]),re||h.lineEnd(),G=!1):re&&(h.lineStart(),h.point(ee,$),G=!1)}L=ee,D=$,O=re}return k}}var uC,cC,Sb,Tb,Fm={sphere:So,point:So,lineStart:Lie,lineEnd:So,polygonStart:So,polygonEnd:So};function Lie(){Fm.point=Iie,Fm.lineEnd=Oie}function Oie(){Fm.point=Fm.lineEnd=So}function Iie(i,e){i*=Wn,e*=Wn,cC=i,Sb=Fn(e),Tb=Jn(e),Fm.point=Bie}function Bie(i,e){i*=Wn,e*=Wn;var t=Fn(e),n=Jn(e),r=cr(i-cC),s=Jn(r),o=Fn(r),a=n*o,l=Tb*t-Sb*n*s,u=Sb*t+Tb*n*s;uC.add(Pl(Ch(a*a+l*l),u)),cC=i,Sb=t,Tb=n}function Uie(i){return uC=new _h,mT(i,Fm),+uC}var hC=[null,null],Fie={type:"LineString",coordinates:hC};function ld(i,e){return hC[0]=i,hC[1]=e,Uie(Fie)}var q7={Feature:function(i,e){return uS(i.geometry,e)},FeatureCollection:function(i,e){for(var t=i.features,n=-1,r=t.length;++n<r;)if(uS(t[n].geometry,e))return!0;return!1}},H7={Sphere:function(){return!0},Point:function(i,e){return W7(i.coordinates,e)},MultiPoint:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(W7(t[n],e))return!0;return!1},LineString:function(i,e){return j7(i.coordinates,e)},MultiLineString:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(j7(t[n],e))return!0;return!1},Polygon:function(i,e){return X7(i.coordinates,e)},MultiPolygon:function(i,e){for(var t=i.coordinates,n=-1,r=t.length;++n<r;)if(X7(t[n],e))return!0;return!1},GeometryCollection:function(i,e){for(var t=i.geometries,n=-1,r=t.length;++n<r;)if(uS(t[n],e))return!0;return!1}};function uS(i,e){return i&&H7.hasOwnProperty(i.type)?H7[i.type](i,e):!1}function W7(i,e){return ld(i,e)===0}function j7(i,e){for(var t,n,r,s=0,o=i.length;s<o;s++){if(n=ld(i[s],e),n===0||s>0&&(r=ld(i[s],i[s-1]),r>0&&t<=r&&n<=r&&(t+n-r)*(1-Math.pow((t-n)/r,2))<Qb*r))return!0;t=n}return!1}function X7(i,e){return!!AF(i.map(kie),mF(e))}function kie(i){return i=i.map(mF),i.pop(),i}function mF(i){return[i[0]*Wn,i[1]*Wn]}function Gie(i,e){return(i&&q7.hasOwnProperty(i.type)?q7[i.type]:uS)(i,e)}function $7(i,e,t){var n=Gp(i,e-pi,t).concat(e);return function(r){return n.map(function(s){return[r,s]})}}function Y7(i,e,t){var n=Gp(i,e-pi,t).concat(e);return function(r){return n.map(function(s){return[s,r]})}}function zie(){var i,e,t,n,r,s,o,a,l=10,u=l,h=90,d=360,_,x,b,R,E=2.5;function w(){return{type:"MultiLineString",coordinates:L()}}function L(){return Gp(fx(n/h)*h,t,h).map(b).concat(Gp(fx(a/d)*d,o,d).map(R)).concat(Gp(fx(e/l)*l,i,l).filter(function(D){return cr(D%h)>pi}).map(_)).concat(Gp(fx(s/u)*u,r,u).filter(function(D){return cr(D%d)>pi}).map(x))}return w.lines=function(){return L().map(function(D){return{type:"LineString",coordinates:D}})},w.outline=function(){return{type:"Polygon",coordinates:[b(n).concat(R(o).slice(1),b(t).reverse().slice(1),R(a).reverse().slice(1))]}},w.extent=function(D){return arguments.length?w.extentMajor(D).extentMinor(D):w.extentMinor()},w.extentMajor=function(D){return arguments.length?(n=+D[0][0],t=+D[1][0],a=+D[0][1],o=+D[1][1],n>t&&(D=n,n=t,t=D),a>o&&(D=a,a=o,o=D),w.precision(E)):[[n,a],[t,o]]},w.extentMinor=function(D){return arguments.length?(e=+D[0][0],i=+D[1][0],s=+D[0][1],r=+D[1][1],e>i&&(D=e,e=i,i=D),s>r&&(D=s,s=r,r=D),w.precision(E)):[[e,s],[i,r]]},w.step=function(D){return arguments.length?w.stepMajor(D).stepMinor(D):w.stepMinor()},w.stepMajor=function(D){return arguments.length?(h=+D[0],d=+D[1],w):[h,d]},w.stepMinor=function(D){return arguments.length?(l=+D[0],u=+D[1],w):[l,u]},w.precision=function(D){return arguments.length?(E=+D,_=$7(s,r,90),x=Y7(e,i,E),b=$7(a,o,90),R=Y7(n,t,E),w):E},w.extentMajor([[-180,-90+pi],[180,90-pi]]).extentMinor([[-180,-80-pi],[180,80+pi]])}function Vie(){return zie()()}function w8(i,e){var t=i[0]*Wn,n=i[1]*Wn,r=e[0]*Wn,s=e[1]*Wn,o=Jn(n),a=Fn(n),l=Jn(s),u=Fn(s),h=o*Jn(t),d=o*Fn(t),_=l*Jn(r),x=l*Fn(r),b=2*Nh(Ch(w7(s-n)+o*l*w7(r-t))),R=Fn(b),E=b?function(w){var L=Fn(w*=b)/R,D=Fn(b-w)/R,O=D*h+L*_,B=D*d+L*x,G=D*a+L*u;return[Pl(B,O)*Kr,Pl(G,Ch(O*O+B*B))*Kr]}:function(){return[t*Kr,n*Kr]};return E.distance=b,E}const Q7=i=>i;var km=1/0,cS=km,cy=-km,hS=cy,K7={point:qie,lineStart:So,lineEnd:So,polygonStart:So,polygonEnd:So,result:function(){var i=[[km,cS],[cy,hS]];return cy=hS=-(cS=km=1/0),i}};function qie(i,e){i<km&&(km=i),i>cy&&(cy=i),e<cS&&(cS=e),e>hS&&(hS=e)}function M8(i){return function(e){var t=new fC;for(var n in i)t[n]=i[n];return t.stream=e,t}}function fC(){}fC.prototype={constructor:fC,point:function(i,e){this.stream.point(i,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function R8(i,e,t){var n=i.clipExtent&&i.clipExtent();return i.scale(150).translate([0,0]),n!=null&&i.clipExtent(null),mT(t,i.stream(K7)),e(K7.result()),n!=null&&i.clipExtent(n),i}function gF(i,e,t){return R8(i,function(n){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),s/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,l=+e[0][1]+(s-o*(n[1][1]+n[0][1]))/2;i.scale(150*o).translate([a,l])},t)}function Hie(i,e,t){return gF(i,[[0,0],e],t)}function Wie(i,e,t){return R8(i,function(n){var r=+e,s=r/(n[1][0]-n[0][0]),o=(r-s*(n[1][0]+n[0][0]))/2,a=-s*n[0][1];i.scale(150*s).translate([o,a])},t)}function jie(i,e,t){return R8(i,function(n){var r=+e,s=r/(n[1][1]-n[0][1]),o=-s*n[0][0],a=(r-s*(n[1][1]+n[0][1]))/2;i.scale(150*s).translate([o,a])},t)}var Z7=16,Xie=Jn(30*Wn);function J7(i,e){return+e?Yie(i,e):$ie(i)}function $ie(i){return M8({point:function(e,t){e=i(e,t),this.stream.point(e[0],e[1])}})}function Yie(i,e){function t(n,r,s,o,a,l,u,h,d,_,x,b,R,E){var w=u-n,L=h-r,D=w*w+L*L;if(D>4*e&&R--){var O=o+_,B=a+x,G=l+b,k=Ch(O*O+B*B+G*G),z=Nh(G/=k),F=cr(cr(G)-1)<pi||cr(s-d)<pi?(s+d)/2:Pl(B,O),q=i(F,z),H=q[0],Q=q[1],K=H-n,se=Q-r,ee=L*K-w*se;(ee*ee/D>e||cr((w*K+L*se)/D-.5)>.3||o*_+a*x+l*b<Xie)&&(t(n,r,s,o,a,l,H,Q,F,O/=k,B/=k,G,R,E),E.point(H,Q),t(H,Q,F,O,B,G,u,h,d,_,x,b,R,E))}}return function(n){var r,s,o,a,l,u,h,d,_,x,b,R,E={point:w,lineStart:L,lineEnd:O,polygonStart:function(){n.polygonStart(),E.lineStart=B},polygonEnd:function(){n.polygonEnd(),E.lineStart=L}};function w(z,F){z=i(z,F),n.point(z[0],z[1])}function L(){d=NaN,E.point=D,n.lineStart()}function D(z,F){var q=HA([z,F]),H=i(z,F);t(d,_,h,x,b,R,d=H[0],_=H[1],h=z,x=q[0],b=q[1],R=q[2],Z7,n),n.point(d,_)}function O(){E.point=w,n.lineEnd()}function B(){L(),E.point=G,E.lineEnd=k}function G(z,F){D(r=z,F),s=d,o=_,a=x,l=b,u=R,E.point=D}function k(){t(d,_,h,x,b,R,s,o,r,a,l,u,Z7,n),E.lineEnd=O,O()}return E}}var Qie=M8({point:function(i,e){this.stream.point(i*Wn,e*Wn)}});function Kie(i){return M8({point:function(e,t){var n=i(e,t);return this.stream.point(n[0],n[1])}})}function Zie(i,e,t,n,r){function s(o,a){return o*=n,a*=r,[e+i*o,t-i*a]}return s.invert=function(o,a){return[(o-e)/i*n,(t-a)/i*r]},s}function eO(i,e,t,n,r,s){if(!s)return Zie(i,e,t,n,r);var o=Jn(s),a=Fn(s),l=o*i,u=a*i,h=o/i,d=a/i,_=(a*t-o*e)/i,x=(a*e+o*t)/i;function b(R,E){return R*=n,E*=r,[l*R-u*E+e,t-u*R-l*E]}return b.invert=function(R,E){return[n*(h*R-d*E+_),r*(x-d*R-h*E)]},b}function Jie(i){return ere(function(){return i})()}function ere(i){var e,t=150,n=480,r=250,s=0,o=0,a=0,l=0,u=0,h,d=0,_=1,x=1,b=null,R=V7,E=null,w,L,D,O=Q7,B=.5,G,k,z,F,q;function H(ee){return z(ee[0]*Wn,ee[1]*Wn)}function Q(ee){return ee=z.invert(ee[0],ee[1]),ee&&[ee[0]*Kr,ee[1]*Kr]}H.stream=function(ee){return F&&q===ee?F:F=Qie(Kie(h)(R(G(O(q=ee)))))},H.preclip=function(ee){return arguments.length?(R=ee,b=void 0,se()):R},H.postclip=function(ee){return arguments.length?(O=ee,E=w=L=D=null,se()):O},H.clipAngle=function(ee){return arguments.length?(R=+ee?Nie(b=ee*Wn):(b=null,V7),se()):b*Kr},H.clipExtent=function(ee){return arguments.length?(O=ee==null?(E=w=L=D=null,Q7):Pie(E=+ee[0][0],w=+ee[0][1],L=+ee[1][0],D=+ee[1][1]),se()):E==null?null:[[E,w],[L,D]]},H.scale=function(ee){return arguments.length?(t=+ee,K()):t},H.translate=function(ee){return arguments.length?(n=+ee[0],r=+ee[1],K()):[n,r]},H.center=function(ee){return arguments.length?(s=ee[0]%360*Wn,o=ee[1]%360*Wn,K()):[s*Kr,o*Kr]},H.rotate=function(ee){return arguments.length?(a=ee[0]%360*Wn,l=ee[1]%360*Wn,u=ee.length>2?ee[2]%360*Wn:0,K()):[a*Kr,l*Kr,u*Kr]},H.angle=function(ee){return arguments.length?(d=ee%360*Wn,K()):d*Kr},H.reflectX=function(ee){return arguments.length?(_=ee?-1:1,K()):_<0},H.reflectY=function(ee){return arguments.length?(x=ee?-1:1,K()):x<0},H.precision=function(ee){return arguments.length?(G=J7(k,B=ee*ee),se()):Ch(B)},H.fitExtent=function(ee,$){return gF(H,ee,$)},H.fitSize=function(ee,$){return Hie(H,ee,$)},H.fitWidth=function(ee,$){return Wie(H,ee,$)},H.fitHeight=function(ee,$){return jie(H,ee,$)};function K(){var ee=eO(t,0,0,_,x,d).apply(null,e(s,o)),$=eO(t,n-ee[0],r-ee[1],_,x,d);return h=hF(a,l,u),k=aC(e,$),z=aC(h,k),G=J7(k,B),se()}function se(){return F=q=null,H}return function(){return e=i.apply(this,arguments),H.invert=e.invert&&Q,K()}}function tre(i){return function(e,t){var n=Ch(e*e+t*t),r=i(n),s=Fn(r),o=Jn(r);return[Pl(e*s,n*o),Nh(n&&t*s/n)]}}function C8(i,e){return[i,lie(cie((fa+e)/2))]}C8.invert=function(i,e){return[i,2*T8(aie(e))-fa]};function _F(i,e){var t=Jn(e),n=1+Jn(i)*t;return[t*Fn(i)/n,Fn(e)/n]}_F.invert=tre(function(i){return 2*T8(i)});function nre(){return Jie(_F).scale(250).clipAngle(142)}function dC(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function ire(i){if(Array.isArray(i))return i}function rre(i){if(Array.isArray(i))return dC(i)}function R_(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function sre(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ore(i,e,t){return e=fS(e),mre(i,vF()?Reflect.construct(e,[],fS(i).constructor):e.apply(i,t))}function yF(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function are(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function di(i,e){return i.get(R_(i,e))}function Mf(i,e,t){yF(i,e),e.set(i,t)}function Rf(i,e,t){return i.set(R_(i,e),t),t}function lre(i,e){yF(i,e),e.add(i)}function ure(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,bF(n.key),n)}}function cre(i,e,t){return ure(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function ap(i,e,t){return(e=bF(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fS(i){return fS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fS(i)}function hre(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&AC(i,e)}function vF(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vF=function(){return!!i})()}function fre(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function dre(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Are(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mre(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sre(i)}function AC(i,e){return AC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},AC(i,e)}function Eb(i,e){return ire(i)||dre(i,e)||SF(i,e)||Are()}function xF(i){return rre(i)||fre(i)||SF(i)||pre()}function gre(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function bF(i){var e=gre(i,"string");return typeof e=="symbol"?e:e+""}function SF(i,e){if(i){if(typeof i=="string")return dC(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?dC(i,e):void 0}}var TF=function(e){e instanceof Array?e.forEach(TF):(e.map&&e.map.dispose(),e.dispose())},EF=function(e){e.geometry&&e.geometry.dispose(),e.material&&TF(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(EF)},tO=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),EF(t)}};function wF(i,e,t){var n=(90-i)*Math.PI/180,r=(90-e)*Math.PI/180;return{x:t*Math.sin(n)*Math.cos(r),y:t*Math.cos(n),z:t*Math.sin(n)*Math.sin(r)}}function _re(i){var e=i.x,t=i.y,n=i.z,r=Math.sqrt(e*e+t*t+n*n),s=Math.acos(t/r),o=Math.atan2(n,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),r}}function qd(i){return i*Math.PI/180}var MF=function(e){return 1-(C8(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},Yw=function(e){return Math.max(0,Math.min(1,MF(e)))},nO=function(e){return .5-C8.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},yre=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=Rh().domain([1,0]).range([t,n]).clamp(!0),s=Rh().domain([Yw(t),Yw(n)]).range([1,0]).clamp(!0),o=function(d){return s(Yw(r(d)))},a=e.array,l=0,u=a.length;l<u;l+=2)a[l+1]=o(a[l+1]);e.needsUpdate=!0},iO=function(e,t,n,r){var s=Math.pow(2,e),o=Math.max(0,Math.min(s-1,Math.floor((n+180)*s/360))),a=(90-r)/180;t&&(a=Math.max(0,Math.min(1,MF(a))));var l=Math.floor(a*s);return[o,l]},pC=function(e,t){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=[],l=Math.pow(2,e),u=360/l,h=180/l,d=s===void 0?l-1:s,_=o===void 0?l-1:o,x=n,b=Math.min(l-1,d);x<=b;x++)for(var R=r,E=Math.min(l-1,_);R<=E;R++){var w=R,L=h;if(t){w=R===0?R:nO(R/l)*l;var D=R+1===l?R+1:nO((R+1)/l)*l;L=(D-w)*180/l}var O=-180+(x+.5)*u,B=90-(w*180/l+L/2),G=L;a.push({x,y:R,lng:O,lat:B,latLen:G})}return a},vre=6,xre=7,bre=3,Sre=90,zu=new WeakMap,Hf=new WeakMap,Qw=new WeakMap,gx=new WeakMap,yl=new WeakMap,dS=new WeakMap,nm=new WeakMap,Hd=new WeakMap,_x=new WeakSet,Tre=function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.tileUrl,o=r.minLevel,a=o===void 0?0:o,l=r.maxLevel,u=l===void 0?17:l,h=r.mercatorProjection,d=h===void 0?!0:h;return are(this,e),n=ore(this,e),lre(n,_x),Mf(n,zu,void 0),Mf(n,Hf,void 0),Mf(n,Qw,void 0),Mf(n,gx,void 0),Mf(n,yl,{}),Mf(n,dS,void 0),Mf(n,nm,void 0),Mf(n,Hd,void 0),ap(n,"minLevel",void 0),ap(n,"maxLevel",void 0),ap(n,"thresholds",xF(new Array(30)).map(function(_,x){return 8/Math.pow(2,x)})),ap(n,"curvatureResolution",5),ap(n,"tileMargin",0),ap(n,"clearTiles",function(){Object.values(di(yl,n)).forEach(function(_){_.forEach(function(x){x.obj&&(n.remove(x.obj),tO(x.obj),delete x.obj)})}),Rf(yl,n,{})}),Rf(zu,n,t),n.tileUrl=s,Rf(Hf,n,d),n.minLevel=a,n.maxLevel=u,n.level=0,n.add(Rf(Hd,n,new Ri(new _c(di(zu,n)*.99,180,90),new $a({color:0})))),di(Hd,n).visible=!1,di(Hd,n).material.polygonOffset=!0,di(Hd,n).material.polygonOffsetUnits=3,di(Hd,n).material.polygonOffsetFactor=1,n}return hre(e,i),cre(e,[{key:"tileUrl",get:function(){return di(Qw,this)},set:function(n){Rf(Qw,this,n),this.updatePov(di(nm,this))}},{key:"level",get:function(){return di(gx,this)},set:function(n){var r=this;di(yl,this)[n]||R_(_x,this,Ere).call(this,n);var s=di(gx,this);if(Rf(gx,this,n),!(n===s||s===void 0)){if(di(Hd,this).visible=n>0,di(yl,this)[n].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!0)}),s<n&&di(yl,this)[s].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!1)}),s>n)for(var o=n+1;o<=s;o++)di(yl,this)[o]&&di(yl,this)[o].forEach(function(a){a.obj&&(r.remove(a.obj),tO(a.obj),delete a.obj)});R_(_x,this,rO).call(this)}}},{key:"updatePov",value:function(n){var r=this;if(!(!n||!(n instanceof jy))){Rf(nm,this,n);var s;if(Rf(dS,this,function(h){if(!h.hullPnts){var d=360/Math.pow(2,r.level),_=h.lng,x=h.lat,b=h.latLen,R=_-d/2,E=_+d/2,w=x-b/2,L=x+b/2;h.hullPnts=[[x,_],[w,R],[L,R],[w,E],[L,E]].map(function(D){var O=Eb(D,2),B=O[0],G=O[1];return wF(B,G,di(zu,r))}).map(function(D){var O=D.x,B=D.y,G=D.z;return new ce(O,B,G)})}return s||(s=new cg,n.updateMatrix(),n.updateMatrixWorld(),s.setFromProjectionMatrix(new Cn().multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse))),h.hullPnts.some(function(D){return s.containsPoint(D.clone().applyMatrix4(r.matrixWorld))})}),this.tileUrl){var o=n.position.clone(),a=o.distanceTo(this.getWorldPosition(new ce)),l=(a-di(zu,this))/di(zu,this),u=this.thresholds.findIndex(function(h){return h&&h<=l});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,u<0?this.thresholds.length:u)),R_(_x,this,rO).call(this)}}}}])}(ca);function Ere(i){var e=this;if(i>xre){di(yl,this)[i]=[];return}var t=di(yl,this)[i]=pC(i,di(Hf,this));t.forEach(function(n){return n.centroid=wF(n.lat,n.lng,di(zu,e))}),t.octree=k9().x(function(n){return n.centroid.x}).y(function(n){return n.centroid.y}).z(function(n){return n.centroid.z}).addAll(t)}function rO(){var i=this;if(!(!this.tileUrl||this.level===void 0||!di(yl,this).hasOwnProperty(this.level))&&!(!di(dS,this)&&this.level>vre)){var e=di(yl,this)[this.level];if(di(nm,this)){var t=this.worldToLocal(di(nm,this).position.clone());if(e.octree){var n,r=this.worldToLocal(di(nm,this).position.clone()),s=(r.length()-di(zu,this))*bre;e=(n=e.octree).findAllWithinRadius.apply(n,xF(r).concat([s]))}else{var o=_re(t),a=(o.r/di(zu,this)-1)*Sre,l=a/Math.cos(qd(o.lat)),u=[o.lng-l,o.lng+l],h=[o.lat+a,o.lat-a],d=iO(this.level,di(Hf,this),u[0],h[0]),_=Eb(d,2),x=_[0],b=_[1],R=iO(this.level,di(Hf,this),u[1],h[1]),E=Eb(R,2),w=E[0],L=E[1];!e.record&&(e.record={});var D=e.record;if(!D.hasOwnProperty("".concat(Math.round((x+w)/2),"_").concat(Math.round((b+L)/2))))e=pC(this.level,di(Hf,this),x,b,w,L).map(function(z){var F="".concat(z.x,"_").concat(z.y);return D.hasOwnProperty(F)?D[F]:(D[F]=z,e.push(z),z)});else{for(var O=[],B=x;B<=w;B++)for(var G=b;G<=L;G++){var k="".concat(B,"_").concat(G);D.hasOwnProperty(k)||(D[k]=pC(this.level,di(Hf,this),B,G,B,G)[0],e.push(D[k])),O.push(D[k])}e=O}}}e.filter(function(z){return!z.obj}).filter(di(dS,this)||function(){return!0}).forEach(function(z){var F=z.x,q=z.y,H=z.lng,Q=z.lat,K=z.latLen,se=360/Math.pow(2,i.level);if(!z.obj){var ee=se*(1-i.tileMargin),$=K*(1-i.tileMargin),re=qd(H),ae=qd(-Q),_e=new Ri(new _c(di(zu,i),Math.ceil(ee/i.curvatureResolution),Math.ceil($/i.curvatureResolution),qd(90-ee/2)+re,qd(ee),qd(90-$/2)+ae,qd($)),new Gh);if(di(Hf,i)){var ne=[Q+K/2,Q-K/2].map(function(Se){return .5-Se/180}),ye=Eb(ne,2),ve=ye[0],Pe=ye[1];yre(_e.geometry.attributes.uv,ve,Pe)}z.obj=_e}z.loading||(z.loading=!0,new d8().load(i.tileUrl(F,q,i.level),function(Se){var Fe=z.obj;Fe&&(Se.colorSpace=qs,Fe.material.map=Se,Fe.material.color=null,Fe.material.needsUpdate=!0,i.add(Fe)),z.loading=!1}))})}}function wre(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=RF(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(n&&(s=Dre(i,e,s,t)),i.length>80*t){a=i[0],l=i[1];let h=a,d=l;for(let _=t;_<r;_+=t){const x=i[_],b=i[_+1];x<a&&(a=x),b<l&&(l=b),x>h&&(h=x),b>d&&(d=b)}u=Math.max(h-a,d-l),u=u!==0?32767/u:0}return hy(s,o,t,a,l,u,0),o}function RF(i,e,t,n,r){let s;if(r===Vre(i,e,t,n)>0)for(let o=e;o<t;o+=n)s=sO(o/n|0,i[o],i[o+1],s);else for(let o=t-n;o>=e;o-=n)s=sO(o/n|0,i[o],i[o+1],s);return s&&Gm(s,s.next)&&(dy(s),s=s.next),s}function WA(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Gm(t,t.next)||zr(t.prev,t,t.next)===0)){if(dy(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function hy(i,e,t,n,r,s,o){if(!i)return;!o&&s&&Bre(i,n,r,s);let a=i;for(;i.prev!==i.next;){const l=i.prev,u=i.next;if(s?Rre(i,n,r,s):Mre(i)){e.push(l.i,i.i,u.i),dy(i),i=u.next,a=u.next;continue}if(i=u,i===a){o?o===1?(i=Cre(WA(i),e),hy(i,e,t,n,r,s,2)):o===2&&Nre(i,e,t,n,r,s):hy(WA(i),e,t,n,r,s,1);break}}}function Mre(i){const e=i.prev,t=i,n=i.next;if(zr(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,l=t.y,u=n.y,h=Math.min(r,s,o),d=Math.min(a,l,u),_=Math.max(r,s,o),x=Math.max(a,l,u);let b=n.next;for(;b!==e;){if(b.x>=h&&b.x<=_&&b.y>=d&&b.y<=x&&u_(r,a,s,l,o,u,b.x,b.y)&&zr(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function Rre(i,e,t,n){const r=i.prev,s=i,o=i.next;if(zr(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,h=r.y,d=s.y,_=o.y,x=Math.min(a,l,u),b=Math.min(h,d,_),R=Math.max(a,l,u),E=Math.max(h,d,_),w=mC(x,b,e,t,n),L=mC(R,E,e,t,n);let D=i.prevZ,O=i.nextZ;for(;D&&D.z>=w&&O&&O.z<=L;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=E&&D!==r&&D!==o&&u_(a,h,l,d,u,_,D.x,D.y)&&zr(D.prev,D,D.next)>=0||(D=D.prevZ,O.x>=x&&O.x<=R&&O.y>=b&&O.y<=E&&O!==r&&O!==o&&u_(a,h,l,d,u,_,O.x,O.y)&&zr(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;D&&D.z>=w;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=E&&D!==r&&D!==o&&u_(a,h,l,d,u,_,D.x,D.y)&&zr(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;O&&O.z<=L;){if(O.x>=x&&O.x<=R&&O.y>=b&&O.y<=E&&O!==r&&O!==o&&u_(a,h,l,d,u,_,O.x,O.y)&&zr(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function Cre(i,e){let t=i;do{const n=t.prev,r=t.next.next;!Gm(n,r)&&NF(n,t,t.next,r)&&fy(n,r)&&fy(r,n)&&(e.push(n.i,t.i,r.i),dy(t),dy(t.next),t=i=r),t=t.next}while(t!==i);return WA(t)}function Nre(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&kre(o,a)){let l=DF(o,a);o=WA(o,o.next),l=WA(l,l.next),hy(o,e,t,n,r,s,0),hy(l,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function Dre(i,e,t,n){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*n,l=s<o-1?e[s+1]*n:i.length,u=RF(i,a,l,n,!1);u===u.next&&(u.steiner=!0),r.push(Fre(u))}r.sort(Pre);for(let s=0;s<r.length;s++)t=Lre(r[s],t);return t}function Pre(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function Lre(i,e){const t=Ore(i,e);if(!t)return e;const n=DF(t,i);return WA(n,n.next),WA(t,t.next)}function Ore(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;if(Gm(i,t))return t;do{if(Gm(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s&&(s=d,o=t.x<t.next.x?t:t.next,d===n))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let h=1/0;t=o;do{if(n>=t.x&&t.x>=l&&n!==t.x&&CF(r<u?n:s,r,l,u,r<u?s:n,r,t.x,t.y)){const d=Math.abs(r-t.y)/(n-t.x);fy(t,i)&&(d<h||d===h&&(t.x>o.x||t.x===o.x&&Ire(o,t)))&&(o=t,h=d)}t=t.next}while(t!==a);return o}function Ire(i,e){return zr(i.prev,i,e.prev)<0&&zr(e.next,i,i.next)<0}function Bre(i,e,t,n){let r=i;do r.z===0&&(r.z=mC(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,Ure(r)}function Ure(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let o=n,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=o}s.nextZ=null,t*=2}while(e>1);return i}function mC(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Fre(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function CF(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function u_(i,e,t,n,r,s,o,a){return!(i===o&&e===a)&&CF(i,e,t,n,r,s,o,a)}function kre(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Gre(i,e)&&(fy(i,e)&&fy(e,i)&&zre(i,e)&&(zr(i.prev,i,e.prev)||zr(i,e.prev,e))||Gm(i,e)&&zr(i.prev,i,i.next)>0&&zr(e.prev,e,e.next)>0)}function zr(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Gm(i,e){return i.x===e.x&&i.y===e.y}function NF(i,e,t,n){const r=vx(zr(i,e,t)),s=vx(zr(i,e,n)),o=vx(zr(t,n,i)),a=vx(zr(t,n,e));return!!(r!==s&&o!==a||r===0&&yx(i,t,e)||s===0&&yx(i,n,e)||o===0&&yx(t,i,n)||a===0&&yx(t,e,n))}function yx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function vx(i){return i>0?1:i<0?-1:0}function Gre(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&NF(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function fy(i,e){return zr(i.prev,i,i.next)<0?zr(i,e,i.next)>=0&&zr(i,i.prev,e)>=0:zr(i,e,i.prev)<0||zr(i,i.next,e)<0}function zre(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function DF(i,e){const t=gC(i.i,i.x,i.y),n=gC(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function sO(i,e,t,n){const r=gC(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function dy(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function gC(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Vre(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}function AS(i){const e=[],t=[],n=i[0][0].length;let r=0,s=0;for(const o of i){for(const a of o)for(let l=0;l<n;l++)e.push(a[l]);s&&(r+=s,t.push(r)),s=o.length}return{vertices:e,holes:t,dimensions:n}}function _C(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function qre(i){if(Array.isArray(i))return i}function Hre(i){if(Array.isArray(i))return _C(i)}function Wre(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function jre(i,e,t){return e=pS(e),tse(i,PF()?Reflect.construct(e,[],pS(i).constructor):e.apply(i,t))}function Xre(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function $re(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function Yre(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=N8(i))||e){t&&(i=t);var n=0,r=function(){};return{s:r,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(i)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function pS(i){return pS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pS(i)}function Qre(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&yC(i,e)}function PF(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PF=function(){return!!i})()}function Kre(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Zre(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Jre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ese(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tse(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wre(i)}function yC(i,e){return yC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},yC(i,e)}function N1(i,e){return qre(i)||Zre(i,e)||N8(i,e)||Jre()}function nse(i){return Hre(i)||Kre(i)||N8(i)||ese()}function N8(i,e){if(i){if(typeof i=="string")return _C(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_C(i,e):void 0}}var oO=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=[],r=null;return e.forEach(function(s){if(r){var o=ld(s,r)*180/Math.PI;if(o>t)for(var a=w8(r,s),l=r.length>2||s.length>2?uy(r[2]||0,s[2]||0):null,u=l?function(_){return[].concat(nse(a(_)),[l(_)])}:a,h=1/Math.ceil(o/t),d=h;d<1;)n.push(u(d)),d+=h}n.push(r=s)}),n},vC=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:Vi,Float32BufferAttribute:Si},ise=new vC.BufferGeometry().setAttribute?"setAttribute":"addAttribute",LF=function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;Xre(this,e),n=jre(this,e),n.type="GeoJsonGeometry",n.parameters={geoJson:t,radius:r,resolution:s};var o=({Point:h,MultiPoint:d,LineString:_,MultiLineString:x,Polygon:b,MultiPolygon:R}[t.type]||function(){return[]})(t.coordinates,r),a=[],l=[],u=0;o.forEach(function(E){var w=a.length;D1({indices:a,vertices:l},E),n.addGroup(w,a.length-w,u++)}),a.length&&n.setIndex(a),l.length&&n[ise]("position",new vC.Float32BufferAttribute(l,3));function h(E,w){var L=Kw(E[1],E[0],w+(E[2]||0)),D=[];return[{vertices:L,indices:D}]}function d(E,w){var L={vertices:[],indices:[]};return E.map(function(D){return h(D,w)}).forEach(function(D){var O=N1(D,1),B=O[0];D1(L,B)}),[L]}function _(E,w){for(var L=oO(E,s).map(function(z){var F=N1(z,3),q=F[0],H=F[1],Q=F[2],K=Q===void 0?0:Q;return Kw(H,q,w+K)}),D=AS([L]),O=D.vertices,B=Math.round(O.length/3),G=[],k=1;k<B;k++)G.push(k-1,k);return[{vertices:O,indices:G}]}function x(E,w){var L={vertices:[],indices:[]};return E.map(function(D){return _(D,w)}).forEach(function(D){var O=N1(D,1),B=O[0];D1(L,B)}),[L]}function b(E,w){for(var L=E.map(function(ee){return oO(ee,s).map(function($){var re=N1($,3),ae=re[0],_e=re[1],ne=re[2],ye=ne===void 0?0:ne;return Kw(_e,ae,w+ye)})}),D=AS(L),O=D.vertices,B=D.holes,G=B[0]||1/0,k=O.slice(0,G*3),z=O.slice(G*3),F=new Set(B),q=Math.round(O.length/3),H=[],Q=[],K=1;K<q;K++)F.has(K)||(K<G?H.push(K-1,K):Q.push(K-1-G,K-G));var se=[{indices:H,vertices:k}];return B.length&&se.push({indices:Q,vertices:z}),se}function R(E,w){var L={vertices:[],indices:[]},D={vertices:[],indices:[]};E.map(function(B){return b(B,w)}).forEach(function(B){var G=N1(B,2),k=G[0],z=G[1];D1(L,k),z&&D1(D,z)});var O=[L];return D.vertices.length&&O.push(D),O}return n}return Qre(e,i),$re(e)}(vC.BufferGeometry);function D1(i,e){var t=Math.round(i.vertices.length/3);aO(i.vertices,e.vertices),aO(i.indices,e.indices.map(function(n){return n+t}))}function aO(i,e){var t=Yre(e),n;try{for(t.s();!(n=t.n()).done;){var r=n.value;i.push(r)}}catch(s){t.e(s)}finally{t.f()}}function Kw(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(90-i)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(n)*Math.cos(r),t*Math.cos(n),t*Math.sin(n)*Math.sin(r)]}function rse(i,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!i.hasAttribute("position")||!i.hasAttribute("normal")||!i.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function n(o){if(o.normalized||o.isInterleavedBufferAttribute){const a=new Float32Array(o.count*o.itemSize);for(let l=0,u=0;l<o.count;l++)a[u++]=o.getX(l),a[u++]=o.getY(l),o.itemSize>2&&(a[u++]=o.getZ(l));return a}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const r=i.index?i.toNonIndexed():i,s=e.generateTangents(n(r.attributes.position),n(r.attributes.normal),n(r.attributes.uv));if(t)for(let o=3;o<s.length;o+=4)s[o]*=-1;return r.setAttribute("tangent",new _r(s,4)),i!==r&&i.copy(r),i}function sse(i,e=!1){const t=i[0].index!==null,n=new Set(Object.keys(i[0].attributes)),r=new Set(Object.keys(i[0].morphAttributes)),s={},o={},a=i[0].morphTargetsRelative,l=new Vi;let u=0;for(let h=0;h<i.length;++h){const d=i[h];let _=0;if(t!==(d.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const x in d.attributes){if(!n.has(x))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+x+'" attribute exists among all geometries, or in none of them.'),null;s[x]===void 0&&(s[x]=[]),s[x].push(d.attributes[x]),_++}if(_!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const x in d.morphAttributes){if(!r.has(x))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[x]===void 0&&(o[x]=[]),o[x].push(d.morphAttributes[x])}if(e){let x;if(t)x=d.index.count;else if(d.attributes.position!==void 0)x=d.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,x,h),u+=x}}if(t){let h=0;const d=[];for(let _=0;_<i.length;++_){const x=i[_].index;for(let b=0;b<x.count;++b)d.push(x.getX(b)+h);h+=i[_].attributes.position.count}l.setIndex(d)}for(const h in s){const d=xC(s[h]);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,d)}for(const h in o){const d=o[h][0].length;if(d===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let _=0;_<d;++_){const x=[];for(let R=0;R<o[h].length;++R)x.push(o[h][R][_]);const b=xC(x);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(b)}}return l}function xC(i){let e,t,n,r=-1,s=0;for(let u=0;u<i.length;++u){const h=i[u];if(e===void 0&&(e=h.array.constructor),e!==h.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=h.itemSize),t!==h.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=h.normalized),n!==h.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=h.gpuType),r!==h.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=h.count*t}const o=new e(s),a=new _r(o,t,n);let l=0;for(let u=0;u<i.length;++u){const h=i[u];if(h.isInterleavedBufferAttribute){const d=l/t;for(let _=0,x=h.count;_<x;_++)for(let b=0;b<t;b++){const R=h.getComponent(_,b);a.setComponent(_+d,b,R)}}else o.set(h.array,l);l+=h.count*t}return r!==void 0&&(a.gpuType=r),a}function ose(i){return i.isInstancedInterleavedBufferAttribute||i.isInterleavedBufferAttribute?mS(i):i.isInstancedBufferAttribute?new ed().copy(i):new _r().copy(i)}function ase(i){let e,t=0,n=0;for(let u=0,h=i.length;u<h;++u){const d=i[u];if(e===void 0&&(e=d.array.constructor),e!==d.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=d.array.length,n+=d.itemSize}const r=new o8(new e(t),n);let s=0;const o=[],a=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let u=0,h=i.length;u<h;u++){const d=i[u],_=d.itemSize,x=d.count,b=new $u(r,_,s,d.normalized);o.push(b),s+=_;for(let R=0;R<x;R++)for(let E=0;E<_;E++)b[l[E]](R,d[a[E]](R))}return o}function mS(i){const e=i.data.array.constructor,t=i.count,n=i.itemSize,r=i.normalized,s=new e(t*n);let o;i.isInstancedInterleavedBufferAttribute?o=new ed(s,n,r,i.meshPerAttribute):o=new _r(s,n,r);for(let a=0;a<t;a++)o.setX(a,i.getX(a)),n>=2&&o.setY(a,i.getY(a)),n>=3&&o.setZ(a,i.getZ(a)),n>=4&&o.setW(a,i.getW(a));return o}function lse(i){const e=i.attributes,t=i.morphTargets,n=new Map;for(const r in e){const s=e[r];s.isInterleavedBufferAttribute&&(n.has(s)||n.set(s,mS(s)),e[r]=n.get(s))}for(const r in t){const s=t[r];s.isInterleavedBufferAttribute&&(n.has(s)||n.set(s,mS(s)),t[r]=n.get(s))}}function use(i){let e=0;for(const n in i.attributes){const r=i.getAttribute(n);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const t=i.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function cse(i,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},n=i.getIndex(),r=i.getAttribute("position"),s=n?n.count:r.count;let o=0;const a=Object.keys(i.attributes),l={},u={},h=[],d=["getX","getY","getZ","getW"],_=["setX","setY","setZ","setW"];for(let L=0,D=a.length;L<D;L++){const O=a[L],B=i.attributes[O];l[O]=new B.constructor(new B.array.constructor(B.count*B.itemSize),B.itemSize,B.normalized);const G=i.morphAttributes[O];G&&(u[O]||(u[O]=[]),G.forEach((k,z)=>{const F=new k.array.constructor(k.count*k.itemSize);u[O][z]=new k.constructor(F,k.itemSize,k.normalized)}))}const x=e*.5,b=Math.log10(1/e),R=Math.pow(10,b),E=x*R;for(let L=0;L<s;L++){const D=n?n.getX(L):L;let O="";for(let B=0,G=a.length;B<G;B++){const k=a[B],z=i.getAttribute(k),F=z.itemSize;for(let q=0;q<F;q++)O+=`${~~(z[d[q]](D)*R+E)},`}if(O in t)h.push(t[O]);else{for(let B=0,G=a.length;B<G;B++){const k=a[B],z=i.getAttribute(k),F=i.morphAttributes[k],q=z.itemSize,H=l[k],Q=u[k];for(let K=0;K<q;K++){const se=d[K],ee=_[K];if(H[ee](o,z[se](D)),F)for(let $=0,re=F.length;$<re;$++)Q[$][ee](o,F[$][se](D))}}t[O]=o,h.push(o),o++}}const w=i.clone();for(const L in i.attributes){const D=l[L];if(w.setAttribute(L,new D.constructor(D.array.slice(0,o*D.itemSize),D.itemSize,D.normalized)),L in u)for(let O=0;O<u[L].length;O++){const B=u[L][O];w.morphAttributes[L][O]=new B.constructor(B.array.slice(0,o*B.itemSize),B.itemSize,B.normalized)}}return w.setIndex(h),w}function hse(i,e){if(e===l$)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===XP||e===u$){let t=i.getIndex();if(t===null){const o=[],a=i.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,r=[];if(e===XP)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}function fse(i){const e=new ce,t=new ce,n=new ce,r=new ce,s=new ce,o=new ce,a=new ce,l=new ce,u=new ce;function h(_e,ne,ye,ve,Pe,Se,Fe,Ye){e.fromBufferAttribute(ne,Pe),t.fromBufferAttribute(ne,Se),n.fromBufferAttribute(ne,Fe);const at=_e.morphTargetInfluences;if(ye&&at){a.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(let At=0,Gt=ye.length;At<Gt;At++){const Dt=at[At],Nn=ye[At];Dt!==0&&(r.fromBufferAttribute(Nn,Pe),s.fromBufferAttribute(Nn,Se),o.fromBufferAttribute(Nn,Fe),ve?(a.addScaledVector(r,Dt),l.addScaledVector(s,Dt),u.addScaledVector(o,Dt)):(a.addScaledVector(r.sub(e),Dt),l.addScaledVector(s.sub(t),Dt),u.addScaledVector(o.sub(n),Dt)))}e.add(a),t.add(l),n.add(u)}_e.isSkinnedMesh&&(_e.applyBoneTransform(Pe,e),_e.applyBoneTransform(Se,t),_e.applyBoneTransform(Fe,n)),Ye[Pe*3+0]=e.x,Ye[Pe*3+1]=e.y,Ye[Pe*3+2]=e.z,Ye[Se*3+0]=t.x,Ye[Se*3+1]=t.y,Ye[Se*3+2]=t.z,Ye[Fe*3+0]=n.x,Ye[Fe*3+1]=n.y,Ye[Fe*3+2]=n.z}const d=i.geometry,_=i.material;let x,b,R;const E=d.index,w=d.attributes.position,L=d.morphAttributes.position,D=d.morphTargetsRelative,O=d.attributes.normal,B=d.morphAttributes.position,G=d.groups,k=d.drawRange;let z,F,q,H,Q,K,se;const ee=new Float32Array(w.count*w.itemSize),$=new Float32Array(O.count*O.itemSize);if(E!==null)if(Array.isArray(_))for(z=0,q=G.length;z<q;z++)for(Q=G[z],K=Math.max(Q.start,k.start),se=Math.min(Q.start+Q.count,k.start+k.count),F=K,H=se;F<H;F+=3)x=E.getX(F),b=E.getX(F+1),R=E.getX(F+2),h(i,w,L,D,x,b,R,ee),h(i,O,B,D,x,b,R,$);else for(K=Math.max(0,k.start),se=Math.min(E.count,k.start+k.count),z=K,q=se;z<q;z+=3)x=E.getX(z),b=E.getX(z+1),R=E.getX(z+2),h(i,w,L,D,x,b,R,ee),h(i,O,B,D,x,b,R,$);else if(Array.isArray(_))for(z=0,q=G.length;z<q;z++)for(Q=G[z],K=Math.max(Q.start,k.start),se=Math.min(Q.start+Q.count,k.start+k.count),F=K,H=se;F<H;F+=3)x=F,b=F+1,R=F+2,h(i,w,L,D,x,b,R,ee),h(i,O,B,D,x,b,R,$);else for(K=Math.max(0,k.start),se=Math.min(w.count,k.start+k.count),z=K,q=se;z<q;z+=3)x=z,b=z+1,R=z+2,h(i,w,L,D,x,b,R,ee),h(i,O,B,D,x,b,R,$);const re=new Si(ee,3),ae=new Si($,3);return{positionAttribute:w,normalAttribute:O,morphedPositionAttribute:re,morphedNormalAttribute:ae}}function dse(i){if(i.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),i;let e=i.groups;if(e=e.sort((o,a)=>o.materialIndex!==a.materialIndex?o.materialIndex-a.materialIndex:o.start-a.start),i.getIndex()===null){const o=i.getAttribute("position"),a=[];for(let l=0;l<o.count;l+=3)a.push(l,l+1,l+2);i.setIndex(a)}const t=i.getIndex(),n=[];for(let o=0;o<e.length;o++){const a=e[o],l=a.start,u=l+a.count;for(let h=l;h<u;h++)n.push(t.getX(h))}i.dispose(),i.setIndex(n);let r=0;for(let o=0;o<e.length;o++){const a=e[o];a.start=r,r+=a.count}let s=e[0];i.groups=[s];for(let o=1;o<e.length;o++){const a=e[o];s.materialIndex===a.materialIndex?s.count+=a.count:(s=a,i.groups.push(s))}return i}function Ase(i,e=Math.PI/3){const t=Math.cos(e),n=(1+1e-10)*100,r=[new ce,new ce,new ce],s=new ce,o=new ce,a=new ce,l=new ce;function u(R){const E=~~(R.x*n),w=~~(R.y*n),L=~~(R.z*n);return`${E},${w},${L}`}const h=i.index?i.toNonIndexed():i,d=h.attributes.position,_={};for(let R=0,E=d.count/3;R<E;R++){const w=3*R,L=r[0].fromBufferAttribute(d,w+0),D=r[1].fromBufferAttribute(d,w+1),O=r[2].fromBufferAttribute(d,w+2);s.subVectors(O,D),o.subVectors(L,D);const B=new ce().crossVectors(s,o).normalize();for(let G=0;G<3;G++){const k=r[G],z=u(k);z in _||(_[z]=[]),_[z].push(B)}}const x=new Float32Array(d.count*3),b=new _r(x,3,!1);for(let R=0,E=d.count/3;R<E;R++){const w=3*R,L=r[0].fromBufferAttribute(d,w+0),D=r[1].fromBufferAttribute(d,w+1),O=r[2].fromBufferAttribute(d,w+2);s.subVectors(O,D),o.subVectors(L,D),a.crossVectors(s,o).normalize();for(let B=0;B<3;B++){const G=r[B],k=u(G),z=_[k];l.set(0,0,0);for(let F=0,q=z.length;F<q;F++){const H=z[F];a.dot(H)>t&&l.add(H)}l.normalize(),b.setXYZ(w+B,l.x,l.y,l.z)}}return h.setAttribute("normal",b),h}const D8=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:rse,computeMorphedAttributes:fse,deepCloneAttribute:ose,deinterleaveAttribute:mS,deinterleaveGeometry:lse,estimateBytesUsed:use,interleaveAttributes:ase,mergeAttributes:xC,mergeGeometries:sse,mergeGroups:dse,mergeVertices:cse,toCreasedNormals:Ase,toTrianglesDrawMode:hse},Symbol.toStringTag,{value:"Module"}));var bt=function(i){return typeof i=="function"?i:typeof i=="string"?function(e){return e[i]}:function(e){return i}};function gS(i){"@babel/helpers - typeof";return gS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gS(i)}var pse=/^\s+/,mse=/\s+$/;function gn(i,e){if(i=i||"",e=e||{},i instanceof gn)return i;if(!(this instanceof gn))return new gn(i,e);var t=gse(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}gn.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,n,r,s,o,a;return t=e.r/255,n=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=OF(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=uO(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=uO(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=lO(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=lO(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return cO(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return xse(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Lr(this._r,255)*100)+"%",g:Math.round(Lr(this._g,255)*100)+"%",b:Math.round(Lr(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Lr(this._r,255)*100)+"%, "+Math.round(Lr(this._g,255)*100)+"%, "+Math.round(Lr(this._b,255)*100)+"%)":"rgba("+Math.round(Lr(this._r,255)*100)+"%, "+Math.round(Lr(this._g,255)*100)+"%, "+Math.round(Lr(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Lse[cO(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+hO(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=gn(e);n="#"+hO(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return gn(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(Ese,arguments)},brighten:function(){return this._applyModification(wse,arguments)},darken:function(){return this._applyModification(Mse,arguments)},desaturate:function(){return this._applyModification(bse,arguments)},saturate:function(){return this._applyModification(Sse,arguments)},greyscale:function(){return this._applyModification(Tse,arguments)},spin:function(){return this._applyModification(Rse,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(Dse,arguments)},complement:function(){return this._applyCombination(Cse,arguments)},monochromatic:function(){return this._applyCombination(Pse,arguments)},splitcomplement:function(){return this._applyCombination(Nse,arguments)},triad:function(){return this._applyCombination(fO,[3])},tetrad:function(){return this._applyCombination(fO,[4])}};gn.fromRatio=function(i,e){if(gS(i)=="object"){var t={};for(var n in i)i.hasOwnProperty(n)&&(n==="a"?t[n]=i[n]:t[n]=c_(i[n]));i=t}return gn(i,e)};function gse(i){var e={r:0,g:0,b:0},t=1,n=null,r=null,s=null,o=!1,a=!1;return typeof i=="string"&&(i=Use(i)),gS(i)=="object"&&(ih(i.r)&&ih(i.g)&&ih(i.b)?(e=_se(i.r,i.g,i.b),o=!0,a=String(i.r).substr(-1)==="%"?"prgb":"rgb"):ih(i.h)&&ih(i.s)&&ih(i.v)?(n=c_(i.s),r=c_(i.v),e=vse(i.h,n,r),o=!0,a="hsv"):ih(i.h)&&ih(i.s)&&ih(i.l)&&(n=c_(i.s),s=c_(i.l),e=yse(i.h,n,s),o=!0,a="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=OF(t),{ok:o,format:i.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function _se(i,e,t){return{r:Lr(i,255)*255,g:Lr(e,255)*255,b:Lr(t,255)*255}}function lO(i,e,t){i=Lr(i,255),e=Lr(e,255),t=Lr(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,o,a=(n+r)/2;if(n==r)s=o=0;else{var l=n-r;switch(o=a>.5?l/(2-n-r):l/(n+r),n){case i:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-i)/l+2;break;case t:s=(i-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function yse(i,e,t){var n,r,s;i=Lr(i,360),e=Lr(e,100),t=Lr(t,100);function o(u,h,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?u+(h-u)*6*d:d<1/2?h:d<2/3?u+(h-u)*(2/3-d)*6:u}if(e===0)n=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;n=o(l,a,i+1/3),r=o(l,a,i),s=o(l,a,i-1/3)}return{r:n*255,g:r*255,b:s*255}}function uO(i,e,t){i=Lr(i,255),e=Lr(e,255),t=Lr(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,o,a=n,l=n-r;if(o=n===0?0:l/n,n==r)s=0;else{switch(n){case i:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-i)/l+2;break;case t:s=(i-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function vse(i,e,t){i=Lr(i,360)*6,e=Lr(e,100),t=Lr(t,100);var n=Math.floor(i),r=i-n,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=n%6,u=[t,o,s,s,a,t][l],h=[a,t,t,o,s,s][l],d=[s,s,a,t,t,o][l];return{r:u*255,g:h*255,b:d*255}}function cO(i,e,t,n){var r=[du(Math.round(i).toString(16)),du(Math.round(e).toString(16)),du(Math.round(t).toString(16))];return n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function xse(i,e,t,n,r){var s=[du(Math.round(i).toString(16)),du(Math.round(e).toString(16)),du(Math.round(t).toString(16)),du(IF(n))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function hO(i,e,t,n){var r=[du(IF(n)),du(Math.round(i).toString(16)),du(Math.round(e).toString(16)),du(Math.round(t).toString(16))];return r.join("")}gn.equals=function(i,e){return!i||!e?!1:gn(i).toRgbString()==gn(e).toRgbString()};gn.random=function(){return gn.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function bse(i,e){e=e===0?0:e||10;var t=gn(i).toHsl();return t.s-=e/100,t.s=gT(t.s),gn(t)}function Sse(i,e){e=e===0?0:e||10;var t=gn(i).toHsl();return t.s+=e/100,t.s=gT(t.s),gn(t)}function Tse(i){return gn(i).desaturate(100)}function Ese(i,e){e=e===0?0:e||10;var t=gn(i).toHsl();return t.l+=e/100,t.l=gT(t.l),gn(t)}function wse(i,e){e=e===0?0:e||10;var t=gn(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),gn(t)}function Mse(i,e){e=e===0?0:e||10;var t=gn(i).toHsl();return t.l-=e/100,t.l=gT(t.l),gn(t)}function Rse(i,e){var t=gn(i).toHsl(),n=(t.h+e)%360;return t.h=n<0?360+n:n,gn(t)}function Cse(i){var e=gn(i).toHsl();return e.h=(e.h+180)%360,gn(e)}function fO(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=gn(i).toHsl(),n=[gn(i)],r=360/e,s=1;s<e;s++)n.push(gn({h:(t.h+s*r)%360,s:t.s,l:t.l}));return n}function Nse(i){var e=gn(i).toHsl(),t=e.h;return[gn(i),gn({h:(t+72)%360,s:e.s,l:e.l}),gn({h:(t+216)%360,s:e.s,l:e.l})]}function Dse(i,e,t){e=e||6,t=t||30;var n=gn(i).toHsl(),r=360/t,s=[gn(i)];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(gn(n));return s}function Pse(i,e){e=e||6;for(var t=gn(i).toHsv(),n=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(gn({h:n,s:r,v:s})),s=(s+a)%1;return o}gn.mix=function(i,e,t){t=t===0?0:t||50;var n=gn(i).toRgb(),r=gn(e).toRgb(),s=t/100,o={r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a};return gn(o)};gn.readability=function(i,e){var t=gn(i),n=gn(e);return(Math.max(t.getLuminance(),n.getLuminance())+.05)/(Math.min(t.getLuminance(),n.getLuminance())+.05)};gn.isReadable=function(i,e,t){var n=gn.readability(i,e),r,s;switch(s=!1,r=Fse(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=n>=4.5;break;case"AAlarge":s=n>=3;break;case"AAAsmall":s=n>=7;break}return s};gn.mostReadable=function(i,e,t){var n=null,r=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var u=0;u<e.length;u++)s=gn.readability(i,e[u]),s>r&&(r=s,n=gn(e[u]));return gn.isReadable(i,n,{level:a,size:l})||!o?n:(t.includeFallbackColors=!1,gn.mostReadable(i,["#fff","#000"],t))};var bC=gn.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Lse=gn.hexNames=Ose(bC);function Ose(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function OF(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function Lr(i,e){Ise(i)&&(i="100%");var t=Bse(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}function gT(i){return Math.min(1,Math.max(0,i))}function Ga(i){return parseInt(i,16)}function Ise(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}function Bse(i){return typeof i=="string"&&i.indexOf("%")!=-1}function du(i){return i.length==1?"0"+i:""+i}function c_(i){return i<=1&&(i=i*100+"%"),i}function IF(i){return Math.round(parseFloat(i)*255).toString(16)}function dO(i){return Ga(i)/255}var su=function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function ih(i){return!!su.CSS_UNIT.exec(i)}function Use(i){i=i.replace(pse,"").replace(mse,"").toLowerCase();var e=!1;if(bC[i])i=bC[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=su.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=su.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=su.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=su.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=su.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=su.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=su.hex8.exec(i))?{r:Ga(t[1]),g:Ga(t[2]),b:Ga(t[3]),a:dO(t[4]),format:e?"name":"hex8"}:(t=su.hex6.exec(i))?{r:Ga(t[1]),g:Ga(t[2]),b:Ga(t[3]),format:e?"name":"hex"}:(t=su.hex4.exec(i))?{r:Ga(t[1]+""+t[1]),g:Ga(t[2]+""+t[2]),b:Ga(t[3]+""+t[3]),a:dO(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=su.hex3.exec(i))?{r:Ga(t[1]+""+t[1]),g:Ga(t[2]+""+t[2]),b:Ga(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function Fse(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function SC(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function kse(i){if(Array.isArray(i))return i}function Gse(i){if(Array.isArray(i))return SC(i)}function BF(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function zse(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vse(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _o(i,e){return i.get(BF(i,e))}function lp(i,e,t){zse(i,e),e.set(i,t)}function xx(i,e,t){return i.set(BF(i,e),t),t}function qse(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Zse(n.key),n)}}function Hse(i,e,t){return e&&qse(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Wse(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function jse(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Xse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yse(i,e){return kse(i)||jse(i,e)||UF(i,e)||Xse()}function Qse(i){return Gse(i)||Wse(i)||UF(i)||$se()}function Kse(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function Zse(i){var e=Kse(i,"string");return typeof e=="symbol"?e:e+""}function UF(i,e){if(i){if(typeof i=="string")return SC(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SC(i,e):void 0}}var up=new WeakMap,P1=new WeakMap,cp=new WeakMap,Zw=new WeakMap,Jw=new WeakMap,eM=new WeakMap,Jse=function(){function i(){Vse(this,i),lp(this,up,new Map),lp(this,P1,new Map),lp(this,cp,function(e){return e}),lp(this,Zw,function(){return{}}),lp(this,Jw,function(){}),lp(this,eM,function(){})}return Hse(i,[{key:"getObj",value:function(t){return _o(up,this).get(_o(cp,this).call(this,t))}},{key:"getData",value:function(t){return _o(P1,this).get(t)}},{key:"entries",value:function(){return Qse(_o(P1,this).entries()).map(function(t){var n=Yse(t,2),r=n[0],s=n[1];return[s,r]})}},{key:"id",value:function(t){return xx(cp,this,bt(t)),this}},{key:"onCreateObj",value:function(t){return xx(Zw,this,t),this}},{key:"onUpdateObj",value:function(t){return xx(Jw,this,t),this}},{key:"onRemoveObj",value:function(t){return xx(eM,this,t),this}},{key:"digest",value:function(t){var n=this;t.filter(function(s){return!_o(up,n).has(_o(cp,n).call(n,s))}).forEach(function(s){var o=_o(Zw,n).call(n,s);_o(up,n).set(_o(cp,n).call(n,s),o),_o(P1,n).set(o,s)});var r=new Map(t.map(function(s){return[_o(cp,n).call(n,s),s]}));return _o(up,this).forEach(function(s,o){r.has(o)?_o(Jw,n).call(n,s,r.get(o)):(_o(eM,n).call(n,s,o),_o(up,n).delete(o),_o(P1,n).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])}(),wb={exports:{}},eoe=wb.exports,AO;function toe(){return AO||(AO=1,function(i,e){(function(t,n){i.exports=n()})(eoe,function(){return function(t){function n(s){if(r[s])return r[s].exports;var o=r[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)}([function(t,n,r){var s=r(1),o=function(){function a(l,u,h){l===void 0&&(l=NaN),u===void 0&&(u=NaN),h===void 0&&(h=!1),this._minFPS=u,this._maxFPS=l,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,h||this.resume()}return a.prototype.updateOnce=function(l){l(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(l){this._timeScale!==l&&(this._timeScale=l)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var l=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return l.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(l,u){u===void 0&&(u=!0),this._currentTick++,this._currentTime+=l,this._tickDeltaTime=l,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),u&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a}();Object.defineProperty(n,"__esModule",{value:!0}),n.default=o},function(t,n,r){(function(s,o){t.exports=o()})(this,function(){return function(s){function o(l){if(a[l])return a[l].exports;var u=a[l]={exports:{},id:l,loaded:!1};return s[l].call(u.exports,u,u.exports,o),u.loaded=!0,u.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)}([function(s,o){var a=function(){function l(){this.functions=[]}return l.prototype.add=function(u){return this.functions.indexOf(u)===-1&&(this.functions.push(u),!0)},l.prototype.remove=function(u){var h=this.functions.indexOf(u);return h>-1&&(this.functions.splice(h,1),!0)},l.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},l.prototype.dispatch=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];var d=this.functions.concat();d.forEach(function(_){_.apply(void 0,u)})},Object.defineProperty(l.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),l}();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})}(wb)),wb.exports}var noe=toe();const zm=nT(noe),yh=11102230246251565e-32,yo=134217729,ioe=(3+8*yh)*yh;function tM(i,e,t,n,r){let s,o,a,l,u=e[0],h=n[0],d=0,_=0;h>u==h>-u?(s=u,u=e[++d]):(s=h,h=n[++_]);let x=0;if(d<i&&_<t)for(h>u==h>-u?(o=u+s,a=s-(o-u),u=e[++d]):(o=h+s,a=s-(o-h),h=n[++_]),s=o,a!==0&&(r[x++]=a);d<i&&_<t;)h>u==h>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++d]):(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=n[++_]),s=o,a!==0&&(r[x++]=a);for(;d<i;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++d],s=o,a!==0&&(r[x++]=a);for(;_<t;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=n[++_],s=o,a!==0&&(r[x++]=a);return(s!==0||x===0)&&(r[x++]=s),x}function roe(i,e){let t=e[0];for(let n=1;n<i;n++)t+=e[n];return t}function Jy(i){return new Float64Array(i)}const soe=(3+16*yh)*yh,ooe=(2+12*yh)*yh,aoe=(9+64*yh)*yh*yh,hp=Jy(4),pO=Jy(8),mO=Jy(12),gO=Jy(16),Lo=Jy(4);function loe(i,e,t,n,r,s,o){let a,l,u,h,d,_,x,b,R,E,w,L,D,O,B,G,k,z;const F=i-r,q=t-r,H=e-s,Q=n-s;O=F*Q,_=yo*F,x=_-(_-F),b=F-x,_=yo*Q,R=_-(_-Q),E=Q-R,B=b*E-(O-x*R-b*R-x*E),G=H*q,_=yo*H,x=_-(_-H),b=H-x,_=yo*q,R=_-(_-q),E=q-R,k=b*E-(G-x*R-b*R-x*E),w=B-k,d=B-w,hp[0]=B-(w+d)+(d-k),L=O+w,d=L-O,D=O-(L-d)+(w-d),w=D-G,d=D-w,hp[1]=D-(w+d)+(d-G),z=L+w,d=z-L,hp[2]=L-(z-d)+(w-d),hp[3]=z;let K=roe(4,hp),se=ooe*o;if(K>=se||-K>=se||(d=i-F,a=i-(F+d)+(d-r),d=t-q,u=t-(q+d)+(d-r),d=e-H,l=e-(H+d)+(d-s),d=n-Q,h=n-(Q+d)+(d-s),a===0&&l===0&&u===0&&h===0)||(se=aoe*o+ioe*Math.abs(K),K+=F*h+Q*a-(H*u+q*l),K>=se||-K>=se))return K;O=a*Q,_=yo*a,x=_-(_-a),b=a-x,_=yo*Q,R=_-(_-Q),E=Q-R,B=b*E-(O-x*R-b*R-x*E),G=l*q,_=yo*l,x=_-(_-l),b=l-x,_=yo*q,R=_-(_-q),E=q-R,k=b*E-(G-x*R-b*R-x*E),w=B-k,d=B-w,Lo[0]=B-(w+d)+(d-k),L=O+w,d=L-O,D=O-(L-d)+(w-d),w=D-G,d=D-w,Lo[1]=D-(w+d)+(d-G),z=L+w,d=z-L,Lo[2]=L-(z-d)+(w-d),Lo[3]=z;const ee=tM(4,hp,4,Lo,pO);O=F*h,_=yo*F,x=_-(_-F),b=F-x,_=yo*h,R=_-(_-h),E=h-R,B=b*E-(O-x*R-b*R-x*E),G=H*u,_=yo*H,x=_-(_-H),b=H-x,_=yo*u,R=_-(_-u),E=u-R,k=b*E-(G-x*R-b*R-x*E),w=B-k,d=B-w,Lo[0]=B-(w+d)+(d-k),L=O+w,d=L-O,D=O-(L-d)+(w-d),w=D-G,d=D-w,Lo[1]=D-(w+d)+(d-G),z=L+w,d=z-L,Lo[2]=L-(z-d)+(w-d),Lo[3]=z;const $=tM(ee,pO,4,Lo,mO);O=a*h,_=yo*a,x=_-(_-a),b=a-x,_=yo*h,R=_-(_-h),E=h-R,B=b*E-(O-x*R-b*R-x*E),G=l*u,_=yo*l,x=_-(_-l),b=l-x,_=yo*u,R=_-(_-u),E=u-R,k=b*E-(G-x*R-b*R-x*E),w=B-k,d=B-w,Lo[0]=B-(w+d)+(d-k),L=O+w,d=L-O,D=O-(L-d)+(w-d),w=D-G,d=D-w,Lo[1]=D-(w+d)+(d-G),z=L+w,d=z-L,Lo[2]=L-(z-d)+(w-d),Lo[3]=z;const re=tM($,mO,4,Lo,gO);return gO[re-1]}function h_(i,e,t,n,r,s){const o=(e-s)*(t-r),a=(i-r)*(n-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=soe*u?l:-loe(i,e,t,n,r,s,u)}const _O=Math.pow(2,-52),bx=new Uint32Array(512);class Ay{static from(e,t=doe,n=Aoe){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=n(a)}return new Ay(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:s}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let F=0;F<o;F++){const q=e[2*F],H=e[2*F+1];q<a&&(a=q),H<l&&(l=H),q>u&&(u=q),H>h&&(h=H),this._ids[F]=F}const d=(a+u)/2,_=(l+h)/2;let x,b,R;for(let F=0,q=1/0;F<o;F++){const H=nM(d,_,e[2*F],e[2*F+1]);H<q&&(x=F,q=H)}const E=e[2*x],w=e[2*x+1];for(let F=0,q=1/0;F<o;F++){if(F===x)continue;const H=nM(E,w,e[2*F],e[2*F+1]);H<q&&H>0&&(b=F,q=H)}let L=e[2*b],D=e[2*b+1],O=1/0;for(let F=0;F<o;F++){if(F===x||F===b)continue;const q=hoe(E,w,L,D,e[2*F],e[2*F+1]);q<O&&(R=F,O=q)}let B=e[2*R],G=e[2*R+1];if(O===1/0){for(let H=0;H<o;H++)this._dists[H]=e[2*H]-e[0]||e[2*H+1]-e[1];Vp(this._ids,this._dists,0,o-1);const F=new Uint32Array(o);let q=0;for(let H=0,Q=-1/0;H<o;H++){const K=this._ids[H],se=this._dists[K];se>Q&&(F[q++]=K,Q=se)}this.hull=F.subarray(0,q),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(h_(E,w,L,D,B,G)<0){const F=b,q=L,H=D;b=R,L=B,D=G,R=F,B=q,G=H}const k=foe(E,w,L,D,B,G);this._cx=k.x,this._cy=k.y;for(let F=0;F<o;F++)this._dists[F]=nM(e[2*F],e[2*F+1],k.x,k.y);Vp(this._ids,this._dists,0,o-1),this._hullStart=x;let z=3;n[x]=t[R]=b,n[b]=t[x]=R,n[R]=t[b]=x,r[x]=0,r[b]=1,r[R]=2,s.fill(-1),s[this._hashKey(E,w)]=x,s[this._hashKey(L,D)]=b,s[this._hashKey(B,G)]=R,this.trianglesLen=0,this._addTriangle(x,b,R,-1,-1,-1);for(let F=0,q,H;F<this._ids.length;F++){const Q=this._ids[F],K=e[2*Q],se=e[2*Q+1];if(F>0&&Math.abs(K-q)<=_O&&Math.abs(se-H)<=_O||(q=K,H=se,Q===x||Q===b||Q===R))continue;let ee=0;for(let ne=0,ye=this._hashKey(K,se);ne<this._hashSize&&(ee=s[(ye+ne)%this._hashSize],!(ee!==-1&&ee!==n[ee]));ne++);ee=t[ee];let $=ee,re;for(;re=n[$],h_(K,se,e[2*$],e[2*$+1],e[2*re],e[2*re+1])>=0;)if($=re,$===ee){$=-1;break}if($===-1)continue;let ae=this._addTriangle($,Q,n[$],-1,-1,r[$]);r[Q]=this._legalize(ae+2),r[$]=ae,z++;let _e=n[$];for(;re=n[_e],h_(K,se,e[2*_e],e[2*_e+1],e[2*re],e[2*re+1])<0;)ae=this._addTriangle(_e,Q,re,r[Q],-1,r[_e]),r[Q]=this._legalize(ae+2),n[_e]=_e,z--,_e=re;if($===ee)for(;re=t[$],h_(K,se,e[2*re],e[2*re+1],e[2*$],e[2*$+1])<0;)ae=this._addTriangle(re,Q,$,-1,r[$],r[re]),this._legalize(ae+2),r[re]=ae,n[$]=$,z--,$=re;this._hullStart=t[Q]=$,n[$]=t[_e]=Q,n[Q]=_e,s[this._hashKey(K,se)]=Q,s[this._hashKey(e[2*$],e[2*$+1])]=$}this.hull=new Uint32Array(z);for(let F=0,q=this._hullStart;F<z;F++)this.hull[F]=q,q=n[q];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(uoe(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let s=0,o=0;for(;;){const a=n[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(s===0)break;e=bx[--s];continue}const u=a-a%3,h=l+(e+1)%3,d=u+(a+2)%3,_=t[o],x=t[e],b=t[h],R=t[d];if(coe(r[2*_],r[2*_+1],r[2*x],r[2*x+1],r[2*b],r[2*b+1],r[2*R],r[2*R+1])){t[e]=R,t[a]=_;const w=n[d];if(w===-1){let D=this._hullStart;do{if(this._hullTri[D]===d){this._hullTri[D]=e;break}D=this._hullPrev[D]}while(D!==this._hullStart)}this._link(e,w),this._link(a,n[o]),this._link(o,d);const L=u+(a+1)%3;s<bx.length&&(bx[s++]=L)}else{if(s===0)break;e=bx[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function uoe(i,e){const t=i/(Math.abs(i)+Math.abs(e));return(e>0?3-t:1+t)/4}function nM(i,e,t,n){const r=i-t,s=e-n;return r*r+s*s}function coe(i,e,t,n,r,s,o,a){const l=i-o,u=e-a,h=t-o,d=n-a,_=r-o,x=s-a,b=l*l+u*u,R=h*h+d*d,E=_*_+x*x;return l*(d*E-R*x)-u*(h*E-R*_)+b*(h*x-d*_)<0}function hoe(i,e,t,n,r,s){const o=t-i,a=n-e,l=r-i,u=s-e,h=o*o+a*a,d=l*l+u*u,_=.5/(o*u-a*l),x=(u*h-a*d)*_,b=(o*d-l*h)*_;return x*x+b*b}function foe(i,e,t,n,r,s){const o=t-i,a=n-e,l=r-i,u=s-e,h=o*o+a*a,d=l*l+u*u,_=.5/(o*u-a*l),x=i+(u*h-a*d)*_,b=e+(o*d-l*h)*_;return{x,y:b}}function Vp(i,e,t,n){if(n-t<=20)for(let r=t+1;r<=n;r++){const s=i[r],o=e[s];let a=r-1;for(;a>=t&&e[i[a]]>o;)i[a+1]=i[a--];i[a+1]=s}else{const r=t+n>>1;let s=t+1,o=n;L1(i,r,s),e[i[t]]>e[i[n]]&&L1(i,t,n),e[i[s]]>e[i[n]]&&L1(i,s,n),e[i[t]]>e[i[s]]&&L1(i,t,s);const a=i[s],l=e[a];for(;;){do s++;while(e[i[s]]<l);do o--;while(e[i[o]]>l);if(o<s)break;L1(i,s,o)}i[t+1]=i[o],i[o]=a,n-s+1>=o-t?(Vp(i,e,s,n),Vp(i,e,t,o-1)):(Vp(i,e,t,o-1),Vp(i,e,s,n))}}function L1(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}function doe(i){return i[0]}function Aoe(i){return i[1]}function poe(i,e){var t,n,r=0,s,o,a,l,u,h,d,_=i[0],x=i[1],b=e.length;for(t=0;t<b;t++){n=0;var R=e[t],E=R.length-1;if(h=R[0],h[0]!==R[E][0]&&h[1]!==R[E][1])throw new Error("First and last coordinates in a ring must be the same");for(o=h[0]-_,a=h[1]-x,n;n<E;n++){if(d=R[n+1],l=d[0]-_,u=d[1]-x,a===0&&u===0){if(l<=0&&o>=0||o<=0&&l>=0)return 0}else if(u>=0&&a<=0||u<=0&&a>=0){if(s=h_(o,l,a,u,0,0),s===0)return 0;(s>0&&u>0&&a<=0||s<0&&u<=0&&a>0)&&r++}h=d,a=u,o=l}}return r%2!==0}function moe(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function goe(i){return i.type==="Feature"?i.geometry:i}function _oe(i,e,t={}){if(!i)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=moe(i),r=goe(e),s=r.type,o=e.bbox;let a=r.coordinates;if(o&&yoe(n,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var u=0;u<a.length;++u){const h=poe(n,a[u]);if(h===0)return!t.ignoreBoundary;h&&(l=!0)}return l}function yoe(i,e){return e[0]<=i[0]&&e[1]<=i[1]&&e[2]>=i[0]&&e[3]>=i[1]}var voe=_oe;const yO=1e-6;class gA{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){e=+e,t=+t,n=+n;const r=e+n,s=t;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>yO||Math.abs(this._y1-s)>yO)&&(this._+="L"+r+","+s),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=s}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}let TC=class{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}};class xoe{constructor(e,[t,n,r,s]=[0,0,960,500]){if(!((r=+r)>=(t=+t))||!((s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=t,this.ymax=s,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let R=0,E=0,w=n.length,L,D;R<w;R+=3,E+=2){const O=n[R]*2,B=n[R+1]*2,G=n[R+2]*2,k=e[O],z=e[O+1],F=e[B],q=e[B+1],H=e[G],Q=e[G+1],K=F-k,se=q-z,ee=H-k,$=Q-z,re=(K*$-se*ee)*2;if(Math.abs(re)<1e-9){if(s===void 0){s=o=0;for(const _e of t)s+=e[_e*2],o+=e[_e*2+1];s/=t.length,o/=t.length}const ae=1e9*Math.sign((s-k)*$-(o-z)*ee);L=(k+H)/2-ae*$,D=(z+Q)/2+ae*ee}else{const ae=1/re,_e=K*K+se*se,ne=ee*ee+$*$;L=k+($*_e-se*ne)*ae,D=z+(K*ne-ee*_e)*ae}a[E]=L,a[E+1]=D}let l=t[t.length-1],u,h=l*4,d,_=e[2*l],x,b=e[2*l+1];r.fill(0);for(let R=0;R<t.length;++R)l=t[R],u=h,d=_,x=b,h=l*4,_=e[2*l],b=e[2*l+1],r[u+2]=r[h]=x-b,r[u+3]=r[h+1]=_-d}render(e){const t=e==null?e=new gA:void 0,{delaunay:{halfedges:n,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let h=0,d=n.length;h<d;++h){const _=n[h];if(_<h)continue;const x=Math.floor(h/3)*2,b=Math.floor(_/3)*2,R=o[x],E=o[x+1],w=o[b],L=o[b+1];this._renderSegment(R,E,w,L,e)}let l,u=s[s.length-1];for(let h=0;h<s.length;++h){l=u,u=s[h];const d=Math.floor(r[u]/3)*2,_=o[d],x=o[d+1],b=l*4,R=this._project(_,x,a[b+2],a[b+3]);R&&this._renderSegment(_,x,R[0],R[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new gA:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=t==null?t=new gA:void 0,r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&t.lineTo(r[o],r[o+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const r=this.cellPolygon(t);r&&(r.index=t,yield r)}}cellPolygon(e){const t=new TC;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,s){let o;const a=this._regioncode(e,t),l=this._regioncode(n,r);a===0&&l===0?(s.moveTo(e,t),s.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,n){return t=+t,t!==t||(n=+n,n!==n)?!1:this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const r=this._clip(n);if(r){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(t[s]===r[a]&&t[s+1]===r[a+1]&&t[(s+2)%o]===r[(a+l-2)%l]&&t[(s+3)%o]===r[(a+l-1)%l]){yield n;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:s}}=this,o=n[e];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(t[u*2],t[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==e)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:n}=this,r=e*4;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let r=null,s,o,a=t[n-2],l=t[n-1],u,h=this._regioncode(a,l),d,_=0;for(let x=0;x<n;x+=2)if(s=a,o=l,a=t[x],l=t[x+1],u=h,h=this._regioncode(a,l),u===0&&h===0)d=_,_=0,r?r.push(a,l):r=[a,l];else{let b,R,E,w,L;if(u===0){if((b=this._clipSegment(s,o,a,l,u,h))===null)continue;[R,E,w,L]=b}else{if((b=this._clipSegment(a,l,s,o,h,u))===null)continue;[w,L,R,E]=b,d=_,_=this._edgecode(R,E),d&&_&&this._edge(e,d,_,r,r.length),r?r.push(R,E):r=[R,E]}d=_,_=this._edgecode(w,L),d&&_&&this._edge(e,d,_,r,r.length),r?r.push(w,L):r=[w,L]}if(r)d=_,_=this._edgecode(r[0],r[1]),d&&_&&this._edge(e,d,_,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,t,n,r,s,o){const a=s<o;for(a&&([e,t,n,r,s,o]=[n,r,e,t,o,s]);;){if(s===0&&o===0)return a?[n,r,e,t]:[e,t,n,r];if(s&o)return null;let l,u,h=s||o;h&8?(l=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):h&4?(l=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):h&2?(u=t+(r-t)*(this.xmax-e)/(n-e),l=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),l=this.xmin),s?(e=l,t=u,s=this._regioncode(e,t)):(n=l,r=u,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,s,o){let a=Array.from(t),l;if((l=this._project(a[0],a[1],n,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(e,a))for(let u=0,h=a.length,d,_=this._edgecode(a[h-2],a[h-1]);u<h;u+=2)d=_,_=this._edgecode(a[u],a[u+1]),d&&_&&(u=this._edge(e,d,_,a,u),h=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,n,r,s){for(;t!==n;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(e,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(e,t,n,r){let s=1/0,o,a,l;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<s&&(l=this.ymin,a=e+(s=o)*n)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<s&&(l=this.ymax,a=e+(s=o)*n)}if(n>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/n)<s&&(a=this.xmax,l=t+(s=o)*r)}else if(n<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/n)<s&&(a=this.xmin,l=t+(s=o)*r)}return[a,l]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}const boe=2*Math.PI,fp=Math.pow;function Soe(i){return i[0]}function Toe(i){return i[1]}function Eoe(i){const{triangles:e,coords:t}=i;for(let n=0;n<e.length;n+=3){const r=2*e[n],s=2*e[n+1],o=2*e[n+2];if((t[o]-t[r])*(t[s+1]-t[r+1])-(t[s]-t[r])*(t[o+1]-t[r+1])>1e-10)return!1}return!0}function woe(i,e,t){return[i+Math.sin(i+e)*t,e+Math.cos(i-e)*t]}class P8{static from(e,t=Soe,n=Toe,r){return new P8("length"in e?Moe(e,t,n,r):Float64Array.from(Roe(e,t,n,r)))}constructor(e){this._delaunator=new Ay(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&Eoe(e)){this.collinear=Int32Array.from({length:t.length/2},(_,x)=>x).sort((_,x)=>t[2*_]-t[2*x]||t[2*_+1]-t[2*x+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],h=[t[2*l],t[2*l+1],t[2*u],t[2*u+1]],d=1e-8*Math.hypot(h[3]-h[1],h[2]-h[0]);for(let _=0,x=t.length/2;_<x;++_){const b=woe(t[2*_],t[2*_+1],d);t[2*_]=b[0],t[2*_+1]=b[1]}this._delaunator=new Ay(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=n.length;l<u;++l){const h=s[l%3===2?l-2:l+1];(n[l]===-1||o[h]===-1)&&(o[h]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new xoe(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const d=a.indexOf(e);d>0&&(yield a[d-1]),d<a.length-1&&(yield a[d+1]);return}const l=t[e];if(l===-1)return;let u=l,h=-1;do{if(yield h=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const d=n[(r[e]+1)%n.length];d!==h&&(yield d);return}}while(u!==l)}find(e,t,n=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const r=n;let s;for(;(s=this._step(n,e,t))>=0&&s!==n&&s!==r;)n=s;return s}_step(e,t,n){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[e]===-1||!u.length)return(e+1)%(u.length>>1);let h=e,d=fp(t-u[e*2],2)+fp(n-u[e*2+1],2);const _=r[e];let x=_;do{let b=l[x];const R=fp(t-u[b*2],2)+fp(n-u[b*2+1],2);if(R<d&&(d=R,h=b),x=x%3===2?x-2:x+1,l[x]!==e)break;if(x=a[x],x===-1){if(x=s[(o[e]+1)%s.length],x!==b&&fp(t-u[x*2],2)+fp(n-u[x*2+1],2)<d)return x;break}}while(x!==_);return h}render(e){const t=e==null?e=new gA:void 0,{points:n,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,h=s[l]*2;e.moveTo(n[u],n[u+1]),e.lineTo(n[h],n[h+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const n=e==null?e=new gA:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];e.moveTo(a+t,l),e.arc(a,l,t,0,boe)}return n&&n.value()}renderHull(e){const t=e==null?e=new gA:void 0,{hull:n,points:r}=this,s=n[0]*2,o=n.length;e.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*n[a];e.lineTo(r[l],r[l+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new TC;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=t==null?t=new gA:void 0,{points:r,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,l=s[e+2]*2;return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[l],r[l+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new TC;return this.renderTriangle(e,t),t.value()}}function Moe(i,e,t,n){const r=i.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=i[o];s[o*2]=e.call(n,a,o,i),s[o*2+1]=t.call(n,a,o,i)}return s}function*Roe(i,e,t,n){let r=0;for(const s of i)yield e.call(n,s,r,i),yield t.call(n,s,r,i),++r}const L8=Math.PI,vO=L8/2,xO=180/L8,bO=L8/180,Coe=Math.atan2,SO=Math.cos,Noe=Math.max,Doe=Math.min,TO=Math.sin,Poe=Math.sign||function(i){return i>0?1:i<0?-1:0},FF=Math.sqrt;function Loe(i){return i>1?vO:i<-1?-vO:Math.asin(i)}function kF(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Ha(i,e){return[i[1]*e[2]-i[2]*e[1],i[2]*e[0]-i[0]*e[2],i[0]*e[1]-i[1]*e[0]]}function _S(i,e){return[i[0]+e[0],i[1]+e[1],i[2]+e[2]]}function yS(i){var e=FF(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);return[i[0]/e,i[1]/e,i[2]/e]}function O8(i){return[Coe(i[1],i[0])*xO,Loe(Noe(-1,Doe(1,i[2])))*xO]}function tc(i){const e=i[0]*bO,t=i[1]*bO,n=SO(t);return[n*SO(e),n*TO(e),TO(t)]}function I8(i){return i=i.map(e=>tc(e)),kF(i[0],Ha(i[2],i[1]))}function Ooe(i){const e=Boe(i),t=Foe(e),n=Uoe(t,i),r=Goe(t,i.length),s=Ioe(r,i),o=koe(t,i),{polygons:a,centers:l}=zoe(o,t,i),u=Voe(a),h=Hoe(t,i),d=qoe(n,t);return{delaunay:e,edges:n,triangles:t,centers:l,neighbors:r,polygons:a,mesh:u,hull:h,urquhart:d,find:s}}function Ioe(i,e){function t(n,r){let s=n[0]-r[0],o=n[1]-r[1],a=n[2]-r[2];return s*s+o*o+a*a}return function(r,s,o){o===void 0&&(o=0);let a,l,u=o;const h=tc([r,s]);do a=o,o=null,l=t(h,tc(e[a])),i[a].forEach(d=>{let _=t(h,tc(e[d]));if(_<l){l=_,o=d,u=d;return}});while(o!==null);return u}}function Boe(i){if(i.length<2)return{};let e=0;for(;isNaN(i[e][0]+i[e][1])&&e++<i.length;);const t=Sie(i[e]),n=nre().translate([0,0]).scale(1).rotate(t.invert([180,0]));i=i.map(n);const r=[];let s=1;for(let d=0,_=i.length;d<_;d++){let x=i[d][0]**2+i[d][1]**2;!isFinite(x)||x>1e32?r.push(d):x>s&&(s=x)}const o=1e6*FF(s);r.forEach(d=>i[d]=[o,0]),i.push([0,o]),i.push([-o,0]),i.push([0,-o]);const a=P8.from(i);a.projection=n;const{triangles:l,halfedges:u,inedges:h}=a;for(let d=0,_=u.length;d<_;d++)if(u[d]<0){const x=d%3==2?d-2:d+1,b=d%3==0?d+2:d-1,R=u[x],E=u[b];u[R]=E,u[E]=R,u[x]=u[b]=-1,l[d]=l[x]=l[b]=e,h[l[R]]=R%3==0?R+2:R-1,h[l[E]]=E%3==0?E+2:E-1,d+=2-d%3}else l[d]>i.length-3-1&&(l[d]=e);return a}function Uoe(i,e){const t=new Set;return e.length===2?[[0,1]]:(i.forEach(n=>{if(n[0]!==n[1]&&!(I8(n.map(r=>e[r]))<0))for(let r=0,s;r<3;r++)s=(r+1)%3,t.add(Hb([n[r],n[s]]).join("-"))}),Array.from(t,n=>n.split("-").map(Number)))}function Foe(i){const{triangles:e}=i;if(!e)return[];const t=[];for(let n=0,r=e.length/3;n<r;n++){const s=e[3*n],o=e[3*n+1],a=e[3*n+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function koe(i,e){return i.map(t=>{const n=t.map(s=>e[s]).map(tc),r=_S(_S(Ha(n[1],n[0]),Ha(n[2],n[1])),Ha(n[0],n[2]));return O8(yS(r))})}function Goe(i,e){const t=[];return i.forEach(n=>{for(let r=0;r<3;r++){const s=n[r],o=n[(r+1)%3];t[s]=t[s]||[],t[s].push(o)}}),i.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function zoe(i,e,t){const n=[],r=i.slice();if(e.length===0){if(t.length<2)return{polygons:n,centers:r};if(t.length===2){const a=tc(t[0]),l=tc(t[1]),u=yS(_S(a,l)),h=yS(Ha(a,l)),d=Ha(u,h),_=[u,Ha(u,d),Ha(Ha(u,d),d),Ha(Ha(Ha(u,d),d),d)].map(O8).map(o);return n.push(_),n.push(_.slice().reverse()),{polygons:n,centers:r}}}e.forEach((a,l)=>{for(let u=0;u<3;u++){const h=a[u],d=a[(u+1)%3],_=a[(u+2)%3];n[h]=n[h]||[],n[h].push([d,_,l,[h,d,_]])}});const s=n.map(a=>{const l=[a[0][2]];let u=a[0][1];for(let h=1;h<a.length;h++)for(let d=0;d<a.length;d++)if(a[d][0]==u){u=a[d][1],l.push(a[d][2]);break}if(l.length>2)return l;if(l.length==2){const h=EO(t[a[0][3][0]],t[a[0][3][1]],r[l[0]]),d=EO(t[a[0][3][2]],t[a[0][3][0]],r[l[0]]),_=o(h),x=o(d);return[l[0],x,l[1],_]}});function o(a){let l=-1;return r.slice(e.length,1/0).forEach((u,h)=>{u[0]===a[0]&&u[1]===a[1]&&(l=h+e.length)}),l<0&&(l=r.length,r.push(a)),l}return{polygons:s,centers:r}}function EO(i,e,t){i=tc(i),e=tc(e),t=tc(t);const n=Poe(kF(Ha(e,i),t));return O8(yS(_S(i,e)).map(r=>n*r))}function Voe(i){const e=[];return i.forEach(t=>{if(!t)return;let n=t[t.length-1];for(let r of t)r>n&&e.push([n,r]),n=r}),e}function qoe(i,e){return function(t){const n=new Map,r=new Map;return i.forEach((s,o)=>{const a=s.join("-");n.set(a,t[o]),r.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let l=0;l<3;l++){let u=Hb([s[l],s[(l+1)%3]]).join("-");n.get(u)>o&&(o=n.get(u),a=u)}r.set(a,!1)}),i.map(s=>r.get(s.join("-")))}}function Hoe(i,e){const t=new Set,n=[];i.map(a=>{if(!(I8(a.map(l=>e[l>e.length?0:l]))>1e-12))for(let l=0;l<3;l++){let u=[a[l],a[(l+1)%3]],h=`${u[0]}-${u[1]}`;t.has(h)?t.delete(h):t.add(`${u[1]}-${u[0]}`)}});const r=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),r.set(a[0],a[1]),s=a[0]}),s===void 0)return n;let o=s;do{n.push(o);let a=r.get(o);r.set(o,-1),o=a}while(o>-1&&o!==s);return n}function Woe(i){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const n=e._data.map(r=>[e._vx(r),e._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));e.points=n.map(r=>[r[0],r[1]]),e.valid=n.map(r=>r[2]),e.delaunay=Ooe(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return B7(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return B7(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const n={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((r,s)=>n.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&n.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),n},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((n,r)=>(n=n.map(s=>e.points[s]),n.center=e.delaunay.centers[r],n)).filter(n=>I8(n)>0).map(n=>({type:"Feature",properties:{circumcenter:n.center},geometry:{type:"Polygon",coordinates:[[...n,n[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const n=e.delaunay.edges.map(s=>ld(e.points[s[0]],e.points[s[1]])),r=e.delaunay.urquhart(n);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:n[o],urquhart:!!r[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(n=>[e.points[n[0]],e.points[n[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:n,polygons:r}=e.delaunay,s=[];for(const o of r)if(o)for(let a=o.length,l=o[a-1],u=o[0],h=0;h<a;l=u,u=o[++h])u>l&&s.push([n[l],n[u]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,n,r){if(e._found=e.delaunay.find(t,n,e._found),!r||ld([t,n],e.points[e._found])<r)return e._found},e.hull=function(t){t!==void 0&&e(t);const n=e.delaunay.hull,r=e.points;return n.length===0?null:{type:"Polygon",coordinates:[[...n.map(s=>r[s]),r[n[0]]]]}},i?e(i):e}function EC(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function joe(i){if(Array.isArray(i))return i}function Xoe(i){if(Array.isArray(i))return EC(i)}function $oe(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Yoe(i,e,t){return e=vS(e),iae(i,GF()?Reflect.construct(e,[],vS(i).constructor):e.apply(i,t))}function Qoe(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Koe(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function vS(i){return vS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vS(i)}function Zoe(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&wC(i,e)}function GF(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GF=function(){return!!i})()}function Joe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function eae(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function tae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iae(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $oe(i)}function wC(i,e){return wC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},wC(i,e)}function Vu(i,e){return joe(i)||eae(i,e)||zF(i,e)||tae()}function iM(i){return Xoe(i)||Joe(i)||zF(i)||nae()}function zF(i,e){if(i){if(typeof i=="string")return EC(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?EC(i,e):void 0}}function rae(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.resolution,n=t===void 0?1/0:t,r=sae(i,n),s=oy(r),o=oae(i,n),a=[].concat(iM(s),iM(o)),l={type:"Polygon",coordinates:i},u=aF(l),h=Vu(u,2),d=Vu(h[0],2),_=d[0],x=d[1],b=Vu(h[1],2),R=b[0],E=b[1],w=_>R||E>=89||x<=-89,L=[];if(w){var D=Woe(a).triangles(),O=new Map(a.map(function(re,ae){var _e=Vu(re,2),ne=_e[0],ye=_e[1];return["".concat(ne,"-").concat(ye),ae]}));D.features.forEach(function(re){var ae,_e=re.geometry.coordinates[0].slice(0,3).reverse(),ne=[];if(_e.forEach(function(ve){var Pe=Vu(ve,2),Se=Pe[0],Fe=Pe[1],Ye="".concat(Se,"-").concat(Fe);O.has(Ye)&&ne.push(O.get(Ye))}),ne.length===3){if(ne.some(function(ve){return ve<s.length})){var ye=re.properties.circumcenter;if(!MC(ye,l,w))return}(ae=L).push.apply(ae,ne)}})}else if(o.length)for(var F=Ay.from(a),q=function(ae){var _e,ne=[2,1,0].map(function(Pe){return F.triangles[ae+Pe]}),ye=ne.map(function(Pe){return a[Pe]});if(ne.some(function(Pe){return Pe<s.length})){var ve=[0,1].map(function(Pe){return mne(ye,function(Se){return Se[Pe]})});if(!MC(ve,l,w))return 1}(_e=L).push.apply(_e,iM(ne))},H=0,Q=F.triangles.length;H<Q;H+=3)q(H);else{var B=AS(r),G=B.vertices,k=B.holes,z=k===void 0?[]:k;L=wre(G,z,2)}var K=Rh(Hb(a,function(re){return re[0]}),[0,1]),se=Rh(Hb(a,function(re){return re[1]}),[0,1]),ee=a.map(function(re){var ae=Vu(re,2),_e=ae[0],ne=ae[1];return[K(_e),se(ne)]}),$={points:a,indices:L,uvs:ee};return{contour:r,triangles:$}}function sae(i,e){return i.map(function(t){var n=[],r;return t.forEach(function(s){if(r){var o=ld(s,r)*180/Math.PI;if(o>e)for(var a=w8(r,s),l=1/Math.ceil(o/e),u=l;u<1;)n.push(a(u)),u+=l}n.push(r=s)}),n})}function oae(i,e){var t={type:"Polygon",coordinates:i},n=aF(t),r=Vu(n,2),s=Vu(r[0],2),o=s[0],a=s[1],l=Vu(r[1],2),u=l[0],h=l[1];if(Math.min(Math.abs(u-o),Math.abs(h-a))<e)return[];var d=o>u||h>=89||a<=-89;return aae(e,{minLng:o,maxLng:u,minLat:a,maxLat:h}).filter(function(_){return MC(_,t,d)})}function aae(i){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.minLng,n=e.maxLng,r=e.minLat,s=e.maxLat,o=Math.round(Math.pow(360/i,2)/Math.PI),a=(1+Math.sqrt(5))/2,l=function(w){return w/a*360%360-180},u=function(w){return Math.acos(2*w/o-1)/Math.PI*180-90},h=function(w){return o*(Math.cos((w+90)*Math.PI/180)+1)/2},d=[s!==void 0?Math.ceil(h(s)):0,r!==void 0?Math.floor(h(r)):o-1],_=t===void 0&&n===void 0?function(){return!0}:t===void 0?function(E){return E<=n}:n===void 0?function(E){return E>=t}:n>=t?function(E){return E>=t&&E<=n}:function(E){return E>=t||E<=n},x=[],b=d[0];b<=d[1];b++){var R=l(b);_(R)&&x.push([R,u(b)])}return x}function MC(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Gie(e,i):voe(i,e)}var Mb=window.THREE?window.THREE:{BufferGeometry:Vi,Float32BufferAttribute:Si},wO=new Mb.BufferGeometry().setAttribute?"setAttribute":"addAttribute",B8=function(i){function e(t,n,r,s,o,a,l){var u;Qoe(this,e),u=Yoe(this,e),u.type="ConicPolygonGeometry",u.parameters={polygonGeoJson:t,bottomHeight:n,topHeight:r,closedBottom:s,closedTop:o,includeSides:a,curvatureResolution:l},n=n||0,r=r||1,s=s!==void 0?s:!0,o=o!==void 0?o:!0,a=a!==void 0?a:!0,l=l||5;var h=rae(t,{resolution:l}),d=h.contour,_=h.triangles,x=oy(_.uvs),b=[],R=[],E=[],w=0,L=function(k){var z=Math.round(b.length/3),F=E.length;b=b.concat(k.vertices),R=R.concat(k.uvs),E=E.concat(z?k.indices.map(function(q){return q+z}):k.indices),u.addGroup(F,E.length-F,w++)};a&&L(O()),s&&L(B(n,!1)),o&&L(B(r,!0)),u.setIndex(E),u[wO]("position",new Mb.Float32BufferAttribute(b,3)),u[wO]("uv",new Mb.Float32BufferAttribute(R,2)),u.computeVertexNormals();function D(G,k){var z=typeof k=="function"?k:function(){return k},F=G.map(function(q){return q.map(function(H){var Q=Vu(H,2),K=Q[0],se=Q[1];return lae(se,K,z(K,se))})});return AS(F)}function O(){for(var G=D(d,n),k=G.vertices,z=G.holes,F=D(d,r),q=F.vertices,H=oy([q,k]),Q=Math.round(q.length/3),K=new Set(z),se=0,ee=[],$=0;$<Q;$++){var re=$+1;if(re===Q)re=se;else if(K.has(re)){var ae=re;re=se,se=ae}ee.push($,$+Q,re+Q),ee.push(re+Q,re,$)}for(var _e=[],ne=1;ne>=0;ne--)for(var ye=0;ye<Q;ye+=1)_e.push(ye/(Q-1),ne);return{indices:ee,vertices:H,uvs:_e}}function B(G){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:k?_.indices:_.indices.slice().reverse(),vertices:D([_.points],G).vertices,uvs:x}}return u}return Zoe(e,i),Koe(e)}(Mb.BufferGeometry);function lae(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(90-i)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(n)*Math.cos(r),t*Math.cos(n),t*Math.sin(n)*Math.sin(r)]}function RC(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function uae(i){if(Array.isArray(i))return i}function cae(i){if(Array.isArray(i))return RC(i)}function hae(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function fae(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function dae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pae(i,e){if(i==null)return{};var t,n,r=mae(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.includes(t)||{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function mae(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.includes(n))continue;t[n]=i[n]}return t}function gae(i,e){return uae(i)||fae(i,e)||VF(i,e)||dae()}function _ae(i){return cae(i)||hae(i)||VF(i)||Aae()}function yae(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function vae(i){var e=yae(i,"string");return typeof e=="symbol"?e:e+""}function VF(i,e){if(i){if(typeof i=="string")return RC(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?RC(i,e):void 0}}var xae=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=i.reduce(function(a,l){var u=a,h=l;return r.forEach(function(d,_){var x=d.keyAccessor,b=d.isProp,R;if(b){var E=h,w=E[x],L=pae(E,[x].map(vae));R=w,h=L}else R=x(h,_);_+1<r.length?(u.hasOwnProperty(R)||(u[R]={}),u=u[R]):t?(u.hasOwnProperty(R)||(u[R]=[]),u[R].push(h)):u[R]=h}),a},{});t instanceof Function&&function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===r.length?Object.keys(l).forEach(function(h){return l[h]=t(l[h])}):Object.values(l).forEach(function(h){return a(h,u+1)})}(s);var o=s;return n&&(o=[],function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===r.length?o.push({keys:u,vals:l}):Object.entries(l).forEach(function(h){var d=gae(h,2),_=d[0],x=d[1];return a(x,[].concat(_ae(u),[_]))})}(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o},bi=function(i){i=i||{};var e=typeof i<"u"?i:{},t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);var r="";function s(ke){return e.locateFile?e.locateFile(ke,r):r+ke}var o;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(We,St,rt){var p=new XMLHttpRequest;p.open("GET",We,!0),p.responseType="arraybuffer",p.onload=function(){if(p.status==200||p.status==0&&p.response){St(p.response);return}var ti=sn(We);if(ti){St(ti.buffer);return}rt()},p.onerror=rt,p.send(null)};var a=e.print||console.log.bind(console),l=e.printErr||console.warn.bind(console);for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);t=null,e.arguments&&e.arguments;var u=0,h=function(ke){u=ke},d=function(){return u},_=8;function x(ke,We,St,rt){switch(St=St||"i8",St.charAt(St.length-1)==="*"&&(St="i32"),St){case"i1":Q[ke>>0]=We;break;case"i8":Q[ke>>0]=We;break;case"i16":se[ke>>1]=We;break;case"i32":ee[ke>>2]=We;break;case"i64":Ge=[We>>>0,(ie=We,+$t(ie)>=1?ie>0?(ft(+vt(ie/4294967296),4294967295)|0)>>>0:~~+he((ie-+(~~ie>>>0))/4294967296)>>>0:0)],ee[ke>>2]=Ge[0],ee[ke+4>>2]=Ge[1];break;case"float":$[ke>>2]=We;break;case"double":re[ke>>3]=We;break;default:Ti("invalid type for setValue: "+St)}}function b(ke,We,St){switch(We=We||"i8",We.charAt(We.length-1)==="*"&&(We="i32"),We){case"i1":return Q[ke>>0];case"i8":return Q[ke>>0];case"i16":return se[ke>>1];case"i32":return ee[ke>>2];case"i64":return ee[ke>>2];case"float":return $[ke>>2];case"double":return re[ke>>3];default:Ti("invalid type for getValue: "+We)}return null}var R=!1;function E(ke,We){ke||Ti("Assertion failed: "+We)}function w(ke){var We=e["_"+ke];return E(We,"Cannot call unknown function "+ke+", make sure it is exported"),We}function L(ke,We,St,rt,p){var J={string:function(on){var $s=0;if(on!=null&&on!==0){var Sc=(on.length<<2)+1;$s=xt(Sc),z(on,$s,Sc)}return $s},array:function(on){var $s=xt(on.length);return F(on,$s),$s}};function ti(on){return We==="string"?G(on):We==="boolean"?!!on:on}var ci=w(ke),hr=[],Tn=0;if(rt)for(var Zn=0;Zn<rt.length;Zn++){var ho=J[St[Zn]];ho?(Tn===0&&(Tn=Ct()),hr[Zn]=ho(rt[Zn])):hr[Zn]=rt[Zn]}var ri=ci.apply(null,hr);return ri=ti(ri),Tn!==0&&Ht(Tn),ri}function D(ke,We,St,rt){St=St||[];var p=St.every(function(ti){return ti==="number"}),J=We!=="string";return J&&p&&!rt?w(ke):function(){return L(ke,We,St,arguments)}}var O=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function B(ke,We,St){for(var rt=We+St,p=We;ke[p]&&!(p>=rt);)++p;if(p-We>16&&ke.subarray&&O)return O.decode(ke.subarray(We,p));for(var J="";We<p;){var ti=ke[We++];if(!(ti&128)){J+=String.fromCharCode(ti);continue}var ci=ke[We++]&63;if((ti&224)==192){J+=String.fromCharCode((ti&31)<<6|ci);continue}var hr=ke[We++]&63;if((ti&240)==224?ti=(ti&15)<<12|ci<<6|hr:ti=(ti&7)<<18|ci<<12|hr<<6|ke[We++]&63,ti<65536)J+=String.fromCharCode(ti);else{var Tn=ti-65536;J+=String.fromCharCode(55296|Tn>>10,56320|Tn&1023)}}return J}function G(ke,We){return ke?B(K,ke,We):""}function k(ke,We,St,rt){if(!(rt>0))return 0;for(var p=St,J=St+rt-1,ti=0;ti<ke.length;++ti){var ci=ke.charCodeAt(ti);if(ci>=55296&&ci<=57343){var hr=ke.charCodeAt(++ti);ci=65536+((ci&1023)<<10)|hr&1023}if(ci<=127){if(St>=J)break;We[St++]=ci}else if(ci<=2047){if(St+1>=J)break;We[St++]=192|ci>>6,We[St++]=128|ci&63}else if(ci<=65535){if(St+2>=J)break;We[St++]=224|ci>>12,We[St++]=128|ci>>6&63,We[St++]=128|ci&63}else{if(St+3>=J)break;We[St++]=240|ci>>18,We[St++]=128|ci>>12&63,We[St++]=128|ci>>6&63,We[St++]=128|ci&63}}return We[St]=0,St-p}function z(ke,We,St){return k(ke,K,We,St)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function F(ke,We){Q.set(ke,We)}function q(ke,We){return ke%We>0&&(ke+=We-ke%We),ke}var H,Q,K,se,ee,$,re;function ae(ke){H=ke,e.HEAP8=Q=new Int8Array(ke),e.HEAP16=se=new Int16Array(ke),e.HEAP32=ee=new Int32Array(ke),e.HEAPU8=K=new Uint8Array(ke),e.HEAPU16=new Uint16Array(ke),e.HEAPU32=new Uint32Array(ke),e.HEAPF32=$=new Float32Array(ke),e.HEAPF64=re=new Float64Array(ke)}var _e=5271520,ne=28608,ye=e.TOTAL_MEMORY||33554432;e.buffer?H=e.buffer:H=new ArrayBuffer(ye),ye=H.byteLength,ae(H),ee[ne>>2]=_e;function ve(ke){for(;ke.length>0;){var We=ke.shift();if(typeof We=="function"){We();continue}var St=We.func;typeof St=="number"?We.arg===void 0?e.dynCall_v(St):e.dynCall_vi(St,We.arg):St(We.arg===void 0?null:We.arg)}}var Pe=[],Se=[],Fe=[],Ye=[];function at(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Nn(e.preRun.shift());ve(Pe)}function At(){ve(Se)}function Gt(){ve(Fe)}function Dt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)bn(e.postRun.shift());ve(Ye)}function Nn(ke){Pe.unshift(ke)}function bn(ke){Ye.unshift(ke)}var $t=Math.abs,he=Math.ceil,vt=Math.floor,ft=Math.min,pt=0,et=null;function Ft(ke){pt++,e.monitorRunDependencies&&e.monitorRunDependencies(pt)}function Tt(ke){if(pt--,e.monitorRunDependencies&&e.monitorRunDependencies(pt),pt==0&&et){var We=et;et=null,We()}}e.preloadedImages={},e.preloadedAudios={};var Lt=null,_n="data:application/octet-stream;base64,";function pe(ke){return String.prototype.startsWith?ke.startsWith(_n):ke.indexOf(_n)===0}var ie,Ge;Lt="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Qe=28624;function nt(ke,We,St,rt){Ti("Assertion failed: "+G(ke)+", at: "+[We?G(We):"unknown filename",St,rt?G(rt):"unknown function"])}function Ke(){return Q.length}function qt(ke,We,St){K.set(K.subarray(We,We+St),ke)}function Bt(ke){return e.___errno_location&&(ee[e.___errno_location()>>2]=ke),ke}function Zt(ke){Ti("OOM")}function nn(ke){try{var We=new ArrayBuffer(ke);return We.byteLength!=ke?void 0:(new Int8Array(We).set(Q),Ut(We),ae(We),1)}catch{}}function _t(ke){var We=Ke(),St=16777216,rt=2147483648-St;if(ke>rt)return!1;for(var p=16777216,J=Math.max(We,p);J<ke;)J<=536870912?J=q(2*J,St):J=Math.min(q((3*J+2147483648)/4,St),rt);var ti=nn(J);return!!ti}var jt=typeof atob=="function"?atob:function(ke){var We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",St="",rt,p,J,ti,ci,hr,Tn,Zn=0;ke=ke.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ti=We.indexOf(ke.charAt(Zn++)),ci=We.indexOf(ke.charAt(Zn++)),hr=We.indexOf(ke.charAt(Zn++)),Tn=We.indexOf(ke.charAt(Zn++)),rt=ti<<2|ci>>4,p=(ci&15)<<4|hr>>2,J=(hr&3)<<6|Tn,St=St+String.fromCharCode(rt),hr!==64&&(St=St+String.fromCharCode(p)),Tn!==64&&(St=St+String.fromCharCode(J));while(Zn<ke.length);return St};function un(ke){try{for(var We=jt(ke),St=new Uint8Array(We.length),rt=0;rt<We.length;++rt)St[rt]=We.charCodeAt(rt);return St}catch{throw new Error("Converting base64 string to bytes failed.")}}function sn(ke){if(pe(ke))return un(ke.slice(_n.length))}var It={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Dn={b:h,c:d,d:nt,e:Bt,f:Ke,g:qt,h:_t,i:Zt,o:Qe,p:ne},fe=function(ke,We,St){"almost asm";var rt=new ke.Int8Array(St),p=new ke.Int32Array(St);new ke.Uint8Array(St),new ke.Float32Array(St);var J=new ke.Float64Array(St),ti=We.o|0,ci=We.p|0,hr=ke.Math.floor,Tn=ke.Math.abs,Zn=ke.Math.sqrt,ho=ke.Math.pow,ri=ke.Math.cos,on=ke.Math.sin,$s=ke.Math.tan,Sc=ke.Math.acos,kl=ke.Math.asin,ue=ke.Math.atan,De=ke.Math.atan2,je=ke.Math.ceil,He=ke.Math.imul,Ie=ke.Math.min,Nt=ke.Math.max,Ot=ke.Math.clz32,ct=We.b,te=We.c,Rt=We.d,yn=We.e,cn=We.f,ni=We.g,Pi=We.h,fr=We.i,Z=28640;function Li(A){return rt=new Int8Array(A),p=new Int32Array(A),J=new Float64Array(A),St=A,!0}function vn(A){A=A|0;var m=0;return m=Z,Z=Z+A|0,Z=Z+15&-16,m|0}function Wi(){return Z|0}function mi(A){A=A|0,Z=A}function ls(A,m){A=A|0,Z=A}function Su(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;return(A|0)<0?(m=2,m|0):(A|0)>13780509?(m=g0(15,m)|0,m|0):(g=((A|0)<0)<<31>>31,S=Ur(A|0,g|0,3,0)|0,v=te()|0,g=Xt(A|0,g|0,1,0)|0,g=Ur(S|0,v|0,g|0,te()|0)|0,g=Xt(g|0,te()|0,1,0)|0,A=te()|0,p[m>>2]=g,p[m+4>>2]=A,m=0,m|0)}function Ji(A,m,g,v){return A=A|0,m=m|0,g=g|0,v=v|0,nl(A,m,g,v,0)|0}function nl(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0;if(I=Z,Z=Z+16|0,C=I,!(ji(A,m,g,v,S)|0))return v=0,Z=I,v|0;do if((g|0)>=0){if((g|0)>13780509){if(M=g0(15,C)|0,M|0)break;N=C,C=p[N>>2]|0,N=p[N+4>>2]|0}else M=((g|0)<0)<<31>>31,V=Ur(g|0,M|0,3,0)|0,N=te()|0,M=Xt(g|0,M|0,1,0)|0,M=Ur(V|0,N|0,M|0,te()|0)|0,M=Xt(M|0,te()|0,1,0)|0,N=te()|0,p[C>>2]=M,p[C+4>>2]=N,C=M;if(dl(v|0,0,C<<3|0)|0,S|0){dl(S|0,0,C<<2|0)|0,M=yr(A,m,g,v,S,C,N,0)|0;break}M=Ko(C,4)|0,M?(V=yr(A,m,g,v,M,C,N,0)|0,xn(M),M=V):M=13}else M=2;while(!1);return V=M,Z=I,V|0}function ji(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0;if(Te=Z,Z=Z+16|0,de=Te,Ae=Te+8|0,ge=de,p[ge>>2]=A,p[ge+4>>2]=m,(g|0)<0)return Ae=2,Z=Te,Ae|0;if(M=v,p[M>>2]=A,p[M+4>>2]=m,M=(S|0)!=0,M&&(p[S>>2]=0),wi(A,m)|0)return Ae=9,Z=Te,Ae|0;p[Ae>>2]=0;e:do if((g|0)>=1)if(M)for(j=1,V=0,oe=0,ge=1,M=A;;){if(!(V|oe)){if(M=hi(M,m,4,Ae,de)|0,M|0)break e;if(m=de,M=p[m>>2]|0,m=p[m+4>>2]|0,wi(M,m)|0){M=9;break e}}if(M=hi(M,m,p[26800+(oe<<2)>>2]|0,Ae,de)|0,M|0)break e;if(m=de,M=p[m>>2]|0,m=p[m+4>>2]|0,A=v+(j<<3)|0,p[A>>2]=M,p[A+4>>2]=m,p[S+(j<<2)>>2]=ge,A=V+1|0,C=(A|0)==(ge|0),N=oe+1|0,I=(N|0)==6,wi(M,m)|0){M=9;break e}if(ge=ge+(I&C&1)|0,(ge|0)>(g|0)){M=0;break}else j=j+1|0,V=C?0:A,oe=C?I?0:N:oe}else for(j=1,V=0,oe=0,ge=1,M=A;;){if(!(V|oe)){if(M=hi(M,m,4,Ae,de)|0,M|0)break e;if(m=de,M=p[m>>2]|0,m=p[m+4>>2]|0,wi(M,m)|0){M=9;break e}}if(M=hi(M,m,p[26800+(oe<<2)>>2]|0,Ae,de)|0,M|0)break e;if(m=de,M=p[m>>2]|0,m=p[m+4>>2]|0,A=v+(j<<3)|0,p[A>>2]=M,p[A+4>>2]=m,A=V+1|0,C=(A|0)==(ge|0),N=oe+1|0,I=(N|0)==6,wi(M,m)|0){M=9;break e}if(ge=ge+(I&C&1)|0,(ge|0)>(g|0)){M=0;break}else j=j+1|0,V=C?0:A,oe=C?I?0:N:oe}else M=0;while(!1);return Ae=M,Z=Te,Ae|0}function yr(A,m,g,v,S,M,C,N){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0,C=C|0,N=N|0;var I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0;if(Te=Z,Z=Z+16|0,de=Te+8|0,Ae=Te,I=zc(A|0,m|0,M|0,C|0)|0,j=te()|0,oe=v+(I<<3)|0,Ne=oe,Ve=p[Ne>>2]|0,Ne=p[Ne+4>>2]|0,V=(Ve|0)==(A|0)&(Ne|0)==(m|0),!((Ve|0)==0&(Ne|0)==0|V))do I=Xt(I|0,j|0,1,0)|0,I=rf(I|0,te()|0,M|0,C|0)|0,j=te()|0,oe=v+(I<<3)|0,Ve=oe,Ne=p[Ve>>2]|0,Ve=p[Ve+4>>2]|0,V=(Ne|0)==(A|0)&(Ve|0)==(m|0);while(!((Ne|0)==0&(Ve|0)==0|V));if(I=S+(I<<2)|0,V&&(p[I>>2]|0)<=(N|0)||(Ve=oe,p[Ve>>2]=A,p[Ve+4>>2]=m,p[I>>2]=N,(N|0)>=(g|0)))return Ve=0,Z=Te,Ve|0;switch(V=N+1|0,p[de>>2]=0,I=hi(A,m,2,de,Ae)|0,I|0){case 9:{ge=9;break}case 0:{I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I||(ge=9);break}}e:do if((ge|0)==9){switch(p[de>>2]=0,I=hi(A,m,3,de,Ae)|0,I|0){case 9:break;case 0:{if(I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I|0)break e;break}default:break e}switch(p[de>>2]=0,I=hi(A,m,1,de,Ae)|0,I|0){case 9:break;case 0:{if(I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I|0)break e;break}default:break e}switch(p[de>>2]=0,I=hi(A,m,5,de,Ae)|0,I|0){case 9:break;case 0:{if(I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I|0)break e;break}default:break e}switch(p[de>>2]=0,I=hi(A,m,4,de,Ae)|0,I|0){case 9:break;case 0:{if(I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I|0)break e;break}default:break e}switch(p[de>>2]=0,I=hi(A,m,6,de,Ae)|0,I|0){case 9:break;case 0:{if(I=Ae,I=yr(p[I>>2]|0,p[I+4>>2]|0,g,v,S,M,C,V)|0,I|0)break e;break}default:break e}return Ve=0,Z=Te,Ve|0}while(!1);return Ve=I,Z=Te,Ve|0}function hi(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0;if(g>>>0>6)return S=1,S|0;if(oe=(p[v>>2]|0)%6|0,p[v>>2]=oe,(oe|0)>0){M=0;do g=Cc(g)|0,M=M+1|0;while((M|0)<(p[v>>2]|0))}if(oe=gt(A|0,m|0,45)|0,te()|0,j=oe&127,j>>>0>121)return S=5,S|0;I=Ys(A,m)|0,M=gt(A|0,m|0,52)|0,te()|0,M=M&15;e:do if(!M)V=8;else{for(;;){if(C=(15-M|0)*3|0,N=gt(A|0,m|0,C|0)|0,te()|0,N=N&7,(N|0)==7){m=5;break}if(Ae=(Xo(M)|0)==0,M=M+-1|0,ge=wt(7,0,C|0)|0,m=m&~(te()|0),de=wt(p[(Ae?432:16)+(N*28|0)+(g<<2)>>2]|0,0,C|0)|0,C=te()|0,g=p[(Ae?640:224)+(N*28|0)+(g<<2)>>2]|0,A=de|A&~ge,m=C|m,!g){g=0;break e}if(!M){V=8;break e}}return m|0}while(!1);(V|0)==8&&(Ae=p[848+(j*28|0)+(g<<2)>>2]|0,de=wt(Ae|0,0,45)|0,A=de|A,m=te()|0|m&-1040385,g=p[4272+(j*28|0)+(g<<2)>>2]|0,(Ae&127|0)==127&&(Ae=wt(p[848+(j*28|0)+20>>2]|0,0,45)|0,m=te()|0|m&-1040385,g=p[4272+(j*28|0)+20>>2]|0,A=Tu(Ae|A,m)|0,m=te()|0,p[v>>2]=(p[v>>2]|0)+1)),N=gt(A|0,m|0,45)|0,te()|0,N=N&127;e:do if(dr(N)|0){t:do if((Ys(A,m)|0)==1){if((j|0)!=(N|0))if(Tc(N,p[7696+(j*28|0)>>2]|0)|0){A=Og(A,m)|0,C=1,m=te()|0;break}else Rt(27795,26864,436,26872);switch(I|0){case 3:{A=Tu(A,m)|0,m=te()|0,p[v>>2]=(p[v>>2]|0)+1,C=0;break t}case 5:{A=Og(A,m)|0,m=te()|0,p[v>>2]=(p[v>>2]|0)+5,C=0;break t}case 0:return Ae=9,Ae|0;default:return Ae=1,Ae|0}}else C=0;while(!1);if((g|0)>0){M=0;do A=A0(A,m)|0,m=te()|0,M=M+1|0;while((M|0)!=(g|0))}if((j|0)!=(N|0)){if(!(xg(N)|0)){if((C|0)!=0|(Ys(A,m)|0)!=5)break;p[v>>2]=(p[v>>2]|0)+1;break}switch(oe&127){case 8:case 118:break e}(Ys(A,m)|0)!=3&&(p[v>>2]=(p[v>>2]|0)+1)}}else if((g|0)>0){M=0;do A=Tu(A,m)|0,m=te()|0,M=M+1|0;while((M|0)!=(g|0))}while(!1);return p[v>>2]=((p[v>>2]|0)+g|0)%6|0,Ae=S,p[Ae>>2]=A,p[Ae+4>>2]=m,Ae=0,Ae|0}function Wr(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0;for(N=Z,Z=Z+16|0,M=N,C=N+8|0,S=(wi(A,m)|0)==0,S=S?1:2;;){if(p[C>>2]=0,V=(hi(A,m,S,C,M)|0)==0,I=M,V&((p[I>>2]|0)==(g|0)?(p[I+4>>2]|0)==(v|0):0)){A=4;break}if(S=S+1|0,S>>>0>=7){S=7,A=4;break}}return(A|0)==4?(Z=N,S|0):0}function vs(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0;if(Ae=Z,Z=Z+16|0,ge=Ae,de=Ae+8|0,oe=ge,p[oe>>2]=A,p[oe+4>>2]=m,!g)return de=v,p[de>>2]=A,p[de+4>>2]=m,de=0,Z=Ae,de|0;p[de>>2]=0;e:do if(wi(A,m)|0)A=9;else{if(M=(g|0)>0,M){S=0,oe=A;do{if(A=hi(oe,m,4,de,ge)|0,A|0)break e;if(m=ge,oe=p[m>>2]|0,m=p[m+4>>2]|0,S=S+1|0,wi(oe,m)|0){A=9;break e}}while((S|0)<(g|0));if(j=v,p[j>>2]=oe,p[j+4>>2]=m,j=g+-1|0,M){V=0,A=1;do{if(S=26800+(V<<2)|0,(V|0)==5)for(C=p[S>>2]|0,M=0,S=A;;){if(A=ge,A=hi(p[A>>2]|0,p[A+4>>2]|0,C,de,ge)|0,A|0)break e;if((M|0)!=(j|0))if(I=ge,N=p[I>>2]|0,I=p[I+4>>2]|0,A=v+(S<<3)|0,p[A>>2]=N,p[A+4>>2]=I,!(wi(N,I)|0))A=S+1|0;else{A=9;break e}else A=S;if(M=M+1|0,(M|0)>=(g|0))break;S=A}else for(C=ge,I=p[S>>2]|0,N=0,S=A,M=p[C>>2]|0,C=p[C+4>>2]|0;;){if(A=hi(M,C,I,de,ge)|0,A|0)break e;if(C=ge,M=p[C>>2]|0,C=p[C+4>>2]|0,A=v+(S<<3)|0,p[A>>2]=M,p[A+4>>2]=C,A=S+1|0,wi(M,C)|0){A=9;break e}if(N=N+1|0,(N|0)>=(g|0))break;S=A}V=V+1|0}while(V>>>0<6);A=ge,C=oe,S=p[A>>2]|0,M=m,A=p[A+4>>2]|0}else C=oe,S=oe,M=m,A=m}else C=v,p[C>>2]=A,p[C+4>>2]=m,C=A,S=A,M=m,A=m;A=(C|0)==(S|0)&(M|0)==(A|0)?0:9}while(!1);return de=A,Z=Ae,de|0}function il(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0;if(N=Z,Z=Z+48|0,S=N+16|0,M=N+8|0,C=N,g=Ls(g)|0,g|0)return C=g,Z=N,C|0;if(V=A,I=p[V+4>>2]|0,g=M,p[g>>2]=p[V>>2],p[g+4>>2]=I,Do(M,S),g=Ed(S,m,C)|0,!g){if(m=p[M>>2]|0,M=p[A+8>>2]|0,(M|0)>0){S=p[A+12>>2]|0,g=0;do m=(p[S+(g<<3)>>2]|0)+m|0,g=g+1|0;while((g|0)<(M|0))}g=C,S=p[g>>2]|0,g=p[g+4>>2]|0,M=((m|0)<0)<<31>>31,(g|0)<(M|0)|(g|0)==(M|0)&S>>>0<m>>>0?(g=C,p[g>>2]=m,p[g+4>>2]=M,g=M):m=S,I=Xt(m|0,g|0,12,0)|0,V=te()|0,g=C,p[g>>2]=I,p[g+4>>2]=V,g=v,p[g>>2]=I,p[g+4>>2]=V,g=0}return V=g,Z=N,V|0}function rl(A,m,g,v,S,M,C){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0,C=C|0;var N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0,Kt=0,Et=0,Ln=0,xi=0,kn=0,wn=0,bs=0,C0=0;if(xi=Z,Z=Z+64|0,fn=xi+48|0,Kt=xi+32|0,Et=xi+24|0,Mt=xi+8|0,Yt=xi,I=p[A>>2]|0,(I|0)<=0)return Ln=0,Z=xi,Ln|0;for(yt=A+4|0,Wt=fn+8|0,tn=Kt+8|0,Yn=Mt+8|0,N=0,Le=0;;){V=p[yt>>2]|0,Be=V+(Le<<4)|0,p[fn>>2]=p[Be>>2],p[fn+4>>2]=p[Be+4>>2],p[fn+8>>2]=p[Be+8>>2],p[fn+12>>2]=p[Be+12>>2],(Le|0)==(I+-1|0)?(p[Kt>>2]=p[V>>2],p[Kt+4>>2]=p[V+4>>2],p[Kt+8>>2]=p[V+8>>2],p[Kt+12>>2]=p[V+12>>2]):(Be=V+(Le+1<<4)|0,p[Kt>>2]=p[Be>>2],p[Kt+4>>2]=p[Be+4>>2],p[Kt+8>>2]=p[Be+8>>2],p[Kt+12>>2]=p[Be+12>>2]),I=T2(fn,Kt,v,Et)|0;e:do if(I)V=0,N=I;else if(I=Et,V=p[I>>2]|0,I=p[I+4>>2]|0,(I|0)>0|(I|0)==0&V>>>0>0){Ve=0,Be=0;t:for(;;){if(wn=1/(+(V>>>0)+4294967296*+(I|0)),C0=+J[fn>>3],I=ns(V|0,I|0,Ve|0,Be|0)|0,bs=+(I>>>0)+4294967296*+(te()|0),kn=+(Ve>>>0)+4294967296*+(Be|0),J[Mt>>3]=wn*(C0*bs)+wn*(+J[Kt>>3]*kn),J[Yn>>3]=wn*(+J[Wt>>3]*bs)+wn*(+J[tn>>3]*kn),I=Ig(Mt,v,Yt)|0,I|0){N=I;break}Ne=Yt,Te=p[Ne>>2]|0,Ne=p[Ne+4>>2]|0,ge=zc(Te|0,Ne|0,m|0,g|0)|0,j=te()|0,I=C+(ge<<3)|0,oe=I,V=p[oe>>2]|0,oe=p[oe+4>>2]|0;n:do if((V|0)==0&(oe|0)==0)Ee=I,Ln=16;else for(de=0,Ae=0;;){if((de|0)>(g|0)|(de|0)==(g|0)&Ae>>>0>m>>>0){N=1;break t}if((V|0)==(Te|0)&(oe|0)==(Ne|0))break n;if(I=Xt(ge|0,j|0,1,0)|0,ge=rf(I|0,te()|0,m|0,g|0)|0,j=te()|0,Ae=Xt(Ae|0,de|0,1,0)|0,de=te()|0,I=C+(ge<<3)|0,oe=I,V=p[oe>>2]|0,oe=p[oe+4>>2]|0,(V|0)==0&(oe|0)==0){Ee=I,Ln=16;break}}while(!1);if((Ln|0)==16&&(Ln=0,!((Te|0)==0&(Ne|0)==0))&&(Ae=Ee,p[Ae>>2]=Te,p[Ae+4>>2]=Ne,Ae=M+(p[S>>2]<<3)|0,p[Ae>>2]=Te,p[Ae+4>>2]=Ne,Ae=S,Ae=Xt(p[Ae>>2]|0,p[Ae+4>>2]|0,1,0)|0,Te=te()|0,Ne=S,p[Ne>>2]=Ae,p[Ne+4>>2]=Te),Ve=Xt(Ve|0,Be|0,1,0)|0,Be=te()|0,I=Et,V=p[I>>2]|0,I=p[I+4>>2]|0,!((I|0)>(Be|0)|(I|0)==(Be|0)&V>>>0>Ve>>>0)){V=1;break e}}V=0}else V=1;while(!1);if(Le=Le+1|0,!V){Ln=21;break}if(I=p[A>>2]|0,(Le|0)>=(I|0)){N=0,Ln=21;break}}return(Ln|0)==21?(Z=xi,N|0):0}function x2(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0,Kt=0,Et=0,Ln=0,xi=0,kn=0,wn=0,bs=0;if(bs=Z,Z=Z+112|0,Ln=bs+80|0,I=bs+72|0,xi=bs,kn=bs+56|0,S=Ls(g)|0,S|0)return wn=S,Z=bs,wn|0;if(V=A+8|0,wn=hl((p[V>>2]<<5)+32|0)|0,!wn)return wn=13,Z=bs,wn|0;if(Hl(A,wn),S=Ls(g)|0,!S){if(Kt=A,Et=p[Kt+4>>2]|0,S=I,p[S>>2]=p[Kt>>2],p[S+4>>2]=Et,Do(I,Ln),S=Ed(Ln,m,xi)|0,S)Kt=0,Et=0;else{if(S=p[I>>2]|0,M=p[V>>2]|0,(M|0)>0){C=p[A+12>>2]|0,g=0;do S=(p[C+(g<<3)>>2]|0)+S|0,g=g+1|0;while((g|0)!=(M|0));g=S}else g=S;S=xi,M=p[S>>2]|0,S=p[S+4>>2]|0,C=((g|0)<0)<<31>>31,(S|0)<(C|0)|(S|0)==(C|0)&M>>>0<g>>>0?(S=xi,p[S>>2]=g,p[S+4>>2]=C,S=C):g=M,Kt=Xt(g|0,S|0,12,0)|0,Et=te()|0,S=xi,p[S>>2]=Kt,p[S+4>>2]=Et,S=0}if(!S){if(g=Ko(Kt,8)|0,!g)return xn(wn),wn=13,Z=bs,wn|0;if(N=Ko(Kt,8)|0,!N)return xn(wn),xn(g),wn=13,Z=bs,wn|0;Yn=Ln,p[Yn>>2]=0,p[Yn+4>>2]=0,Yn=A,fn=p[Yn+4>>2]|0,S=I,p[S>>2]=p[Yn>>2],p[S+4>>2]=fn,S=rl(I,Kt,Et,m,Ln,g,N)|0;e:do if(S)xn(g),xn(N),xn(wn);else{t:do if((p[V>>2]|0)>0){for(C=A+12|0,M=0;S=rl((p[C>>2]|0)+(M<<3)|0,Kt,Et,m,Ln,g,N)|0,M=M+1|0,!(S|0);)if((M|0)>=(p[V>>2]|0))break t;xn(g),xn(N),xn(wn);break e}while(!1);(Et|0)>0|(Et|0)==0&Kt>>>0>0&&dl(N|0,0,Kt<<3|0)|0,fn=Ln,Yn=p[fn+4>>2]|0;t:do if((Yn|0)>0|(Yn|0)==0&(p[fn>>2]|0)>>>0>0){yt=g,Wt=N,tn=g,Yn=N,fn=g,S=g,Ee=g,Mt=N,Yt=N,g=N;n:for(;;){for(Ne=0,Ve=0,Be=0,Le=0,M=0,C=0;;){N=xi,I=N+56|0;do p[N>>2]=0,N=N+4|0;while((N|0)<(I|0));if(m=yt+(Ne<<3)|0,V=p[m>>2]|0,m=p[m+4>>2]|0,ji(V,m,1,xi,0)|0){N=xi,I=N+56|0;do p[N>>2]=0,N=N+4|0;while((N|0)<(I|0));N=Ko(7,4)|0,N|0&&(yr(V,m,1,xi,N,7,0,0)|0,xn(N))}for(Te=0;;){Ae=xi+(Te<<3)|0,de=p[Ae>>2]|0,Ae=p[Ae+4>>2]|0;i:do if((de|0)==0&(Ae|0)==0)N=M,I=C;else{if(j=zc(de|0,Ae|0,Kt|0,Et|0)|0,V=te()|0,N=v+(j<<3)|0,m=N,I=p[m>>2]|0,m=p[m+4>>2]|0,!((I|0)==0&(m|0)==0)){oe=0,ge=0;do{if((oe|0)>(Et|0)|(oe|0)==(Et|0)&ge>>>0>Kt>>>0)break n;if((I|0)==(de|0)&(m|0)==(Ae|0)){N=M,I=C;break i}N=Xt(j|0,V|0,1,0)|0,j=rf(N|0,te()|0,Kt|0,Et|0)|0,V=te()|0,ge=Xt(ge|0,oe|0,1,0)|0,oe=te()|0,N=v+(j<<3)|0,m=N,I=p[m>>2]|0,m=p[m+4>>2]|0}while(!((I|0)==0&(m|0)==0))}if((de|0)==0&(Ae|0)==0){N=M,I=C;break}Eu(de,Ae,kn)|0,Na(A,wn,kn)|0&&(ge=Xt(M|0,C|0,1,0)|0,C=te()|0,oe=N,p[oe>>2]=de,p[oe+4>>2]=Ae,M=Wt+(M<<3)|0,p[M>>2]=de,p[M+4>>2]=Ae,M=ge),N=M,I=C}while(!1);if(Te=Te+1|0,Te>>>0>=7)break;M=N,C=I}if(Ne=Xt(Ne|0,Ve|0,1,0)|0,Ve=te()|0,Be=Xt(Be|0,Le|0,1,0)|0,Le=te()|0,C=Ln,M=p[C>>2]|0,C=p[C+4>>2]|0,(Le|0)<(C|0)|(Le|0)==(C|0)&Be>>>0<M>>>0)M=N,C=I;else break}if((C|0)>0|(C|0)==0&M>>>0>0){M=0,C=0;do Le=yt+(M<<3)|0,p[Le>>2]=0,p[Le+4>>2]=0,M=Xt(M|0,C|0,1,0)|0,C=te()|0,Le=Ln,Be=p[Le+4>>2]|0;while((C|0)<(Be|0)|((C|0)==(Be|0)?M>>>0<(p[Le>>2]|0)>>>0:0))}if(Le=Ln,p[Le>>2]=N,p[Le+4>>2]=I,(I|0)>0|(I|0)==0&N>>>0>0)Te=g,Ne=Yt,Ve=fn,Be=Mt,Le=Wt,g=Ee,Yt=S,Mt=tn,Ee=Te,S=Ne,fn=Yn,Yn=Ve,tn=Be,Wt=yt,yt=Le;else break t}xn(tn),xn(Yn),xn(wn),S=1;break e}else S=N;while(!1);xn(wn),xn(g),xn(S),S=0}while(!1);return wn=S,Z=bs,wn|0}}return xn(wn),wn=S,Z=bs,wn|0}function b2(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(j=Z,Z=Z+176|0,I=j,(m|0)<1)return cl(g,0,0),V=0,Z=j,V|0;for(N=A,N=gt(p[N>>2]|0,p[N+4>>2]|0,52)|0,te()|0,cl(g,(m|0)>6?m:6,N&15),N=0;v=A+(N<<3)|0,v=Pc(p[v>>2]|0,p[v+4>>2]|0,I)|0,!(v|0);){if(v=p[I>>2]|0,(v|0)>0){C=0;do M=I+8+(C<<4)|0,C=C+1|0,v=I+8+(((C|0)%(v|0)|0)<<4)|0,S=kc(g,v,M)|0,S?ef(g,S)|0:E0(g,M,v)|0,v=p[I>>2]|0;while((C|0)<(v|0))}if(N=N+1|0,(N|0)>=(m|0)){v=0,V=13;break}}return(V|0)==13?(Z=j,v|0):(S0(g),V=v,Z=j,V|0)}function vg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;if(M=Z,Z=Z+32|0,v=M,S=M+16|0,A=b2(A,m,S)|0,A|0)return g=A,Z=M,g|0;if(p[g>>2]=0,p[g+4>>2]=0,p[g+8>>2]=0,A=T0(S)|0,A|0)do{m=y0(g)|0;do v0(m,A)|0,C=A+16|0,p[v>>2]=p[C>>2],p[v+4>>2]=p[C+4>>2],p[v+8>>2]=p[C+8>>2],p[v+12>>2]=p[C+12>>2],ef(S,A)|0,A=Os(S,v)|0;while((A|0)!=0);A=T0(S)|0}while((A|0)!=0);return S0(S),A=Kh(g)|0,A?(x0(g),C=A,Z=M,C|0):(C=0,Z=M,C|0)}function dr(A){return A=A|0,A>>>0>121?(A=0,A|0):(A=p[7696+(A*28|0)+16>>2]|0,A|0)}function xg(A){return A=A|0,(A|0)==4|(A|0)==117|0}function yd(A){return A=A|0,p[11120+((p[A>>2]|0)*216|0)+((p[A+4>>2]|0)*72|0)+((p[A+8>>2]|0)*24|0)+(p[A+12>>2]<<3)>>2]|0}function bg(A){return A=A|0,p[11120+((p[A>>2]|0)*216|0)+((p[A+4>>2]|0)*72|0)+((p[A+8>>2]|0)*24|0)+(p[A+12>>2]<<3)+4>>2]|0}function Sg(A,m){A=A|0,m=m|0,A=7696+(A*28|0)|0,p[m>>2]=p[A>>2],p[m+4>>2]=p[A+4>>2],p[m+8>>2]=p[A+8>>2],p[m+12>>2]=p[A+12>>2]}function Hh(A,m){A=A|0,m=m|0;var g=0,v=0;if(m>>>0>20)return m=-1,m|0;do if((p[11120+(m*216|0)>>2]|0)!=(A|0))if((p[11120+(m*216|0)+8>>2]|0)!=(A|0))if((p[11120+(m*216|0)+16>>2]|0)!=(A|0))if((p[11120+(m*216|0)+24>>2]|0)!=(A|0))if((p[11120+(m*216|0)+32>>2]|0)!=(A|0))if((p[11120+(m*216|0)+40>>2]|0)!=(A|0))if((p[11120+(m*216|0)+48>>2]|0)!=(A|0))if((p[11120+(m*216|0)+56>>2]|0)!=(A|0))if((p[11120+(m*216|0)+64>>2]|0)!=(A|0))if((p[11120+(m*216|0)+72>>2]|0)!=(A|0))if((p[11120+(m*216|0)+80>>2]|0)!=(A|0))if((p[11120+(m*216|0)+88>>2]|0)!=(A|0))if((p[11120+(m*216|0)+96>>2]|0)!=(A|0))if((p[11120+(m*216|0)+104>>2]|0)!=(A|0))if((p[11120+(m*216|0)+112>>2]|0)!=(A|0))if((p[11120+(m*216|0)+120>>2]|0)!=(A|0))if((p[11120+(m*216|0)+128>>2]|0)!=(A|0))if((p[11120+(m*216|0)+136>>2]|0)==(A|0))A=2,g=1,v=2;else{if((p[11120+(m*216|0)+144>>2]|0)==(A|0)){A=0,g=2,v=0;break}if((p[11120+(m*216|0)+152>>2]|0)==(A|0)){A=0,g=2,v=1;break}if((p[11120+(m*216|0)+160>>2]|0)==(A|0)){A=0,g=2,v=2;break}if((p[11120+(m*216|0)+168>>2]|0)==(A|0)){A=1,g=2,v=0;break}if((p[11120+(m*216|0)+176>>2]|0)==(A|0)){A=1,g=2,v=1;break}if((p[11120+(m*216|0)+184>>2]|0)==(A|0)){A=1,g=2,v=2;break}if((p[11120+(m*216|0)+192>>2]|0)==(A|0)){A=2,g=2,v=0;break}if((p[11120+(m*216|0)+200>>2]|0)==(A|0)){A=2,g=2,v=1;break}if((p[11120+(m*216|0)+208>>2]|0)==(A|0)){A=2,g=2,v=2;break}else A=-1;return A|0}else A=2,g=1,v=1;else A=2,g=1,v=0;else A=1,g=1,v=2;else A=1,g=1,v=1;else A=1,g=1,v=0;else A=0,g=1,v=2;else A=0,g=1,v=1;else A=0,g=1,v=0;else A=2,g=0,v=2;else A=2,g=0,v=1;else A=2,g=0,v=0;else A=1,g=0,v=2;else A=1,g=0,v=1;else A=1,g=0,v=0;else A=0,g=0,v=2;else A=0,g=0,v=1;else A=0,g=0,v=0;while(!1);return m=p[11120+(m*216|0)+(g*72|0)+(A*24|0)+(v<<3)+4>>2]|0,m|0}function Tc(A,m){return A=A|0,m=m|0,(p[7696+(A*28|0)+20>>2]|0)==(m|0)?(m=1,m|0):(m=(p[7696+(A*28|0)+24>>2]|0)==(m|0),m|0)}function o0(A,m){return A=A|0,m=m|0,p[848+(A*28|0)+(m<<2)>>2]|0}function vd(A,m){return A=A|0,m=m|0,(p[848+(A*28|0)>>2]|0)==(m|0)?(m=0,m|0):(p[848+(A*28|0)+4>>2]|0)==(m|0)?(m=1,m|0):(p[848+(A*28|0)+8>>2]|0)==(m|0)?(m=2,m|0):(p[848+(A*28|0)+12>>2]|0)==(m|0)?(m=3,m|0):(p[848+(A*28|0)+16>>2]|0)==(m|0)?(m=4,m|0):(p[848+(A*28|0)+20>>2]|0)==(m|0)?(m=5,m|0):((p[848+(A*28|0)+24>>2]|0)==(m|0)?6:7)|0}function S2(){return 122}function xd(A){A=A|0;var m=0,g=0,v=0;m=0;do wt(m|0,0,45)|0,v=te()|0|134225919,g=A+(m<<3)|0,p[g>>2]=-1,p[g+4>>2]=v,m=m+1|0;while((m|0)!=122);return 0}function Gl(A){A=A|0;var m=0,g=0,v=0;return v=+J[A+16>>3],g=+J[A+24>>3],m=v-g,+(v<g?m+6.283185307179586:m)}function a0(A){return A=A|0,+J[A+16>>3]<+J[A+24>>3]|0}function bd(A){return A=A|0,+(+J[A>>3]-+J[A+8>>3])}function sl(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;return g=+J[m>>3],!(g>=+J[A+8>>3])||!(g<=+J[A>>3])?(m=0,m|0):(v=+J[A+16>>3],g=+J[A+24>>3],S=+J[m+8>>3],m=S>=g,A=S<=v&1,v<g?m&&(A=1):m||(A=0),m=(A|0)!=0,m|0)}function Sd(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;return+J[A>>3]<+J[m+8>>3]||+J[A+8>>3]>+J[m>>3]?(v=0,v|0):(M=+J[A+16>>3],g=A+24|0,j=+J[g>>3],C=M<j,v=m+16|0,V=+J[v>>3],S=m+24|0,I=+J[S>>3],N=V<I,m=j-V<I-M,A=C?N|m?1:2:0,m=N?C?1:m?2:1:0,M=+Ks(M,A),M<+Ks(+J[S>>3],m)||(j=+Ks(+J[g>>3],A),j>+Ks(+J[v>>3],m))?(N=0,N|0):(N=1,N|0))}function l0(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0;M=+J[A+16>>3],I=+J[A+24>>3],A=M<I,N=+J[m+16>>3],C=+J[m+24>>3],S=N<C,m=I-N<C-M,p[g>>2]=A?S|m?1:2:0,p[v>>2]=S?A?1:m?2:1:0}function Tg(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;return+J[A>>3]<+J[m>>3]||+J[A+8>>3]>+J[m+8>>3]?(v=0,v|0):(v=A+16|0,I=+J[v>>3],M=+J[A+24>>3],C=I<M,g=m+16|0,j=+J[g>>3],S=m+24|0,V=+J[S>>3],N=j<V,m=M-j<V-I,A=C?N|m?1:2:0,m=N?C?1:m?2:1:0,M=+Ks(M,A),M<=+Ks(+J[S>>3],m)?(j=+Ks(+J[v>>3],A),N=j>=+Ks(+J[g>>3],m),N|0):(N=0,N|0))}function Td(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0;S=Z,Z=Z+176|0,v=S,p[v>>2]=4,N=+J[m>>3],J[v+8>>3]=N,M=+J[m+16>>3],J[v+16>>3]=M,J[v+24>>3]=N,N=+J[m+24>>3],J[v+32>>3]=N,C=+J[m+8>>3],J[v+40>>3]=C,J[v+48>>3]=N,J[v+56>>3]=C,J[v+64>>3]=M,m=v+72|0,g=m+96|0;do p[m>>2]=0,m=m+4|0;while((m|0)<(g|0));Vc(A|0,v|0,168)|0,Z=S}function Ed(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0;Ae=Z,Z=Z+288|0,j=Ae+264|0,oe=Ae+96|0,V=Ae,N=V,I=N+96|0;do p[N>>2]=0,N=N+4|0;while((N|0)<(I|0));return m=Fg(m,V)|0,m|0?(de=m,Z=Ae,de|0):(I=V,V=p[I>>2]|0,I=p[I+4>>2]|0,Eu(V,I,j)|0,Pc(V,I,oe)|0,C=+Ra(j,oe+8|0),J[j>>3]=+J[A>>3],I=j+8|0,J[I>>3]=+J[A+16>>3],J[oe>>3]=+J[A+8>>3],V=oe+8|0,J[V>>3]=+J[A+24>>3],S=+Ra(j,oe),Ne=+J[I>>3]-+J[V>>3],M=+Tn(+Ne),Te=+J[j>>3]-+J[oe>>3],v=+Tn(+Te),!(Ne==0|Te==0)&&(Ne=+Dd(+M,+v),Ne=+je(+(S*S/+Pd(+(Ne/+Pd(+M,+v)),3)/(C*(C*2.59807621135)*.8))),J[ti>>3]=Ne,ge=~~Ne>>>0,de=+Tn(Ne)>=1?Ne>0?~~+Ie(+hr(Ne/4294967296),4294967295)>>>0:~~+je((Ne-+(~~Ne>>>0))/4294967296)>>>0:0,(p[ti+4>>2]&2146435072|0)!=2146435072)?(oe=(ge|0)==0&(de|0)==0,m=g,p[m>>2]=oe?1:ge,p[m+4>>2]=oe?0:de,m=0):m=1,de=m,Z=Ae,de|0)}function T2(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0;V=Z,Z=Z+288|0,C=V+264|0,N=V+96|0,I=V,S=I,M=S+96|0;do p[S>>2]=0,S=S+4|0;while((S|0)<(M|0));return g=Fg(g,I)|0,g|0?(v=g,Z=V,v|0):(g=I,S=p[g>>2]|0,g=p[g+4>>2]|0,Eu(S,g,C)|0,Pc(S,g,N)|0,j=+Ra(C,N+8|0),j=+je(+(+Ra(A,m)/(j*2))),J[ti>>3]=j,g=~~j>>>0,S=+Tn(j)>=1?j>0?~~+Ie(+hr(j/4294967296),4294967295)>>>0:~~+je((j-+(~~j>>>0))/4294967296)>>>0:0,(p[ti+4>>2]&2146435072|0)==2146435072?(v=1,Z=V,v|0):(I=(g|0)==0&(S|0)==0,p[v>>2]=I?1:g,p[v+4>>2]=I?0:S,v=0,Z=V,v|0))}function fo(A,m){A=A|0,m=+m;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;M=A+16|0,C=+J[M>>3],g=A+24|0,S=+J[g>>3],v=C-S,v=C<S?v+6.283185307179586:v,V=+J[A>>3],N=A+8|0,I=+J[N>>3],j=V-I,v=(v*m-v)*.5,m=(j*m-j)*.5,V=V+m,J[A>>3]=V>1.5707963267948966?1.5707963267948966:V,m=I-m,J[N>>3]=m<-1.5707963267948966?-1.5707963267948966:m,m=C+v,m=m>3.141592653589793?m+-6.283185307179586:m,J[M>>3]=m<-3.141592653589793?m+6.283185307179586:m,m=S-v,m=m>3.141592653589793?m+-6.283185307179586:m,J[g>>3]=m<-3.141592653589793?m+6.283185307179586:m}function Ec(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0,p[A>>2]=m,p[A+4>>2]=g,p[A+8>>2]=v}function u0(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0;oe=m+8|0,p[oe>>2]=0,I=+J[A>>3],C=+Tn(+I),V=+J[A+8>>3],N=+Tn(+V)*1.1547005383792515,C=C+N*.5,g=~~C,A=~~N,C=C-+(g|0),N=N-+(A|0);do if(C<.5)if(C<.3333333333333333)if(p[m>>2]=g,N<(C+1)*.5){p[m+4>>2]=A;break}else{A=A+1|0,p[m+4>>2]=A;break}else if(ge=1-C,A=(!(N<ge)&1)+A|0,p[m+4>>2]=A,ge<=N&N<C*2){g=g+1|0,p[m>>2]=g;break}else{p[m>>2]=g;break}else{if(!(C<.6666666666666666))if(g=g+1|0,p[m>>2]=g,N<C*.5){p[m+4>>2]=A;break}else{A=A+1|0,p[m+4>>2]=A;break}if(N<1-C){if(p[m+4>>2]=A,C*2+-1<N){p[m>>2]=g;break}}else A=A+1|0,p[m+4>>2]=A;g=g+1|0,p[m>>2]=g}while(!1);do if(I<0)if(A&1){j=(A+1|0)/2|0,j=ns(g|0,((g|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0,g=~~(+(g|0)-((+(j>>>0)+4294967296*+(te()|0))*2+1)),p[m>>2]=g;break}else{j=(A|0)/2|0,j=ns(g|0,((g|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0,g=~~(+(g|0)-(+(j>>>0)+4294967296*+(te()|0))*2),p[m>>2]=g;break}while(!1);j=m+4|0,V<0&&(g=g-((A<<1|1|0)/2|0)|0,p[m>>2]=g,A=0-A|0,p[j>>2]=A),v=A-g|0,(g|0)<0?(S=0-g|0,p[j>>2]=v,p[oe>>2]=S,p[m>>2]=0,A=v,g=0):S=0,(A|0)<0&&(g=g-A|0,p[m>>2]=g,S=S-A|0,p[oe>>2]=S,p[j>>2]=0,A=0),M=g-S|0,v=A-S|0,(S|0)<0&&(p[m>>2]=M,p[j>>2]=v,p[oe>>2]=0,A=v,g=M,S=0),v=(A|0)<(g|0)?A:g,v=(S|0)<(v|0)?S:v,!((v|0)<=0)&&(p[m>>2]=g-v,p[j>>2]=A-v,p[oe>>2]=S-v)}function jr(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0;m=p[A>>2]|0,C=A+4|0,g=p[C>>2]|0,(m|0)<0&&(g=g-m|0,p[C>>2]=g,M=A+8|0,p[M>>2]=(p[M>>2]|0)-m,p[A>>2]=0,m=0),(g|0)<0?(m=m-g|0,p[A>>2]=m,M=A+8|0,S=(p[M>>2]|0)-g|0,p[M>>2]=S,p[C>>2]=0,g=0):(S=A+8|0,M=S,S=p[S>>2]|0),(S|0)<0&&(m=m-S|0,p[A>>2]=m,g=g-S|0,p[C>>2]=g,p[M>>2]=0,S=0),v=(g|0)<(m|0)?g:m,v=(S|0)<(v|0)?S:v,!((v|0)<=0)&&(p[A>>2]=m-v,p[C>>2]=g-v,p[M>>2]=S-v)}function wc(A,m){A=A|0,m=m|0;var g=0,v=0;v=p[A+8>>2]|0,g=+((p[A+4>>2]|0)-v|0),J[m>>3]=+((p[A>>2]|0)-v|0)-g*.5,J[m+8>>3]=g*.8660254037844386}function xs(A,m,g){A=A|0,m=m|0,g=g|0,p[g>>2]=(p[m>>2]|0)+(p[A>>2]|0),p[g+4>>2]=(p[m+4>>2]|0)+(p[A+4>>2]|0),p[g+8>>2]=(p[m+8>>2]|0)+(p[A+8>>2]|0)}function wd(A,m,g){A=A|0,m=m|0,g=g|0,p[g>>2]=(p[A>>2]|0)-(p[m>>2]|0),p[g+4>>2]=(p[A+4>>2]|0)-(p[m+4>>2]|0),p[g+8>>2]=(p[A+8>>2]|0)-(p[m+8>>2]|0)}function Wh(A,m){A=A|0,m=m|0;var g=0,v=0;g=He(p[A>>2]|0,m)|0,p[A>>2]=g,g=A+4|0,v=He(p[g>>2]|0,m)|0,p[g>>2]=v,A=A+8|0,m=He(p[A>>2]|0,m)|0,p[A>>2]=m}function Mc(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;C=p[A>>2]|0,N=(C|0)<0,v=(p[A+4>>2]|0)-(N?C:0)|0,M=(v|0)<0,S=(M?0-v|0:0)+((p[A+8>>2]|0)-(N?C:0))|0,g=(S|0)<0,A=g?0:S,m=(M?0:v)-(g?S:0)|0,S=(N?0:C)-(M?v:0)-(g?S:0)|0,g=(m|0)<(S|0)?m:S,g=(A|0)<(g|0)?A:g,v=(g|0)>0,A=A-(v?g:0)|0,m=m-(v?g:0)|0;e:do switch(S-(v?g:0)|0){case 0:switch(m|0){case 0:return N=(A|0)==0?0:(A|0)==1?1:7,N|0;case 1:return N=(A|0)==0?2:(A|0)==1?3:7,N|0;default:break e}case 1:switch(m|0){case 0:return N=(A|0)==0?4:(A|0)==1?5:7,N|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(!1);return N=7,N|0}function E2(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0;if(I=A+8|0,C=p[I>>2]|0,N=(p[A>>2]|0)-C|0,V=A+4|0,C=(p[V>>2]|0)-C|0,N>>>0>715827881|C>>>0>715827881){if(v=(N|0)>0,S=2147483647-N|0,M=-2147483648-N|0,(v?(S|0)<(N|0):(M|0)>(N|0))||(g=N<<1,v?(2147483647-g|0)<(N|0):(-2147483648-g|0)>(N|0))||((C|0)>0?(2147483647-C|0)<(C|0):(-2147483648-C|0)>(C|0))||(m=N*3|0,g=C<<1,(v?(S|0)<(g|0):(M|0)>(g|0))||((N|0)>-1?(m|-2147483648|0)>=(C|0):(m^-2147483648|0)<(C|0))))return V=1,V|0}else g=C<<1,m=N*3|0;return v=Xl(+(m-C|0)*.14285714285714285)|0,p[A>>2]=v,S=Xl(+(g+N|0)*.14285714285714285)|0,p[V>>2]=S,p[I>>2]=0,g=(S|0)<(v|0),m=g?v:S,g=g?S:v,(g|0)<0&&(((g|0)==-2147483648||((m|0)>0?(2147483647-m|0)<(g|0):(-2147483648-m|0)>(g|0)))&&Rt(27795,26892,354,26903),((m|0)>-1?(m|-2147483648|0)>=(g|0):(m^-2147483648|0)<(g|0))&&Rt(27795,26892,354,26903)),m=S-v|0,(v|0)<0?(g=0-v|0,p[V>>2]=m,p[I>>2]=g,p[A>>2]=0,v=0):(m=S,g=0),(m|0)<0&&(v=v-m|0,p[A>>2]=v,g=g-m|0,p[I>>2]=g,p[V>>2]=0,m=0),M=v-g|0,S=m-g|0,(g|0)<0?(p[A>>2]=M,p[V>>2]=S,p[I>>2]=0,m=S,S=M,g=0):S=v,v=(m|0)<(S|0)?m:S,v=(g|0)<(v|0)?g:v,(v|0)<=0?(V=0,V|0):(p[A>>2]=S-v,p[V>>2]=m-v,p[I>>2]=g-v,V=0,V|0)}function M3(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0;if(C=A+8|0,S=p[C>>2]|0,M=(p[A>>2]|0)-S|0,N=A+4|0,S=(p[N>>2]|0)-S|0,M>>>0>715827881|S>>>0>715827881){if(g=(M|0)>0,(g?(2147483647-M|0)<(M|0):(-2147483648-M|0)>(M|0))||(m=M<<1,v=(S|0)>0,v?(2147483647-S|0)<(S|0):(-2147483648-S|0)>(S|0)))return N=1,N|0;if(I=S<<1,(v?(2147483647-I|0)<(S|0):(-2147483648-I|0)>(S|0))||(g?(2147483647-m|0)<(S|0):(-2147483648-m|0)>(S|0))||(g=S*3|0,(S|0)>-1?(g|-2147483648|0)>=(M|0):(g^-2147483648|0)<(M|0)))return I=1,I|0}else g=S*3|0,m=M<<1;return v=Xl(+(m+S|0)*.14285714285714285)|0,p[A>>2]=v,S=Xl(+(g-M|0)*.14285714285714285)|0,p[N>>2]=S,p[C>>2]=0,g=(S|0)<(v|0),m=g?v:S,g=g?S:v,(g|0)<0&&(((g|0)==-2147483648||((m|0)>0?(2147483647-m|0)<(g|0):(-2147483648-m|0)>(g|0)))&&Rt(27795,26892,402,26917),((m|0)>-1?(m|-2147483648|0)>=(g|0):(m^-2147483648|0)<(g|0))&&Rt(27795,26892,402,26917)),m=S-v|0,(v|0)<0?(g=0-v|0,p[N>>2]=m,p[C>>2]=g,p[A>>2]=0,v=0):(m=S,g=0),(m|0)<0&&(v=v-m|0,p[A>>2]=v,g=g-m|0,p[C>>2]=g,p[N>>2]=0,m=0),M=v-g|0,S=m-g|0,(g|0)<0?(p[A>>2]=M,p[N>>2]=S,p[C>>2]=0,m=S,S=M,g=0):S=v,v=(m|0)<(S|0)?m:S,v=(g|0)<(v|0)?g:v,(v|0)<=0?(I=0,I|0):(p[A>>2]=S-v,p[N>>2]=m-v,p[C>>2]=g-v,I=0,I|0)}function R3(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;C=A+8|0,g=p[C>>2]|0,m=(p[A>>2]|0)-g|0,N=A+4|0,g=(p[N>>2]|0)-g|0,v=Xl(+((m*3|0)-g|0)*.14285714285714285)|0,p[A>>2]=v,m=Xl(+((g<<1)+m|0)*.14285714285714285)|0,p[N>>2]=m,p[C>>2]=0,g=m-v|0,(v|0)<0?(M=0-v|0,p[N>>2]=g,p[C>>2]=M,p[A>>2]=0,m=g,v=0,g=M):g=0,(m|0)<0&&(v=v-m|0,p[A>>2]=v,g=g-m|0,p[C>>2]=g,p[N>>2]=0,m=0),M=v-g|0,S=m-g|0,(g|0)<0?(p[A>>2]=M,p[N>>2]=S,p[C>>2]=0,m=S,S=M,g=0):S=v,v=(m|0)<(S|0)?m:S,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(p[A>>2]=S-v,p[N>>2]=m-v,p[C>>2]=g-v)}function w2(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;C=A+8|0,g=p[C>>2]|0,m=(p[A>>2]|0)-g|0,N=A+4|0,g=(p[N>>2]|0)-g|0,v=Xl(+((m<<1)+g|0)*.14285714285714285)|0,p[A>>2]=v,m=Xl(+((g*3|0)-m|0)*.14285714285714285)|0,p[N>>2]=m,p[C>>2]=0,g=m-v|0,(v|0)<0?(M=0-v|0,p[N>>2]=g,p[C>>2]=M,p[A>>2]=0,m=g,v=0,g=M):g=0,(m|0)<0&&(v=v-m|0,p[A>>2]=v,g=g-m|0,p[C>>2]=g,p[N>>2]=0,m=0),M=v-g|0,S=m-g|0,(g|0)<0?(p[A>>2]=M,p[N>>2]=S,p[C>>2]=0,m=S,S=M,g=0):S=v,v=(m|0)<(S|0)?m:S,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(p[A>>2]=S-v,p[N>>2]=m-v,p[C>>2]=g-v)}function jh(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;m=p[A>>2]|0,C=A+4|0,g=p[C>>2]|0,N=A+8|0,v=p[N>>2]|0,S=g+(m*3|0)|0,p[A>>2]=S,g=v+(g*3|0)|0,p[C>>2]=g,m=(v*3|0)+m|0,p[N>>2]=m,v=g-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=v,p[N>>2]=m,p[A>>2]=0,g=v,v=0):v=S,(g|0)<0&&(v=v-g|0,p[A>>2]=v,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=v-m|0,S=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=S,p[N>>2]=0,v=M,m=0):S=g,g=(S|0)<(v|0)?S:v,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=v-g,p[C>>2]=S-g,p[N>>2]=m-g)}function Rc(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;S=p[A>>2]|0,C=A+4|0,m=p[C>>2]|0,N=A+8|0,g=p[N>>2]|0,v=(m*3|0)+S|0,S=g+(S*3|0)|0,p[A>>2]=S,p[C>>2]=v,m=(g*3|0)+m|0,p[N>>2]=m,g=v-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=g,p[N>>2]=m,p[A>>2]=0,S=0):g=v,(g|0)<0&&(S=S-g|0,p[A>>2]=S,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=S-m|0,v=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=v,p[N>>2]=0,S=M,m=0):v=g,g=(v|0)<(S|0)?v:S,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=S-g,p[C>>2]=v-g,p[N>>2]=m-g)}function M2(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0;(m+-1|0)>>>0>=6||(S=(p[15440+(m*12|0)>>2]|0)+(p[A>>2]|0)|0,p[A>>2]=S,N=A+4|0,v=(p[15440+(m*12|0)+4>>2]|0)+(p[N>>2]|0)|0,p[N>>2]=v,C=A+8|0,m=(p[15440+(m*12|0)+8>>2]|0)+(p[C>>2]|0)|0,p[C>>2]=m,g=v-S|0,(S|0)<0?(m=m-S|0,p[N>>2]=g,p[C>>2]=m,p[A>>2]=0,v=0):(g=v,v=S),(g|0)<0&&(v=v-g|0,p[A>>2]=v,m=m-g|0,p[C>>2]=m,p[N>>2]=0,g=0),M=v-m|0,S=g-m|0,(m|0)<0?(p[A>>2]=M,p[N>>2]=S,p[C>>2]=0,v=M,m=0):S=g,g=(S|0)<(v|0)?S:v,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=v-g,p[N>>2]=S-g,p[C>>2]=m-g))}function R2(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;S=p[A>>2]|0,C=A+4|0,m=p[C>>2]|0,N=A+8|0,g=p[N>>2]|0,v=m+S|0,S=g+S|0,p[A>>2]=S,p[C>>2]=v,m=g+m|0,p[N>>2]=m,g=v-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=g,p[N>>2]=m,p[A>>2]=0,v=0):(g=v,v=S),(g|0)<0&&(v=v-g|0,p[A>>2]=v,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=v-m|0,S=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=S,p[N>>2]=0,v=M,m=0):S=g,g=(S|0)<(v|0)?S:v,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=v-g,p[C>>2]=S-g,p[N>>2]=m-g)}function c0(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;m=p[A>>2]|0,C=A+4|0,v=p[C>>2]|0,N=A+8|0,g=p[N>>2]|0,S=v+m|0,p[A>>2]=S,v=g+v|0,p[C>>2]=v,m=g+m|0,p[N>>2]=m,g=v-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=g,p[N>>2]=m,p[A>>2]=0,v=0):(g=v,v=S),(g|0)<0&&(v=v-g|0,p[A>>2]=v,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=v-m|0,S=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=S,p[N>>2]=0,v=M,m=0):S=g,g=(S|0)<(v|0)?S:v,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=v-g,p[C>>2]=S-g,p[N>>2]=m-g)}function Cc(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function zl(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function C2(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;m=p[A>>2]|0,C=A+4|0,g=p[C>>2]|0,N=A+8|0,v=p[N>>2]|0,S=g+(m<<1)|0,p[A>>2]=S,g=v+(g<<1)|0,p[C>>2]=g,m=(v<<1)+m|0,p[N>>2]=m,v=g-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=v,p[N>>2]=m,p[A>>2]=0,g=v,v=0):v=S,(g|0)<0&&(v=v-g|0,p[A>>2]=v,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=v-m|0,S=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=S,p[N>>2]=0,v=M,m=0):S=g,g=(S|0)<(v|0)?S:v,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=v-g,p[C>>2]=S-g,p[N>>2]=m-g)}function N2(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;S=p[A>>2]|0,C=A+4|0,m=p[C>>2]|0,N=A+8|0,g=p[N>>2]|0,v=(m<<1)+S|0,S=g+(S<<1)|0,p[A>>2]=S,p[C>>2]=v,m=(g<<1)+m|0,p[N>>2]=m,g=v-S|0,(S|0)<0?(m=m-S|0,p[C>>2]=g,p[N>>2]=m,p[A>>2]=0,S=0):g=v,(g|0)<0&&(S=S-g|0,p[A>>2]=S,m=m-g|0,p[N>>2]=m,p[C>>2]=0,g=0),M=S-m|0,v=g-m|0,(m|0)<0?(p[A>>2]=M,p[C>>2]=v,p[N>>2]=0,S=M,m=0):v=g,g=(v|0)<(S|0)?v:S,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[A>>2]=S-g,p[C>>2]=v-g,p[N>>2]=m-g)}function Eg(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0;return C=(p[A>>2]|0)-(p[m>>2]|0)|0,N=(C|0)<0,v=(p[A+4>>2]|0)-(p[m+4>>2]|0)-(N?C:0)|0,M=(v|0)<0,S=(N?0-C|0:0)+(p[A+8>>2]|0)-(p[m+8>>2]|0)+(M?0-v|0:0)|0,A=(S|0)<0,m=A?0:S,g=(M?0:v)-(A?S:0)|0,S=(N?0:C)-(M?v:0)-(A?S:0)|0,A=(g|0)<(S|0)?g:S,A=(m|0)<(A|0)?m:A,v=(A|0)>0,m=m-(v?A:0)|0,g=g-(v?A:0)|0,A=S-(v?A:0)|0,A=(A|0)>-1?A:0-A|0,g=(g|0)>-1?g:0-g|0,m=(m|0)>-1?m:0-m|0,m=(g|0)>(m|0)?g:m,((A|0)>(m|0)?A:m)|0}function C3(A,m){A=A|0,m=m|0;var g=0;g=p[A+8>>2]|0,p[m>>2]=(p[A>>2]|0)-g,p[m+4>>2]=(p[A+4>>2]|0)-g}function wg(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0;return v=p[A>>2]|0,p[m>>2]=v,S=p[A+4>>2]|0,C=m+4|0,p[C>>2]=S,N=m+8|0,p[N>>2]=0,g=(S|0)<(v|0),A=g?v:S,g=g?S:v,(g|0)<0&&((g|0)==-2147483648||((A|0)>0?(2147483647-A|0)<(g|0):(-2147483648-A|0)>(g|0))||((A|0)>-1?(A|-2147483648|0)>=(g|0):(A^-2147483648|0)<(g|0)))?(m=1,m|0):(A=S-v|0,(v|0)<0?(g=0-v|0,p[C>>2]=A,p[N>>2]=g,p[m>>2]=0,v=0):(A=S,g=0),(A|0)<0&&(v=v-A|0,p[m>>2]=v,g=g-A|0,p[N>>2]=g,p[C>>2]=0,A=0),M=v-g|0,S=A-g|0,(g|0)<0?(p[m>>2]=M,p[C>>2]=S,p[N>>2]=0,A=S,S=M,g=0):S=v,v=(A|0)<(S|0)?A:S,v=(g|0)<(v|0)?g:v,(v|0)<=0?(m=0,m|0):(p[m>>2]=S-v,p[C>>2]=A-v,p[N>>2]=g-v,m=0,m|0))}function D2(A){A=A|0;var m=0,g=0,v=0,S=0;m=A+8|0,S=p[m>>2]|0,g=S-(p[A>>2]|0)|0,p[A>>2]=g,v=A+4|0,A=(p[v>>2]|0)-S|0,p[v>>2]=A,p[m>>2]=0-(A+g)}function N3(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;g=p[A>>2]|0,m=0-g|0,p[A>>2]=m,C=A+8|0,p[C>>2]=0,N=A+4|0,v=p[N>>2]|0,S=v+g|0,(g|0)>0?(p[N>>2]=S,p[C>>2]=g,p[A>>2]=0,m=0,v=S):g=0,(v|0)<0?(M=m-v|0,p[A>>2]=M,g=g-v|0,p[C>>2]=g,p[N>>2]=0,S=M-g|0,m=0-g|0,(g|0)<0?(p[A>>2]=S,p[N>>2]=m,p[C>>2]=0,v=m,g=0):(v=0,S=M)):S=m,m=(v|0)<(S|0)?v:S,m=(g|0)<(m|0)?g:m,!((m|0)<=0)&&(p[A>>2]=S-m,p[N>>2]=v-m,p[C>>2]=g-m)}function D3(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0;if(oe=Z,Z=Z+64|0,j=oe,N=oe+56|0,!(!0&(m&2013265920|0)==134217728&(!0&(v&2013265920|0)==134217728)))return S=5,Z=oe,S|0;if((A|0)==(g|0)&(m|0)==(v|0))return p[S>>2]=0,S=0,Z=oe,S|0;if(C=gt(A|0,m|0,52)|0,te()|0,C=C&15,V=gt(g|0,v|0,52)|0,te()|0,(C|0)!=(V&15|0))return S=12,Z=oe,S|0;if(M=C+-1|0,C>>>0>1){d0(A,m,M,j)|0,d0(g,v,M,N)|0,V=j,I=p[V>>2]|0,V=p[V+4>>2]|0;e:do if((I|0)==(p[N>>2]|0)&&(V|0)==(p[N+4>>2]|0)){C=(C^15)*3|0,M=gt(A|0,m|0,C|0)|0,te()|0,M=M&7,C=gt(g|0,v|0,C|0)|0,te()|0,C=C&7;do if((M|0)==0|(C|0)==0)p[S>>2]=1,M=0;else if((M|0)==7)M=5;else{if((M|0)==1|(C|0)==1&&wi(I,V)|0){M=5;break}if((p[15536+(M<<2)>>2]|0)!=(C|0)&&(p[15568+(M<<2)>>2]|0)!=(C|0))break e;p[S>>2]=1,M=0}while(!1);return S=M,Z=oe,S|0}while(!1)}M=j,C=M+56|0;do p[M>>2]=0,M=M+4|0;while((M|0)<(C|0));return Ji(A,m,1,j)|0,m=j,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0))&&(m=j+8|0,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0)))&&(m=j+16|0,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0)))&&(m=j+24|0,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0)))&&(m=j+32|0,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0)))&&(m=j+40|0,!((p[m>>2]|0)==(g|0)&&(p[m+4>>2]|0)==(v|0)))?(M=j+48|0,M=((p[M>>2]|0)==(g|0)?(p[M+4>>2]|0)==(v|0):0)&1):M=1,p[S>>2]=M,S=0,Z=oe,S|0}function P2(A,m,g,v,S){return A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,g=Wr(A,m,g,v)|0,(g|0)==7?(S=11,S|0):(v=wt(g|0,0,56)|0,m=m&-2130706433|(te()|0)|268435456,p[S>>2]=A|v,p[S+4>>2]=m,S=0,S|0)}function P3(A,m,g){return A=A|0,m=m|0,g=g|0,!0&(m&2013265920|0)==268435456?(p[g>>2]=A,p[g+4>>2]=m&-2130706433|134217728,g=0,g|0):(g=6,g|0)}function L3(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;return S=Z,Z=Z+16|0,v=S,p[v>>2]=0,!0&(m&2013265920|0)==268435456?(M=gt(A|0,m|0,56)|0,te()|0,v=hi(A,m&-2130706433|134217728,M&7,v,g)|0,Z=S,v|0):(v=6,Z=S,v|0)}function O3(A,m){A=A|0,m=m|0;var g=0;switch(g=gt(A|0,m|0,56)|0,te()|0,g&7){case 0:case 7:return g=0,g|0}return g=m&-2130706433|134217728,!(!0&(m&2013265920|0)==268435456)||!0&(m&117440512|0)==16777216&(wi(A,g)|0)!=0?(g=0,g|0):(g=Ng(A,g)|0,g|0)}function I3(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;return S=Z,Z=Z+16|0,v=S,!0&(m&2013265920|0)==268435456?(M=m&-2130706433|134217728,C=g,p[C>>2]=A,p[C+4>>2]=M,p[v>>2]=0,m=gt(A|0,m|0,56)|0,te()|0,v=hi(A,M,m&7,v,g+8|0)|0,Z=S,v|0):(v=6,Z=S,v|0)}function B3(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0;return S=(wi(A,m)|0)==0,m=m&-2130706433,v=g,p[v>>2]=S?A:0,p[v+4>>2]=S?m|285212672:0,v=g+8|0,p[v>>2]=A,p[v+4>>2]=m|301989888,v=g+16|0,p[v>>2]=A,p[v+4>>2]=m|318767104,v=g+24|0,p[v>>2]=A,p[v+4>>2]=m|335544320,v=g+32|0,p[v>>2]=A,p[v+4>>2]=m|352321536,g=g+40|0,p[g>>2]=A,p[g+4>>2]=m|369098752,0}function h0(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;return C=Z,Z=Z+16|0,S=C,M=m&-2130706433|134217728,!0&(m&2013265920|0)==268435456?(v=gt(A|0,m|0,56)|0,te()|0,v=X2(A,M,v&7)|0,(v|0)==-1?(p[g>>2]=0,M=6,Z=C,M|0):(ol(A,M,S)|0&&Rt(27795,26932,282,26947),m=gt(A|0,m|0,52)|0,te()|0,m=m&15,wi(A,M)|0?Mg(S,m,v,2,g):f0(S,m,v,2,g),M=0,Z=C,M|0)):(M=6,Z=C,M|0)}function U3(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0;v=Z,Z=Z+16|0,S=v,F3(A,m,g,S),u0(S,g+4|0),Z=v}function F3(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0;if(N=Z,Z=Z+16|0,I=N,k3(A,g,I),M=+Sc(+(1-+J[I>>3]*.5)),M<1e-16){p[v>>2]=0,p[v+4>>2]=0,p[v+8>>2]=0,p[v+12>>2]=0,Z=N;return}if(I=p[g>>2]|0,S=+J[15920+(I*24|0)>>3],S=+wa(S-+wa(+z2(15600+(I<<4)|0,A))),Xo(m)|0?C=+wa(S+-.3334731722518321):C=S,S=+$s(+M)*2.618033988749896,(m|0)>0){A=0;do S=S*2.6457513110645907,A=A+1|0;while((A|0)!=(m|0))}M=+ri(+C)*S,J[v>>3]=M,C=+on(+C)*S,J[v+8>>3]=C,Z=N}function k3(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;if(M=Z,Z=Z+32|0,S=M,Nd(A,S),p[m>>2]=0,J[g>>3]=5,v=+vr(16400,S),v<+J[g>>3]&&(p[m>>2]=0,J[g>>3]=v),v=+vr(16424,S),v<+J[g>>3]&&(p[m>>2]=1,J[g>>3]=v),v=+vr(16448,S),v<+J[g>>3]&&(p[m>>2]=2,J[g>>3]=v),v=+vr(16472,S),v<+J[g>>3]&&(p[m>>2]=3,J[g>>3]=v),v=+vr(16496,S),v<+J[g>>3]&&(p[m>>2]=4,J[g>>3]=v),v=+vr(16520,S),v<+J[g>>3]&&(p[m>>2]=5,J[g>>3]=v),v=+vr(16544,S),v<+J[g>>3]&&(p[m>>2]=6,J[g>>3]=v),v=+vr(16568,S),v<+J[g>>3]&&(p[m>>2]=7,J[g>>3]=v),v=+vr(16592,S),v<+J[g>>3]&&(p[m>>2]=8,J[g>>3]=v),v=+vr(16616,S),v<+J[g>>3]&&(p[m>>2]=9,J[g>>3]=v),v=+vr(16640,S),v<+J[g>>3]&&(p[m>>2]=10,J[g>>3]=v),v=+vr(16664,S),v<+J[g>>3]&&(p[m>>2]=11,J[g>>3]=v),v=+vr(16688,S),v<+J[g>>3]&&(p[m>>2]=12,J[g>>3]=v),v=+vr(16712,S),v<+J[g>>3]&&(p[m>>2]=13,J[g>>3]=v),v=+vr(16736,S),v<+J[g>>3]&&(p[m>>2]=14,J[g>>3]=v),v=+vr(16760,S),v<+J[g>>3]&&(p[m>>2]=15,J[g>>3]=v),v=+vr(16784,S),v<+J[g>>3]&&(p[m>>2]=16,J[g>>3]=v),v=+vr(16808,S),v<+J[g>>3]&&(p[m>>2]=17,J[g>>3]=v),v=+vr(16832,S),v<+J[g>>3]&&(p[m>>2]=18,J[g>>3]=v),v=+vr(16856,S),!(v<+J[g>>3])){Z=M;return}p[m>>2]=19,J[g>>3]=v,Z=M}function Nc(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0;if(M=+Uc(A),M<1e-16){m=15600+(m<<4)|0,p[S>>2]=p[m>>2],p[S+4>>2]=p[m+4>>2],p[S+8>>2]=p[m+8>>2],p[S+12>>2]=p[m+12>>2];return}if(C=+De(+ +J[A+8>>3],+ +J[A>>3]),(g|0)>0){A=0;do M=M*.37796447300922725,A=A+1|0;while((A|0)!=(g|0))}N=M*.3333333333333333,v?(g=(Xo(g)|0)==0,M=+ue(+((g?N:N*.37796447300922725)*.381966011250105))):(M=+ue(+(M*.381966011250105)),Xo(g)|0&&(C=+wa(C+.3334731722518321))),V2(15600+(m<<4)|0,+wa(+J[15920+(m*24|0)>>3]-C),M,S)}function Md(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0;v=Z,Z=Z+16|0,S=v,wc(A+4|0,S),Nc(S,p[A>>2]|0,m,0,g),Z=v}function Mg(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0,Kt=0,Et=0,Ln=0,xi=0,kn=0;if(Ln=Z,Z=Z+272|0,M=Ln+256|0,Be=Ln+240|0,fn=Ln,Kt=Ln+224|0,Et=Ln+208|0,Le=Ln+176|0,Ee=Ln+160|0,Mt=Ln+192|0,Yt=Ln+144|0,yt=Ln+128|0,Wt=Ln+112|0,tn=Ln+96|0,Yn=Ln+80|0,p[M>>2]=m,p[Be>>2]=p[A>>2],p[Be+4>>2]=p[A+4>>2],p[Be+8>>2]=p[A+8>>2],p[Be+12>>2]=p[A+12>>2],Rg(Be,M,fn),p[S>>2]=0,Be=v+g+((v|0)==5&1)|0,(Be|0)<=(g|0)){Z=Ln;return}I=p[M>>2]|0,V=Kt+4|0,j=Le+4|0,oe=g+5|0,ge=16880+(I<<2)|0,de=16960+(I<<2)|0,Ae=yt+8|0,Te=Wt+8|0,Ne=tn+8|0,Ve=Et+4|0,N=g;e:for(;;){C=fn+(((N|0)%5|0)<<4)|0,p[Et>>2]=p[C>>2],p[Et+4>>2]=p[C+4>>2],p[Et+8>>2]=p[C+8>>2],p[Et+12>>2]=p[C+12>>2];do;while((Dc(Et,I,0,1)|0)==2);if((N|0)>(g|0)&(Xo(m)|0)!=0){if(p[Le>>2]=p[Et>>2],p[Le+4>>2]=p[Et+4>>2],p[Le+8>>2]=p[Et+8>>2],p[Le+12>>2]=p[Et+12>>2],wc(V,Ee),v=p[Le>>2]|0,M=p[17040+(v*80|0)+(p[Kt>>2]<<2)>>2]|0,p[Le>>2]=p[18640+(v*80|0)+(M*20|0)>>2],C=p[18640+(v*80|0)+(M*20|0)+16>>2]|0,(C|0)>0){A=0;do R2(j),A=A+1|0;while((A|0)<(C|0))}switch(C=18640+(v*80|0)+(M*20|0)+4|0,p[Mt>>2]=p[C>>2],p[Mt+4>>2]=p[C+4>>2],p[Mt+8>>2]=p[C+8>>2],Wh(Mt,(p[ge>>2]|0)*3|0),xs(j,Mt,j),jr(j),wc(j,Yt),xi=+(p[de>>2]|0),J[yt>>3]=xi*3,J[Ae>>3]=0,kn=xi*-1.5,J[Wt>>3]=kn,J[Te>>3]=xi*2.598076211353316,J[tn>>3]=kn,J[Ne>>3]=xi*-2.598076211353316,p[17040+((p[Le>>2]|0)*80|0)+(p[Et>>2]<<2)>>2]|0){case 1:{A=Wt,v=yt;break}case 3:{A=tn,v=Wt;break}case 2:{A=yt,v=tn;break}default:{A=12;break e}}$g(Ee,Yt,v,A,Yn),Nc(Yn,p[Le>>2]|0,I,1,S+8+(p[S>>2]<<4)|0),p[S>>2]=(p[S>>2]|0)+1}if((N|0)<(oe|0)&&(wc(Ve,Le),Nc(Le,p[Et>>2]|0,I,1,S+8+(p[S>>2]<<4)|0),p[S>>2]=(p[S>>2]|0)+1),p[Kt>>2]=p[Et>>2],p[Kt+4>>2]=p[Et+4>>2],p[Kt+8>>2]=p[Et+8>>2],p[Kt+12>>2]=p[Et+12>>2],N=N+1|0,(N|0)>=(Be|0)){A=3;break}}if((A|0)==3){Z=Ln;return}else(A|0)==12&&Rt(26970,27017,572,27027)}function Rg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0;I=Z,Z=Z+128|0,v=I+64|0,S=I,M=v,C=20240,N=M+60|0;do p[M>>2]=p[C>>2],M=M+4|0,C=C+4|0;while((M|0)<(N|0));M=S,C=20304,N=M+60|0;do p[M>>2]=p[C>>2],M=M+4|0,C=C+4|0;while((M|0)<(N|0));N=(Xo(p[m>>2]|0)|0)==0,v=N?v:S,S=A+4|0,C2(S),N2(S),Xo(p[m>>2]|0)|0&&(Rc(S),p[m>>2]=(p[m>>2]|0)+1),p[g>>2]=p[A>>2],m=g+4|0,xs(S,v,m),jr(m),p[g+16>>2]=p[A>>2],m=g+20|0,xs(S,v+12|0,m),jr(m),p[g+32>>2]=p[A>>2],m=g+36|0,xs(S,v+24|0,m),jr(m),p[g+48>>2]=p[A>>2],m=g+52|0,xs(S,v+36|0,m),jr(m),p[g+64>>2]=p[A>>2],g=g+68|0,xs(S,v+48|0,g),jr(g),Z=I}function Dc(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0;if(Ae=Z,Z=Z+32|0,ge=Ae+12|0,N=Ae,de=A+4|0,oe=p[16960+(m<<2)>>2]|0,j=(v|0)!=0,oe=j?oe*3|0:oe,S=p[de>>2]|0,V=A+8|0,C=p[V>>2]|0,j){if(M=A+12|0,v=p[M>>2]|0,S=C+S+v|0,(S|0)==(oe|0))return de=1,Z=Ae,de|0;I=M}else I=A+12|0,v=p[I>>2]|0,S=C+S+v|0;if((S|0)<=(oe|0))return de=0,Z=Ae,de|0;do if((v|0)>0){if(v=p[A>>2]|0,(C|0)>0){M=18640+(v*80|0)+60|0,v=A;break}v=18640+(v*80|0)+40|0,g?(Ec(ge,oe,0,0),wd(de,ge,N),c0(N),xs(N,ge,de),M=v,v=A):(M=v,v=A)}else M=18640+((p[A>>2]|0)*80|0)+20|0,v=A;while(!1);if(p[v>>2]=p[M>>2],S=M+16|0,(p[S>>2]|0)>0){v=0;do R2(de),v=v+1|0;while((v|0)<(p[S>>2]|0))}return A=M+4|0,p[ge>>2]=p[A>>2],p[ge+4>>2]=p[A+4>>2],p[ge+8>>2]=p[A+8>>2],m=p[16880+(m<<2)>>2]|0,Wh(ge,j?m*3|0:m),xs(de,ge,de),jr(de),j?v=((p[V>>2]|0)+(p[de>>2]|0)+(p[I>>2]|0)|0)==(oe|0)?1:2:v=2,de=v,Z=Ae,de|0}function L2(A,m){A=A|0,m=m|0;var g=0;do g=Dc(A,m,0,1)|0;while((g|0)==2);return g|0}function f0(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0;if(tn=Z,Z=Z+240|0,M=tn+224|0,Mt=tn+208|0,Yt=tn,yt=tn+192|0,Wt=tn+176|0,Ne=tn+160|0,Ve=tn+144|0,Be=tn+128|0,Le=tn+112|0,Ee=tn+96|0,p[M>>2]=m,p[Mt>>2]=p[A>>2],p[Mt+4>>2]=p[A+4>>2],p[Mt+8>>2]=p[A+8>>2],p[Mt+12>>2]=p[A+12>>2],Cg(Mt,M,Yt),p[S>>2]=0,Te=v+g+((v|0)==6&1)|0,(Te|0)<=(g|0)){Z=tn;return}I=p[M>>2]|0,V=g+6|0,j=16960+(I<<2)|0,oe=Ve+8|0,ge=Be+8|0,de=Le+8|0,Ae=yt+4|0,C=0,N=g,v=-1;e:for(;;){if(M=(N|0)%6|0,A=Yt+(M<<4)|0,p[yt>>2]=p[A>>2],p[yt+4>>2]=p[A+4>>2],p[yt+8>>2]=p[A+8>>2],p[yt+12>>2]=p[A+12>>2],A=C,C=Dc(yt,I,0,1)|0,(N|0)>(g|0)&(Xo(m)|0)!=0&&(A|0)!=1&&(p[yt>>2]|0)!=(v|0)){switch(wc(Yt+(((M+5|0)%6|0)<<4)+4|0,Wt),wc(Yt+(M<<4)+4|0,Ne),Yn=+(p[j>>2]|0),J[Ve>>3]=Yn*3,J[oe>>3]=0,fn=Yn*-1.5,J[Be>>3]=fn,J[ge>>3]=Yn*2.598076211353316,J[Le>>3]=fn,J[de>>3]=Yn*-2.598076211353316,M=p[Mt>>2]|0,p[17040+(M*80|0)+(((v|0)==(M|0)?p[yt>>2]|0:v)<<2)>>2]|0){case 1:{A=Be,v=Ve;break}case 3:{A=Le,v=Be;break}case 2:{A=Ve,v=Le;break}default:{A=8;break e}}$g(Wt,Ne,v,A,Ee),!(Yg(Wt,Ee)|0)&&!(Yg(Ne,Ee)|0)&&(Nc(Ee,p[Mt>>2]|0,I,1,S+8+(p[S>>2]<<4)|0),p[S>>2]=(p[S>>2]|0)+1)}if((N|0)<(V|0)&&(wc(Ae,Wt),Nc(Wt,p[yt>>2]|0,I,1,S+8+(p[S>>2]<<4)|0),p[S>>2]=(p[S>>2]|0)+1),N=N+1|0,(N|0)>=(Te|0)){A=3;break}else v=p[yt>>2]|0}if((A|0)==3){Z=tn;return}else(A|0)==8&&Rt(27054,27017,737,27099)}function Cg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0;I=Z,Z=Z+160|0,v=I+80|0,S=I,M=v,C=20368,N=M+72|0;do p[M>>2]=p[C>>2],M=M+4|0,C=C+4|0;while((M|0)<(N|0));M=S,C=20448,N=M+72|0;do p[M>>2]=p[C>>2],M=M+4|0,C=C+4|0;while((M|0)<(N|0));N=(Xo(p[m>>2]|0)|0)==0,v=N?v:S,S=A+4|0,C2(S),N2(S),Xo(p[m>>2]|0)|0&&(Rc(S),p[m>>2]=(p[m>>2]|0)+1),p[g>>2]=p[A>>2],m=g+4|0,xs(S,v,m),jr(m),p[g+16>>2]=p[A>>2],m=g+20|0,xs(S,v+12|0,m),jr(m),p[g+32>>2]=p[A>>2],m=g+36|0,xs(S,v+24|0,m),jr(m),p[g+48>>2]=p[A>>2],m=g+52|0,xs(S,v+36|0,m),jr(m),p[g+64>>2]=p[A>>2],m=g+68|0,xs(S,v+48|0,m),jr(m),p[g+80>>2]=p[A>>2],g=g+84|0,xs(S,v+60|0,g),jr(g),Z=I}function Xh(A,m){return A=A|0,m=m|0,m=gt(A|0,m|0,52)|0,te()|0,m&15|0}function O2(A,m){return A=A|0,m=m|0,m=gt(A|0,m|0,45)|0,te()|0,m&127|0}function Ng(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0;return!(!0&(m&-16777216|0)==134217728)||(v=gt(A|0,m|0,52)|0,te()|0,v=v&15,g=gt(A|0,m|0,45)|0,te()|0,g=g&127,g>>>0>121)?(A=0,A|0):(C=(v^15)*3|0,S=gt(A|0,m|0,C|0)|0,C=wt(S|0,te()|0,C|0)|0,S=te()|0,M=ns(-1227133514,-1171,C|0,S|0)|0,!((C&613566756&M|0)==0&(S&4681&(te()|0)|0)==0)||(C=(v*3|0)+19|0,M=wt(~A|0,~m|0,C|0)|0,C=gt(M|0,te()|0,C|0)|0,!((v|0)==15|(C|0)==0&(te()|0)==0))?(C=0,C|0):!(rt[20528+g>>0]|0)||(m=m&8191,(A|0)==0&(m|0)==0)?(C=1,C|0):(C=M0(A|0,m|0)|0,te()|0,((63-C|0)%3|0|0)!=0|0))}function Dg(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0;if(S=wt(m|0,0,52)|0,M=te()|0,g=wt(g|0,0,45)|0,g=M|(te()|0)|134225919,(m|0)<1){M=-1,v=g,m=A,p[m>>2]=M,A=A+4|0,p[A>>2]=v;return}for(M=1,S=-1;C=(15-M|0)*3|0,N=wt(7,0,C|0)|0,g=g&~(te()|0),C=wt(v|0,0,C|0)|0,S=S&~N|C,g=g|(te()|0),(M|0)!=(m|0);)M=M+1|0;N=A,C=N,p[C>>2]=S,N=N+4|0,p[N>>2]=g}function d0(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0;if(M=gt(A|0,m|0,52)|0,te()|0,M=M&15,g>>>0>15)return v=4,v|0;if((M|0)<(g|0))return v=12,v|0;if((M|0)==(g|0))return p[v>>2]=A,p[v+4>>2]=m,v=0,v|0;if(S=wt(g|0,0,52)|0,S=S|A,A=te()|0|m&-15728641,(M|0)>(g|0))do m=wt(7,0,(14-g|0)*3|0)|0,g=g+1|0,S=m|S,A=te()|0|A;while((g|0)<(M|0));return p[v>>2]=S,p[v+4>>2]=A,v=0,v|0}function $h(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0;if(M=gt(A|0,m|0,52)|0,te()|0,M=M&15,!((g|0)<16&(M|0)<=(g|0)))return v=4,v|0;S=g-M|0,g=gt(A|0,m|0,45)|0,te()|0;e:do if(!(dr(g&127)|0))g=Ca(7,0,S,((S|0)<0)<<31>>31)|0,S=te()|0;else{t:do if(M|0){for(g=1;C=wt(7,0,(15-g|0)*3|0)|0,!!((C&A|0)==0&((te()|0)&m|0)==0);)if(g>>>0<M>>>0)g=g+1|0;else break t;g=Ca(7,0,S,((S|0)<0)<<31>>31)|0,S=te()|0;break e}while(!1);g=Ca(7,0,S,((S|0)<0)<<31>>31)|0,g=Ur(g|0,te()|0,5,0)|0,g=Xt(g|0,te()|0,-5,-1)|0,g=fl(g|0,te()|0,6,0)|0,g=Xt(g|0,te()|0,1,0)|0,S=te()|0}while(!1);return C=v,p[C>>2]=g,p[C+4>>2]=S,C=0,C|0}function wi(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;if(S=gt(A|0,m|0,45)|0,te()|0,!(dr(S&127)|0))return S=0,S|0;S=gt(A|0,m|0,52)|0,te()|0,S=S&15;e:do if(!S)g=0;else for(v=1;;){if(g=gt(A|0,m|0,(15-v|0)*3|0)|0,te()|0,g=g&7,g|0)break e;if(v>>>0<S>>>0)v=v+1|0;else{g=0;break}}while(!1);return S=(g|0)==0&1,S|0}function Rd(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0;if(C=Z,Z=Z+16|0,M=C,Lc(M,A,m,g),m=M,A=p[m>>2]|0,m=p[m+4>>2]|0,(A|0)==0&(m|0)==0)return Z=C,0;S=0,g=0;do N=v+(S<<3)|0,p[N>>2]=A,p[N+4>>2]=m,S=Xt(S|0,g|0,1,0)|0,g=te()|0,m0(M),N=M,A=p[N>>2]|0,m=p[N+4>>2]|0;while(!((A|0)==0&(m|0)==0));return Z=C,0}function I2(A,m,g,v){return A=A|0,m=m|0,g=g|0,v=v|0,(v|0)<(g|0)?(g=m,v=A,ct(g|0),v|0):(g=wt(-1,-1,((v-g|0)*3|0)+3|0)|0,v=wt(~g|0,~(te()|0)|0,(15-v|0)*3|0)|0,g=~(te()|0)&m,v=~v&A,ct(g|0),v|0)}function Cd(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0;return S=gt(A|0,m|0,52)|0,te()|0,S=S&15,(g|0)<16&(S|0)<=(g|0)?((S|0)<(g|0)&&(S=wt(-1,-1,((g+-1-S|0)*3|0)+3|0)|0,S=wt(~S|0,~(te()|0)|0,(15-g|0)*3|0)|0,m=~(te()|0)&m,A=~S&A),S=wt(g|0,0,52)|0,g=m&-15728641|(te()|0),p[v>>2]=A|S,p[v+4>>2]=g,v=0,v|0):(v=4,v|0)}function B2(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0,Kt=0,Et=0;if((g|0)==0&(v|0)==0)return Et=0,Et|0;if(S=A,M=p[S>>2]|0,S=p[S+4>>2]|0,!0&(S&15728640|0)==0){if(!((v|0)>0|(v|0)==0&g>>>0>0)||(Et=m,p[Et>>2]=M,p[Et+4>>2]=S,(g|0)==1&(v|0)==0))return Et=0,Et|0;S=1,M=0;do fn=A+(S<<3)|0,Kt=p[fn+4>>2]|0,Et=m+(S<<3)|0,p[Et>>2]=p[fn>>2],p[Et+4>>2]=Kt,S=Xt(S|0,M|0,1,0)|0,M=te()|0;while((M|0)<(v|0)|(M|0)==(v|0)&S>>>0<g>>>0);return S=0,S|0}if(Yn=g<<3,Kt=hl(Yn)|0,!Kt)return Et=13,Et|0;if(Vc(Kt|0,A|0,Yn|0)|0,fn=Ko(g,8)|0,!fn)return xn(Kt),Et=13,Et|0;e:for(;;){S=Kt,V=p[S>>2]|0,S=p[S+4>>2]|0,Wt=gt(V|0,S|0,52)|0,te()|0,Wt=Wt&15,tn=Wt+-1|0,yt=(Wt|0)!=0,Yt=(v|0)>0|(v|0)==0&g>>>0>0;t:do if(yt&Yt){if(Be=wt(tn|0,0,52)|0,Le=te()|0,tn>>>0>15){if(!((V|0)==0&(S|0)==0)){Et=16;break e}for(M=0,A=0;;){if(M=Xt(M|0,A|0,1,0)|0,A=te()|0,!((A|0)<(v|0)|(A|0)==(v|0)&M>>>0<g>>>0))break t;if(C=Kt+(M<<3)|0,Mt=p[C>>2]|0,C=p[C+4>>2]|0,!((Mt|0)==0&(C|0)==0)){S=C,Et=16;break e}}}for(N=V,A=S,M=0,C=0;;){if(!((N|0)==0&(A|0)==0)){if(!(!0&(A&117440512|0)==0)){Et=21;break e}if(j=gt(N|0,A|0,52)|0,te()|0,j=j&15,(j|0)<(tn|0)){S=12,Et=27;break e}if((j|0)!=(tn|0)&&(N=N|Be,A=A&-15728641|Le,j>>>0>=Wt>>>0)){I=tn;do Mt=wt(7,0,(14-I|0)*3|0)|0,I=I+1|0,N=Mt|N,A=te()|0|A;while(I>>>0<j>>>0)}if(ge=zc(N|0,A|0,g|0,v|0)|0,de=te()|0,I=fn+(ge<<3)|0,j=I,oe=p[j>>2]|0,j=p[j+4>>2]|0,!((oe|0)==0&(j|0)==0)){Ne=0,Ve=0;do{if((Ne|0)>(v|0)|(Ne|0)==(v|0)&Ve>>>0>g>>>0){Et=31;break e}if((oe|0)==(N|0)&(j&-117440513|0)==(A|0)){Ae=gt(oe|0,j|0,56)|0,te()|0,Ae=Ae&7,Te=Ae+1|0,Mt=gt(oe|0,j|0,45)|0,te()|0;n:do if(!(dr(Mt&127)|0))j=7;else{if(oe=gt(oe|0,j|0,52)|0,te()|0,oe=oe&15,!oe){j=6;break}for(j=1;;){if(Mt=wt(7,0,(15-j|0)*3|0)|0,!((Mt&N|0)==0&((te()|0)&A|0)==0)){j=7;break n}if(j>>>0<oe>>>0)j=j+1|0;else{j=6;break}}}while(!1);if((Ae+2|0)>>>0>j>>>0){Et=41;break e}Mt=wt(Te|0,0,56)|0,A=te()|0|A&-117440513,Ee=I,p[Ee>>2]=0,p[Ee+4>>2]=0,N=Mt|N}else ge=Xt(ge|0,de|0,1,0)|0,ge=rf(ge|0,te()|0,g|0,v|0)|0,de=te()|0;Ve=Xt(Ve|0,Ne|0,1,0)|0,Ne=te()|0,I=fn+(ge<<3)|0,j=I,oe=p[j>>2]|0,j=p[j+4>>2]|0}while(!((oe|0)==0&(j|0)==0))}Mt=I,p[Mt>>2]=N,p[Mt+4>>2]=A}if(M=Xt(M|0,C|0,1,0)|0,C=te()|0,!((C|0)<(v|0)|(C|0)==(v|0)&M>>>0<g>>>0))break t;A=Kt+(M<<3)|0,N=p[A>>2]|0,A=p[A+4>>2]|0}}while(!1);if(Mt=Xt(g|0,v|0,5,0)|0,Ee=te()|0,Ee>>>0<0|(Ee|0)==0&Mt>>>0<11){Et=85;break}if(Mt=fl(g|0,v|0,6,0)|0,te()|0,Mt=Ko(Mt,8)|0,!Mt){Et=48;break}do if(Yt){for(Te=0,A=0,Ae=0,Ne=0;;){if(j=fn+(Te<<3)|0,C=j,M=p[C>>2]|0,C=p[C+4>>2]|0,(M|0)==0&(C|0)==0)Ee=Ae;else{oe=gt(M|0,C|0,56)|0,te()|0,oe=oe&7,N=oe+1|0,ge=C&-117440513,Ee=gt(M|0,C|0,45)|0,te()|0;t:do if(dr(Ee&127)|0){if(de=gt(M|0,C|0,52)|0,te()|0,de=de&15,de|0)for(I=1;;){if(Ee=wt(7,0,(15-I|0)*3|0)|0,!((M&Ee|0)==0&(ge&(te()|0)|0)==0))break t;if(I>>>0<de>>>0)I=I+1|0;else break}C=wt(N|0,0,56)|0,M=C|M,C=te()|0|ge,N=j,p[N>>2]=M,p[N+4>>2]=C,N=oe+2|0}while(!1);(N|0)==7?(Ee=Mt+(A<<3)|0,p[Ee>>2]=M,p[Ee+4>>2]=C&-117440513,A=Xt(A|0,Ae|0,1,0)|0,Ee=te()|0):Ee=Ae}if(Te=Xt(Te|0,Ne|0,1,0)|0,Ne=te()|0,(Ne|0)<(v|0)|(Ne|0)==(v|0)&Te>>>0<g>>>0)Ae=Ee;else break}if(Yt){if(Ve=tn>>>0>15,Be=wt(tn|0,0,52)|0,Le=te()|0,!yt){for(M=0,I=0,N=0,C=0;(V|0)==0&(S|0)==0||(tn=m+(M<<3)|0,p[tn>>2]=V,p[tn+4>>2]=S,M=Xt(M|0,I|0,1,0)|0,I=te()|0),N=Xt(N|0,C|0,1,0)|0,C=te()|0,!!((C|0)<(v|0)|(C|0)==(v|0)&N>>>0<g>>>0);)S=Kt+(N<<3)|0,V=p[S>>2]|0,S=p[S+4>>2]|0;S=Ee;break}for(M=0,I=0,C=0,N=0;;){do if(!((V|0)==0&(S|0)==0)){if(de=gt(V|0,S|0,52)|0,te()|0,de=de&15,Ve|(de|0)<(tn|0)){Et=80;break e}if((de|0)!=(tn|0)){if(j=V|Be,oe=S&-15728641|Le,de>>>0>=Wt>>>0){ge=tn;do yt=wt(7,0,(14-ge|0)*3|0)|0,ge=ge+1|0,j=yt|j,oe=te()|0|oe;while(ge>>>0<de>>>0)}}else j=V,oe=S;Ae=zc(j|0,oe|0,g|0,v|0)|0,ge=0,de=0,Ne=te()|0;do{if((ge|0)>(v|0)|(ge|0)==(v|0)&de>>>0>g>>>0){Et=81;break e}if(yt=fn+(Ae<<3)|0,Te=p[yt+4>>2]|0,(Te&-117440513|0)==(oe|0)&&(p[yt>>2]|0)==(j|0)){Et=65;break}yt=Xt(Ae|0,Ne|0,1,0)|0,Ae=rf(yt|0,te()|0,g|0,v|0)|0,Ne=te()|0,de=Xt(de|0,ge|0,1,0)|0,ge=te()|0,yt=fn+(Ae<<3)|0}while(!((p[yt>>2]|0)==(j|0)&&(p[yt+4>>2]|0)==(oe|0)));if((Et|0)==65&&(Et=0,!0&(Te&117440512|0)==100663296))break;yt=m+(M<<3)|0,p[yt>>2]=V,p[yt+4>>2]=S,M=Xt(M|0,I|0,1,0)|0,I=te()|0}while(!1);if(C=Xt(C|0,N|0,1,0)|0,N=te()|0,!((N|0)<(v|0)|(N|0)==(v|0)&C>>>0<g>>>0))break;S=Kt+(C<<3)|0,V=p[S>>2]|0,S=p[S+4>>2]|0}S=Ee}else M=0,S=Ee}else M=0,A=0,S=0;while(!1);if(dl(fn|0,0,Yn|0)|0,Vc(Kt|0,Mt|0,A<<3|0)|0,xn(Mt),(A|0)==0&(S|0)==0){Et=89;break}else m=m+(M<<3)|0,v=S,g=A}if((Et|0)==16)!0&(S&117440512|0)==0?(S=4,Et=27):Et=21;else if((Et|0)==31)Rt(27795,27122,529,27132);else{if((Et|0)==41)return xn(Kt),xn(fn),Et=10,Et|0;if((Et|0)==48)return xn(Kt),xn(fn),Et=13,Et|0;(Et|0)==80?Rt(27795,27122,620,27132):(Et|0)==81?Rt(27795,27122,632,27132):(Et|0)==85&&(Vc(m|0,Kt|0,g<<3|0)|0,Et=89)}return(Et|0)==21?(xn(Kt),xn(fn),Et=5,Et|0):(Et|0)==27?(xn(Kt),xn(fn),Et=S,Et|0):(Et|0)==89?(xn(Kt),xn(fn),Et=0,Et|0):0}function U2(A,m,g,v,S,M,C){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0,C=C|0;var N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0;if(Te=Z,Z=Z+16|0,Ae=Te,!((g|0)>0|(g|0)==0&m>>>0>0))return Ae=0,Z=Te,Ae|0;if((C|0)>=16)return Ae=12,Z=Te,Ae|0;ge=0,de=0,oe=0,N=0;e:for(;;){if(V=A+(ge<<3)|0,I=p[V>>2]|0,V=p[V+4>>2]|0,j=gt(I|0,V|0,52)|0,te()|0,(j&15|0)>(C|0)){N=12,I=11;break}if(Lc(Ae,I,V,C),j=Ae,V=p[j>>2]|0,j=p[j+4>>2]|0,(V|0)==0&(j|0)==0)I=oe;else{I=oe;do{if(!((N|0)<(M|0)|(N|0)==(M|0)&I>>>0<S>>>0)){I=10;break e}oe=v+(I<<3)|0,p[oe>>2]=V,p[oe+4>>2]=j,I=Xt(I|0,N|0,1,0)|0,N=te()|0,m0(Ae),oe=Ae,V=p[oe>>2]|0,j=p[oe+4>>2]|0}while(!((V|0)==0&(j|0)==0))}if(ge=Xt(ge|0,de|0,1,0)|0,de=te()|0,(de|0)<(g|0)|(de|0)==(g|0)&ge>>>0<m>>>0)oe=I;else{N=0,I=11;break}}return(I|0)==10?(Ae=14,Z=Te,Ae|0):(I|0)==11?(Z=Te,N|0):0}function Pg(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0;ge=Z,Z=Z+16|0,oe=ge;e:do if((g|0)>0|(g|0)==0&m>>>0>0){for(V=0,C=0,M=0,j=0;;){if(I=A+(V<<3)|0,N=p[I>>2]|0,I=p[I+4>>2]|0,!((N|0)==0&(I|0)==0)&&(I=($h(N,I,v,oe)|0)==0,N=oe,C=Xt(p[N>>2]|0,p[N+4>>2]|0,C|0,M|0)|0,M=te()|0,!I)){M=12;break}if(V=Xt(V|0,j|0,1,0)|0,j=te()|0,!((j|0)<(g|0)|(j|0)==(g|0)&V>>>0<m>>>0))break e}return Z=ge,M|0}else C=0,M=0;while(!1);return p[S>>2]=C,p[S+4>>2]=M,S=0,Z=ge,S|0}function Lg(A,m){return A=A|0,m=m|0,m=gt(A|0,m|0,52)|0,te()|0,m&1|0}function Ys(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;if(S=gt(A|0,m|0,52)|0,te()|0,S=S&15,!S)return S=0,S|0;for(v=1;;){if(g=gt(A|0,m|0,(15-v|0)*3|0)|0,te()|0,g=g&7,g|0){v=5;break}if(v>>>0<S>>>0)v=v+1|0;else{g=0,v=5;break}}return(v|0)==5?g|0:0}function A0(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0;if(I=gt(A|0,m|0,52)|0,te()|0,I=I&15,!I)return N=m,I=A,ct(N|0),I|0;for(N=1,g=0;;){M=(15-N|0)*3|0,v=wt(7,0,M|0)|0,S=te()|0,C=gt(A|0,m|0,M|0)|0,te()|0,M=wt(Cc(C&7)|0,0,M|0)|0,C=te()|0,A=M|A&~v,m=C|m&~S;e:do if(!g)if((M&v|0)==0&(C&S|0)==0)g=0;else if(v=gt(A|0,m|0,52)|0,te()|0,v=v&15,!v)g=1;else{g=1;t:for(;;){switch(C=gt(A|0,m|0,(15-g|0)*3|0)|0,te()|0,C&7){case 1:break t;case 0:break;default:{g=1;break e}}if(g>>>0<v>>>0)g=g+1|0;else{g=1;break e}}for(g=1;;)if(C=(15-g|0)*3|0,S=gt(A|0,m|0,C|0)|0,te()|0,M=wt(7,0,C|0)|0,m=m&~(te()|0),C=wt(Cc(S&7)|0,0,C|0)|0,A=A&~M|C,m=m|(te()|0),g>>>0<v>>>0)g=g+1|0;else{g=1;break}}while(!1);if(N>>>0<I>>>0)N=N+1|0;else break}return ct(m|0),A|0}function Tu(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0;if(v=gt(A|0,m|0,52)|0,te()|0,v=v&15,!v)return g=m,v=A,ct(g|0),v|0;for(g=1;M=(15-g|0)*3|0,C=gt(A|0,m|0,M|0)|0,te()|0,S=wt(7,0,M|0)|0,m=m&~(te()|0),M=wt(Cc(C&7)|0,0,M|0)|0,A=M|A&~S,m=te()|0|m,g>>>0<v>>>0;)g=g+1|0;return ct(m|0),A|0}function G3(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0;if(I=gt(A|0,m|0,52)|0,te()|0,I=I&15,!I)return N=m,I=A,ct(N|0),I|0;for(N=1,g=0;;){M=(15-N|0)*3|0,v=wt(7,0,M|0)|0,S=te()|0,C=gt(A|0,m|0,M|0)|0,te()|0,M=wt(zl(C&7)|0,0,M|0)|0,C=te()|0,A=M|A&~v,m=C|m&~S;e:do if(!g)if((M&v|0)==0&(C&S|0)==0)g=0;else if(v=gt(A|0,m|0,52)|0,te()|0,v=v&15,!v)g=1;else{g=1;t:for(;;){switch(C=gt(A|0,m|0,(15-g|0)*3|0)|0,te()|0,C&7){case 1:break t;case 0:break;default:{g=1;break e}}if(g>>>0<v>>>0)g=g+1|0;else{g=1;break e}}for(g=1;;)if(S=(15-g|0)*3|0,M=wt(7,0,S|0)|0,C=m&~(te()|0),m=gt(A|0,m|0,S|0)|0,te()|0,m=wt(zl(m&7)|0,0,S|0)|0,A=A&~M|m,m=C|(te()|0),g>>>0<v>>>0)g=g+1|0;else{g=1;break}}while(!1);if(N>>>0<I>>>0)N=N+1|0;else break}return ct(m|0),A|0}function Og(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0;if(v=gt(A|0,m|0,52)|0,te()|0,v=v&15,!v)return g=m,v=A,ct(g|0),v|0;for(g=1;C=(15-g|0)*3|0,M=wt(7,0,C|0)|0,S=m&~(te()|0),m=gt(A|0,m|0,C|0)|0,te()|0,m=wt(zl(m&7)|0,0,C|0)|0,A=m|A&~M,m=te()|0|S,g>>>0<v>>>0;)g=g+1|0;return ct(m|0),A|0}function z3(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(I=Z,Z=Z+64|0,N=I+40|0,v=I+24|0,S=I+12|0,M=I,wt(m|0,0,52)|0,g=te()|0|134225919,!m)return(p[A+4>>2]|0)>2||(p[A+8>>2]|0)>2||(p[A+12>>2]|0)>2?(C=0,N=0,ct(C|0),Z=I,N|0):(wt(yd(A)|0,0,45)|0,C=te()|0|g,N=-1,ct(C|0),Z=I,N|0);if(p[N>>2]=p[A>>2],p[N+4>>2]=p[A+4>>2],p[N+8>>2]=p[A+8>>2],p[N+12>>2]=p[A+12>>2],C=N+4|0,(m|0)>0)for(A=-1;p[v>>2]=p[C>>2],p[v+4>>2]=p[C+4>>2],p[v+8>>2]=p[C+8>>2],m&1?(R3(C),p[S>>2]=p[C>>2],p[S+4>>2]=p[C+4>>2],p[S+8>>2]=p[C+8>>2],jh(S)):(w2(C),p[S>>2]=p[C>>2],p[S+4>>2]=p[C+4>>2],p[S+8>>2]=p[C+8>>2],Rc(S)),wd(v,S,M),jr(M),j=(15-m|0)*3|0,V=wt(7,0,j|0)|0,g=g&~(te()|0),j=wt(Mc(M)|0,0,j|0)|0,A=j|A&~V,g=te()|0|g,(m|0)>1;)m=m+-1|0;else A=-1;e:do if((p[C>>2]|0)<=2&&(p[N+8>>2]|0)<=2&&(p[N+12>>2]|0)<=2){if(v=yd(N)|0,m=wt(v|0,0,45)|0,m=m|A,A=te()|0|g&-1040385,M=bg(N)|0,!(dr(v)|0)){if((M|0)<=0)break;for(S=0;;){if(v=gt(m|0,A|0,52)|0,te()|0,v=v&15,v)for(g=1;j=(15-g|0)*3|0,N=gt(m|0,A|0,j|0)|0,te()|0,V=wt(7,0,j|0)|0,A=A&~(te()|0),j=wt(Cc(N&7)|0,0,j|0)|0,m=m&~V|j,A=A|(te()|0),g>>>0<v>>>0;)g=g+1|0;if(S=S+1|0,(S|0)==(M|0))break e}}S=gt(m|0,A|0,52)|0,te()|0,S=S&15;t:do if(S){g=1;n:for(;;){switch(j=gt(m|0,A|0,(15-g|0)*3|0)|0,te()|0,j&7){case 1:break n;case 0:break;default:break t}if(g>>>0<S>>>0)g=g+1|0;else break t}if(Tc(v,p[N>>2]|0)|0)for(g=1;N=(15-g|0)*3|0,V=wt(7,0,N|0)|0,j=A&~(te()|0),A=gt(m|0,A|0,N|0)|0,te()|0,A=wt(zl(A&7)|0,0,N|0)|0,m=m&~V|A,A=j|(te()|0),g>>>0<S>>>0;)g=g+1|0;else for(g=1;j=(15-g|0)*3|0,N=gt(m|0,A|0,j|0)|0,te()|0,V=wt(7,0,j|0)|0,A=A&~(te()|0),j=wt(Cc(N&7)|0,0,j|0)|0,m=m&~V|j,A=A|(te()|0),g>>>0<S>>>0;)g=g+1|0}while(!1);if((M|0)>0){g=0;do m=A0(m,A)|0,A=te()|0,g=g+1|0;while((g|0)!=(M|0))}}else m=0,A=0;while(!1);return V=A,j=m,ct(V|0),Z=I,j|0}function Xo(A){return A=A|0,(A|0)%2|0|0}function Ig(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0;return S=Z,Z=Z+16|0,v=S,m>>>0>15?(v=4,Z=S,v|0):(p[A+4>>2]&2146435072|0)==2146435072||(p[A+8+4>>2]&2146435072|0)==2146435072?(v=3,Z=S,v|0):(U3(A,m,v),m=z3(v,m)|0,v=te()|0,p[g>>2]=m,p[g+4>>2]=v,(m|0)==0&(v|0)==0&&Rt(27795,27122,959,27145),v=0,Z=S,v|0)}function Qs(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;if(S=g+4|0,M=gt(A|0,m|0,52)|0,te()|0,M=M&15,C=gt(A|0,m|0,45)|0,te()|0,v=(M|0)==0,dr(C&127)|0){if(v)return C=1,C|0;v=1}else{if(v)return C=0,C|0;(p[S>>2]|0)==0&&(p[g+8>>2]|0)==0?v=(p[g+12>>2]|0)!=0&1:v=1}for(g=1;g&1?jh(S):Rc(S),C=gt(A|0,m|0,(15-g|0)*3|0)|0,te()|0,M2(S,C&7),g>>>0<M>>>0;)g=g+1|0;return v|0}function ol(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(j=Z,Z=Z+16|0,I=j,V=gt(A|0,m|0,45)|0,te()|0,V=V&127,V>>>0>121)return p[g>>2]=0,p[g+4>>2]=0,p[g+8>>2]=0,p[g+12>>2]=0,V=5,Z=j,V|0;e:do if((dr(V)|0)!=0&&(M=gt(A|0,m|0,52)|0,te()|0,M=M&15,(M|0)!=0)){v=1;t:for(;;){switch(N=gt(A|0,m|0,(15-v|0)*3|0)|0,te()|0,N&7){case 5:break t;case 0:break;default:{v=m;break e}}if(v>>>0<M>>>0)v=v+1|0;else{v=m;break e}}for(S=1,v=m;m=(15-S|0)*3|0,C=wt(7,0,m|0)|0,N=v&~(te()|0),v=gt(A|0,v|0,m|0)|0,te()|0,v=wt(zl(v&7)|0,0,m|0)|0,A=A&~C|v,v=N|(te()|0),S>>>0<M>>>0;)S=S+1|0}else v=m;while(!1);if(N=7696+(V*28|0)|0,p[g>>2]=p[N>>2],p[g+4>>2]=p[N+4>>2],p[g+8>>2]=p[N+8>>2],p[g+12>>2]=p[N+12>>2],!(Qs(A,v,g)|0))return V=0,Z=j,V|0;if(C=g+4|0,p[I>>2]=p[C>>2],p[I+4>>2]=p[C+4>>2],p[I+8>>2]=p[C+8>>2],M=gt(A|0,v|0,52)|0,te()|0,N=M&15,M&1?(Rc(C),M=N+1|0):M=N,!(dr(V)|0))v=0;else{e:do if(!N)v=0;else for(m=1;;){if(S=gt(A|0,v|0,(15-m|0)*3|0)|0,te()|0,S=S&7,S|0){v=S;break e}if(m>>>0<N>>>0)m=m+1|0;else{v=0;break}}while(!1);v=(v|0)==4&1}if(!(Dc(g,M,v,0)|0))(M|0)!=(N|0)&&(p[C>>2]=p[I>>2],p[C+4>>2]=p[I+4>>2],p[C+8>>2]=p[I+8>>2]);else{if(dr(V)|0)do;while((Dc(g,M,0,0)|0)!=0);(M|0)!=(N|0)&&w2(C)}return V=0,Z=j,V|0}function Eu(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;return M=Z,Z=Z+16|0,v=M,S=ol(A,m,v)|0,S|0?(Z=M,S|0):(S=gt(A|0,m|0,52)|0,te()|0,Md(v,S&15,g),S=0,Z=M,S|0)}function Pc(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0;if(C=Z,Z=Z+16|0,M=C,v=ol(A,m,M)|0,v|0)return M=v,Z=C,M|0;v=gt(A|0,m|0,45)|0,te()|0,v=(dr(v&127)|0)==0,S=gt(A|0,m|0,52)|0,te()|0,S=S&15;e:do if(!v){if(S|0)for(v=1;;){if(N=wt(7,0,(15-v|0)*3|0)|0,!((N&A|0)==0&((te()|0)&m|0)==0))break e;if(v>>>0<S>>>0)v=v+1|0;else break}return Mg(M,S,0,5,g),N=0,Z=C,N|0}while(!1);return f0(M,S,0,6,g),N=0,Z=C,N|0}function F2(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;if(S=gt(A|0,m|0,45)|0,te()|0,!(dr(S&127)|0))return S=2,p[g>>2]=S,0;if(S=gt(A|0,m|0,52)|0,te()|0,S=S&15,!S)return S=5,p[g>>2]=S,0;for(v=1;;){if(M=wt(7,0,(15-v|0)*3|0)|0,!((M&A|0)==0&((te()|0)&m|0)==0)){v=2,A=6;break}if(v>>>0<S>>>0)v=v+1|0;else{v=5,A=6;break}}return(A|0)==6&&(p[g>>2]=v),0}function Bg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0;oe=Z,Z=Z+128|0,V=oe+112|0,M=oe+96|0,j=oe,S=gt(A|0,m|0,52)|0,te()|0,N=S&15,p[V>>2]=N,C=gt(A|0,m|0,45)|0,te()|0,C=C&127;e:do if(dr(C)|0){if(N|0)for(v=1;;){if(I=wt(7,0,(15-v|0)*3|0)|0,!((I&A|0)==0&((te()|0)&m|0)==0)){S=0;break e}if(v>>>0<N>>>0)v=v+1|0;else break}if(S&1)S=1;else return I=wt(N+1|0,0,52)|0,j=te()|0|m&-15728641,V=wt(7,0,(14-N|0)*3|0)|0,j=Bg((I|A)&~V,j&~(te()|0),g)|0,Z=oe,j|0}else S=0;while(!1);if(v=ol(A,m,M)|0,!v){S?(Rg(M,V,j),I=5):(Cg(M,V,j),I=6);e:do if(dr(C)|0)if(!N)A=5;else for(v=1;;){if(C=wt(7,0,(15-v|0)*3|0)|0,!((C&A|0)==0&((te()|0)&m|0)==0)){A=2;break e}if(v>>>0<N>>>0)v=v+1|0;else{A=5;break}}else A=2;while(!1);dl(g|0,-1,A<<2|0)|0;e:do if(S)for(M=0;;){if(C=j+(M<<4)|0,L2(C,p[V>>2]|0)|0,C=p[C>>2]|0,N=p[g>>2]|0,(N|0)==-1|(N|0)==(C|0))v=g;else{S=0;do{if(S=S+1|0,S>>>0>=A>>>0){v=1;break e}v=g+(S<<2)|0,N=p[v>>2]|0}while(!((N|0)==-1|(N|0)==(C|0)))}if(p[v>>2]=C,M=M+1|0,M>>>0>=I>>>0){v=0;break}}else for(M=0;;){if(C=j+(M<<4)|0,Dc(C,p[V>>2]|0,0,1)|0,C=p[C>>2]|0,N=p[g>>2]|0,(N|0)==-1|(N|0)==(C|0))v=g;else{S=0;do{if(S=S+1|0,S>>>0>=A>>>0){v=1;break e}v=g+(S<<2)|0,N=p[v>>2]|0}while(!((N|0)==-1|(N|0)==(C|0)))}if(p[v>>2]=C,M=M+1|0,M>>>0>=I>>>0){v=0;break}}while(!1)}return j=v,Z=oe,j|0}function Ug(){return 12}function Fg(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0;if(A>>>0>15)return N=4,N|0;if(wt(A|0,0,52)|0,N=te()|0|134225919,!A){g=0,v=0;do dr(v)|0&&(wt(v|0,0,45)|0,C=N|(te()|0),A=m+(g<<3)|0,p[A>>2]=-1,p[A+4>>2]=C,g=g+1|0),v=v+1|0;while((v|0)!=122);return g=0,g|0}g=0,C=0;do{if(dr(C)|0){for(wt(C|0,0,45)|0,v=1,S=-1,M=N|(te()|0);I=wt(7,0,(15-v|0)*3|0)|0,S=S&~I,M=M&~(te()|0),(v|0)!=(A|0);)v=v+1|0;I=m+(g<<3)|0,p[I>>2]=S,p[I+4>>2]=M,g=g+1|0}C=C+1|0}while((C|0)!=122);return g=0,g|0}function Yh(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0;if(Be=Z,Z=Z+16|0,Ne=Be,Ve=gt(A|0,m|0,52)|0,te()|0,Ve=Ve&15,g>>>0>15)return Ve=4,Z=Be,Ve|0;if((Ve|0)<(g|0))return Ve=12,Z=Be,Ve|0;if((Ve|0)!=(g|0))if(M=wt(g|0,0,52)|0,M=M|A,N=te()|0|m&-15728641,(Ve|0)>(g|0)){I=g;do Te=wt(7,0,(14-I|0)*3|0)|0,I=I+1|0,M=Te|M,N=te()|0|N;while((I|0)<(Ve|0));Te=M}else Te=M;else Te=A,N=m;Ae=gt(Te|0,N|0,45)|0,te()|0;e:do if(dr(Ae&127)|0){if(I=gt(Te|0,N|0,52)|0,te()|0,I=I&15,I|0)for(M=1;;){if(Ae=wt(7,0,(15-M|0)*3|0)|0,!((Ae&Te|0)==0&((te()|0)&N|0)==0)){V=33;break e}if(M>>>0<I>>>0)M=M+1|0;else break}if(Ae=v,p[Ae>>2]=0,p[Ae+4>>2]=0,(Ve|0)>(g|0)){for(Ae=m&-15728641,de=Ve;;){if(ge=de,de=de+-1|0,de>>>0>15|(Ve|0)<(de|0)){V=19;break}if((Ve|0)!=(de|0))if(M=wt(de|0,0,52)|0,M=M|A,I=te()|0|Ae,(Ve|0)<(ge|0))oe=M;else{V=de;do oe=wt(7,0,(14-V|0)*3|0)|0,V=V+1|0,M=oe|M,I=te()|0|I;while((V|0)<(Ve|0));oe=M}else oe=A,I=m;if(j=gt(oe|0,I|0,45)|0,te()|0,!(dr(j&127)|0))M=0;else{j=gt(oe|0,I|0,52)|0,te()|0,j=j&15;t:do if(!j)M=0;else for(V=1;;){if(M=gt(oe|0,I|0,(15-V|0)*3|0)|0,te()|0,M=M&7,M|0)break t;if(V>>>0<j>>>0)V=V+1|0;else{M=0;break}}while(!1);M=(M|0)==0&1}if(I=gt(A|0,m|0,(15-ge|0)*3|0)|0,te()|0,I=I&7,(I|0)==7){S=5,V=42;break}if(M=(M|0)!=0,(I|0)==1&M){S=5,V=42;break}if(oe=I+(((I|0)!=0&M)<<31>>31)|0,oe|0&&(V=Ve-ge|0,V=Ca(7,0,V,((V|0)<0)<<31>>31)|0,j=te()|0,M?(M=Ur(V|0,j|0,5,0)|0,M=Xt(M|0,te()|0,-5,-1)|0,M=fl(M|0,te()|0,6,0)|0,M=Xt(M|0,te()|0,1,0)|0,I=te()|0):(M=V,I=j),ge=oe+-1|0,ge=Ur(V|0,j|0,ge|0,((ge|0)<0)<<31>>31|0)|0,ge=Xt(M|0,I|0,ge|0,te()|0)|0,oe=te()|0,j=v,j=Xt(ge|0,oe|0,p[j>>2]|0,p[j+4>>2]|0)|0,oe=te()|0,ge=v,p[ge>>2]=j,p[ge+4>>2]=oe),(de|0)<=(g|0)){V=37;break}}if((V|0)==19)Rt(27795,27122,1276,27158);else if((V|0)==37){C=v,S=p[C+4>>2]|0,C=p[C>>2]|0;break}else if((V|0)==42)return Z=Be,S|0}else S=0,C=0}else V=33;while(!1);e:do if((V|0)==33)if(Ae=v,p[Ae>>2]=0,p[Ae+4>>2]=0,(Ve|0)>(g|0)){for(M=Ve;;){if(S=gt(A|0,m|0,(15-M|0)*3|0)|0,te()|0,S=S&7,(S|0)==7){S=5;break}if(C=Ve-M|0,C=Ca(7,0,C,((C|0)<0)<<31>>31)|0,S=Ur(C|0,te()|0,S|0,0)|0,C=te()|0,Ae=v,C=Xt(p[Ae>>2]|0,p[Ae+4>>2]|0,S|0,C|0)|0,S=te()|0,Ae=v,p[Ae>>2]=C,p[Ae+4>>2]=S,M=M+-1|0,(M|0)<=(g|0))break e}return Z=Be,S|0}else S=0,C=0;while(!1);return $h(Te,N,Ve,Ne)|0&&Rt(27795,27122,1236,27173),Ve=Ne,Ne=p[Ve+4>>2]|0,((S|0)>-1|(S|0)==-1&C>>>0>4294967295)&((Ne|0)>(S|0)|((Ne|0)==(S|0)?(p[Ve>>2]|0)>>>0>C>>>0:0))?(Ve=0,Z=Be,Ve|0):(Rt(27795,27122,1316,27158),0)}function kg(A,m,g,v,S,M){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0;var C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0;if(oe=Z,Z=Z+16|0,C=oe,S>>>0>15)return M=4,Z=oe,M|0;if(N=gt(g|0,v|0,52)|0,te()|0,N=N&15,(N|0)>(S|0))return M=12,Z=oe,M|0;if($h(g,v,S,C)|0&&Rt(27795,27122,1236,27173),j=C,V=p[j+4>>2]|0,!(((m|0)>-1|(m|0)==-1&A>>>0>4294967295)&((V|0)>(m|0)|((V|0)==(m|0)?(p[j>>2]|0)>>>0>A>>>0:0))))return M=2,Z=oe,M|0;j=S-N|0,S=wt(S|0,0,52)|0,I=te()|0|v&-15728641,V=M,p[V>>2]=S|g,p[V+4>>2]=I,V=gt(g|0,v|0,45)|0,te()|0;e:do if(dr(V&127)|0){if(N|0)for(C=1;;){if(V=wt(7,0,(15-C|0)*3|0)|0,!((V&g|0)==0&((te()|0)&v|0)==0))break e;if(C>>>0<N>>>0)C=C+1|0;else break}if((j|0)<1)return M=0,Z=oe,M|0;for(V=N^15,v=-1,I=1,C=1;;){N=j-I|0,N=Ca(7,0,N,((N|0)<0)<<31>>31)|0,g=te()|0;do if(C)if(C=Ur(N|0,g|0,5,0)|0,C=Xt(C|0,te()|0,-5,-1)|0,C=fl(C|0,te()|0,6,0)|0,S=te()|0,(m|0)>(S|0)|(m|0)==(S|0)&A>>>0>C>>>0){m=Xt(A|0,m|0,-1,-1)|0,m=ns(m|0,te()|0,C|0,S|0)|0,C=te()|0,ge=M,Ae=p[ge>>2]|0,ge=p[ge+4>>2]|0,Te=(V+v|0)*3|0,de=wt(7,0,Te|0)|0,ge=ge&~(te()|0),v=fl(m|0,C|0,N|0,g|0)|0,A=te()|0,S=Xt(v|0,A|0,2,0)|0,Te=wt(S|0,te()|0,Te|0)|0,ge=te()|0|ge,S=M,p[S>>2]=Te|Ae&~de,p[S+4>>2]=ge,A=Ur(v|0,A|0,N|0,g|0)|0,A=ns(m|0,C|0,A|0,te()|0)|0,C=0,m=te()|0;break}else{Te=M,de=p[Te>>2]|0,Te=p[Te+4>>2]|0,Ae=wt(7,0,(V+v|0)*3|0)|0,Te=Te&~(te()|0),C=M,p[C>>2]=de&~Ae,p[C+4>>2]=Te,C=1;break}else de=M,S=p[de>>2]|0,de=p[de+4>>2]|0,v=(V+v|0)*3|0,ge=wt(7,0,v|0)|0,de=de&~(te()|0),Te=fl(A|0,m|0,N|0,g|0)|0,C=te()|0,v=wt(Te|0,C|0,v|0)|0,de=te()|0|de,Ae=M,p[Ae>>2]=v|S&~ge,p[Ae+4>>2]=de,C=Ur(Te|0,C|0,N|0,g|0)|0,A=ns(A|0,m|0,C|0,te()|0)|0,C=0,m=te()|0;while(!1);if((j|0)>(I|0))v=~I,I=I+1|0;else{m=0;break}}return Z=oe,m|0}while(!1);if((j|0)<1)return Te=0,Z=oe,Te|0;for(S=N^15,C=1;;)if(Ae=j-C|0,Ae=Ca(7,0,Ae,((Ae|0)<0)<<31>>31)|0,Te=te()|0,I=M,g=p[I>>2]|0,I=p[I+4>>2]|0,N=(S-C|0)*3|0,v=wt(7,0,N|0)|0,I=I&~(te()|0),ge=fl(A|0,m|0,Ae|0,Te|0)|0,de=te()|0,N=wt(ge|0,de|0,N|0)|0,I=te()|0|I,V=M,p[V>>2]=N|g&~v,p[V+4>>2]=I,Te=Ur(ge|0,de|0,Ae|0,Te|0)|0,A=ns(A|0,m|0,Te|0,te()|0)|0,m=te()|0,(j|0)<=(C|0)){m=0;break}else C=C+1|0;return Z=oe,m|0}function Lc(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0;S=gt(m|0,g|0,52)|0,te()|0,S=S&15,(m|0)==0&(g|0)==0|((v|0)>15|(S|0)>(v|0))?(M=-1,m=-1,g=0,S=0):(m=I2(m,g,S+1|0,v)|0,C=(te()|0)&-15728641,g=wt(v|0,0,52)|0,g=m|g,C=C|(te()|0),m=(wi(g,C)|0)==0,M=S,m=m?-1:v,S=C),C=A,p[C>>2]=g,p[C+4>>2]=S,p[A+8>>2]=M,p[A+12>>2]=m}function p0(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0;if(S=gt(A|0,m|0,52)|0,te()|0,S=S&15,M=v+8|0,p[M>>2]=S,(A|0)==0&(m|0)==0|((g|0)>15|(S|0)>(g|0))){g=v,p[g>>2]=0,p[g+4>>2]=0,p[M>>2]=-1,p[v+12>>2]=-1;return}if(A=I2(A,m,S+1|0,g)|0,M=(te()|0)&-15728641,S=wt(g|0,0,52)|0,S=A|S,M=M|(te()|0),A=v,p[A>>2]=S,p[A+4>>2]=M,A=v+12|0,wi(S,M)|0){p[A>>2]=g;return}else{p[A>>2]=-1;return}}function m0(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0;if(g=A,m=p[g>>2]|0,g=p[g+4>>2]|0,!((m|0)==0&(g|0)==0)&&(v=gt(m|0,g|0,52)|0,te()|0,v=v&15,N=wt(1,0,(v^15)*3|0)|0,m=Xt(N|0,te()|0,m|0,g|0)|0,g=te()|0,N=A,p[N>>2]=m,p[N+4>>2]=g,N=A+8|0,C=p[N>>2]|0,!((v|0)<(C|0)))){for(I=A+12|0,M=v;;){if((M|0)==(C|0)){v=5;break}if(V=(M|0)==(p[I>>2]|0),S=(15-M|0)*3|0,v=gt(m|0,g|0,S|0)|0,te()|0,v=v&7,V&((v|0)==1&!0)){v=7;break}if(!((v|0)==7&!0)){v=10;break}if(V=wt(1,0,S|0)|0,m=Xt(m|0,g|0,V|0,te()|0)|0,g=te()|0,V=A,p[V>>2]=m,p[V+4>>2]=g,(M|0)>(C|0))M=M+-1|0;else{v=10;break}}if((v|0)==5){V=A,p[V>>2]=0,p[V+4>>2]=0,p[N>>2]=-1,p[I>>2]=-1;return}else if((v|0)==7){C=wt(1,0,S|0)|0,C=Xt(m|0,g|0,C|0,te()|0)|0,N=te()|0,V=A,p[V>>2]=C,p[V+4>>2]=N,p[I>>2]=M+-1;return}else if((v|0)==10)return}}function wa(A){A=+A;var m=0;return m=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?m+-6.283185307179586:m)}function Ma(A,m){return A=A|0,m=m|0,+Tn(+(+J[A>>3]-+J[m>>3]))<17453292519943298e-27?(m=+Tn(+(+J[A+8>>3]-+J[m+8>>3]))<17453292519943298e-27,m|0):(m=0,m|0)}function Ks(A,m){switch(A=+A,m=m|0,m|0){case 1:{A=A<0?A+6.283185307179586:A;break}case 2:{A=A>0?A+-6.283185307179586:A;break}}return+A}function k2(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;return S=+J[m>>3],v=+J[A>>3],M=+on(+((S-v)*.5)),g=+on(+((+J[m+8>>3]-+J[A+8>>3])*.5)),g=M*M+g*(+ri(+S)*+ri(+v)*g),+(+De(+ +Zn(+g),+ +Zn(+(1-g)))*2)}function Ra(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;return S=+J[m>>3],v=+J[A>>3],M=+on(+((S-v)*.5)),g=+on(+((+J[m+8>>3]-+J[A+8>>3])*.5)),g=M*M+g*(+ri(+S)*+ri(+v)*g),+(+De(+ +Zn(+g),+ +Zn(+(1-g)))*2*6371.007180918475)}function G2(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;return S=+J[m>>3],v=+J[A>>3],M=+on(+((S-v)*.5)),g=+on(+((+J[m+8>>3]-+J[A+8>>3])*.5)),g=M*M+g*(+ri(+S)*+ri(+v)*g),+(+De(+ +Zn(+g),+ +Zn(+(1-g)))*2*6371.007180918475*1e3)}function z2(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0;return M=+J[m>>3],v=+ri(+M),S=+J[m+8>>3]-+J[A+8>>3],C=v*+on(+S),g=+J[A>>3],+ +De(+C,+(+on(+M)*+ri(+g)-+ri(+S)*(v*+on(+g))))}function V2(A,m,g,v){A=A|0,m=+m,g=+g,v=v|0;var S=0,M=0,C=0,N=0;if(g<1e-16){p[v>>2]=p[A>>2],p[v+4>>2]=p[A+4>>2],p[v+8>>2]=p[A+8>>2],p[v+12>>2]=p[A+12>>2];return}M=m<0?m+6.283185307179586:m,M=m>=6.283185307179586?M+-6.283185307179586:M;do if(M<1e-16)m=+J[A>>3]+g,J[v>>3]=m,S=v;else{if(S=+Tn(+(M+-3.141592653589793))<1e-16,m=+J[A>>3],S){m=m-g,J[v>>3]=m,S=v;break}if(C=+ri(+g),g=+on(+g),m=C*+on(+m)+ +ri(+M)*(g*+ri(+m)),m=m>1?1:m,m=+kl(+(m<-1?-1:m)),J[v>>3]=m,+Tn(+(m+-1.5707963267948966))<1e-16){J[v>>3]=1.5707963267948966,J[v+8>>3]=0;return}if(+Tn(+(m+1.5707963267948966))<1e-16){J[v>>3]=-1.5707963267948966,J[v+8>>3]=0;return}if(N=1/+ri(+m),M=g*+on(+M)*N,g=+J[A>>3],m=N*((C-+on(+m)*+on(+g))/+ri(+g)),C=M>1?1:M,m=m>1?1:m,m=+J[A+8>>3]+ +De(+(C<-1?-1:C),+(m<-1?-1:m)),m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);J[v+8>>3]=m;return}while(!1);if(+Tn(+(m+-1.5707963267948966))<1e-16){J[S>>3]=1.5707963267948966,J[v+8>>3]=0;return}if(+Tn(+(m+1.5707963267948966))<1e-16){J[S>>3]=-1.5707963267948966,J[v+8>>3]=0;return}if(m=+J[A+8>>3],m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);J[v+8>>3]=m}function q2(A,m){return A=A|0,m=m|0,A>>>0>15?(m=4,m|0):(J[m>>3]=+J[20656+(A<<3)>>3],m=0,m|0)}function V3(A,m){return A=A|0,m=m|0,A>>>0>15?(m=4,m|0):(J[m>>3]=+J[20784+(A<<3)>>3],m=0,m|0)}function q3(A,m){return A=A|0,m=m|0,A>>>0>15?(m=4,m|0):(J[m>>3]=+J[20912+(A<<3)>>3],m=0,m|0)}function H2(A,m){return A=A|0,m=m|0,A>>>0>15?(m=4,m|0):(J[m>>3]=+J[21040+(A<<3)>>3],m=0,m|0)}function g0(A,m){A=A|0,m=m|0;var g=0;return A>>>0>15?(m=4,m|0):(g=Ca(7,0,A,((A|0)<0)<<31>>31)|0,g=Ur(g|0,te()|0,120,0)|0,A=te()|0,p[m>>2]=g|2,p[m+4>>2]=A,m=0,m|0)}function _0(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0;return ge=+J[m>>3],j=+J[A>>3],I=+on(+((ge-j)*.5)),M=+J[m+8>>3],V=+J[A+8>>3],C=+on(+((M-V)*.5)),N=+ri(+j),oe=+ri(+ge),C=I*I+C*(oe*N*C),C=+De(+ +Zn(+C),+ +Zn(+(1-C)))*2,I=+J[g>>3],ge=+on(+((I-ge)*.5)),v=+J[g+8>>3],M=+on(+((v-M)*.5)),S=+ri(+I),M=ge*ge+M*(oe*S*M),M=+De(+ +Zn(+M),+ +Zn(+(1-M)))*2,I=+on(+((j-I)*.5)),v=+on(+((V-v)*.5)),v=I*I+v*(N*S*v),v=+De(+ +Zn(+v),+ +Zn(+(1-v)))*2,S=(C+M+v)*.5,+(+ue(+ +Zn(+(+$s(+(S*.5))*+$s(+((S-C)*.5))*+$s(+((S-M)*.5))*+$s(+((S-v)*.5)))))*4)}function Co(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0;if(N=Z,Z=Z+192|0,M=N+168|0,C=N,S=Eu(A,m,M)|0,S|0)return g=S,Z=N,g|0;if(Pc(A,m,C)|0&&Rt(27795,27190,415,27199),m=p[C>>2]|0,(m|0)>0){if(v=+_0(C+8|0,C+8+(((m|0)!=1&1)<<4)|0,M)+0,(m|0)!=1){A=1;do S=A,A=A+1|0,v=v+ +_0(C+8+(S<<4)|0,C+8+(((A|0)%(m|0)|0)<<4)|0,M);while((A|0)<(m|0))}}else v=0;return J[g>>3]=v,g=0,Z=N,g|0}function W2(A,m,g){return A=A|0,m=m|0,g=g|0,A=Co(A,m,g)|0,A|0||(J[g>>3]=+J[g>>3]*6371.007180918475*6371.007180918475),A|0}function $o(A,m,g){return A=A|0,m=m|0,g=g|0,A=Co(A,m,g)|0,A|0||(J[g>>3]=+J[g>>3]*6371.007180918475*6371.007180918475*1e3*1e3),A|0}function Yo(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(N=Z,Z=Z+176|0,C=N,A=h0(A,m,C)|0,A|0)return C=A,Z=N,C|0;if(J[g>>3]=0,A=p[C>>2]|0,(A|0)<=1)return C=0,Z=N,C|0;m=A+-1|0,A=0,v=+J[C+8>>3],S=+J[C+16>>3],M=0;do A=A+1|0,V=v,v=+J[C+8+(A<<4)>>3],j=+on(+((v-V)*.5)),I=S,S=+J[C+8+(A<<4)+8>>3],I=+on(+((S-I)*.5)),I=j*j+I*(+ri(+v)*+ri(+V)*I),M=M+ +De(+ +Zn(+I),+ +Zn(+(1-I)))*2;while((A|0)<(m|0));return J[g>>3]=M,C=0,Z=N,C|0}function Qh(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(N=Z,Z=Z+176|0,C=N,A=h0(A,m,C)|0,A|0)return C=A,M=+J[g>>3],M=M*6371.007180918475,J[g>>3]=M,Z=N,C|0;if(J[g>>3]=0,A=p[C>>2]|0,(A|0)<=1)return C=0,M=0,M=M*6371.007180918475,J[g>>3]=M,Z=N,C|0;m=A+-1|0,A=0,v=+J[C+8>>3],S=+J[C+16>>3],M=0;do A=A+1|0,V=v,v=+J[C+8+(A<<4)>>3],j=+on(+((v-V)*.5)),I=S,S=+J[C+8+(A<<4)+8>>3],I=+on(+((S-I)*.5)),I=j*j+I*(+ri(+V)*+ri(+v)*I),M=M+ +De(+ +Zn(+I),+ +Zn(+(1-I)))*2;while((A|0)!=(m|0));return J[g>>3]=M,C=0,j=M,j=j*6371.007180918475,J[g>>3]=j,Z=N,C|0}function Gg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(N=Z,Z=Z+176|0,C=N,A=h0(A,m,C)|0,A|0)return C=A,M=+J[g>>3],M=M*6371.007180918475,M=M*1e3,J[g>>3]=M,Z=N,C|0;if(J[g>>3]=0,A=p[C>>2]|0,(A|0)<=1)return C=0,M=0,M=M*6371.007180918475,M=M*1e3,J[g>>3]=M,Z=N,C|0;m=A+-1|0,A=0,v=+J[C+8>>3],S=+J[C+16>>3],M=0;do A=A+1|0,V=v,v=+J[C+8+(A<<4)>>3],j=+on(+((v-V)*.5)),I=S,S=+J[C+8+(A<<4)+8>>3],I=+on(+((S-I)*.5)),I=j*j+I*(+ri(+V)*+ri(+v)*I),M=M+ +De(+ +Zn(+I),+ +Zn(+(1-I)))*2;while((A|0)!=(m|0));return J[g>>3]=M,C=0,j=M,j=j*6371.007180918475,j=j*1e3,J[g>>3]=j,Z=N,C|0}function y0(A){A=A|0;var m=0,g=0,v=0;return m=Ko(1,12)|0,m||Rt(27280,27235,49,27293),g=A+4|0,v=p[g>>2]|0,v|0?(v=v+8|0,p[v>>2]=m,p[g>>2]=m,m|0):(p[A>>2]|0&&Rt(27310,27235,61,27333),v=A,p[v>>2]=m,p[g>>2]=m,m|0)}function v0(A,m){A=A|0,m=m|0;var g=0,v=0;return v=hl(24)|0,v||Rt(27347,27235,78,27361),p[v>>2]=p[m>>2],p[v+4>>2]=p[m+4>>2],p[v+8>>2]=p[m+8>>2],p[v+12>>2]=p[m+12>>2],p[v+16>>2]=0,m=A+4|0,g=p[m>>2]|0,g|0?(p[g+16>>2]=v,p[m>>2]=v,v|0):(p[A>>2]|0&&Rt(27376,27235,82,27361),p[A>>2]=v,p[m>>2]=v,v|0)}function x0(A){A=A|0;var m=0,g=0,v=0,S=0;if(A)for(v=1;;){if(m=p[A>>2]|0,m|0)do{if(g=p[m>>2]|0,g|0)do S=g,g=p[g+16>>2]|0,xn(S);while((g|0)!=0);S=m,m=p[m+8>>2]|0,xn(S)}while((m|0)!=0);if(m=A,A=p[A+8>>2]|0,v||xn(m),A)v=0;else break}}function Kh(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0,tn=0,Yn=0,fn=0,Kt=0,Et=0,Ln=0,xi=0,kn=0;if(S=A+8|0,p[S>>2]|0)return kn=1,kn|0;if(v=p[A>>2]|0,!v)return kn=0,kn|0;m=v,g=0;do g=g+1|0,m=p[m+8>>2]|0;while((m|0)!=0);if(g>>>0<2)return kn=0,kn|0;Ln=hl(g<<2)|0,Ln||Rt(27396,27235,317,27415),Et=hl(g<<5)|0,Et||Rt(27437,27235,321,27415),p[A>>2]=0,Yt=A+4|0,p[Yt>>2]=0,p[S>>2]=0,g=0,Kt=0,Mt=0,oe=0;e:for(;;){if(j=p[v>>2]|0,j){M=0,C=j;do{if(I=+J[C+8>>3],m=C,C=p[C+16>>2]|0,V=(C|0)==0,S=V?j:C,N=+J[S+8>>3],+Tn(+(I-N))>3.141592653589793){kn=14;break}M=M+(N-I)*(+J[m>>3]+ +J[S>>3])}while(!V);if((kn|0)==14){kn=0,M=0,m=j;do Ee=+J[m+8>>3],fn=m+16|0,Yn=p[fn>>2]|0,Yn=(Yn|0)==0?j:Yn,Le=+J[Yn+8>>3],M=M+(+J[m>>3]+ +J[Yn>>3])*((Le<0?Le+6.283185307179586:Le)-(Ee<0?Ee+6.283185307179586:Ee)),m=p[((m|0)==0?v:fn)>>2]|0;while((m|0)!=0)}M>0?(p[Ln+(Kt<<2)>>2]=v,Kt=Kt+1|0,S=Mt,m=oe):kn=19}else kn=19;if((kn|0)==19){kn=0;do if(g){if(m=g+8|0,p[m>>2]|0){kn=21;break e}if(g=Ko(1,12)|0,!g){kn=23;break e}p[m>>2]=g,S=g+4|0,C=g,m=oe}else if(oe){S=Yt,C=oe+8|0,m=v,g=A;break}else if(p[A>>2]|0){kn=27;break e}else{S=Yt,C=A,m=v,g=A;break}while(!1);if(p[C>>2]=v,p[S>>2]=v,C=Et+(Mt<<5)|0,V=p[v>>2]|0,V){for(j=Et+(Mt<<5)+8|0,J[j>>3]=17976931348623157e292,oe=Et+(Mt<<5)+24|0,J[oe>>3]=17976931348623157e292,J[C>>3]=-17976931348623157e292,ge=Et+(Mt<<5)+16|0,J[ge>>3]=-17976931348623157e292,Ve=17976931348623157e292,Be=-17976931348623157e292,S=0,de=V,I=17976931348623157e292,Te=17976931348623157e292,Ne=-17976931348623157e292,N=-17976931348623157e292;M=+J[de>>3],Ee=+J[de+8>>3],de=p[de+16>>2]|0,Ae=(de|0)==0,Le=+J[(Ae?V:de)+8>>3],M<I&&(J[j>>3]=M,I=M),Ee<Te&&(J[oe>>3]=Ee,Te=Ee),M>Ne?J[C>>3]=M:M=Ne,Ee>N&&(J[ge>>3]=Ee,N=Ee),Ve=Ee>0&Ee<Ve?Ee:Ve,Be=Ee<0&Ee>Be?Ee:Be,S=S|+Tn(+(Ee-Le))>3.141592653589793,!Ae;)Ne=M;S&&(J[ge>>3]=Be,J[oe>>3]=Ve)}else p[C>>2]=0,p[C+4>>2]=0,p[C+8>>2]=0,p[C+12>>2]=0,p[C+16>>2]=0,p[C+20>>2]=0,p[C+24>>2]=0,p[C+28>>2]=0;S=Mt+1|0}if(fn=v+8|0,v=p[fn>>2]|0,p[fn>>2]=0,v)Mt=S,oe=m;else{kn=45;break}}if((kn|0)==21)Rt(27213,27235,35,27247);else if((kn|0)==23)Rt(27267,27235,37,27247);else if((kn|0)==27)Rt(27310,27235,61,27333);else if((kn|0)==45){e:do if((Kt|0)>0){for(fn=(S|0)==0,tn=S<<2,Yn=(A|0)==0,Wt=0,m=0;;){if(yt=p[Ln+(Wt<<2)>>2]|0,fn)kn=73;else{if(Mt=hl(tn)|0,!Mt){kn=50;break}if(Yt=hl(tn)|0,!Yt){kn=52;break}t:do if(Yn)g=0;else{for(S=0,g=0,C=A;v=Et+(S<<5)|0,zg(p[C>>2]|0,v,p[yt>>2]|0)|0?(p[Mt+(g<<2)>>2]=C,p[Yt+(g<<2)>>2]=v,Ae=g+1|0):Ae=g,C=p[C+8>>2]|0,C;)S=S+1|0,g=Ae;if((Ae|0)>0)if(v=p[Mt>>2]|0,(Ae|0)==1)g=v;else for(ge=0,de=-1,g=v,oe=v;;){for(V=p[oe>>2]|0,v=0,C=0;S=p[p[Mt+(C<<2)>>2]>>2]|0,(S|0)==(V|0)?j=v:j=v+((zg(S,p[Yt+(C<<2)>>2]|0,p[V>>2]|0)|0)&1)|0,C=C+1|0,(C|0)!=(Ae|0);)v=j;if(S=(j|0)>(de|0),g=S?oe:g,v=ge+1|0,(v|0)==(Ae|0))break t;ge=v,de=S?j:de,oe=p[Mt+(v<<2)>>2]|0}else g=0}while(!1);if(xn(Mt),xn(Yt),g){if(S=g+4|0,v=p[S>>2]|0,v)g=v+8|0;else if(p[g>>2]|0){kn=70;break}p[g>>2]=yt,p[S>>2]=yt}else kn=73}if((kn|0)==73){if(kn=0,m=p[yt>>2]|0,m|0)do Yt=m,m=p[m+16>>2]|0,xn(Yt);while((m|0)!=0);xn(yt),m=1}if(Wt=Wt+1|0,(Wt|0)>=(Kt|0)){xi=m;break e}}(kn|0)==50?Rt(27452,27235,249,27471):(kn|0)==52?Rt(27490,27235,252,27471):(kn|0)==70&&Rt(27310,27235,61,27333)}else xi=0;while(!1);return xn(Ln),xn(Et),kn=xi,kn|0}return 0}function zg(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(!(sl(m,g)|0)||(m=a0(m)|0,v=+J[g>>3],S=+J[g+8>>3],S=m&S<0?S+6.283185307179586:S,A=p[A>>2]|0,!A))return A=0,A|0;if(m){m=0,V=S,g=A;e:for(;;){for(;C=+J[g>>3],S=+J[g+8>>3],g=g+16|0,j=p[g>>2]|0,j=(j|0)==0?A:j,M=+J[j>>3],N=+J[j+8>>3],C>M?(I=C,C=N):(I=M,M=C,C=S,S=N),v=v==M|v==I?v+2220446049250313e-31:v,!!(v<M|v>I);)if(g=p[g>>2]|0,!g){g=22;break e}if(N=C<0?C+6.283185307179586:C,C=S<0?S+6.283185307179586:S,V=N==V|C==V?V+-2220446049250313e-31:V,I=N+(C-N)*((v-M)/(I-M)),(I<0?I+6.283185307179586:I)>V&&(m=m^1),g=p[g>>2]|0,!g){g=22;break}}if((g|0)==22)return m|0}else{m=0,V=S,g=A;e:for(;;){for(;C=+J[g>>3],S=+J[g+8>>3],g=g+16|0,j=p[g>>2]|0,j=(j|0)==0?A:j,M=+J[j>>3],N=+J[j+8>>3],C>M?(I=C,C=N):(I=M,M=C,C=S,S=N),v=v==M|v==I?v+2220446049250313e-31:v,!!(v<M|v>I);)if(g=p[g>>2]|0,!g){g=22;break e}if(V=C==V|S==V?V+-2220446049250313e-31:V,C+(S-C)*((v-M)/(I-M))>V&&(m=m^1),g=p[g>>2]|0,!g){g=22;break}}if((g|0)==22)return m|0}return 0}function Qo(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0;if(Be=Z,Z=Z+32|0,Ve=Be+16|0,Ne=Be,M=gt(A|0,m|0,52)|0,te()|0,M=M&15,de=gt(g|0,v|0,52)|0,te()|0,(M|0)!=(de&15|0))return Ve=12,Z=Be,Ve|0;if(V=gt(A|0,m|0,45)|0,te()|0,V=V&127,j=gt(g|0,v|0,45)|0,te()|0,j=j&127,V>>>0>121|j>>>0>121)return Ve=5,Z=Be,Ve|0;if(de=(V|0)!=(j|0),de){if(N=vd(V,j)|0,(N|0)==7)return Ve=1,Z=Be,Ve|0;I=vd(j,V)|0,(I|0)==7?Rt(27514,27538,161,27548):(Ae=N,C=I)}else Ae=0,C=0;oe=dr(V)|0,ge=dr(j)|0,p[Ve>>2]=0,p[Ve+4>>2]=0,p[Ve+8>>2]=0,p[Ve+12>>2]=0;do if(Ae){if(j=p[4272+(V*28|0)+(Ae<<2)>>2]|0,N=(j|0)>0,ge)if(N){V=0,I=g,N=v;do I=G3(I,N)|0,N=te()|0,C=zl(C)|0,(C|0)==1&&(C=zl(1)|0),V=V+1|0;while((V|0)!=(j|0));j=C,V=I,I=N}else j=C,V=g,I=v;else if(N){V=0,I=g,N=v;do I=Og(I,N)|0,N=te()|0,C=zl(C)|0,V=V+1|0;while((V|0)!=(j|0));j=C,V=I,I=N}else j=C,V=g,I=v;if(Qs(V,I,Ve)|0,de||Rt(27563,27538,191,27548),N=(oe|0)!=0,C=(ge|0)!=0,N&C&&Rt(27590,27538,192,27548),N){if(C=Ys(A,m)|0,(C|0)==7){M=5;break}if(rt[22e3+(C*7|0)+Ae>>0]|0){M=1;break}I=p[21168+(C*28|0)+(Ae<<2)>>2]|0,V=I}else if(C){if(C=Ys(V,I)|0,(C|0)==7){M=5;break}if(rt[22e3+(C*7|0)+j>>0]|0){M=1;break}V=0,I=p[21168+(j*28|0)+(C<<2)>>2]|0}else V=0,I=0;if((V|I|0)<0)M=5;else{if((I|0)>0){N=Ve+4|0,C=0;do c0(N),C=C+1|0;while((C|0)!=(I|0))}if(p[Ne>>2]=0,p[Ne+4>>2]=0,p[Ne+8>>2]=0,M2(Ne,Ae),M|0)for(;Xo(M)|0?jh(Ne):Rc(Ne),(M|0)>1;)M=M+-1|0;if((V|0)>0){M=0;do c0(Ne),M=M+1|0;while((M|0)!=(V|0))}Te=Ve+4|0,xs(Te,Ne,Te),jr(Te),Te=51}}else if(Qs(g,v,Ve)|0,(oe|0)!=0&(ge|0)!=0)if((j|0)!=(V|0)&&Rt(27621,27538,261,27548),C=Ys(A,m)|0,M=Ys(g,v)|0,(C|0)==7|(M|0)==7)M=5;else if(rt[22e3+(C*7|0)+M>>0]|0)M=1;else if(C=p[21168+(C*28|0)+(M<<2)>>2]|0,(C|0)>0){N=Ve+4|0,M=0;do c0(N),M=M+1|0;while((M|0)!=(C|0));Te=51}else Te=51;else Te=51;while(!1);return(Te|0)==51&&(M=Ve+4|0,p[S>>2]=p[M>>2],p[S+4>>2]=p[M+4>>2],p[S+8>>2]=p[M+8>>2],M=0),Ve=M,Z=Be,Ve|0}function Oc(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0;if(Te=Z,Z=Z+48|0,V=Te+36|0,C=Te+24|0,N=Te+12|0,I=Te,S=gt(A|0,m|0,52)|0,te()|0,S=S&15,ge=gt(A|0,m|0,45)|0,te()|0,ge=ge&127,ge>>>0>121)return v=5,Z=Te,v|0;if(j=dr(ge)|0,wt(S|0,0,52)|0,Ne=te()|0|134225919,M=v,p[M>>2]=-1,p[M+4>>2]=Ne,!S)return S=Mc(g)|0,(S|0)==7||(S=o0(ge,S)|0,(S|0)==127)?(Ne=1,Z=Te,Ne|0):(de=wt(S|0,0,45)|0,Ae=te()|0,ge=v,Ae=p[ge+4>>2]&-1040385|Ae,Ne=v,p[Ne>>2]=p[ge>>2]|de,p[Ne+4>>2]=Ae,Ne=0,Z=Te,Ne|0);for(p[V>>2]=p[g>>2],p[V+4>>2]=p[g+4>>2],p[V+8>>2]=p[g+8>>2],g=S;;){if(M=g,g=g+-1|0,p[C>>2]=p[V>>2],p[C+4>>2]=p[V+4>>2],p[C+8>>2]=p[V+8>>2],Xo(M)|0){if(S=E2(V)|0,S|0){g=13;break}p[N>>2]=p[V>>2],p[N+4>>2]=p[V+4>>2],p[N+8>>2]=p[V+8>>2],jh(N)}else{if(S=M3(V)|0,S|0){g=13;break}p[N>>2]=p[V>>2],p[N+4>>2]=p[V+4>>2],p[N+8>>2]=p[V+8>>2],Rc(N)}if(wd(C,N,I),jr(I),S=v,Be=p[S>>2]|0,S=p[S+4>>2]|0,Le=(15-M|0)*3|0,Ve=wt(7,0,Le|0)|0,S=S&~(te()|0),Le=wt(Mc(I)|0,0,Le|0)|0,S=te()|0|S,Ne=v,p[Ne>>2]=Le|Be&~Ve,p[Ne+4>>2]=S,(M|0)<=1){g=14;break}}e:do if((g|0)!=13&&(g|0)==14)if((p[V>>2]|0)<=1&&(p[V+4>>2]|0)<=1&&(p[V+8>>2]|0)<=1){g=Mc(V)|0,S=o0(ge,g)|0,(S|0)==127?I=0:I=dr(S)|0;t:do if(g){if(j){if(S=Ys(A,m)|0,(S|0)==7){S=5;break e}if(M=p[21376+(S*28|0)+(g<<2)>>2]|0,(M|0)>0){S=g,g=0;do S=Cc(S)|0,g=g+1|0;while((g|0)!=(M|0))}else S=g;if((S|0)==1){S=9;break e}g=o0(ge,S)|0,(g|0)==127&&Rt(27648,27538,411,27678),dr(g)|0?Rt(27693,27538,412,27678):(Ae=g,de=M,oe=S)}else Ae=S,de=0,oe=g;if(N=p[4272+(ge*28|0)+(oe<<2)>>2]|0,(N|0)<=-1&&Rt(27724,27538,419,27678),!I){if((de|0)<0){S=5;break e}if(de|0){M=v,S=0,g=p[M>>2]|0,M=p[M+4>>2]|0;do g=Tu(g,M)|0,M=te()|0,Le=v,p[Le>>2]=g,p[Le+4>>2]=M,S=S+1|0;while((S|0)<(de|0))}if((N|0)<=0){S=Ae,g=58;break}for(M=v,S=0,g=p[M>>2]|0,M=p[M+4>>2]|0;;)if(g=Tu(g,M)|0,M=te()|0,Le=v,p[Le>>2]=g,p[Le+4>>2]=M,S=S+1|0,(S|0)==(N|0)){S=Ae,g=58;break t}}if(C=vd(Ae,ge)|0,(C|0)==7&&Rt(27514,27538,428,27678),S=v,g=p[S>>2]|0,S=p[S+4>>2]|0,(N|0)>0){M=0;do g=Tu(g,S)|0,S=te()|0,Le=v,p[Le>>2]=g,p[Le+4>>2]=S,M=M+1|0;while((M|0)!=(N|0))}if(S=Ys(g,S)|0,(S|0)==7&&Rt(27795,27538,440,27678),g=xg(Ae)|0,g=p[(g?21792:21584)+(C*28|0)+(S<<2)>>2]|0,(g|0)<0&&Rt(27795,27538,454,27678),!g)S=Ae,g=58;else{C=v,S=0,M=p[C>>2]|0,C=p[C+4>>2]|0;do M=A0(M,C)|0,C=te()|0,Le=v,p[Le>>2]=M,p[Le+4>>2]=C,S=S+1|0;while((S|0)<(g|0));S=Ae,g=58}}else if((j|0)!=0&(I|0)!=0){if(g=Ys(A,m)|0,M=v,M=Ys(p[M>>2]|0,p[M+4>>2]|0)|0,(g|0)==7|(M|0)==7){S=5;break e}if(M=p[21376+(g*28|0)+(M<<2)>>2]|0,(M|0)<0){S=5;break e}if(!M)g=59;else{N=v,g=0,C=p[N>>2]|0,N=p[N+4>>2]|0;do C=Tu(C,N)|0,N=te()|0,Le=v,p[Le>>2]=C,p[Le+4>>2]=N,g=g+1|0;while((g|0)<(M|0));g=58}}else g=58;while(!1);if((g|0)==58&&I&&(g=59),(g|0)==59&&(Le=v,(Ys(p[Le>>2]|0,p[Le+4>>2]|0)|0)==1)){S=9;break}Le=v,Ve=p[Le>>2]|0,Le=p[Le+4>>2]&-1040385,Be=wt(S|0,0,45)|0,Le=Le|(te()|0),S=v,p[S>>2]=Ve|Be,p[S+4>>2]=Le,S=0}else S=1;while(!1);return Le=S,Z=Te,Le|0}function H3(A,m,g,v,S,M){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0;var C=0,N=0;return N=Z,Z=Z+16|0,C=N,S?A=15:(A=Qo(A,m,g,v,C)|0,A||(C3(C,M),A=0)),Z=N,A|0}function No(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0;return C=Z,Z=Z+16|0,M=C,v?g=15:(g=wg(g,M)|0,g||(g=Oc(A,m,M,S)|0)),Z=C,g|0}function Vg(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0;return I=Z,Z=Z+32|0,C=I+12|0,N=I,M=Qo(A,m,A,m,C)|0,M|0?(N=M,Z=I,N|0):(A=Qo(A,m,g,v,N)|0,A|0?(N=A,Z=I,N|0):(C=Eg(C,N)|0,N=S,p[N>>2]=C,p[N+4>>2]=((C|0)<0)<<31>>31,N=0,Z=I,N|0))}function Vl(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0;return I=Z,Z=Z+32|0,C=I+12|0,N=I,M=Qo(A,m,A,m,C)|0,!M&&(M=Qo(A,m,g,v,N)|0,!M)?(v=Eg(C,N)|0,v=Xt(v|0,((v|0)<0)<<31>>31|0,1,0)|0,C=te()|0,N=S,p[N>>2]=v,p[N+4>>2]=C,N=0,Z=I,N|0):(N=M,Z=I,N|0)}function j2(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0;if(yt=Z,Z=Z+48|0,Mt=yt+24|0,C=yt+12|0,Yt=yt,M=Qo(A,m,A,m,Mt)|0,!M&&(M=Qo(A,m,g,v,C)|0,!M)){Le=Eg(Mt,C)|0,Ee=((Le|0)<0)<<31>>31,p[Mt>>2]=0,p[Mt+4>>2]=0,p[Mt+8>>2]=0,p[C>>2]=0,p[C+4>>2]=0,p[C+8>>2]=0,Qo(A,m,A,m,Mt)|0&&Rt(27795,27538,692,27747),Qo(A,m,g,v,C)|0&&Rt(27795,27538,697,27747),D2(Mt),D2(C),j=(Le|0)==0?0:1/+(Le|0),g=p[Mt>>2]|0,Te=j*+((p[C>>2]|0)-g|0),Ne=Mt+4|0,v=p[Ne>>2]|0,Ve=j*+((p[C+4>>2]|0)-v|0),Be=Mt+8|0,M=p[Be>>2]|0,j=j*+((p[C+8>>2]|0)-M|0),p[Yt>>2]=g,oe=Yt+4|0,p[oe>>2]=v,ge=Yt+8|0,p[ge>>2]=M;e:do if((Le|0)<0)M=0;else for(de=0,Ae=0;;){I=+(Ae>>>0)+4294967296*+(de|0),Wt=Te*I+ +(g|0),N=Ve*I+ +(v|0),I=j*I+ +(M|0),g=~~+Ru(+Wt),C=~~+Ru(+N),M=~~+Ru(+I),Wt=+Tn(+(+(g|0)-Wt)),N=+Tn(+(+(C|0)-N)),I=+Tn(+(+(M|0)-I));do if(Wt>N&Wt>I)g=0-(C+M)|0,v=C;else if(V=0-g|0,N>I){v=V-M|0;break}else{v=C,M=V-C|0;break}while(!1);if(p[Yt>>2]=g,p[oe>>2]=v,p[ge>>2]=M,N3(Yt),M=Oc(A,m,Yt,S+(Ae<<3)|0)|0,M|0)break e;if(!((de|0)<(Ee|0)|(de|0)==(Ee|0)&Ae>>>0<Le>>>0)){M=0;break e}g=Xt(Ae|0,de|0,1,0)|0,v=te()|0,de=v,Ae=g,g=p[Mt>>2]|0,v=p[Ne>>2]|0,M=p[Be>>2]|0}while(!1);return Yt=M,Z=yt,Yt|0}return Yt=M,Z=yt,Yt|0}function Ca(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0;if((g|0)==0&(v|0)==0)return S=0,M=1,ct(S|0),M|0;M=A,S=m,A=1,m=0;do C=(g&1|0)==0&!0,A=Ur((C?1:M)|0,(C?0:S)|0,A|0,m|0)|0,m=te()|0,g=$2(g|0,v|0,1)|0,v=te()|0,M=Ur(M|0,S|0,M|0,S|0)|0,S=te()|0;while(!((g|0)==0&(v|0)==0));return ct(m|0),A|0}function ql(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0;N=Z,Z=Z+16|0,M=N,C=gt(A|0,m|0,52)|0,te()|0,C=C&15;do if(C){if(S=Eu(A,m,M)|0,!S){V=+J[M>>3],I=1/+ri(+V),j=+J[25968+(C<<3)>>3],J[g>>3]=V+j,J[g+8>>3]=V-j,V=+J[M+8>>3],I=j*I,J[g+16>>3]=I+V,J[g+24>>3]=V-I;break}return C=S,Z=N,C|0}else{if(S=gt(A|0,m|0,45)|0,te()|0,S=S&127,S>>>0>121)return C=5,Z=N,C|0;M=22064+(S<<5)|0,p[g>>2]=p[M>>2],p[g+4>>2]=p[M+4>>2],p[g+8>>2]=p[M+8>>2],p[g+12>>2]=p[M+12>>2],p[g+16>>2]=p[M+16>>2],p[g+20>>2]=p[M+20>>2],p[g+24>>2]=p[M+24>>2],p[g+28>>2]=p[M+28>>2];break}while(!1);return fo(g,v?1.4:1.1),v=26096+(C<<3)|0,(p[v>>2]|0)==(A|0)&&(p[v+4>>2]|0)==(m|0)&&(J[g>>3]=1.5707963267948966),C=26224+(C<<3)|0,(p[C>>2]|0)==(A|0)&&(p[C+4>>2]|0)==(m|0)&&(J[g+8>>3]=-1.5707963267948966),+J[g>>3]!=1.5707963267948966&&+J[g+8>>3]!=-1.5707963267948966?(C=0,Z=N,C|0):(J[g+16>>3]=3.141592653589793,J[g+24>>3]=-3.141592653589793,C=0,Z=N,C|0)}function qg(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0;V=Z,Z=Z+48|0,C=V+32|0,M=V+40|0,N=V,Dg(C,0,0,0),I=p[C>>2]|0,C=p[C+4>>2]|0;do if(g>>>0<=15){if(S=Ls(v)|0,S|0){v=N,p[v>>2]=0,p[v+4>>2]=0,p[N+8>>2]=S,p[N+12>>2]=-1,v=N+16|0,I=N+29|0,p[v>>2]=0,p[v+4>>2]=0,p[v+8>>2]=0,rt[v+12>>0]=0,rt[I>>0]=rt[M>>0]|0,rt[I+1>>0]=rt[M+1>>0]|0,rt[I+2>>0]=rt[M+2>>0]|0;break}if(S=Ko((p[m+8>>2]|0)+1|0,32)|0,S){Hl(m,S),j=N,p[j>>2]=I,p[j+4>>2]=C,p[N+8>>2]=0,p[N+12>>2]=g,p[N+16>>2]=v,p[N+20>>2]=m,p[N+24>>2]=S,rt[N+28>>0]=0,I=N+29|0,rt[I>>0]=rt[M>>0]|0,rt[I+1>>0]=rt[M+1>>0]|0,rt[I+2>>0]=rt[M+2>>0]|0;break}else{v=N,p[v>>2]=0,p[v+4>>2]=0,p[N+8>>2]=13,p[N+12>>2]=-1,v=N+16|0,I=N+29|0,p[v>>2]=0,p[v+4>>2]=0,p[v+8>>2]=0,rt[v+12>>0]=0,rt[I>>0]=rt[M>>0]|0,rt[I+1>>0]=rt[M+1>>0]|0,rt[I+2>>0]=rt[M+2>>0]|0;break}}else I=N,p[I>>2]=0,p[I+4>>2]=0,p[N+8>>2]=4,p[N+12>>2]=-1,I=N+16|0,j=N+29|0,p[I>>2]=0,p[I+4>>2]=0,p[I+8>>2]=0,rt[I+12>>0]=0,rt[j>>0]=rt[M>>0]|0,rt[j+1>>0]=rt[M+1>>0]|0,rt[j+2>>0]=rt[M+2>>0]|0;while(!1);Zh(N),p[A>>2]=p[N>>2],p[A+4>>2]=p[N+4>>2],p[A+8>>2]=p[N+8>>2],p[A+12>>2]=p[N+12>>2],p[A+16>>2]=p[N+16>>2],p[A+20>>2]=p[N+20>>2],p[A+24>>2]=p[N+24>>2],p[A+28>>2]=p[N+28>>2],Z=V}function Zh(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0;if(Ee=Z,Z=Z+336|0,de=Ee+168|0,Ae=Ee,v=A,g=p[v>>2]|0,v=p[v+4>>2]|0,(g|0)==0&(v|0)==0){Z=Ee;return}if(m=A+28|0,rt[m>>0]|0?(g=Ic(g,v)|0,v=te()|0):rt[m>>0]=1,Le=A+20|0,!(p[p[Le>>2]>>2]|0)){m=A+24|0,g=p[m>>2]|0,g|0&&xn(g),Be=A,p[Be>>2]=0,p[Be+4>>2]=0,p[A+8>>2]=0,p[Le>>2]=0,p[A+12>>2]=-1,p[A+16>>2]=0,p[m>>2]=0,Z=Ee;return}Be=A+16|0,m=p[Be>>2]|0,S=m&15;e:do if((g|0)==0&(v|0)==0)Ve=A+24|0;else{Te=A+12|0,oe=(S|0)==3,j=m&255,I=(S|1|0)==3,ge=A+24|0,V=(S+-1|0)>>>0<3,C=(S|2|0)==3,N=Ae+8|0;t:for(;;){if(M=gt(g|0,v|0,52)|0,te()|0,M=M&15,(M|0)==(p[Te>>2]|0)){switch(j&15){case 0:case 2:case 3:{if(S=Eu(g,v,de)|0,S|0){Ne=15;break t}if(Na(p[Le>>2]|0,p[ge>>2]|0,de)|0){Ne=19;break t}break}}if(I&&(S=p[(p[Le>>2]|0)+4>>2]|0,p[de>>2]=p[S>>2],p[de+4>>2]=p[S+4>>2],p[de+8>>2]=p[S+8>>2],p[de+12>>2]=p[S+12>>2],sl(26832,de)|0)){if(Ig(p[(p[Le>>2]|0)+4>>2]|0,M,Ae)|0){Ne=25;break}if(S=Ae,(p[S>>2]|0)==(g|0)&&(p[S+4>>2]|0)==(v|0)){Ne=29;break}}if(V){if(S=Pc(g,v,de)|0,S|0){Ne=32;break}if(ql(g,v,Ae,0)|0){Ne=36;break}if(C&&al(p[Le>>2]|0,p[ge>>2]|0,de,Ae)|0){Ne=42;break}if(I&&Hg(p[Le>>2]|0,p[ge>>2]|0,de,Ae)|0){Ne=42;break}}if(oe){if(m=ql(g,v,de,1)|0,S=p[ge>>2]|0,m|0){Ne=45;break}if(Sd(S,de)|0){if(Td(Ae,de),Tg(de,p[ge>>2]|0)|0){Ne=53;break}if(Na(p[Le>>2]|0,p[ge>>2]|0,N)|0){Ne=53;break}if(Hg(p[Le>>2]|0,p[ge>>2]|0,Ae,de)|0){Ne=53;break}}}}do if((M|0)<(p[Te>>2]|0)){if(m=ql(g,v,de,1)|0,S=p[ge>>2]|0,m|0){Ne=58;break t}if(!(Sd(S,de)|0)){Ne=73;break}if(Tg(p[ge>>2]|0,de)|0&&(Td(Ae,de),al(p[Le>>2]|0,p[ge>>2]|0,Ae,de)|0)){Ne=65;break t}if(g=Cd(g,v,M+1|0,Ae)|0,g|0){Ne=67;break t}v=Ae,g=p[v>>2]|0,v=p[v+4>>2]|0}else Ne=73;while(!1);if((Ne|0)==73&&(Ne=0,g=Ic(g,v)|0,v=te()|0),(g|0)==0&(v|0)==0){Ve=ge;break e}}switch(Ne|0){case 15:{m=p[ge>>2]|0,m|0&&xn(m),Ne=A,p[Ne>>2]=0,p[Ne+4>>2]=0,p[Le>>2]=0,p[Te>>2]=-1,p[Be>>2]=0,p[ge>>2]=0,p[A+8>>2]=S,Ne=20;break}case 19:{p[A>>2]=g,p[A+4>>2]=v,Ne=20;break}case 25:{Rt(27795,27761,470,27772);break}case 29:{p[A>>2]=g,p[A+4>>2]=v,Z=Ee;return}case 32:{m=p[ge>>2]|0,m|0&&xn(m),Ve=A,p[Ve>>2]=0,p[Ve+4>>2]=0,p[Le>>2]=0,p[Te>>2]=-1,p[Be>>2]=0,p[ge>>2]=0,p[A+8>>2]=S,Z=Ee;return}case 36:{Rt(27795,27761,493,27772);break}case 42:{p[A>>2]=g,p[A+4>>2]=v,Z=Ee;return}case 45:{S|0&&xn(S),Ne=A,p[Ne>>2]=0,p[Ne+4>>2]=0,p[Le>>2]=0,p[Te>>2]=-1,p[Be>>2]=0,p[ge>>2]=0,p[A+8>>2]=m,Ne=55;break}case 53:{p[A>>2]=g,p[A+4>>2]=v,Ne=55;break}case 58:{S|0&&xn(S),Ne=A,p[Ne>>2]=0,p[Ne+4>>2]=0,p[Le>>2]=0,p[Te>>2]=-1,p[Be>>2]=0,p[ge>>2]=0,p[A+8>>2]=m,Ne=71;break}case 65:{p[A>>2]=g,p[A+4>>2]=v,Ne=71;break}case 67:{m=p[ge>>2]|0,m|0&&xn(m),Ve=A,p[Ve>>2]=0,p[Ve+4>>2]=0,p[Le>>2]=0,p[Te>>2]=-1,p[Be>>2]=0,p[ge>>2]=0,p[A+8>>2]=g,Z=Ee;return}}if((Ne|0)==20){Z=Ee;return}else if((Ne|0)==55){Z=Ee;return}else if((Ne|0)==71){Z=Ee;return}}while(!1);m=p[Ve>>2]|0,m|0&&xn(m),Ne=A,p[Ne>>2]=0,p[Ne+4>>2]=0,p[A+8>>2]=0,p[Le>>2]=0,p[A+12>>2]=-1,p[Be>>2]=0,p[Ve>>2]=0,Z=Ee}function Ic(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0;oe=Z,Z=Z+16|0,j=oe,v=gt(A|0,m|0,52)|0,te()|0,v=v&15,g=gt(A|0,m|0,45)|0,te()|0;do if(v){for(;g=wt(v+4095|0,0,52)|0,S=te()|0|m&-15728641,M=(15-v|0)*3|0,C=wt(7,0,M|0)|0,N=te()|0,g=g|A|C,S=S|N,I=gt(A|0,m|0,M|0)|0,te()|0,I=I&7,v=v+-1|0,!(I>>>0<6);)if(v)m=S,A=g;else{V=4;break}if((V|0)==4){g=gt(g|0,S|0,45)|0,te()|0;break}return j=(I|0)==0&(wi(g,S)|0)!=0,j=wt((j?2:1)+I|0,0,M|0)|0,V=te()|0|m&~N,j=j|A&~C,ct(V|0),Z=oe,j|0}while(!1);return g=g&127,g>>>0>120?(V=0,j=0,ct(V|0),Z=oe,j|0):(Dg(j,0,g+1|0,0),V=p[j+4>>2]|0,j=p[j>>2]|0,ct(V|0),Z=oe,j|0)}function Jh(A,m,g,v,S,M){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0,M=M|0;var C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0;Ne=Z,Z=Z+160|0,oe=Ne+80|0,N=Ne+64|0,ge=Ne+112|0,Te=Ne,qg(oe,A,m,g),V=oe,Lc(N,p[V>>2]|0,p[V+4>>2]|0,m),V=N,I=p[V>>2]|0,V=p[V+4>>2]|0,C=p[oe+8>>2]|0,de=ge+4|0,p[de>>2]=p[oe>>2],p[de+4>>2]=p[oe+4>>2],p[de+8>>2]=p[oe+8>>2],p[de+12>>2]=p[oe+12>>2],p[de+16>>2]=p[oe+16>>2],p[de+20>>2]=p[oe+20>>2],p[de+24>>2]=p[oe+24>>2],p[de+28>>2]=p[oe+28>>2],de=Te,p[de>>2]=I,p[de+4>>2]=V,de=Te+8|0,p[de>>2]=C,A=Te+12|0,m=ge,g=A+36|0;do p[A>>2]=p[m>>2],A=A+4|0,m=m+4|0;while((A|0)<(g|0));if(ge=Te+48|0,p[ge>>2]=p[N>>2],p[ge+4>>2]=p[N+4>>2],p[ge+8>>2]=p[N+8>>2],p[ge+12>>2]=p[N+12>>2],(I|0)==0&(V|0)==0)return Te=C,Z=Ne,Te|0;g=Te+16|0,j=Te+24|0,oe=Te+28|0,C=0,N=0,m=I,A=V;do{if(!((C|0)<(S|0)|(C|0)==(S|0)&N>>>0<v>>>0)){Ae=4;break}if(V=N,N=Xt(N|0,C|0,1,0)|0,C=te()|0,V=M+(V<<3)|0,p[V>>2]=m,p[V+4>>2]=A,m0(ge),A=ge,m=p[A>>2]|0,A=p[A+4>>2]|0,(m|0)==0&(A|0)==0){if(Zh(g),m=g,A=p[m>>2]|0,m=p[m+4>>2]|0,(A|0)==0&(m|0)==0){Ae=10;break}p0(A,m,p[oe>>2]|0,ge),A=ge,m=p[A>>2]|0,A=p[A+4>>2]|0}V=Te,p[V>>2]=m,p[V+4>>2]=A}while(!((m|0)==0&(A|0)==0));return(Ae|0)==4?(A=Te+40|0,m=p[A>>2]|0,m|0&&xn(m),Ae=Te+16|0,p[Ae>>2]=0,p[Ae+4>>2]=0,p[j>>2]=0,p[Te+36>>2]=0,p[oe>>2]=-1,p[Te+32>>2]=0,p[A>>2]=0,p0(0,0,0,ge),p[Te>>2]=0,p[Te+4>>2]=0,p[de>>2]=0,Te=14,Z=Ne,Te|0):((Ae|0)==10&&(p[Te>>2]=0,p[Te+4>>2]=0,p[de>>2]=p[j>>2]),Te=p[de>>2]|0,Z=Ne,Te|0)}function b0(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0;if(oe=Z,Z=Z+48|0,I=oe+32|0,N=oe+40|0,V=oe,!(p[A>>2]|0))return j=v,p[j>>2]=0,p[j+4>>2]=0,j=0,Z=oe,j|0;Dg(I,0,0,0),C=I,S=p[C>>2]|0,C=p[C+4>>2]|0;do if(m>>>0>15)j=V,p[j>>2]=0,p[j+4>>2]=0,p[V+8>>2]=4,p[V+12>>2]=-1,j=V+16|0,g=V+29|0,p[j>>2]=0,p[j+4>>2]=0,p[j+8>>2]=0,rt[j+12>>0]=0,rt[g>>0]=rt[N>>0]|0,rt[g+1>>0]=rt[N+1>>0]|0,rt[g+2>>0]=rt[N+2>>0]|0,g=4,j=9;else{if(g=Ls(g)|0,g|0){I=V,p[I>>2]=0,p[I+4>>2]=0,p[V+8>>2]=g,p[V+12>>2]=-1,I=V+16|0,j=V+29|0,p[I>>2]=0,p[I+4>>2]=0,p[I+8>>2]=0,rt[I+12>>0]=0,rt[j>>0]=rt[N>>0]|0,rt[j+1>>0]=rt[N+1>>0]|0,rt[j+2>>0]=rt[N+2>>0]|0,j=9;break}if(g=Ko((p[A+8>>2]|0)+1|0,32)|0,!g){j=V,p[j>>2]=0,p[j+4>>2]=0,p[V+8>>2]=13,p[V+12>>2]=-1,j=V+16|0,g=V+29|0,p[j>>2]=0,p[j+4>>2]=0,p[j+8>>2]=0,rt[j+12>>0]=0,rt[g>>0]=rt[N>>0]|0,rt[g+1>>0]=rt[N+1>>0]|0,rt[g+2>>0]=rt[N+2>>0]|0,g=13,j=9;break}Hl(A,g),de=V,p[de>>2]=S,p[de+4>>2]=C,C=V+8|0,p[C>>2]=0,p[V+12>>2]=m,p[V+20>>2]=A,p[V+24>>2]=g,rt[V+28>>0]=0,S=V+29|0,rt[S>>0]=rt[N>>0]|0,rt[S+1>>0]=rt[N+1>>0]|0,rt[S+2>>0]=rt[N+2>>0]|0,p[V+16>>2]=3,ge=+bd(g),ge=ge*+Gl(g),M=+Tn(+ +J[g>>3]),M=ge/+ri(+ +Pd(+M,+ +Tn(+ +J[g+8>>3])))*6371.007180918475*6371.007180918475,S=V+12|0,g=p[S>>2]|0;e:do if((g|0)>0)do{if(q2(g+-1|0,I)|0,!(M/+J[I>>3]>10))break e;de=p[S>>2]|0,g=de+-1|0,p[S>>2]=g}while((de|0)>1);while(!1);if(Zh(V),S=v,p[S>>2]=0,p[S+4>>2]=0,S=V,g=p[S>>2]|0,S=p[S+4>>2]|0,!((g|0)==0&(S|0)==0))do $h(g,S,m,I)|0,N=I,A=v,N=Xt(p[A>>2]|0,p[A+4>>2]|0,p[N>>2]|0,p[N+4>>2]|0)|0,A=te()|0,de=v,p[de>>2]=N,p[de+4>>2]=A,Zh(V),de=V,g=p[de>>2]|0,S=p[de+4>>2]|0;while(!((g|0)==0&(S|0)==0));g=p[C>>2]|0}while(!1);return de=g,Z=oe,de|0}function wu(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0;if(!(sl(m,g)|0)||(m=a0(m)|0,v=+J[g>>3],S=+J[g+8>>3],S=m&S<0?S+6.283185307179586:S,ge=p[A>>2]|0,(ge|0)<=0))return ge=0,ge|0;if(oe=p[A+4>>2]|0,m){m=0,j=S,g=-1,A=0;e:for(;;){for(V=A;C=+J[oe+(V<<4)>>3],S=+J[oe+(V<<4)+8>>3],A=(g+2|0)%(ge|0)|0,M=+J[oe+(A<<4)>>3],N=+J[oe+(A<<4)+8>>3],C>M?(I=C,C=N):(I=M,M=C,C=S,S=N),v=v==M|v==I?v+2220446049250313e-31:v,!!(v<M|v>I);)if(g=V+1|0,(g|0)>=(ge|0)){g=22;break e}else A=V,V=g,g=A;if(N=C<0?C+6.283185307179586:C,C=S<0?S+6.283185307179586:S,j=N==j|C==j?j+-2220446049250313e-31:j,I=N+(C-N)*((v-M)/(I-M)),(I<0?I+6.283185307179586:I)>j&&(m=m^1),A=V+1|0,(A|0)>=(ge|0)){g=22;break}else g=V}if((g|0)==22)return m|0}else{m=0,j=S,g=-1,A=0;e:for(;;){for(V=A;C=+J[oe+(V<<4)>>3],S=+J[oe+(V<<4)+8>>3],A=(g+2|0)%(ge|0)|0,M=+J[oe+(A<<4)>>3],N=+J[oe+(A<<4)+8>>3],C>M?(I=C,C=N):(I=M,M=C,C=S,S=N),v=v==M|v==I?v+2220446049250313e-31:v,!!(v<M|v>I);)if(g=V+1|0,(g|0)>=(ge|0)){g=22;break e}else A=V,V=g,g=A;if(j=C==j|S==j?j+-2220446049250313e-31:j,C+(S-C)*((v-M)/(I-M))>j&&(m=m^1),A=V+1|0,(A|0)>=(ge|0)){g=22;break}else g=V}if((g|0)==22)return m|0}return 0}function Do(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0;if(Ae=p[A>>2]|0,!Ae){p[m>>2]=0,p[m+4>>2]=0,p[m+8>>2]=0,p[m+12>>2]=0,p[m+16>>2]=0,p[m+20>>2]=0,p[m+24>>2]=0,p[m+28>>2]=0;return}if(Te=m+8|0,J[Te>>3]=17976931348623157e292,Ne=m+24|0,J[Ne>>3]=17976931348623157e292,J[m>>3]=-17976931348623157e292,Ve=m+16|0,J[Ve>>3]=-17976931348623157e292,!((Ae|0)<=0)){for(ge=p[A+4>>2]|0,V=17976931348623157e292,j=-17976931348623157e292,oe=0,A=-1,M=17976931348623157e292,C=17976931348623157e292,I=-17976931348623157e292,v=-17976931348623157e292,de=0;g=+J[ge+(de<<4)>>3],N=+J[ge+(de<<4)+8>>3],A=A+2|0,S=+J[ge+(((A|0)==(Ae|0)?0:A)<<4)+8>>3],g<M&&(J[Te>>3]=g,M=g),N<C&&(J[Ne>>3]=N,C=N),g>I?J[m>>3]=g:g=I,N>v&&(J[Ve>>3]=N,v=N),V=N>0&N<V?N:V,j=N<0&N>j?N:j,oe=oe|+Tn(+(N-S))>3.141592653589793,A=de+1|0,(A|0)!=(Ae|0);)Be=de,I=g,de=A,A=Be;oe&&(J[Ve>>3]=j,J[Ne>>3]=V)}}function Ls(A){return A=A|0,(A>>>0<4?0:15)|0}function Hl(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0;if(Ae=p[A>>2]|0,Ae){if(Te=m+8|0,J[Te>>3]=17976931348623157e292,Ne=m+24|0,J[Ne>>3]=17976931348623157e292,J[m>>3]=-17976931348623157e292,Ve=m+16|0,J[Ve>>3]=-17976931348623157e292,(Ae|0)>0){for(S=p[A+4>>2]|0,ge=17976931348623157e292,de=-17976931348623157e292,v=0,g=-1,I=17976931348623157e292,V=17976931348623157e292,oe=-17976931348623157e292,C=-17976931348623157e292,Be=0;M=+J[S+(Be<<4)>>3],j=+J[S+(Be<<4)+8>>3],Yt=g+2|0,N=+J[S+(((Yt|0)==(Ae|0)?0:Yt)<<4)+8>>3],M<I&&(J[Te>>3]=M,I=M),j<V&&(J[Ne>>3]=j,V=j),M>oe?J[m>>3]=M:M=oe,j>C&&(J[Ve>>3]=j,C=j),ge=j>0&j<ge?j:ge,de=j<0&j>de?j:de,v=v|+Tn(+(j-N))>3.141592653589793,g=Be+1|0,(g|0)!=(Ae|0);)Yt=Be,oe=M,Be=g,g=Yt;v&&(J[Ve>>3]=de,J[Ne>>3]=ge)}}else p[m>>2]=0,p[m+4>>2]=0,p[m+8>>2]=0,p[m+12>>2]=0,p[m+16>>2]=0,p[m+20>>2]=0,p[m+24>>2]=0,p[m+28>>2]=0;if(Yt=A+8|0,g=p[Yt>>2]|0,!((g|0)<=0)){Mt=A+12|0,Ee=0;do if(S=p[Mt>>2]|0,v=Ee,Ee=Ee+1|0,Ne=m+(Ee<<5)|0,Ve=p[S+(v<<3)>>2]|0,Ve){if(Be=m+(Ee<<5)+8|0,J[Be>>3]=17976931348623157e292,A=m+(Ee<<5)+24|0,J[A>>3]=17976931348623157e292,J[Ne>>3]=-17976931348623157e292,Le=m+(Ee<<5)+16|0,J[Le>>3]=-17976931348623157e292,(Ve|0)>0){for(Ae=p[S+(v<<3)+4>>2]|0,ge=17976931348623157e292,de=-17976931348623157e292,S=0,v=-1,Te=0,I=17976931348623157e292,V=17976931348623157e292,j=-17976931348623157e292,C=-17976931348623157e292;M=+J[Ae+(Te<<4)>>3],oe=+J[Ae+(Te<<4)+8>>3],v=v+2|0,N=+J[Ae+(((v|0)==(Ve|0)?0:v)<<4)+8>>3],M<I&&(J[Be>>3]=M,I=M),oe<V&&(J[A>>3]=oe,V=oe),M>j?J[Ne>>3]=M:M=j,oe>C&&(J[Le>>3]=oe,C=oe),ge=oe>0&oe<ge?oe:ge,de=oe<0&oe>de?oe:de,S=S|+Tn(+(oe-N))>3.141592653589793,v=Te+1|0,(v|0)!=(Ve|0);)yt=Te,Te=v,j=M,v=yt;S&&(J[Le>>3]=de,J[A>>3]=ge)}}else p[Ne>>2]=0,p[Ne+4>>2]=0,p[Ne+8>>2]=0,p[Ne+12>>2]=0,p[Ne+16>>2]=0,p[Ne+20>>2]=0,p[Ne+24>>2]=0,p[Ne+28>>2]=0,g=p[Yt>>2]|0;while((Ee|0)<(g|0))}}function Na(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;if(!(wu(A,m,g)|0))return S=0,S|0;if(S=A+8|0,(p[S>>2]|0)<=0)return S=1,S|0;for(v=A+12|0,A=0;;){if(M=A,A=A+1|0,wu((p[v>>2]|0)+(M<<3)|0,m+(A<<5)|0,g)|0){A=0,v=6;break}if((A|0)>=(p[S>>2]|0)){A=1,v=6;break}}return(v|0)==6?A|0:0}function al(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0;if(V=Z,Z=Z+16|0,N=V,C=g+8|0,!(wu(A,m,C)|0))return I=0,Z=V,I|0;I=A+8|0;e:do if((p[I>>2]|0)>0){for(M=A+12|0,S=0;;){if(j=S,S=S+1|0,wu((p[M>>2]|0)+(j<<3)|0,m+(S<<5)|0,C)|0){S=0;break}if((S|0)>=(p[I>>2]|0))break e}return Z=V,S|0}while(!1);if(ll(A,m,g,v)|0)return j=0,Z=V,j|0;p[N>>2]=p[g>>2],p[N+4>>2]=C,S=p[I>>2]|0;e:do if((S|0)>0)for(A=A+12|0,C=0,M=S;;){if(S=p[A>>2]|0,(p[S+(C<<3)>>2]|0)>0){if(wu(N,v,p[S+(C<<3)+4>>2]|0)|0){S=0;break e}if(S=C+1|0,ll((p[A>>2]|0)+(C<<3)|0,m+(S<<5)|0,g,v)|0){S=0;break e}M=p[I>>2]|0}else S=C+1|0;if((S|0)<(M|0))C=S;else{S=1;break}}else S=1;while(!1);return j=S,Z=V,j|0}function ll(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0,Yt=0,yt=0,Wt=0;if(Yt=Z,Z=Z+176|0,Be=Yt+172|0,S=Yt+168|0,Le=Yt,!(Sd(m,v)|0))return A=0,Z=Yt,A|0;if(l0(m,v,Be,S),Vc(Le|0,g|0,168)|0,(p[g>>2]|0)>0){m=0;do yt=Le+8+(m<<4)+8|0,Ve=+Ks(+J[yt>>3],p[S>>2]|0),J[yt>>3]=Ve,m=m+1|0;while((m|0)<(p[g>>2]|0))}Te=+J[v>>3],Ne=+J[v+8>>3],Ve=+Ks(+J[v+16>>3],p[S>>2]|0),de=+Ks(+J[v+24>>3],p[S>>2]|0);e:do if((p[A>>2]|0)>0){if(v=A+4|0,S=p[Le>>2]|0,(S|0)<=0){for(m=0;;)if(m=m+1|0,(m|0)>=(p[A>>2]|0)){m=0;break e}}for(g=0;;){if(m=p[v>>2]|0,ge=+J[m+(g<<4)>>3],Ae=+Ks(+J[m+(g<<4)+8>>3],p[Be>>2]|0),m=p[v>>2]|0,g=g+1|0,yt=(g|0)%(p[A>>2]|0)|0,M=+J[m+(yt<<4)>>3],C=+Ks(+J[m+(yt<<4)+8>>3],p[Be>>2]|0),!(ge>=Te)|!(M>=Te)&&!(ge<=Ne)|!(M<=Ne)&&!(Ae<=de)|!(C<=de)&&!(Ae>=Ve)|!(C>=Ve)){oe=M-ge,V=C-Ae,m=0;do if(Wt=m,m=m+1|0,yt=(m|0)==(S|0)?0:m,M=+J[Le+8+(Wt<<4)+8>>3],C=+J[Le+8+(yt<<4)+8>>3]-M,N=+J[Le+8+(Wt<<4)>>3],I=+J[Le+8+(yt<<4)>>3]-N,j=oe*C-V*I,j!=0&&(Ee=Ae-M,Mt=ge-N,I=(Ee*I-C*Mt)/j,!(I<0|I>1))&&(j=(oe*Ee-V*Mt)/j,j>=0&j<=1)){m=1;break e}while((m|0)<(S|0))}if((g|0)>=(p[A>>2]|0)){m=0;break}}}else m=0;while(!1);return Wt=m,Z=Yt,Wt|0}function Hg(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0;if(ll(A,m,g,v)|0)return M=1,M|0;if(M=A+8|0,(p[M>>2]|0)<=0)return M=0,M|0;for(S=A+12|0,A=0;;){if(C=A,A=A+1|0,ll((p[S>>2]|0)+(C<<3)|0,m+(A<<5)|0,g,v)|0){A=1,S=6;break}if((A|0)>=(p[M>>2]|0)){A=0,S=6;break}}return(S|0)==6?A|0:0}function Wg(){return 8}function jg(){return 16}function Zs(){return 168}function Nr(){return 8}function Ci(){return 16}function Bc(){return 12}function ul(){return 8}function Xg(A){return A=A|0,+(+((p[A>>2]|0)>>>0)+4294967296*+(p[A+4>>2]|0))}function Uc(A){A=A|0;var m=0,g=0;return g=+J[A>>3],m=+J[A+8>>3],+ +Zn(+(g*g+m*m))}function $g(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0;V=+J[A>>3],I=+J[m>>3]-V,N=+J[A+8>>3],C=+J[m+8>>3]-N,oe=+J[g>>3],M=+J[v>>3]-oe,ge=+J[g+8>>3],j=+J[v+8>>3]-ge,M=(M*(N-ge)-(V-oe)*j)/(I*j-C*M),J[S>>3]=V+I*M,J[S+8>>3]=N+C*M}function Yg(A,m){return A=A|0,m=m|0,+Tn(+(+J[A>>3]-+J[m>>3]))<11920928955078125e-23?(m=+Tn(+(+J[A+8>>3]-+J[m+8>>3]))<11920928955078125e-23,m|0):(m=0,m|0)}function vr(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;return S=+J[A>>3]-+J[m>>3],v=+J[A+8>>3]-+J[m+8>>3],g=+J[A+16>>3]-+J[m+16>>3],+(S*S+v*v+g*g)}function Nd(A,m){A=A|0,m=m|0;var g=0,v=0,S=0;g=+J[A>>3],v=+ri(+g),g=+on(+g),J[m+16>>3]=g,g=+J[A+8>>3],S=v*+ri(+g),J[m>>3]=S,g=v*+on(+g),J[m+8>>3]=g}function X2(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;if(M=Z,Z=Z+16|0,S=M,v=wi(A,m)|0,(g+-1|0)>>>0>5||(v=(v|0)!=0,(g|0)==1&v))return S=-1,Z=M,S|0;do if(Wl(A,m,S)|0)v=-1;else if(v){v=((p[26352+(g<<2)>>2]|0)+5-(p[S>>2]|0)|0)%5|0;break}else{v=((p[26384+(g<<2)>>2]|0)+6-(p[S>>2]|0)|0)%6|0;break}while(!1);return S=v,Z=M,S|0}function Wl(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0,V=0;if(V=Z,Z=Z+32|0,C=V+16|0,N=V,v=ol(A,m,C)|0,v|0)return g=v,Z=V,g|0;M=O2(A,m)|0,I=Ys(A,m)|0,Sg(M,N),v=Hh(M,p[C>>2]|0)|0;e:do if(dr(M)|0){do switch(M|0){case 4:{A=0;break}case 14:{A=1;break}case 24:{A=2;break}case 38:{A=3;break}case 49:{A=4;break}case 58:{A=5;break}case 63:{A=6;break}case 72:{A=7;break}case 83:{A=8;break}case 97:{A=9;break}case 107:{A=10;break}case 117:{A=11;break}default:{v=1;break e}}while(!1);if(S=p[26416+(A*24|0)+8>>2]|0,m=p[26416+(A*24|0)+16>>2]|0,A=p[C>>2]|0,(A|0)!=(p[N>>2]|0)&&(N=xg(M)|0,A=p[C>>2]|0,N|(A|0)==(m|0)&&(v=(v+1|0)%6|0)),(I|0)==3&(A|0)==(m|0)){v=(v+5|0)%6|0,S=22;break}(I|0)==5&(A|0)==(S|0)&&(v=(v+1|0)%6|0),S=22}else S=22;while(!1);return(S|0)==22&&(p[g>>2]=v,v=0),g=v,Z=V,g|0}function Ao(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0;if(Le=Z,Z=Z+32|0,Be=Le+24|0,Ne=Le+20|0,Ae=Le+8|0,de=Le+16|0,ge=Le,I=(wi(A,m)|0)==0,I=I?6:5,j=gt(A|0,m|0,52)|0,te()|0,j=j&15,I>>>0<=g>>>0)return v=2,Z=Le,v|0;oe=(j|0)==0,!oe&&(Te=wt(7,0,(j^15)*3|0)|0,(Te&A|0)==0&((te()|0)&m|0)==0)?S=g:M=4;e:do if((M|0)==4){if(S=(wi(A,m)|0)!=0,((S?4:5)|0)<(g|0)||Wl(A,m,Be)|0||(M=(p[Be>>2]|0)+g|0,S?S=26704+(((M|0)%5|0)<<2)|0:S=26736+(((M|0)%6|0)<<2)|0,Te=p[S>>2]|0,(Te|0)==7))return v=1,Z=Le,v|0;p[Ne>>2]=0,S=hi(A,m,Te,Ne,Ae)|0;do if(!S){if(N=Ae,V=p[N>>2]|0,N=p[N+4>>2]|0,C=N>>>0<m>>>0|(N|0)==(m|0)&V>>>0<A>>>0,M=C?V:A,C=C?N:m,!oe&&(oe=wt(7,0,(j^15)*3|0)|0,(V&oe|0)==0&(N&(te()|0)|0)==0))S=g;else{if(N=(g+-1+I|0)%(I|0)|0,S=wi(A,m)|0,(N|0)<0&&Rt(27795,27797,246,27806),I=(S|0)!=0,((I?4:5)|0)<(N|0)&&Rt(27795,27797,246,27806),Wl(A,m,Be)|0&&Rt(27795,27797,246,27806),S=(p[Be>>2]|0)+N|0,I?S=26704+(((S|0)%5|0)<<2)|0:S=26736+(((S|0)%6|0)<<2)|0,N=p[S>>2]|0,(N|0)==7&&Rt(27795,27797,246,27806),p[de>>2]=0,S=hi(A,m,N,de,ge)|0,S|0)break;V=ge,I=p[V>>2]|0,V=p[V+4>>2]|0;do if(V>>>0<C>>>0|(V|0)==(C|0)&I>>>0<M>>>0){if(wi(I,V)|0?M=Wr(I,V,A,m)|0:M=p[26800+((((p[de>>2]|0)+(p[26768+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,S=wi(I,V)|0,(M+-1|0)>>>0>5){S=-1,M=I,C=V;break}if(S=(S|0)!=0,(M|0)==1&S){S=-1,M=I,C=V;break}do if(Wl(I,V,Be)|0)S=-1;else if(S){S=((p[26352+(M<<2)>>2]|0)+5-(p[Be>>2]|0)|0)%5|0;break}else{S=((p[26384+(M<<2)>>2]|0)+6-(p[Be>>2]|0)|0)%6|0;break}while(!1);M=I,C=V}else S=g;while(!1);N=Ae,V=p[N>>2]|0,N=p[N+4>>2]|0}if((M|0)==(V|0)&(C|0)==(N|0)){if(I=(wi(V,N)|0)!=0,I?A=Wr(V,N,A,m)|0:A=p[26800+((((p[Ne>>2]|0)+(p[26768+(Te<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,S=wi(V,N)|0,(A+-1|0)>>>0<=5&&(Ve=(S|0)!=0,!((A|0)==1&Ve)))do if(Wl(V,N,Be)|0)S=-1;else if(Ve){S=((p[26352+(A<<2)>>2]|0)+5-(p[Be>>2]|0)|0)%5|0;break}else{S=((p[26384+(A<<2)>>2]|0)+6-(p[Be>>2]|0)|0)%6|0;break}while(!1);else S=-1;S=S+1|0,S=(S|0)==6|I&(S|0)==5?0:S}m=C,A=M;break e}while(!1);return v=S,Z=Le,v|0}while(!1);return Ve=wt(S|0,0,56)|0,Be=te()|0|m&-2130706433|536870912,p[v>>2]=Ve|A,p[v+4>>2]=Be,v=0,Z=Le,v|0}function Fc(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;return M=(wi(A,m)|0)==0,v=Ao(A,m,0,g)|0,S=(v|0)==0,M?!S||(v=Ao(A,m,1,g+8|0)|0,v|0)||(v=Ao(A,m,2,g+16|0)|0,v|0)||(v=Ao(A,m,3,g+24|0)|0,v|0)||(v=Ao(A,m,4,g+32|0)|0,v)?(M=v,M|0):Ao(A,m,5,g+40|0)|0:!S||(v=Ao(A,m,1,g+8|0)|0,v|0)||(v=Ao(A,m,2,g+16|0)|0,v|0)||(v=Ao(A,m,3,g+24|0)|0,v|0)||(v=Ao(A,m,4,g+32|0)|0,v|0)?(M=v,M|0):(M=g+40|0,p[M>>2]=0,p[M+4>>2]=0,M=0,M|0)}function jl(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0,N=0,I=0;return I=Z,Z=Z+192|0,S=I,M=I+168|0,C=gt(A|0,m|0,56)|0,te()|0,C=C&7,N=m&-2130706433|134217728,v=ol(A,N,M)|0,v|0?(N=v,Z=I,N|0):(m=gt(A|0,m|0,52)|0,te()|0,m=m&15,wi(A,N)|0?Mg(M,m,C,1,S):f0(M,m,C,1,S),N=S+8|0,p[g>>2]=p[N>>2],p[g+4>>2]=p[N+4>>2],p[g+8>>2]=p[N+8>>2],p[g+12>>2]=p[N+12>>2],N=0,Z=I,N|0)}function Mu(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;return S=Z,Z=Z+16|0,g=S,!(!0&(m&2013265920|0)==536870912)||(v=m&-2130706433|134217728,!(Ng(A,v)|0))?(v=0,Z=S,v|0):(M=gt(A|0,m|0,56)|0,te()|0,M=(Ao(A,v,M&7,g)|0)==0,v=g,v=M&((p[v>>2]|0)==(A|0)?(p[v+4>>2]|0)==(m|0):0)&1,Z=S,v|0)}function cl(A,m,g){A=A|0,m=m|0,g=g|0;var v=0;(m|0)>0?(v=Ko(m,4)|0,p[A>>2]=v,v||Rt(27819,27842,40,27856)):p[A>>2]=0,p[A+4>>2]=m,p[A+8>>2]=0,p[A+12>>2]=g}function S0(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0;S=A+4|0,M=A+12|0,C=A+8|0;e:for(;;){for(g=p[S>>2]|0,m=0;;){if((m|0)>=(g|0))break e;if(v=p[A>>2]|0,N=p[v+(m<<2)>>2]|0,!N)m=m+1|0;else break}m=v+(~~(+Tn(+(+ho(10,+ +(15-(p[M>>2]|0)|0))*(+J[N>>3]+ +J[N+8>>3])))%+(g|0))>>>0<<2)|0,g=p[m>>2]|0;t:do if(g|0){if(v=N+32|0,(g|0)==(N|0))p[m>>2]=p[v>>2];else{if(g=g+32|0,m=p[g>>2]|0,!m)break;for(;(m|0)!=(N|0);)if(g=m+32|0,m=p[g>>2]|0,!m)break t;p[g>>2]=p[v>>2]}xn(N),p[C>>2]=(p[C>>2]|0)+-1}while(!1)}xn(p[A>>2]|0)}function T0(A){A=A|0;var m=0,g=0,v=0;for(v=p[A+4>>2]|0,g=0;;){if((g|0)>=(v|0)){m=0,g=4;break}if(m=p[(p[A>>2]|0)+(g<<2)>>2]|0,!m)g=g+1|0;else{g=4;break}}return(g|0)==4?m|0:0}function ef(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;if(g=~~(+Tn(+(+ho(10,+ +(15-(p[A+12>>2]|0)|0))*(+J[m>>3]+ +J[m+8>>3])))%+(p[A+4>>2]|0))>>>0,g=(p[A>>2]|0)+(g<<2)|0,v=p[g>>2]|0,!v)return M=1,M|0;M=m+32|0;do if((v|0)!=(m|0)){if(g=p[v+32>>2]|0,!g)return M=1,M|0;for(S=g;;){if((S|0)==(m|0)){S=8;break}if(g=p[S+32>>2]|0,g)v=S,S=g;else{g=1,S=10;break}}if((S|0)==8){p[v+32>>2]=p[M>>2];break}else if((S|0)==10)return g|0}else p[g>>2]=p[M>>2];while(!1);return xn(m),M=A+8|0,p[M>>2]=(p[M>>2]|0)+-1,M=0,M|0}function E0(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;M=hl(40)|0,M||Rt(27872,27842,98,27885),p[M>>2]=p[m>>2],p[M+4>>2]=p[m+4>>2],p[M+8>>2]=p[m+8>>2],p[M+12>>2]=p[m+12>>2],S=M+16|0,p[S>>2]=p[g>>2],p[S+4>>2]=p[g+4>>2],p[S+8>>2]=p[g+8>>2],p[S+12>>2]=p[g+12>>2],p[M+32>>2]=0,S=~~(+Tn(+(+ho(10,+ +(15-(p[A+12>>2]|0)|0))*(+J[m>>3]+ +J[m+8>>3])))%+(p[A+4>>2]|0))>>>0,S=(p[A>>2]|0)+(S<<2)|0,v=p[S>>2]|0;do if(!v)p[S>>2]=M;else{for(;!(Ma(v,m)|0&&Ma(v+16|0,g)|0);)if(S=p[v+32>>2]|0,v=(S|0)==0?v:S,!(p[v+32>>2]|0)){C=10;break}if((C|0)==10){p[v+32>>2]=M;break}return xn(M),C=v,C|0}while(!1);return C=A+8|0,p[C>>2]=(p[C>>2]|0)+1,C=M,C|0}function kc(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0;if(S=~~(+Tn(+(+ho(10,+ +(15-(p[A+12>>2]|0)|0))*(+J[m>>3]+ +J[m+8>>3])))%+(p[A+4>>2]|0))>>>0,S=p[(p[A>>2]|0)+(S<<2)>>2]|0,!S)return g=0,g|0;if(!g){for(A=S;;){if(Ma(A,m)|0){v=10;break}if(A=p[A+32>>2]|0,!A){A=0,v=10;break}}if((v|0)==10)return A|0}for(A=S;;){if(Ma(A,m)|0&&Ma(A+16|0,g)|0){v=10;break}if(A=p[A+32>>2]|0,!A){A=0,v=10;break}}return(v|0)==10?A|0:0}function Os(A,m){A=A|0,m=m|0;var g=0;if(g=~~(+Tn(+(+ho(10,+ +(15-(p[A+12>>2]|0)|0))*(+J[m>>3]+ +J[m+8>>3])))%+(p[A+4>>2]|0))>>>0,A=p[(p[A>>2]|0)+(g<<2)>>2]|0,!A)return g=0,g|0;for(;;){if(Ma(A,m)|0){m=5;break}if(A=p[A+32>>2]|0,!A){A=0,m=5;break}}return(m|0)==5?A|0:0}function w0(){return 27904}function Xl(A){return A=+A,~~+R0(+A)|0}function hl(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0,Te=0,Ne=0,Ve=0,Be=0,Le=0,Ee=0,Mt=0;Mt=Z,Z=Z+16|0,ge=Mt;do if(A>>>0<245){if(V=A>>>0<11?16:A+11&-8,A=V>>>3,oe=p[6977]|0,g=oe>>>A,g&3|0)return m=(g&1^1)+A|0,A=27948+(m<<1<<2)|0,g=A+8|0,v=p[g>>2]|0,S=v+8|0,M=p[S>>2]|0,(M|0)==(A|0)?p[6977]=oe&~(1<<m):(p[M+12>>2]=A,p[g>>2]=M),Ee=m<<3,p[v+4>>2]=Ee|3,Ee=v+Ee+4|0,p[Ee>>2]=p[Ee>>2]|1,Ee=S,Z=Mt,Ee|0;if(j=p[6979]|0,V>>>0>j>>>0){if(g|0)return m=2<<A,m=g<<A&(m|0-m),m=(m&0-m)+-1|0,N=m>>>12&16,m=m>>>N,g=m>>>5&8,m=m>>>g,M=m>>>2&4,m=m>>>M,A=m>>>1&2,m=m>>>A,v=m>>>1&1,v=(g|N|M|A|v)+(m>>>v)|0,m=27948+(v<<1<<2)|0,A=m+8|0,M=p[A>>2]|0,N=M+8|0,g=p[N>>2]|0,(g|0)==(m|0)?(A=oe&~(1<<v),p[6977]=A):(p[g+12>>2]=m,p[A>>2]=g,A=oe),Ee=v<<3,C=Ee-V|0,p[M+4>>2]=V|3,S=M+V|0,p[S+4>>2]=C|1,p[M+Ee>>2]=C,j|0&&(v=p[6982]|0,m=j>>>3,g=27948+(m<<1<<2)|0,m=1<<m,A&m?(A=g+8|0,m=p[A>>2]|0):(p[6977]=A|m,m=g,A=g+8|0),p[A>>2]=v,p[m+12>>2]=v,p[v+8>>2]=m,p[v+12>>2]=g),p[6979]=C,p[6982]=S,Ee=N,Z=Mt,Ee|0;if(M=p[6978]|0,M){for(g=(M&0-M)+-1|0,S=g>>>12&16,g=g>>>S,v=g>>>5&8,g=g>>>v,C=g>>>2&4,g=g>>>C,N=g>>>1&2,g=g>>>N,I=g>>>1&1,I=p[28212+((v|S|C|N|I)+(g>>>I)<<2)>>2]|0,g=I,N=I,I=(p[I+4>>2]&-8)-V|0;A=p[g+16>>2]|0,!(!A&&(A=p[g+20>>2]|0,!A));)C=(p[A+4>>2]&-8)-V|0,S=C>>>0<I>>>0,g=A,N=S?A:N,I=S?C:I;if(C=N+V|0,C>>>0>N>>>0){S=p[N+24>>2]|0,m=p[N+12>>2]|0;do if((m|0)==(N|0)){if(A=N+20|0,m=p[A>>2]|0,!m&&(A=N+16|0,m=p[A>>2]|0,!m)){g=0;break}for(;;)if(v=m+20|0,g=p[v>>2]|0,g)m=g,A=v;else if(v=m+16|0,g=p[v>>2]|0,g)m=g,A=v;else break;p[A>>2]=0,g=m}else g=p[N+8>>2]|0,p[g+12>>2]=m,p[m+8>>2]=g,g=m;while(!1);do if(S|0){if(m=p[N+28>>2]|0,A=28212+(m<<2)|0,(N|0)==(p[A>>2]|0)){if(p[A>>2]=g,!g){p[6978]=M&~(1<<m);break}}else if(Ee=S+16|0,p[((p[Ee>>2]|0)==(N|0)?Ee:S+20|0)>>2]=g,!g)break;p[g+24>>2]=S,m=p[N+16>>2]|0,m|0&&(p[g+16>>2]=m,p[m+24>>2]=g),m=p[N+20>>2]|0,m|0&&(p[g+20>>2]=m,p[m+24>>2]=g)}while(!1);return I>>>0<16?(Ee=I+V|0,p[N+4>>2]=Ee|3,Ee=N+Ee+4|0,p[Ee>>2]=p[Ee>>2]|1):(p[N+4>>2]=V|3,p[C+4>>2]=I|1,p[C+I>>2]=I,j|0&&(v=p[6982]|0,m=j>>>3,g=27948+(m<<1<<2)|0,m=1<<m,m&oe?(A=g+8|0,m=p[A>>2]|0):(p[6977]=m|oe,m=g,A=g+8|0),p[A>>2]=v,p[m+12>>2]=v,p[v+8>>2]=m,p[v+12>>2]=g),p[6979]=I,p[6982]=C),Ee=N+8|0,Z=Mt,Ee|0}else oe=V}else oe=V}else oe=V}else if(A>>>0<=4294967231)if(A=A+11|0,V=A&-8,v=p[6978]|0,v){S=0-V|0,A=A>>>8,A?V>>>0>16777215?I=31:(oe=(A+1048320|0)>>>16&8,Te=A<<oe,N=(Te+520192|0)>>>16&4,Te=Te<<N,I=(Te+245760|0)>>>16&2,I=14-(N|oe|I)+(Te<<I>>>15)|0,I=V>>>(I+7|0)&1|I<<1):I=0,g=p[28212+(I<<2)>>2]|0;e:do if(!g)g=0,A=0,Te=61;else for(A=0,N=V<<((I|0)==31?0:25-(I>>>1)|0),M=0;;){if(C=(p[g+4>>2]&-8)-V|0,C>>>0<S>>>0)if(C)A=g,S=C;else{A=g,S=0,Te=65;break e}if(Te=p[g+20>>2]|0,g=p[g+16+(N>>>31<<2)>>2]|0,M=(Te|0)==0|(Te|0)==(g|0)?M:Te,g)N=N<<1;else{g=M,Te=61;break}}while(!1);if((Te|0)==61){if((g|0)==0&(A|0)==0){if(A=2<<I,A=(A|0-A)&v,!A){oe=V;break}oe=(A&0-A)+-1|0,C=oe>>>12&16,oe=oe>>>C,M=oe>>>5&8,oe=oe>>>M,N=oe>>>2&4,oe=oe>>>N,I=oe>>>1&2,oe=oe>>>I,g=oe>>>1&1,A=0,g=p[28212+((M|C|N|I|g)+(oe>>>g)<<2)>>2]|0}g?Te=65:(N=A,C=S)}if((Te|0)==65)for(M=g;;)if(oe=(p[M+4>>2]&-8)-V|0,g=oe>>>0<S>>>0,S=g?oe:S,A=g?M:A,g=p[M+16>>2]|0,g||(g=p[M+20>>2]|0),g)M=g;else{N=A,C=S;break}if((N|0)!=0&&C>>>0<((p[6979]|0)-V|0)>>>0&&(j=N+V|0,j>>>0>N>>>0)){M=p[N+24>>2]|0,m=p[N+12>>2]|0;do if((m|0)==(N|0)){if(A=N+20|0,m=p[A>>2]|0,!m&&(A=N+16|0,m=p[A>>2]|0,!m)){m=0;break}for(;;)if(S=m+20|0,g=p[S>>2]|0,g)m=g,A=S;else if(S=m+16|0,g=p[S>>2]|0,g)m=g,A=S;else break;p[A>>2]=0}else Ee=p[N+8>>2]|0,p[Ee+12>>2]=m,p[m+8>>2]=Ee;while(!1);do if(M){if(A=p[N+28>>2]|0,g=28212+(A<<2)|0,(N|0)==(p[g>>2]|0)){if(p[g>>2]=m,!m){v=v&~(1<<A),p[6978]=v;break}}else if(Ee=M+16|0,p[((p[Ee>>2]|0)==(N|0)?Ee:M+20|0)>>2]=m,!m)break;p[m+24>>2]=M,A=p[N+16>>2]|0,A|0&&(p[m+16>>2]=A,p[A+24>>2]=m),A=p[N+20>>2]|0,A&&(p[m+20>>2]=A,p[A+24>>2]=m)}while(!1);e:do if(C>>>0<16)Ee=C+V|0,p[N+4>>2]=Ee|3,Ee=N+Ee+4|0,p[Ee>>2]=p[Ee>>2]|1;else{if(p[N+4>>2]=V|3,p[j+4>>2]=C|1,p[j+C>>2]=C,m=C>>>3,C>>>0<256){g=27948+(m<<1<<2)|0,A=p[6977]|0,m=1<<m,A&m?(A=g+8|0,m=p[A>>2]|0):(p[6977]=A|m,m=g,A=g+8|0),p[A>>2]=j,p[m+12>>2]=j,p[j+8>>2]=m,p[j+12>>2]=g;break}if(m=C>>>8,m?C>>>0>16777215?g=31:(Le=(m+1048320|0)>>>16&8,Ee=m<<Le,Be=(Ee+520192|0)>>>16&4,Ee=Ee<<Be,g=(Ee+245760|0)>>>16&2,g=14-(Be|Le|g)+(Ee<<g>>>15)|0,g=C>>>(g+7|0)&1|g<<1):g=0,m=28212+(g<<2)|0,p[j+28>>2]=g,A=j+16|0,p[A+4>>2]=0,p[A>>2]=0,A=1<<g,!(v&A)){p[6978]=v|A,p[m>>2]=j,p[j+24>>2]=m,p[j+12>>2]=j,p[j+8>>2]=j;break}m=p[m>>2]|0;t:do if((p[m+4>>2]&-8|0)!=(C|0)){for(v=C<<((g|0)==31?0:25-(g>>>1)|0);g=m+16+(v>>>31<<2)|0,A=p[g>>2]|0,!!A;)if((p[A+4>>2]&-8|0)==(C|0)){m=A;break t}else v=v<<1,m=A;p[g>>2]=j,p[j+24>>2]=m,p[j+12>>2]=j,p[j+8>>2]=j;break e}while(!1);Le=m+8|0,Ee=p[Le>>2]|0,p[Ee+12>>2]=j,p[Le>>2]=j,p[j+8>>2]=Ee,p[j+12>>2]=m,p[j+24>>2]=0}while(!1);return Ee=N+8|0,Z=Mt,Ee|0}else oe=V}else oe=V;else oe=-1;while(!1);if(g=p[6979]|0,g>>>0>=oe>>>0)return m=g-oe|0,A=p[6982]|0,m>>>0>15?(Ee=A+oe|0,p[6982]=Ee,p[6979]=m,p[Ee+4>>2]=m|1,p[A+g>>2]=m,p[A+4>>2]=oe|3):(p[6979]=0,p[6982]=0,p[A+4>>2]=g|3,Ee=A+g+4|0,p[Ee>>2]=p[Ee>>2]|1),Ee=A+8|0,Z=Mt,Ee|0;if(C=p[6980]|0,C>>>0>oe>>>0)return Be=C-oe|0,p[6980]=Be,Ee=p[6983]|0,Le=Ee+oe|0,p[6983]=Le,p[Le+4>>2]=Be|1,p[Ee+4>>2]=oe|3,Ee=Ee+8|0,Z=Mt,Ee|0;if(p[7095]|0?A=p[7097]|0:(p[7097]=4096,p[7096]=4096,p[7098]=-1,p[7099]=-1,p[7100]=0,p[7088]=0,p[7095]=ge&-16^1431655768,A=4096),N=oe+48|0,I=oe+47|0,M=A+I|0,S=0-A|0,V=M&S,V>>>0<=oe>>>0||(A=p[7087]|0,A|0&&(j=p[7085]|0,ge=j+V|0,ge>>>0<=j>>>0|ge>>>0>A>>>0)))return Ee=0,Z=Mt,Ee|0;e:do if(p[7088]&4)m=0,Te=143;else{g=p[6983]|0;t:do if(g){for(v=28356;ge=p[v>>2]|0,!(ge>>>0<=g>>>0&&(ge+(p[v+4>>2]|0)|0)>>>0>g>>>0);)if(A=p[v+8>>2]|0,A)v=A;else{Te=128;break t}if(m=M-C&S,m>>>0<2147483647)if(A=$l(m|0)|0,(A|0)==((p[v>>2]|0)+(p[v+4>>2]|0)|0)){if((A|0)!=-1){C=m,M=A,Te=145;break e}}else v=A,Te=136;else m=0}else Te=128;while(!1);do if((Te|0)==128)if(g=$l(0)|0,(g|0)!=-1&&(m=g,de=p[7096]|0,Ae=de+-1|0,m=((Ae&m|0)==0?0:(Ae+m&0-de)-m|0)+V|0,de=p[7085]|0,Ae=m+de|0,m>>>0>oe>>>0&m>>>0<2147483647)){if(ge=p[7087]|0,ge|0&&Ae>>>0<=de>>>0|Ae>>>0>ge>>>0){m=0;break}if(A=$l(m|0)|0,(A|0)==(g|0)){C=m,M=g,Te=145;break e}else v=A,Te=136}else m=0;while(!1);do if((Te|0)==136){if(g=0-m|0,!(N>>>0>m>>>0&(m>>>0<2147483647&(v|0)!=-1)))if((v|0)==-1){m=0;break}else{C=m,M=v,Te=145;break e}if(A=p[7097]|0,A=I-m+A&0-A,A>>>0>=2147483647){C=m,M=v,Te=145;break e}if(($l(A|0)|0)==-1){$l(g|0)|0,m=0;break}else{C=A+m|0,M=v,Te=145;break e}}while(!1);p[7088]=p[7088]|4,Te=143}while(!1);if((Te|0)==143&&V>>>0<2147483647&&(Be=$l(V|0)|0,Ae=$l(0)|0,Ne=Ae-Be|0,Ve=Ne>>>0>(oe+40|0)>>>0,!((Be|0)==-1|Ve^1|Be>>>0<Ae>>>0&((Be|0)!=-1&(Ae|0)!=-1)^1))&&(C=Ve?Ne:m,M=Be,Te=145),(Te|0)==145){m=(p[7085]|0)+C|0,p[7085]=m,m>>>0>(p[7086]|0)>>>0&&(p[7086]=m),I=p[6983]|0;e:do if(I){for(m=28356;;){if(A=p[m>>2]|0,g=p[m+4>>2]|0,(M|0)==(A+g|0)){Te=154;break}if(v=p[m+8>>2]|0,v)m=v;else break}if((Te|0)==154&&(Le=m+4|0,(p[m+12>>2]&8|0)==0)&&M>>>0>I>>>0&A>>>0<=I>>>0){p[Le>>2]=g+C,Ee=(p[6980]|0)+C|0,Be=I+8|0,Be=(Be&7|0)==0?0:0-Be&7,Le=I+Be|0,Be=Ee-Be|0,p[6983]=Le,p[6980]=Be,p[Le+4>>2]=Be|1,p[I+Ee+4>>2]=40,p[6984]=p[7099];break}for(M>>>0<(p[6981]|0)>>>0&&(p[6981]=M),g=M+C|0,m=28356;;){if((p[m>>2]|0)==(g|0)){Te=162;break}if(A=p[m+8>>2]|0,A)m=A;else break}if((Te|0)==162&&(p[m+12>>2]&8|0)==0){p[m>>2]=M,j=m+4|0,p[j>>2]=(p[j>>2]|0)+C,j=M+8|0,j=M+((j&7|0)==0?0:0-j&7)|0,m=g+8|0,m=g+((m&7|0)==0?0:0-m&7)|0,V=j+oe|0,N=m-j-oe|0,p[j+4>>2]=oe|3;t:do if((I|0)==(m|0))Ee=(p[6980]|0)+N|0,p[6980]=Ee,p[6983]=V,p[V+4>>2]=Ee|1;else{if((p[6982]|0)==(m|0)){Ee=(p[6979]|0)+N|0,p[6979]=Ee,p[6982]=V,p[V+4>>2]=Ee|1,p[V+Ee>>2]=Ee;break}if(A=p[m+4>>2]|0,(A&3|0)==1){C=A&-8,v=A>>>3;n:do if(A>>>0<256)if(A=p[m+8>>2]|0,g=p[m+12>>2]|0,(g|0)==(A|0)){p[6977]=p[6977]&~(1<<v);break}else{p[A+12>>2]=g,p[g+8>>2]=A;break}else{M=p[m+24>>2]|0,A=p[m+12>>2]|0;do if((A|0)==(m|0)){if(g=m+16|0,v=g+4|0,A=p[v>>2]|0,A)g=v;else if(A=p[g>>2]|0,!A){A=0;break}for(;;)if(S=A+20|0,v=p[S>>2]|0,v)A=v,g=S;else if(S=A+16|0,v=p[S>>2]|0,v)A=v,g=S;else break;p[g>>2]=0}else Ee=p[m+8>>2]|0,p[Ee+12>>2]=A,p[A+8>>2]=Ee;while(!1);if(!M)break;g=p[m+28>>2]|0,v=28212+(g<<2)|0;do if((p[v>>2]|0)!=(m|0)){if(Ee=M+16|0,p[((p[Ee>>2]|0)==(m|0)?Ee:M+20|0)>>2]=A,!A)break n}else{if(p[v>>2]=A,A|0)break;p[6978]=p[6978]&~(1<<g);break n}while(!1);if(p[A+24>>2]=M,g=m+16|0,v=p[g>>2]|0,v|0&&(p[A+16>>2]=v,p[v+24>>2]=A),g=p[g+4>>2]|0,!g)break;p[A+20>>2]=g,p[g+24>>2]=A}while(!1);m=m+C|0,S=C+N|0}else S=N;if(m=m+4|0,p[m>>2]=p[m>>2]&-2,p[V+4>>2]=S|1,p[V+S>>2]=S,m=S>>>3,S>>>0<256){g=27948+(m<<1<<2)|0,A=p[6977]|0,m=1<<m,A&m?(A=g+8|0,m=p[A>>2]|0):(p[6977]=A|m,m=g,A=g+8|0),p[A>>2]=V,p[m+12>>2]=V,p[V+8>>2]=m,p[V+12>>2]=g;break}m=S>>>8;do if(!m)v=0;else{if(S>>>0>16777215){v=31;break}Le=(m+1048320|0)>>>16&8,Ee=m<<Le,Be=(Ee+520192|0)>>>16&4,Ee=Ee<<Be,v=(Ee+245760|0)>>>16&2,v=14-(Be|Le|v)+(Ee<<v>>>15)|0,v=S>>>(v+7|0)&1|v<<1}while(!1);if(m=28212+(v<<2)|0,p[V+28>>2]=v,A=V+16|0,p[A+4>>2]=0,p[A>>2]=0,A=p[6978]|0,g=1<<v,!(A&g)){p[6978]=A|g,p[m>>2]=V,p[V+24>>2]=m,p[V+12>>2]=V,p[V+8>>2]=V;break}m=p[m>>2]|0;n:do if((p[m+4>>2]&-8|0)!=(S|0)){for(v=S<<((v|0)==31?0:25-(v>>>1)|0);g=m+16+(v>>>31<<2)|0,A=p[g>>2]|0,!!A;)if((p[A+4>>2]&-8|0)==(S|0)){m=A;break n}else v=v<<1,m=A;p[g>>2]=V,p[V+24>>2]=m,p[V+12>>2]=V,p[V+8>>2]=V;break t}while(!1);Le=m+8|0,Ee=p[Le>>2]|0,p[Ee+12>>2]=V,p[Le>>2]=V,p[V+8>>2]=Ee,p[V+12>>2]=m,p[V+24>>2]=0}while(!1);return Ee=j+8|0,Z=Mt,Ee|0}for(m=28356;A=p[m>>2]|0,!(A>>>0<=I>>>0&&(Ee=A+(p[m+4>>2]|0)|0,Ee>>>0>I>>>0));)m=p[m+8>>2]|0;S=Ee+-47|0,A=S+8|0,A=S+((A&7|0)==0?0:0-A&7)|0,S=I+16|0,A=A>>>0<S>>>0?I:A,m=A+8|0,g=C+-40|0,Be=M+8|0,Be=(Be&7|0)==0?0:0-Be&7,Le=M+Be|0,Be=g-Be|0,p[6983]=Le,p[6980]=Be,p[Le+4>>2]=Be|1,p[M+g+4>>2]=40,p[6984]=p[7099],g=A+4|0,p[g>>2]=27,p[m>>2]=p[7089],p[m+4>>2]=p[7090],p[m+8>>2]=p[7091],p[m+12>>2]=p[7092],p[7089]=M,p[7090]=C,p[7092]=0,p[7091]=m,m=A+24|0;do Le=m,m=m+4|0,p[m>>2]=7;while((Le+8|0)>>>0<Ee>>>0);if((A|0)!=(I|0)){if(M=A-I|0,p[g>>2]=p[g>>2]&-2,p[I+4>>2]=M|1,p[A>>2]=M,m=M>>>3,M>>>0<256){g=27948+(m<<1<<2)|0,A=p[6977]|0,m=1<<m,A&m?(A=g+8|0,m=p[A>>2]|0):(p[6977]=A|m,m=g,A=g+8|0),p[A>>2]=I,p[m+12>>2]=I,p[I+8>>2]=m,p[I+12>>2]=g;break}if(m=M>>>8,m?M>>>0>16777215?v=31:(Le=(m+1048320|0)>>>16&8,Ee=m<<Le,Be=(Ee+520192|0)>>>16&4,Ee=Ee<<Be,v=(Ee+245760|0)>>>16&2,v=14-(Be|Le|v)+(Ee<<v>>>15)|0,v=M>>>(v+7|0)&1|v<<1):v=0,g=28212+(v<<2)|0,p[I+28>>2]=v,p[I+20>>2]=0,p[S>>2]=0,m=p[6978]|0,A=1<<v,!(m&A)){p[6978]=m|A,p[g>>2]=I,p[I+24>>2]=g,p[I+12>>2]=I,p[I+8>>2]=I;break}m=p[g>>2]|0;t:do if((p[m+4>>2]&-8|0)!=(M|0)){for(v=M<<((v|0)==31?0:25-(v>>>1)|0);g=m+16+(v>>>31<<2)|0,A=p[g>>2]|0,!!A;)if((p[A+4>>2]&-8|0)==(M|0)){m=A;break t}else v=v<<1,m=A;p[g>>2]=I,p[I+24>>2]=m,p[I+12>>2]=I,p[I+8>>2]=I;break e}while(!1);Le=m+8|0,Ee=p[Le>>2]|0,p[Ee+12>>2]=I,p[Le>>2]=I,p[I+8>>2]=Ee,p[I+12>>2]=m,p[I+24>>2]=0}}else Ee=p[6981]|0,(Ee|0)==0|M>>>0<Ee>>>0&&(p[6981]=M),p[7089]=M,p[7090]=C,p[7092]=0,p[6986]=p[7095],p[6985]=-1,p[6990]=27948,p[6989]=27948,p[6992]=27956,p[6991]=27956,p[6994]=27964,p[6993]=27964,p[6996]=27972,p[6995]=27972,p[6998]=27980,p[6997]=27980,p[7e3]=27988,p[6999]=27988,p[7002]=27996,p[7001]=27996,p[7004]=28004,p[7003]=28004,p[7006]=28012,p[7005]=28012,p[7008]=28020,p[7007]=28020,p[7010]=28028,p[7009]=28028,p[7012]=28036,p[7011]=28036,p[7014]=28044,p[7013]=28044,p[7016]=28052,p[7015]=28052,p[7018]=28060,p[7017]=28060,p[7020]=28068,p[7019]=28068,p[7022]=28076,p[7021]=28076,p[7024]=28084,p[7023]=28084,p[7026]=28092,p[7025]=28092,p[7028]=28100,p[7027]=28100,p[7030]=28108,p[7029]=28108,p[7032]=28116,p[7031]=28116,p[7034]=28124,p[7033]=28124,p[7036]=28132,p[7035]=28132,p[7038]=28140,p[7037]=28140,p[7040]=28148,p[7039]=28148,p[7042]=28156,p[7041]=28156,p[7044]=28164,p[7043]=28164,p[7046]=28172,p[7045]=28172,p[7048]=28180,p[7047]=28180,p[7050]=28188,p[7049]=28188,p[7052]=28196,p[7051]=28196,Ee=C+-40|0,Be=M+8|0,Be=(Be&7|0)==0?0:0-Be&7,Le=M+Be|0,Be=Ee-Be|0,p[6983]=Le,p[6980]=Be,p[Le+4>>2]=Be|1,p[M+Ee+4>>2]=40,p[6984]=p[7099];while(!1);if(m=p[6980]|0,m>>>0>oe>>>0)return Be=m-oe|0,p[6980]=Be,Ee=p[6983]|0,Le=Ee+oe|0,p[6983]=Le,p[Le+4>>2]=Be|1,p[Ee+4>>2]=oe|3,Ee=Ee+8|0,Z=Mt,Ee|0}return Ee=w0()|0,p[Ee>>2]=12,Ee=0,Z=Mt,Ee|0}function xn(A){A=A|0;var m=0,g=0,v=0,S=0,M=0,C=0,N=0,I=0;if(A){g=A+-8|0,S=p[6981]|0,A=p[A+-4>>2]|0,m=A&-8,I=g+m|0;do if(A&1)N=g,C=g;else{if(v=p[g>>2]|0,!(A&3)||(C=g+(0-v)|0,M=v+m|0,C>>>0<S>>>0))return;if((p[6982]|0)==(C|0)){if(A=I+4|0,m=p[A>>2]|0,(m&3|0)!=3){N=C,m=M;break}p[6979]=M,p[A>>2]=m&-2,p[C+4>>2]=M|1,p[C+M>>2]=M;return}if(g=v>>>3,v>>>0<256)if(A=p[C+8>>2]|0,m=p[C+12>>2]|0,(m|0)==(A|0)){p[6977]=p[6977]&~(1<<g),N=C,m=M;break}else{p[A+12>>2]=m,p[m+8>>2]=A,N=C,m=M;break}S=p[C+24>>2]|0,A=p[C+12>>2]|0;do if((A|0)==(C|0)){if(m=C+16|0,g=m+4|0,A=p[g>>2]|0,A)m=g;else if(A=p[m>>2]|0,!A){A=0;break}for(;;)if(v=A+20|0,g=p[v>>2]|0,g)A=g,m=v;else if(v=A+16|0,g=p[v>>2]|0,g)A=g,m=v;else break;p[m>>2]=0}else N=p[C+8>>2]|0,p[N+12>>2]=A,p[A+8>>2]=N;while(!1);if(S){if(m=p[C+28>>2]|0,g=28212+(m<<2)|0,(p[g>>2]|0)==(C|0)){if(p[g>>2]=A,!A){p[6978]=p[6978]&~(1<<m),N=C,m=M;break}}else if(N=S+16|0,p[((p[N>>2]|0)==(C|0)?N:S+20|0)>>2]=A,!A){N=C,m=M;break}p[A+24>>2]=S,m=C+16|0,g=p[m>>2]|0,g|0&&(p[A+16>>2]=g,p[g+24>>2]=A),m=p[m+4>>2]|0,m?(p[A+20>>2]=m,p[m+24>>2]=A,N=C,m=M):(N=C,m=M)}else N=C,m=M}while(!1);if(!(C>>>0>=I>>>0)&&(A=I+4|0,v=p[A>>2]|0,!!(v&1))){if(v&2)p[A>>2]=v&-2,p[N+4>>2]=m|1,p[C+m>>2]=m,S=m;else{if((p[6983]|0)==(I|0)){if(I=(p[6980]|0)+m|0,p[6980]=I,p[6983]=N,p[N+4>>2]=I|1,(N|0)!=(p[6982]|0))return;p[6982]=0,p[6979]=0;return}if((p[6982]|0)==(I|0)){I=(p[6979]|0)+m|0,p[6979]=I,p[6982]=C,p[N+4>>2]=I|1,p[C+I>>2]=I;return}S=(v&-8)+m|0,g=v>>>3;do if(v>>>0<256)if(m=p[I+8>>2]|0,A=p[I+12>>2]|0,(A|0)==(m|0)){p[6977]=p[6977]&~(1<<g);break}else{p[m+12>>2]=A,p[A+8>>2]=m;break}else{M=p[I+24>>2]|0,A=p[I+12>>2]|0;do if((A|0)==(I|0)){if(m=I+16|0,g=m+4|0,A=p[g>>2]|0,A)m=g;else if(A=p[m>>2]|0,!A){g=0;break}for(;;)if(v=A+20|0,g=p[v>>2]|0,g)A=g,m=v;else if(v=A+16|0,g=p[v>>2]|0,g)A=g,m=v;else break;p[m>>2]=0,g=A}else g=p[I+8>>2]|0,p[g+12>>2]=A,p[A+8>>2]=g,g=A;while(!1);if(M|0){if(A=p[I+28>>2]|0,m=28212+(A<<2)|0,(p[m>>2]|0)==(I|0)){if(p[m>>2]=g,!g){p[6978]=p[6978]&~(1<<A);break}}else if(v=M+16|0,p[((p[v>>2]|0)==(I|0)?v:M+20|0)>>2]=g,!g)break;p[g+24>>2]=M,A=I+16|0,m=p[A>>2]|0,m|0&&(p[g+16>>2]=m,p[m+24>>2]=g),A=p[A+4>>2]|0,A|0&&(p[g+20>>2]=A,p[A+24>>2]=g)}}while(!1);if(p[N+4>>2]=S|1,p[C+S>>2]=S,(N|0)==(p[6982]|0)){p[6979]=S;return}}if(A=S>>>3,S>>>0<256){g=27948+(A<<1<<2)|0,m=p[6977]|0,A=1<<A,m&A?(m=g+8|0,A=p[m>>2]|0):(p[6977]=m|A,A=g,m=g+8|0),p[m>>2]=N,p[A+12>>2]=N,p[N+8>>2]=A,p[N+12>>2]=g;return}A=S>>>8,A?S>>>0>16777215?v=31:(C=(A+1048320|0)>>>16&8,I=A<<C,M=(I+520192|0)>>>16&4,I=I<<M,v=(I+245760|0)>>>16&2,v=14-(M|C|v)+(I<<v>>>15)|0,v=S>>>(v+7|0)&1|v<<1):v=0,A=28212+(v<<2)|0,p[N+28>>2]=v,p[N+20>>2]=0,p[N+16>>2]=0,m=p[6978]|0,g=1<<v;e:do if(!(m&g))p[6978]=m|g,p[A>>2]=N,p[N+24>>2]=A,p[N+12>>2]=N,p[N+8>>2]=N;else{A=p[A>>2]|0;t:do if((p[A+4>>2]&-8|0)!=(S|0)){for(v=S<<((v|0)==31?0:25-(v>>>1)|0);g=A+16+(v>>>31<<2)|0,m=p[g>>2]|0,!!m;)if((p[m+4>>2]&-8|0)==(S|0)){A=m;break t}else v=v<<1,A=m;p[g>>2]=N,p[N+24>>2]=A,p[N+12>>2]=N,p[N+8>>2]=N;break e}while(!1);C=A+8|0,I=p[C>>2]|0,p[I+12>>2]=N,p[C>>2]=N,p[N+8>>2]=I,p[N+12>>2]=A,p[N+24>>2]=0}while(!1);if(I=(p[6985]|0)+-1|0,p[6985]=I,!(I|0)){for(A=28364;A=p[A>>2]|0,A;)A=A+8|0;p[6985]=-1}}}}function Ko(A,m){A=A|0,m=m|0;var g=0;return A?(g=He(m,A)|0,(m|A)>>>0>65535&&(g=((g>>>0)/(A>>>0)|0|0)==(m|0)?g:-1)):g=0,A=hl(g)|0,!A||!(p[A+-4>>2]&3)||dl(A|0,0,g|0)|0,A|0}function Xt(A,m,g,v){return A=A|0,m=m|0,g=g|0,v=v|0,g=A+g>>>0,ct(m+v+(g>>>0<A>>>0|0)>>>0|0),g|0|0}function ns(A,m,g,v){return A=A|0,m=m|0,g=g|0,v=v|0,v=m-v-(g>>>0>A>>>0|0)>>>0,ct(v|0),A-g>>>0|0|0}function tf(A){return A=A|0,(A?31-(Ot(A^A-1)|0)|0:32)|0}function Gc(A,m,g,v,S){A=A|0,m=m|0,g=g|0,v=v|0,S=S|0;var M=0,C=0,N=0,I=0,V=0,j=0,oe=0,ge=0,de=0,Ae=0;if(j=A,I=m,V=I,C=g,ge=v,N=ge,!V)return M=(S|0)!=0,N?M?(p[S>>2]=A|0,p[S+4>>2]=m&0,ge=0,S=0,ct(ge|0),S|0):(ge=0,S=0,ct(ge|0),S|0):(M&&(p[S>>2]=(j>>>0)%(C>>>0),p[S+4>>2]=0),ge=0,S=(j>>>0)/(C>>>0)>>>0,ct(ge|0),S|0);M=(N|0)==0;do if(C){if(!M){if(M=(Ot(N|0)|0)-(Ot(V|0)|0)|0,M>>>0<=31){oe=M+1|0,N=31-M|0,m=M-31>>31,C=oe,A=j>>>(oe>>>0)&m|V<<N,m=V>>>(oe>>>0)&m,M=0,N=j<<N;break}return S?(p[S>>2]=A|0,p[S+4>>2]=I|m&0,ge=0,S=0,ct(ge|0),S|0):(ge=0,S=0,ct(ge|0),S|0)}if(M=C-1|0,M&C|0){N=(Ot(C|0)|0)+33-(Ot(V|0)|0)|0,Ae=64-N|0,oe=32-N|0,I=oe>>31,de=N-32|0,m=de>>31,C=N,A=oe-1>>31&V>>>(de>>>0)|(V<<oe|j>>>(N>>>0))&m,m=m&V>>>(N>>>0),M=j<<Ae&I,N=(V<<Ae|j>>>(de>>>0))&I|j<<oe&N-33>>31;break}return S|0&&(p[S>>2]=M&j,p[S+4>>2]=0),(C|0)==1?(de=I|m&0,Ae=A|0|0,ct(de|0),Ae|0):(Ae=tf(C|0)|0,de=V>>>(Ae>>>0)|0,Ae=V<<32-Ae|j>>>(Ae>>>0)|0,ct(de|0),Ae|0)}else{if(M)return S|0&&(p[S>>2]=(V>>>0)%(C>>>0),p[S+4>>2]=0),de=0,Ae=(V>>>0)/(C>>>0)>>>0,ct(de|0),Ae|0;if(!j)return S|0&&(p[S>>2]=0,p[S+4>>2]=(V>>>0)%(N>>>0)),de=0,Ae=(V>>>0)/(N>>>0)>>>0,ct(de|0),Ae|0;if(M=N-1|0,!(M&N))return S|0&&(p[S>>2]=A|0,p[S+4>>2]=M&V|m&0),de=0,Ae=V>>>((tf(N|0)|0)>>>0),ct(de|0),Ae|0;if(M=(Ot(N|0)|0)-(Ot(V|0)|0)|0,M>>>0<=30){m=M+1|0,N=31-M|0,C=m,A=V<<N|j>>>(m>>>0),m=V>>>(m>>>0),M=0,N=j<<N;break}return S?(p[S>>2]=A|0,p[S+4>>2]=I|m&0,de=0,Ae=0,ct(de|0),Ae|0):(de=0,Ae=0,ct(de|0),Ae|0)}while(!1);if(!C)V=N,I=0,N=0;else{oe=g|0|0,j=ge|v&0,V=Xt(oe|0,j|0,-1,-1)|0,g=te()|0,I=N,N=0;do v=I,I=M>>>31|I<<1,M=N|M<<1,v=A<<1|v>>>31|0,ge=A>>>31|m<<1|0,ns(V|0,g|0,v|0,ge|0)|0,Ae=te()|0,de=Ae>>31|((Ae|0)<0?-1:0)<<1,N=de&1,A=ns(v|0,ge|0,de&oe|0,(((Ae|0)<0?-1:0)>>31|((Ae|0)<0?-1:0)<<1)&j|0)|0,m=te()|0,C=C-1|0;while((C|0)!=0);V=I,I=0}return C=0,S|0&&(p[S>>2]=A,p[S+4>>2]=m),de=(M|0)>>>31|(V|C)<<1|(C<<1|M>>>31)&0|I,Ae=(M<<1|0)&-2|N,ct(de|0),Ae|0}function fl(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0;return V=m>>31|((m|0)<0?-1:0)<<1,I=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,M=v>>31|((v|0)<0?-1:0)<<1,S=((v|0)<0?-1:0)>>31|((v|0)<0?-1:0)<<1,N=ns(V^A|0,I^m|0,V|0,I|0)|0,C=te()|0,A=M^V,m=S^I,ns((Gc(N,C,ns(M^g|0,S^v|0,M|0,S|0)|0,te()|0,0)|0)^A|0,(te()|0)^m|0,A|0,m|0)|0}function nf(A,m){A=A|0,m=m|0;var g=0,v=0,S=0,M=0;return M=A&65535,S=m&65535,g=He(S,M)|0,v=A>>>16,A=(g>>>16)+(He(S,v)|0)|0,S=m>>>16,m=He(S,M)|0,ct((A>>>16)+(He(S,v)|0)+(((A&65535)+m|0)>>>16)|0),A+m<<16|g&65535|0|0}function Ur(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0;return S=A,M=g,g=nf(S,M)|0,A=te()|0,ct((He(m,M)|0)+(He(v,S)|0)+A|A&0|0),g|0|0|0}function rf(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0,C=0,N=0,I=0,V=0;return S=Z,Z=Z+16|0,N=S|0,C=m>>31|((m|0)<0?-1:0)<<1,M=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,V=v>>31|((v|0)<0?-1:0)<<1,I=((v|0)<0?-1:0)>>31|((v|0)<0?-1:0)<<1,A=ns(C^A|0,M^m|0,C|0,M|0)|0,m=te()|0,Gc(A,m,ns(V^g|0,I^v|0,V|0,I|0)|0,te()|0,N)|0,v=ns(p[N>>2]^C|0,p[N+4>>2]^M|0,C|0,M|0)|0,g=te()|0,Z=S,ct(g|0),v|0}function zc(A,m,g,v){A=A|0,m=m|0,g=g|0,v=v|0;var S=0,M=0;return M=Z,Z=Z+16|0,S=M|0,Gc(A,m,g,v,S)|0,Z=M,ct(p[S+4>>2]|0),p[S>>2]|0|0}function $2(A,m,g){return A=A|0,m=m|0,g=g|0,(g|0)<32?(ct(m>>g|0),A>>>g|(m&(1<<g)-1)<<32-g):(ct(((m|0)<0?-1:0)|0),m>>g-32|0)}function gt(A,m,g){return A=A|0,m=m|0,g=g|0,(g|0)<32?(ct(m>>>g|0),A>>>g|(m&(1<<g)-1)<<32-g):(ct(0),m>>>g-32|0)}function wt(A,m,g){return A=A|0,m=m|0,g=g|0,(g|0)<32?(ct(m<<g|(A&(1<<g)-1<<32-g)>>>32-g|0),A<<g):(ct(A<<g-32|0),0)}function M0(A,m,g){return A=A|0,m=m|0,m=Ot(m)|0,(m|0)==32&&(m=m+(Ot(A)|0)|0),ct(0),m|0}function Dd(A,m){return A=+A,m=+m,A!=A?+m:m!=m?+A:+Nt(+A,+m)}function Pd(A,m){return A=+A,m=+m,A!=A?+m:m!=m?+A:+Ie(+A,+m)}function Ru(A){return A=+A,A>=0?+hr(A+.5):+je(A-.5)}function Vc(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0;if((g|0)>=8192)return ni(A|0,m|0,g|0)|0,A|0;if(M=A|0,S=A+g|0,(A&3)==(m&3)){for(;A&3;){if(!g)return M|0;rt[A>>0]=rt[m>>0]|0,A=A+1|0,m=m+1|0,g=g-1|0}for(g=S&-4|0,v=g-64|0;(A|0)<=(v|0);)p[A>>2]=p[m>>2],p[A+4>>2]=p[m+4>>2],p[A+8>>2]=p[m+8>>2],p[A+12>>2]=p[m+12>>2],p[A+16>>2]=p[m+16>>2],p[A+20>>2]=p[m+20>>2],p[A+24>>2]=p[m+24>>2],p[A+28>>2]=p[m+28>>2],p[A+32>>2]=p[m+32>>2],p[A+36>>2]=p[m+36>>2],p[A+40>>2]=p[m+40>>2],p[A+44>>2]=p[m+44>>2],p[A+48>>2]=p[m+48>>2],p[A+52>>2]=p[m+52>>2],p[A+56>>2]=p[m+56>>2],p[A+60>>2]=p[m+60>>2],A=A+64|0,m=m+64|0;for(;(A|0)<(g|0);)p[A>>2]=p[m>>2],A=A+4|0,m=m+4|0}else for(g=S-4|0;(A|0)<(g|0);)rt[A>>0]=rt[m>>0]|0,rt[A+1>>0]=rt[m+1>>0]|0,rt[A+2>>0]=rt[m+2>>0]|0,rt[A+3>>0]=rt[m+3>>0]|0,A=A+4|0,m=m+4|0;for(;(A|0)<(S|0);)rt[A>>0]=rt[m>>0]|0,A=A+1|0,m=m+1|0;return M|0}function dl(A,m,g){A=A|0,m=m|0,g=g|0;var v=0,S=0,M=0,C=0;if(M=A+g|0,m=m&255,(g|0)>=67){for(;A&3;)rt[A>>0]=m,A=A+1|0;for(v=M&-4|0,C=m|m<<8|m<<16|m<<24,S=v-64|0;(A|0)<=(S|0);)p[A>>2]=C,p[A+4>>2]=C,p[A+8>>2]=C,p[A+12>>2]=C,p[A+16>>2]=C,p[A+20>>2]=C,p[A+24>>2]=C,p[A+28>>2]=C,p[A+32>>2]=C,p[A+36>>2]=C,p[A+40>>2]=C,p[A+44>>2]=C,p[A+48>>2]=C,p[A+52>>2]=C,p[A+56>>2]=C,p[A+60>>2]=C,A=A+64|0;for(;(A|0)<(v|0);)p[A>>2]=C,A=A+4|0}for(;(A|0)<(M|0);)rt[A>>0]=m,A=A+1|0;return M-g|0}function R0(A){return A=+A,A>=0?+hr(A+.5):+je(A-.5)}function $l(A){A=A|0;var m=0,g=0,v=0;return v=cn()|0,g=p[ci>>2]|0,m=g+A|0,(A|0)>0&(m|0)<(g|0)|(m|0)<0?(fr(m|0)|0,yn(12),-1):(m|0)>(v|0)&&!(Pi(m|0)|0)?(yn(12),-1):(p[ci>>2]=m,g|0)}return{___divdi3:fl,___muldi3:Ur,___remdi3:rf,___uremdi3:zc,_areNeighborCells:D3,_bitshift64Ashr:$2,_bitshift64Lshr:gt,_bitshift64Shl:wt,_calloc:Ko,_cellAreaKm2:W2,_cellAreaM2:$o,_cellAreaRads2:Co,_cellToBoundary:Pc,_cellToCenterChild:Cd,_cellToChildPos:Yh,_cellToChildren:Rd,_cellToChildrenSize:$h,_cellToLatLng:Eu,_cellToLocalIj:H3,_cellToParent:d0,_cellToVertex:Ao,_cellToVertexes:Fc,_cellsToDirectedEdge:P2,_cellsToLinkedMultiPolygon:vg,_childPosToCell:kg,_compactCells:B2,_destroyLinkedMultiPolygon:x0,_directedEdgeToBoundary:h0,_directedEdgeToCells:I3,_edgeLengthKm:Qh,_edgeLengthM:Gg,_edgeLengthRads:Yo,_emscripten_replace_memory:Li,_free:xn,_getBaseCellNumber:O2,_getDirectedEdgeDestination:L3,_getDirectedEdgeOrigin:P3,_getHexagonAreaAvgKm2:q2,_getHexagonAreaAvgM2:V3,_getHexagonEdgeLengthAvgKm:q3,_getHexagonEdgeLengthAvgM:H2,_getIcosahedronFaces:Bg,_getNumCells:g0,_getPentagons:Fg,_getRes0Cells:xd,_getResolution:Xh,_greatCircleDistanceKm:Ra,_greatCircleDistanceM:G2,_greatCircleDistanceRads:k2,_gridDisk:Ji,_gridDiskDistances:nl,_gridDistance:Vg,_gridPathCells:j2,_gridPathCellsSize:Vl,_gridRingUnsafe:vs,_i64Add:Xt,_i64Subtract:ns,_isPentagon:wi,_isResClassIII:Lg,_isValidCell:Ng,_isValidDirectedEdge:O3,_isValidVertex:Mu,_latLngToCell:Ig,_llvm_ctlz_i64:M0,_llvm_maxnum_f64:Dd,_llvm_minnum_f64:Pd,_llvm_round_f64:Ru,_localIjToCell:No,_malloc:hl,_maxFaceCount:F2,_maxGridDiskSize:Su,_maxPolygonToCellsSize:il,_maxPolygonToCellsSizeExperimental:b0,_memcpy:Vc,_memset:dl,_originToDirectedEdges:B3,_pentagonCount:Ug,_polygonToCells:x2,_polygonToCellsExperimental:Jh,_readInt64AsDoubleFromPointer:Xg,_res0CellCount:S2,_round:R0,_sbrk:$l,_sizeOfCellBoundary:Zs,_sizeOfCoordIJ:ul,_sizeOfGeoLoop:Nr,_sizeOfGeoPolygon:Ci,_sizeOfH3Index:Wg,_sizeOfLatLng:jg,_sizeOfLinkedGeoPolygon:Bc,_uncompactCells:U2,_uncompactCellsSize:Pg,_vertexToLatLng:jl,establishStackSpace:ls,stackAlloc:vn,stackRestore:mi,stackSave:Wi}}(It,Dn,H);e.___divdi3=fe.___divdi3,e.___muldi3=fe.___muldi3,e.___remdi3=fe.___remdi3,e.___uremdi3=fe.___uremdi3,e._areNeighborCells=fe._areNeighborCells,e._bitshift64Ashr=fe._bitshift64Ashr,e._bitshift64Lshr=fe._bitshift64Lshr,e._bitshift64Shl=fe._bitshift64Shl,e._calloc=fe._calloc,e._cellAreaKm2=fe._cellAreaKm2,e._cellAreaM2=fe._cellAreaM2,e._cellAreaRads2=fe._cellAreaRads2,e._cellToBoundary=fe._cellToBoundary,e._cellToCenterChild=fe._cellToCenterChild,e._cellToChildPos=fe._cellToChildPos,e._cellToChildren=fe._cellToChildren,e._cellToChildrenSize=fe._cellToChildrenSize,e._cellToLatLng=fe._cellToLatLng,e._cellToLocalIj=fe._cellToLocalIj,e._cellToParent=fe._cellToParent,e._cellToVertex=fe._cellToVertex,e._cellToVertexes=fe._cellToVertexes,e._cellsToDirectedEdge=fe._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=fe._cellsToLinkedMultiPolygon,e._childPosToCell=fe._childPosToCell,e._compactCells=fe._compactCells,e._destroyLinkedMultiPolygon=fe._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=fe._directedEdgeToBoundary,e._directedEdgeToCells=fe._directedEdgeToCells,e._edgeLengthKm=fe._edgeLengthKm,e._edgeLengthM=fe._edgeLengthM,e._edgeLengthRads=fe._edgeLengthRads;var Ut=e._emscripten_replace_memory=fe._emscripten_replace_memory;e._free=fe._free,e._getBaseCellNumber=fe._getBaseCellNumber,e._getDirectedEdgeDestination=fe._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=fe._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=fe._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=fe._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=fe._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=fe._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=fe._getIcosahedronFaces,e._getNumCells=fe._getNumCells,e._getPentagons=fe._getPentagons,e._getRes0Cells=fe._getRes0Cells,e._getResolution=fe._getResolution,e._greatCircleDistanceKm=fe._greatCircleDistanceKm,e._greatCircleDistanceM=fe._greatCircleDistanceM,e._greatCircleDistanceRads=fe._greatCircleDistanceRads,e._gridDisk=fe._gridDisk,e._gridDiskDistances=fe._gridDiskDistances,e._gridDistance=fe._gridDistance,e._gridPathCells=fe._gridPathCells,e._gridPathCellsSize=fe._gridPathCellsSize,e._gridRingUnsafe=fe._gridRingUnsafe,e._i64Add=fe._i64Add,e._i64Subtract=fe._i64Subtract,e._isPentagon=fe._isPentagon,e._isResClassIII=fe._isResClassIII,e._isValidCell=fe._isValidCell,e._isValidDirectedEdge=fe._isValidDirectedEdge,e._isValidVertex=fe._isValidVertex,e._latLngToCell=fe._latLngToCell,e._llvm_ctlz_i64=fe._llvm_ctlz_i64,e._llvm_maxnum_f64=fe._llvm_maxnum_f64,e._llvm_minnum_f64=fe._llvm_minnum_f64,e._llvm_round_f64=fe._llvm_round_f64,e._localIjToCell=fe._localIjToCell,e._malloc=fe._malloc,e._maxFaceCount=fe._maxFaceCount,e._maxGridDiskSize=fe._maxGridDiskSize,e._maxPolygonToCellsSize=fe._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=fe._maxPolygonToCellsSizeExperimental,e._memcpy=fe._memcpy,e._memset=fe._memset,e._originToDirectedEdges=fe._originToDirectedEdges,e._pentagonCount=fe._pentagonCount,e._polygonToCells=fe._polygonToCells,e._polygonToCellsExperimental=fe._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=fe._readInt64AsDoubleFromPointer,e._res0CellCount=fe._res0CellCount,e._round=fe._round,e._sbrk=fe._sbrk,e._sizeOfCellBoundary=fe._sizeOfCellBoundary,e._sizeOfCoordIJ=fe._sizeOfCoordIJ,e._sizeOfGeoLoop=fe._sizeOfGeoLoop,e._sizeOfGeoPolygon=fe._sizeOfGeoPolygon,e._sizeOfH3Index=fe._sizeOfH3Index,e._sizeOfLatLng=fe._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=fe._sizeOfLinkedGeoPolygon,e._uncompactCells=fe._uncompactCells,e._uncompactCellsSize=fe._uncompactCellsSize,e._vertexToLatLng=fe._vertexToLatLng,e.establishStackSpace=fe.establishStackSpace;var xt=e.stackAlloc=fe.stackAlloc,Ht=e.stackRestore=fe.stackRestore,Ct=e.stackSave=fe.stackSave;if(e.asm=fe,e.cwrap=D,e.setValue=x,e.getValue=b,Lt){pe(Lt)||(Lt=s(Lt));{Ft();var ut=function(ke){ke.byteLength&&(ke=new Uint8Array(ke)),K.set(ke,_),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Tt()},kt=function(){o(Lt,ut,function(){throw"could not load memory initializer "+Lt})},hn=sn(Lt);if(hn)ut(hn.buffer);else if(e.memoryInitializerRequest){var $n=function(){var ke=e.memoryInitializerRequest,We=ke.response;if(ke.status!==200&&ke.status!==0){var St=sn(e.memoryInitializerRequestURL);if(St)We=St.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+ke.status+", retrying "+Lt),kt();return}}ut(We)};e.memoryInitializerRequest.response?setTimeout($n,0):e.memoryInitializerRequest.addEventListener("load",$n)}else kt()}}var Bn;et=function ke(){Bn||Hi(),Bn||(et=ke)};function Hi(ke){if(pt>0||(at(),pt>0))return;function We(){Bn||(Bn=!0,!R&&(At(),Gt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Dt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),We()},1)):We()}e.run=Hi;function Ti(ke){throw e.onAbort&&e.onAbort(ke),ke+="",a(ke),l(ke),R=!0,"abort("+ke+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Ti,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Hi(),i}(typeof bi=="object"?bi:{}),qn="number",Rn=qn,O1=qn,Gn=qn,zn=qn,ks=qn,en=qn,bae=[["sizeOfH3Index",qn],["sizeOfLatLng",qn],["sizeOfCellBoundary",qn],["sizeOfGeoLoop",qn],["sizeOfGeoPolygon",qn],["sizeOfLinkedGeoPolygon",qn],["sizeOfCoordIJ",qn],["readInt64AsDoubleFromPointer",qn],["isValidCell",O1,[Gn,zn]],["latLngToCell",Rn,[qn,qn,ks,en]],["cellToLatLng",Rn,[Gn,zn,en]],["cellToBoundary",Rn,[Gn,zn,en]],["maxGridDiskSize",Rn,[qn,en]],["gridDisk",Rn,[Gn,zn,qn,en]],["gridDiskDistances",Rn,[Gn,zn,qn,en,en]],["gridRingUnsafe",Rn,[Gn,zn,qn,en]],["maxPolygonToCellsSize",Rn,[en,ks,qn,en]],["polygonToCells",Rn,[en,ks,qn,en]],["maxPolygonToCellsSizeExperimental",Rn,[en,ks,qn,en]],["polygonToCellsExperimental",Rn,[en,ks,qn,qn,qn,en]],["cellsToLinkedMultiPolygon",Rn,[en,qn,en]],["destroyLinkedMultiPolygon",null,[en]],["compactCells",Rn,[en,en,qn,qn]],["uncompactCells",Rn,[en,qn,qn,en,qn,ks]],["uncompactCellsSize",Rn,[en,qn,qn,ks,en]],["isPentagon",O1,[Gn,zn]],["isResClassIII",O1,[Gn,zn]],["getBaseCellNumber",qn,[Gn,zn]],["getResolution",qn,[Gn,zn]],["maxFaceCount",Rn,[Gn,zn,en]],["getIcosahedronFaces",Rn,[Gn,zn,en]],["cellToParent",Rn,[Gn,zn,ks,en]],["cellToChildren",Rn,[Gn,zn,ks,en]],["cellToCenterChild",Rn,[Gn,zn,ks,en]],["cellToChildrenSize",Rn,[Gn,zn,ks,en]],["cellToChildPos",Rn,[Gn,zn,ks,en]],["childPosToCell",Rn,[qn,qn,Gn,zn,ks,en]],["areNeighborCells",Rn,[Gn,zn,Gn,zn,en]],["cellsToDirectedEdge",Rn,[Gn,zn,Gn,zn,en]],["getDirectedEdgeOrigin",Rn,[Gn,zn,en]],["getDirectedEdgeDestination",Rn,[Gn,zn,en]],["isValidDirectedEdge",O1,[Gn,zn]],["directedEdgeToCells",Rn,[Gn,zn,en]],["originToDirectedEdges",Rn,[Gn,zn,en]],["directedEdgeToBoundary",Rn,[Gn,zn,en]],["gridDistance",Rn,[Gn,zn,Gn,zn,en]],["gridPathCells",Rn,[Gn,zn,Gn,zn,en]],["gridPathCellsSize",Rn,[Gn,zn,Gn,zn,en]],["cellToLocalIj",Rn,[Gn,zn,Gn,zn,qn,en]],["localIjToCell",Rn,[Gn,zn,en,qn,en]],["getHexagonAreaAvgM2",Rn,[ks,en]],["getHexagonAreaAvgKm2",Rn,[ks,en]],["getHexagonEdgeLengthAvgM",Rn,[ks,en]],["getHexagonEdgeLengthAvgKm",Rn,[ks,en]],["greatCircleDistanceM",qn,[en,en]],["greatCircleDistanceKm",qn,[en,en]],["greatCircleDistanceRads",qn,[en,en]],["cellAreaM2",Rn,[Gn,zn,en]],["cellAreaKm2",Rn,[Gn,zn,en]],["cellAreaRads2",Rn,[Gn,zn,en]],["edgeLengthM",Rn,[Gn,zn,en]],["edgeLengthKm",Rn,[Gn,zn,en]],["edgeLengthRads",Rn,[Gn,zn,en]],["getNumCells",Rn,[ks,en]],["getRes0Cells",Rn,[en]],["res0CellCount",qn],["getPentagons",Rn,[qn,en]],["pentagonCount",qn],["cellToVertex",Rn,[Gn,zn,qn,en]],["cellToVertexes",Rn,[Gn,zn,en]],["vertexToLatLng",Rn,[Gn,zn,en]],["isValidVertex",O1,[Gn,zn]]],Sae=0,Tae=1,Eae=2,wae=3,qF=4,Mae=5,Rae=6,Cae=7,Nae=8,Dae=9,Pae=10,Lae=11,Oae=12,Iae=13,Bae=14,Uae=15,uo={};uo[Sae]="Success";uo[Tae]="The operation failed but a more specific error is not available";uo[Eae]="Argument was outside of acceptable range";uo[wae]="Latitude or longitude arguments were outside of acceptable range";uo[qF]="Resolution argument was outside of acceptable range";uo[Mae]="Cell argument was not valid";uo[Rae]="Directed edge argument was not valid";uo[Cae]="Undirected edge argument was not valid";uo[Nae]="Vertex argument was not valid";uo[Dae]="Pentagon distortion was encountered";uo[Pae]="Duplicate input";uo[Lae]="Cell arguments were not neighbors";uo[Oae]="Cell arguments had incompatible resolutions";uo[Iae]="Memory allocation failed";uo[Bae]="Bounds of provided memory were insufficient";uo[Uae]="Mode or flags argument was not valid";var Fae=1e3,HF=1001,WF=1002,_T={};_T[Fae]="Unknown unit";_T[HF]="Array length out of bounds";_T[WF]="Got unexpected null value for H3 index";var kae="Unknown error";function jF(i,e,t){var n=t&&"value"in t,r=new Error((i[e]||kae)+" (code: "+e+(n?", value: "+t.value:"")+")");return r.code=e,r}function XF(i,e){var t=arguments.length===2?{value:e}:{};return jF(uo,i,t)}function $F(i,e){var t=arguments.length===2?{value:e}:{};return jF(_T,i,t)}function py(i){if(i!==0)throw XF(i)}var va={};bae.forEach(function(e){va[e[0]]=bi.cwrap.apply(bi,e)});var qp=16,my=4,Vm=8,Gae=8,xS=va.sizeOfH3Index(),U8=va.sizeOfLatLng(),zae=va.sizeOfCellBoundary(),Vae=va.sizeOfGeoPolygon(),C_=va.sizeOfGeoLoop();va.sizeOfLinkedGeoPolygon();va.sizeOfCoordIJ();function qae(i){if(typeof i!="number"||i<0||i>15||Math.floor(i)!==i)throw XF(qF,i);return i}function Hae(i){if(!i)throw $F(WF);return i}var Wae=Math.pow(2,32)-1;function jae(i){if(i>Wae)throw $F(HF,i);return i}var Xae=/[^0-9a-fA-F]/;function YF(i){if(Array.isArray(i)&&i.length===2&&Number.isInteger(i[0])&&Number.isInteger(i[1]))return i;if(typeof i!="string"||Xae.test(i))return[0,0];var e=parseInt(i.substring(0,i.length-8),qp),t=parseInt(i.substring(i.length-8),qp);return[t,e]}function MO(i){if(i>=0)return i.toString(qp);i=i&2147483647;var e=QF(8,i.toString(qp)),t=(parseInt(e[0],qp)+8).toString(qp);return e=t+e.substring(1),e}function $ae(i,e){return MO(e)+QF(8,MO(i))}function QF(i,e){for(var t=i-e.length,n="",r=0;r<t;r++)n+="0";return n=n+e,n}function RO(i,e,t){for(var n=i.length,r=bi._calloc(n,U8),s=t?1:0,o=t?0:1,a=0;a<n*2;a+=2)bi.HEAPF64.set([i[a/2][s],i[a/2][o]].map(ek),r/Vm+a);return bi.HEAPU32.set([n,r],e/my),e}function Yae(i,e){var t=i.length-1,n=bi._calloc(Vae),r=0,s=r+C_,o=s+my;RO(i[0],n+r,e);var a;if(t>0){a=bi._calloc(t,C_);for(var l=0;l<t;l++)RO(i[l+1],a+C_*l,e)}return bi.setValue(n+s,t,"i32"),bi.setValue(n+o,a,"i32"),n}function Qae(i){var e=0,t=e+C_,n=t+my,r=my;bi._free(bi.getValue(i+e+r,"i8*"));var s=bi.getValue(i+t,"i32");if(s>0){for(var o=bi.getValue(i+n,"i32"),a=0;a<s;a++)bi._free(bi.getValue(o+C_*a+r,"i8*"));bi._free(o)}bi._free(i)}function KF(i,e){e===void 0&&(e=0);var t=bi.getValue(i+xS*e,"i32"),n=bi.getValue(i+xS*e+my,"i32");return n?$ae(t,n):null}function Kae(i){return va.readInt64AsDoubleFromPointer(i)}function Zae(i,e){for(var t=[],n=0;n<e;n++){var r=KF(i,n);r!==null&&t.push(r)}return t}function bS(i){return ile(bi.getValue(i,"double"))}function Jae(i){return[bS(i),bS(i+Vm)]}function ele(i){return[bS(i+Vm),bS(i)]}function tle(i,e,t){for(var n=bi.getValue(i,"i32"),r=i+Vm,s=[],o=ele,a=0;a<n*2;a+=2)s.push(o(r+Vm*a));return s.push(s[0]),s}function nle(i,e,t){var n=bi._malloc(U8);bi.HEAPF64.set([i,e].map(ek),n/Vm);var r=bi._malloc(xS);try{return py(va.latLngToCell(n,t,r)),Hae(KF(r))}finally{bi._free(r),bi._free(n)}}function ZF(i){var e=bi._malloc(U8),t=YF(i),n=t[0],r=t[1];try{return py(va.cellToLatLng(n,r,e)),Jae(e)}finally{bi._free(e)}}function JF(i,e){var t=bi._malloc(zae),n=YF(i),r=n[0],s=n[1];try{return py(va.cellToBoundary(r,s,t)),tle(t,e,e)}finally{bi._free(t)}}function CO(i,e,t){if(qae(e),t=!!t,i.length===0||i[0].length===0)return[];var n=typeof i[0][0]=="number"?[i]:i,r=Yae(n,t),s=bi._malloc(Gae);try{py(va.maxPolygonToCellsSize(r,e,0,s));var o=jae(Kae(s)),a=bi._calloc(o,xS);try{return py(va.polygonToCells(r,e,0,a)),Zae(a,o)}finally{bi._free(a)}}finally{bi._free(s),Qae(r)}}function ek(i){return i*Math.PI/180}function ile(i){return i*180/Math.PI}function rle(i){return i=Math.max(0,Math.min(1,i)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+i*(1172.33-i*(10793.56-i*(33300.12-i*(38394.49-i*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+i*(557.33+i*(1225.33-i*(3574.96-i*(1073.77+i*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+i*(3211.1-i*(15327.97-i*(27814-i*(22569.18-i*6838.66)))))))+")"}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const sle=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class ole{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=sle,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:s}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:o,height:a}=e.context;t.bufferWidth=o,t.bufferHeight=a}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e){const{object:t,material:n,geometry:r}=e,s=this.getRenderObjectData(e);if(s.worldMatrix.equals(t.matrixWorld)!==!0)return s.worldMatrix.copy(t.matrixWorld),!1;const o=s.material;for(const R in o){const E=o[R],w=n[R];if(E.equals!==void 0){if(E.equals(w)===!1)return E.copy(w),!1}else if(w.isTexture===!0){if(E.id!==w.id||E.version!==w.version)return E.id=w.id,E.version=w.version,!1}else if(E!==w)return o[R]=w,!1}if(o.transmission>0){const{width:R,height:E}=e.context;if(s.bufferWidth!==R||s.bufferHeight!==E)return s.bufferWidth=R,s.bufferHeight=E,!1}const a=s.geometry,l=r.attributes,u=a.attributes,h=Object.keys(u),d=Object.keys(l);if(a.id!==r.id)return a.id=r.id,!1;if(h.length!==d.length)return s.geometry.attributes=this.getAttributesData(l),!1;for(const R of h){const E=u[R],w=l[R];if(w===void 0)return delete u[R],!1;if(E.version!==w.version)return E.version=w.version,!1}const _=r.index,x=a.indexVersion,b=_?_.version:null;if(x!==b)return a.indexVersion=b,!1;if(a.drawRange.start!==r.drawRange.start||a.drawRange.count!==r.drawRange.count)return a.drawRange.start=r.drawRange.start,a.drawRange.count=r.drawRange.count,!1;if(s.morphTargetInfluences){let R=!1;for(let E=0;E<s.morphTargetInfluences.length;E++)s.morphTargetInfluences[E]!==t.morphTargetInfluences[E]&&(R=!0);if(R)return!0}return s.center&&s.center.equals(t.center)===!1?(s.center.copy(t.center),!0):(e.bundle!==null&&(s.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||s?!1:this.equals(e)!==!0}}function gy(i,e=0){let t=3735928559^e,n=1103547991^e;if(i instanceof Array)for(let r=0,s;r<i.length;r++)s=i[r],t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);else for(let r=0,s;r<i.length;r++)s=i.charCodeAt(r),t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const tk=i=>gy(i),yT=i=>gy(i),SS=(...i)=>gy(i);function nk(i,e=!1){const t=[];i.isNode===!0&&(t.push(i.id),i=i.getSelf());for(const{property:n,childNode:r}of TS(i))t.push(gy(n.slice(0,-4)),r.getCacheKey(e));return gy(t)}function*TS(i,e=!1){for(const t in i){if(t.startsWith("_")===!0)continue;const n=i[t];if(Array.isArray(n)===!0)for(let r=0;r<n.length;r++){const s=n[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}else if(n&&n.isNode===!0)yield{property:t,childNode:n};else if(typeof n=="object")for(const r in n){const s=n[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}}}const ale=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),NO=new WeakMap;function ik(i){return ale.get(i)}function ES(i){if(/[iu]?vec\d/.test(i))return i.startsWith("ivec")?Int32Array:i.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(i)||/float/.test(i))return Float32Array;if(/uint/.test(i))return Uint32Array;if(/int/.test(i))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${i}`)}function rk(i){if(/float|int|uint/.test(i))return 1;if(/vec2/.test(i))return 2;if(/vec3/.test(i))return 3;if(/vec4/.test(i)||/mat2/.test(i))return 4;if(/mat3/.test(i))return 9;if(/mat4/.test(i))return 16;console.error("THREE.TSL: Unsupported type:",i)}function lle(i){if(/float|int|uint/.test(i))return 1;if(/vec2/.test(i))return 2;if(/vec3/.test(i))return 3;if(/vec4/.test(i)||/mat2/.test(i))return 4;if(/mat3/.test(i))return 12;if(/mat4/.test(i))return 16;console.error("THREE.TSL: Unsupported type:",i)}function ule(i){if(/float|int|uint/.test(i))return 4;if(/vec2/.test(i))return 8;if(/vec3/.test(i)||/vec4/.test(i))return 16;if(/mat2/.test(i))return 8;if(/mat3/.test(i))return 48;if(/mat4/.test(i))return 64;console.error("THREE.TSL: Unsupported type:",i)}function $f(i){if(i==null)return null;const e=typeof i;return i.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":i.isVector2===!0?"vec2":i.isVector3===!0?"vec3":i.isVector4===!0?"vec4":i.isMatrix2===!0?"mat2":i.isMatrix3===!0?"mat3":i.isMatrix4===!0?"mat4":i.isColor===!0?"color":i instanceof ArrayBuffer?"ArrayBuffer":null}function sk(i,...e){const t=i?i.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),i==="color"?new Jt(...e):t==="vec2"?new it(...e):t==="vec3"?new ce(...e):t==="vec4"?new mn(...e):t==="mat2"?new dT(...e):t==="mat3"?new Hn(...e):t==="mat4"?new Cn(...e):i==="bool"?e[0]||!1:i==="float"||i==="int"||i==="uint"?e[0]||0:i==="string"?e[0]||"":i==="ArrayBuffer"?lk(e[0]):null}function ok(i){let e=NO.get(i);return e===void 0&&(e={},NO.set(i,e)),e}function ak(i){let e="";const t=new Uint8Array(i);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function lk(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0)).buffer}const f_={VERTEX:"vertex",FRAGMENT:"fragment"},Kn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},cle={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},To={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},uk=["fragment","vertex"],CC=["setup","analyze","generate"],NC=[...uk,"compute"],ZA=["x","y","z","w"],hle={analyze:"setup",generate:"analyze"};let fle=0;class dn extends gc{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Kn.NONE,this.updateBeforeType=Kn.NONE,this.updateAfterType=Kn.NONE,this.uuid=Lm.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:fle++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,Kn.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Kn.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Kn.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of TS(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=SS(nk(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const s of Object.values(r))s&&s.isNode===!0&&s.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const s=hle[e.buildStage];if(s&&r.buildStages[s]!==!0){const l=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(l)}e.addNode(this),e.addChain(this);let o=null;const a=e.getBuildStage();if(a==="setup"){this.updateReference(e);const l=e.getNodeProperties(this);if(l.initialized!==!0){l.initialized=!0,l.outputNode=this.setup(e)||l.outputNode||null;for(const u of Object.values(l))if(u&&u.isNode===!0){if(u.parents===!0){const h=e.getNodeProperties(u);h.parents=h.parents||[],h.parents.push(this)}u.build(e)}}o=l.outputNode}else if(a==="analyze")this.analyze(e,t);else if(a==="generate")if(this.generate.length===1){const u=this.getNodeType(e),h=e.getDataFromNode(this);o=h.snippet,o===void 0?h.generated===void 0?(h.generated=!0,o=this.generate(e)||"",h.snippet=o):(console.warn("THREE.Node: Recursion detected.",this),o="/* Recursion detected. */"):h.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),o=e.format(o,u,t)}else o=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),o}getSerializeChildren(){return TS(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:s,childNode:o}of t)s!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(s)?[]:{}),n[r][s]=o.toJSON(e.meta).uuid):n[r]=o.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const s of e.inputNodes[n])r.push(t[s]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const s in e.inputNodes[n]){const o=e.inputNodes[n][s];r[s]=t[o]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(a){const l=[];for(const u in a){const h=a[u];delete h.metadata,l.push(h)}return l}if(r){const a=o(e.textures),l=o(e.images),u=o(e.nodes);a.length>0&&(s.textures=a),l.length>0&&(s.images=l),u.length>0&&(s.nodes=u)}return s}}class JA extends dn{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class ck extends dn{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),s=n.build(e,r);return e.format(s,r,t)}}class _s extends dn{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,r),a=e.getVarFromNode(this,null,r),l=e.getPropertyName(a);return e.addLineFlowCode(`${l} = ${o}`,this),s.snippet=o,s.propertyName=l,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class dle extends _s{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),s=this.nodes,o=e.getComponentType(n),a=[];let l=0;for(const h of s){if(l>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let d=h.getNodeType(e),_=e.getTypeLength(d),x;l+_>r&&(console.error(`THREE.TSL: Length of '${n}()' data exceeds maximum length of output type.`),_=r-l,d=e.getTypeFromLength(_)),l+=_,x=h.build(e,d);const b=e.getComponentType(d);b!==o&&(x=e.format(x,b,o)),a.push(x)}const u=`${e.getType(n)}( ${a.join(", ")} )`;return e.format(u,n,t)}}const Ale=ZA.join("");class DC extends dn{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(ZA.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let s=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=n.build(e,o);this.components.length===r&&this.components===Ale.slice(0,this.components.length)?s=e.format(l,o,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=n.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class ple extends _s{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,s=this.getNodeType(e),o=e.getComponentType(r.getNodeType(e)),a=e.getTypeFromLength(n.length,o),l=r.build(e,a),u=t.build(e,s),h=e.getTypeLength(s),d=[];for(let _=0;_<h;_++){const x=ZA[_];x===n[0]?(d.push(l),_+=n.length-1):d.push(u+"."+x)}return`${e.getType(s)}( ${d.join(", ")} )`}}class mle extends _s{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),s=n.build(e),o=e.getVarFromNode(this),a=e.getPropertyName(o);e.addLineFlowCode(a+" = "+s,this);const l=e.getTypeLength(r),u=[];let h=0;for(let d=0;d<l;d++){const _=ZA[d];_===t[h]?(u.push("1.0 - "+(a+"."+_)),h++):u.push(a+"."+_)}return`${e.getType(r)}( ${u.join(", ")} )`}}class F8 extends dn{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?$f(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=$f(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=ak(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?sk(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const DO=/float|u?int/;class bu extends F8{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return DO.test(n)&&DO.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class gle extends dn{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let jA=null;const Hp=new Map;function tt(i,e){if(Hp.has(i)){console.warn(`THREE.TSL: Redefinition of method chaining '${i}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${i} is not a function`);Hp.set(i,e)}const hk=i=>i.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),PO=i=>hk(i).split("").sort().join(""),fk={setup(i,e){const t=e.shift();return i(e2(t),...e)},get(i,e,t){if(typeof e=="string"&&i[e]===void 0){if(i.isStackNode!==!0&&e==="assign")return(...n)=>(jA.assign(t,...n),t);if(Hp.has(e)){const n=Hp.get(e);return i.isStackNode?(...r)=>t.add(n(...r)):(...r)=>n(t,...r)}else{if(e==="self")return i;if(e.endsWith("Assign")&&Hp.has(e.slice(0,e.length-6))){const n=Hp.get(e.slice(0,e.length-6));return i.isStackNode?(...r)=>t.assign(r[0],n(...r)):(...r)=>t.assign(n(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=hk(e),Ze(new DC(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=PO(e.slice(3).toLowerCase()),n=>Ze(new ple(i,e,Ze(n)));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=PO(e.slice(4).toLowerCase()),()=>Ze(new mle(Ze(i),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),Ze(new DC(i,e));if(/^\d+$/.test(e)===!0)return Ze(new JA(t,new bu(Number(e),"uint")));if(/^get$/.test(e)===!0)return n=>Ze(new gle(t,n))}}}return Reflect.get(i,e,t)},set(i,e,t,n){return typeof e=="string"&&i[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(n[e].assign(t),!0):Reflect.set(i,e,t,n)}},rM=new WeakMap,LO=new WeakMap,_le=function(i,e=null){const t=$f(i);if(t==="node"){let n=rM.get(i);return n===void 0&&(n=new Proxy(i,fk),rM.set(i,n),rM.set(n,n)),n}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return Ze(PC(i,e));if(t==="shader")return i.isFn?i:Ce(i)}return i},yle=function(i,e=null){for(const t in i)i[t]=Ze(i[t],e);return i},vle=function(i,e=null){const t=i.length;for(let n=0;n<t;n++)i[n]=Ze(i[n],e);return i},xle=function(i,e=null,t=null,n=null){const r=h=>Ze(n!==null?Object.assign(h,n):h);let s,o=e,a,l;function u(h){let d;return o?d=/[a-z]/i.test(o)?o+"()":o:d=i.type,a!==void 0&&h.length<a?(console.error(`THREE.TSL: "${d}" parameter length is less than minimum required.`),h.concat(new Array(a-h.length).fill(0))):l!==void 0&&h.length>l?(console.error(`THREE.TSL: "${d}" parameter length exceeds limit.`),h.slice(0,l)):h}return e===null?s=(...h)=>r(new i(...NA(u(h)))):t!==null?(t=Ze(t),s=(...h)=>r(new i(e,...NA(u(h)),t))):s=(...h)=>r(new i(e,...NA(u(h)))),s.setParameterLength=(...h)=>(h.length===1?a=l=h[0]:h.length===2&&([a,l]=h),s),s.setName=h=>(o=h,s),s},ble=function(i,...e){return Ze(new i(...NA(e)))};class Sle extends dn{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:n}=this,r=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",o=s||"default";if(r[o])return r[o];const a=e.subBuildFn;e.subBuildFn=s;let l=null;if(t.layout){let u=LO.get(e.constructor);u===void 0&&(u=new WeakMap,LO.set(e.constructor,u));let h=u.get(t);h===void 0&&(h=Ze(e.buildFunctionNode(t)),u.set(t,h)),e.addInclude(h),l=Ze(h.call(n))}else{const u=t.jsFunc,h=n!==null||u.length>1?u(n||[],e):u(e);l=Ze(h)}return e.subBuildFn=a,t.once&&(r[o]=l),l}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getSubBuildOutput(this);return t[n]=t[n]||this.setupOutput(e),t[n].subBuild=e.getClosestSubBuild(this),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),s=e.getNodeProperties(this),o=e.getSubBuildOutput(this),a=this.getOutputNode(e);if(r==="setup"){const l=e.getSubBuildProperty("initialized",this);if(s[l]!==!0&&(s[l]=!0,s[o]=this.getOutputNode(e),s[o].build(e),this.shaderNode.subBuilds))for(const u of e.chaining){const h=e.getDataFromNode(u,"any");h.subBuilds=h.subBuilds||new Set;for(const d of this.shaderNode.subBuilds)h.subBuilds.add(d)}n=s[o]}else r==="analyze"?a.build(e,t):r==="generate"&&(n=a.build(e,t)||"");return n}}class Tle extends dn{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return e2(e),Ze(new Sle(this,e))}setup(){return this.call()}}const Ele=[!1,!0],wle=[0,1,2,3],Mle=[-1,-2],dk=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],k8=new Map;for(const i of Ele)k8.set(i,new bu(i));const G8=new Map;for(const i of wle)G8.set(i,new bu(i,"uint"));const z8=new Map([...G8].map(i=>new bu(i.value,"int")));for(const i of Mle)z8.set(i,new bu(i,"int"));const vT=new Map([...z8].map(i=>new bu(i.value)));for(const i of dk)vT.set(i,new bu(i));for(const i of dk)vT.set(-i,new bu(-i));const xT={bool:k8,uint:G8,ints:z8,float:vT},OO=new Map([...k8,...vT]),PC=(i,e)=>OO.has(i)?OO.get(i):i.isNode===!0?i:new bu(i,e),ys=function(i,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(i)&&t.every(r=>typeof r!="object"))&&(t=[sk(i,...t)]),t.length===1&&e!==null&&e.has(t[0]))return Ze(e.get(t[0]));if(t.length===1){const r=PC(t[0],i);return r.nodeType===i?Ze(r):Ze(new ck(r,i))}const n=t.map(r=>PC(r));return Ze(new dle(n,i))}},_y=i=>typeof i=="object"&&i!==null?i.value:i,Ak=i=>i!=null?i.nodeType||i.convertTo||(typeof i=="string"?i:null):null;function Wp(i,e){return new Proxy(new Tle(i,e),fk)}const Ze=(i,e=null)=>_le(i,e),e2=(i,e=null)=>new yle(i,e),NA=(i,e=null)=>new vle(i,e),st=(...i)=>new xle(...i),Pt=(...i)=>new ble(...i);let Rle=0;const Ce=(i,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const n=new Wp(i,t),r=(...s)=>{let o;e2(s),s[0]&&(s[0].isNode||Object.getPrototypeOf(s[0])!==Object.prototype)?o=[...s]:o=s[0];const l=n.call(o);return t==="void"&&l.toStack(),l};if(r.shaderNode=n,r.id=n.id,r.isFn=!0,r.getNodeType=(...s)=>n.getNodeType(...s),r.getCacheKey=(...s)=>n.getCacheKey(...s),r.setLayout=s=>(n.setLayout(s),r),r.once=(s=null)=>(n.once=!0,n.subBuilds=s,r),e!==null){if(typeof e.inputs!="object"){const s={name:"fn"+Rle++,type:t,inputs:[]};for(const o in e)o!=="return"&&s.inputs.push({name:o,type:e[o]});e=s}r.setLayout(e)}return r},yy=i=>{jA=i},V8=()=>jA,Xn=(...i)=>jA.If(...i),Cle=(...i)=>jA.Switch(...i);function bT(i){return jA&&jA.add(i),i}tt("toStack",bT);const pk=new ys("color"),me=new ys("float",xT.float),be=new ys("int",xT.ints),Vt=new ys("uint",xT.uint),cc=new ys("bool",xT.bool),dt=new ys("vec2"),ws=new ys("ivec2"),mk=new ys("uvec2"),gk=new ys("bvec2"),Me=new ys("vec3"),_k=new ys("ivec3"),dg=new ys("uvec3"),q8=new ys("bvec3"),an=new ys("vec4"),yk=new ys("ivec4"),vk=new ys("uvec4"),xk=new ys("bvec4"),ST=new ys("mat2"),Ro=new ys("mat3"),DA=new ys("mat4"),Nle=(i="")=>Ze(new bu(i,"string")),Dle=i=>Ze(new bu(i,"ArrayBuffer"));tt("toColor",pk);tt("toFloat",me);tt("toInt",be);tt("toUint",Vt);tt("toBool",cc);tt("toVec2",dt);tt("toIVec2",ws);tt("toUVec2",mk);tt("toBVec2",gk);tt("toVec3",Me);tt("toIVec3",_k);tt("toUVec3",dg);tt("toBVec3",q8);tt("toVec4",an);tt("toIVec4",yk);tt("toUVec4",vk);tt("toBVec4",xk);tt("toMat2",ST);tt("toMat3",Ro);tt("toMat4",DA);const bk=st(JA).setParameterLength(2),Sk=(i,e)=>Ze(new ck(Ze(i),e)),Ple=(i,e)=>Ze(new DC(Ze(i),e));tt("element",bk);tt("convert",Sk);const Lle=i=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),bT(i));tt("append",i=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),bT(i)));class qi extends dn{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const vh=(i,e)=>Ze(new qi(i,e)),vy=(i,e)=>Ze(new qi(i,e,!0)),Di=Pt(qi,"vec4","DiffuseColor"),LC=Pt(qi,"vec3","EmissiveColor"),qu=Pt(qi,"float","Roughness"),xy=Pt(qi,"float","Metalness"),wS=Pt(qi,"float","Clearcoat"),by=Pt(qi,"float","ClearcoatRoughness"),_A=Pt(qi,"vec3","Sheen"),TT=Pt(qi,"float","SheenRoughness"),ET=Pt(qi,"float","Iridescence"),H8=Pt(qi,"float","IridescenceIOR"),W8=Pt(qi,"float","IridescenceThickness"),MS=Pt(qi,"float","AlphaT"),Vf=Pt(qi,"float","Anisotropy"),N_=Pt(qi,"vec3","AnisotropyT"),PA=Pt(qi,"vec3","AnisotropyB"),na=Pt(qi,"color","SpecularColor"),Sy=Pt(qi,"float","SpecularF90"),RS=Pt(qi,"float","Shininess"),im=Pt(qi,"vec4","Output"),Rb=Pt(qi,"float","dashSize"),OC=Pt(qi,"float","gapSize"),Ole=Pt(qi,"float","pointWidth"),D_=Pt(qi,"float","IOR"),CS=Pt(qi,"float","Transmission"),j8=Pt(qi,"float","Thickness"),X8=Pt(qi,"float","AttenuationDistance"),$8=Pt(qi,"color","AttenuationColor"),Y8=Pt(qi,"float","Dispersion");class Tk extends dn{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const Ek=i=>new Tk(i),wT=(i,e=0)=>new Tk(i,!0,e),wk=wT("frame"),pn=wT("render"),Q8=Ek("object");class t2 extends F8{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=Q8}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate(r=>{const s=e(r,n);s!==void 0&&(this.value=s)},t)}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const o=s.getInputType(e),a=e.getUniformFromNode(s,o,e.shaderStage,this.name||e.context.label),l=e.getPropertyName(a);return e.context.label!==void 0&&delete e.context.label,e.format(l,n,t)}}const ln=(i,e)=>{const t=Ak(e||i),n=i&&i.isNode===!0?i.node&&i.node.value||i.value:i;return Ze(new t2(n,t))};class IO extends _s{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const Mk=(...i)=>{let e;if(i.length===1){const t=i[0];e=new IO(null,t.length,t)}else{const t=i[0],n=i[1];e=new IO(t,n)}return Ze(e)};tt("toArray",(i,e)=>Mk(Array(e).fill(i)));class Ile extends _s{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return ZA.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=e.getNodeProperties(this);r.sourceNode=n,r.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),s=this.needsSplitAssign(e),o=n.getNodeType(e),a=n.build(e),l=r.build(e,o),u=r.getNodeType(e),h=e.getDataFromNode(this);let d;if(h.initialized===!0)t!=="void"&&(d=a);else if(s){const _=e.getVarFromNode(this,null,o),x=e.getPropertyName(_);e.addLineFlowCode(`${x} = ${l}`,this);const b=n.node,E=b.node.context({assign:!0}).build(e);for(let w=0;w<b.components.length;w++){const L=b.components[w];e.addLineFlowCode(`${E}.${L} = ${x}[ ${w} ]`,this)}t!=="void"&&(d=a)}else d=`${a} = ${l}`,(t==="void"||u==="void")&&(e.addLineFlowCode(d,this),t!=="void"&&(d=a));return h.initialized=!0,e.format(d,o,t)}}const Rk=st(Ile).setParameterLength(2);tt("assign",Rk);class Ble extends _s{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),s=this.parameters,o=(l,u)=>{const h=u.type,d=h==="pointer";let _;return d?_="&"+l.build(e):_=l.build(e,h),_};if(Array.isArray(s)){if(s.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(me(0));for(let l=0;l<s.length;l++)t.push(o(s[l],r[l]))}else for(const l of r){const u=s[l.name];u!==void 0?t.push(o(u,l)):(console.error(`THREE.TSL: Input '${l.name}' not found in 'Fn()'.`),t.push(o(me(0),l)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const Ck=(i,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?NA(e):e2(e[0]),Ze(new Ble(Ze(i),e)));tt("call",Ck);const Ule={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Br extends _s{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let s=new Br(e,t,n);for(let o=0;o<r.length-1;o++)s=new Br(e,s,r[o]);t=s,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(Ule[this.op],t)}getNodeType(e){const t=this.op,n=this.aNode,r=this.bNode,s=n.getNodeType(e),o=r?r.getNodeType(e):null;if(s==="void"||o==="void")return"void";if(t==="%")return s;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(s);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const a=Math.max(e.getTypeLength(s),e.getTypeLength(o));return a>1?`bvec${a}`:"bool"}else{if(e.isMatrix(s)){if(o==="float")return s;if(e.isVector(o))return e.getVectorFromMatrix(s);if(e.isMatrix(o))return s}else if(e.isMatrix(o)){if(s==="float")return o;if(e.isVector(s))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(s)?o:s}}generate(e,t){const n=this.op,{aNode:r,bNode:s}=this,o=this.getNodeType(e);let a=null,l=null;o!=="void"?(a=r.getNodeType(e),l=s?s.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(a)?l=a:e.isVector(l)?a=l:a!==l&&(a=l="float"):n===">>"||n==="<<"?(a=o,l=e.changeComponentType(l,"uint")):n==="%"?(a=o,l=e.isInteger(a)&&e.isInteger(l)?l:a):e.isMatrix(a)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(a):e.isMatrix(l)||(a=l=o):e.isMatrix(l)?a==="float"?a="float":e.isVector(a)?a=e.getVectorFromMatrix(l):a=l=o:a=l=o):a=l=o;const u=r.build(e,a),h=s?s.build(e,l):null,d=e.getFunctionOperator(n);if(t!=="void"){const _=e.renderer.coordinateSystem===qo;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return _?e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${u}, ${h} )`,o,t):e.format(`( ${u} ${n} ${h} )`,o,t):e.format(`( ${u} ${n} ${h} )`,o,t);if(n==="%")return e.isInteger(l)?e.format(`( ${u} % ${h} )`,o,t):e.format(`${this.getOperatorMethod(e,o)}( ${u}, ${h} )`,o,t);if(n==="!"||n==="~")return e.format(`(${n}${u})`,a,t);if(d)return e.format(`${d}( ${u}, ${h} )`,o,t);if(e.isMatrix(a)&&l==="float")return e.format(`( ${h} ${n} ${u} )`,o,t);if(a==="float"&&e.isMatrix(l))return e.format(`${u} ${n} ${h}`,o,t);{let x=`( ${u} ${n} ${h} )`;return!_&&o==="bool"&&e.isVector(a)&&e.isVector(l)&&(x=`all${x}`),e.format(x,o,t)}}else if(a!=="void")return d?e.format(`${d}( ${u}, ${h} )`,o,t):e.isMatrix(a)&&l==="float"?e.format(`${h} ${n} ${u}`,o,t):e.format(`${u} ${n} ${h}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const gs=st(Br,"+").setParameterLength(2,1/0).setName("add"),vi=st(Br,"-").setParameterLength(2,1/0).setName("sub"),jn=st(Br,"*").setParameterLength(2,1/0).setName("mul"),Ll=st(Br,"/").setParameterLength(2,1/0).setName("div"),MT=st(Br,"%").setParameterLength(2).setName("mod"),K8=st(Br,"==").setParameterLength(2).setName("equal"),Nk=st(Br,"!=").setParameterLength(2).setName("notEqual"),Dk=st(Br,"<").setParameterLength(2).setName("lessThan"),Z8=st(Br,">").setParameterLength(2).setName("greaterThan"),Pk=st(Br,"<=").setParameterLength(2).setName("lessThanEqual"),Lk=st(Br,">=").setParameterLength(2).setName("greaterThanEqual"),Ok=st(Br,"&&").setParameterLength(2,1/0).setName("and"),Ik=st(Br,"||").setParameterLength(2,1/0).setName("or"),Bk=st(Br,"!").setParameterLength(1).setName("not"),Uk=st(Br,"^^").setParameterLength(2).setName("xor"),Fk=st(Br,"&").setParameterLength(2).setName("bitAnd"),kk=st(Br,"~").setParameterLength(2).setName("bitNot"),Gk=st(Br,"|").setParameterLength(2).setName("bitOr"),zk=st(Br,"^").setParameterLength(2).setName("bitXor"),Vk=st(Br,"<<").setParameterLength(2).setName("shiftLeft"),qk=st(Br,">>").setParameterLength(2).setName("shiftRight"),Hk=Ce(([i])=>(i.addAssign(1),i)),Wk=Ce(([i])=>(i.subAssign(1),i)),jk=Ce(([i])=>{const e=be(i).toConst();return i.addAssign(1),e}),Xk=Ce(([i])=>{const e=be(i).toConst();return i.subAssign(1),e});tt("add",gs);tt("sub",vi);tt("mul",jn);tt("div",Ll);tt("mod",MT);tt("equal",K8);tt("notEqual",Nk);tt("lessThan",Dk);tt("greaterThan",Z8);tt("lessThanEqual",Pk);tt("greaterThanEqual",Lk);tt("and",Ok);tt("or",Ik);tt("not",Bk);tt("xor",Uk);tt("bitAnd",Fk);tt("bitNot",kk);tt("bitOr",Gk);tt("bitXor",zk);tt("shiftLeft",Vk);tt("shiftRight",qk);tt("incrementBefore",Hk);tt("decrementBefore",Wk);tt("increment",jk);tt("decrement",Xk);const $k=(i,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),MT(be(i),be(e)));tt("modInt",$k);class Ue extends _s{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===Ue.MAX||e===Ue.MIN)&&arguments.length>3){let s=new Ue(e,t,n);for(let o=2;o<arguments.length-1;o++)s=new Ue(e,s,arguments[o]);t=s,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(n)?0:e.getTypeLength(n),a=e.isMatrix(r)?0:e.getTypeLength(r);return s>o&&s>a?t:o>a?n:a>s?r:t}getNodeType(e){const t=this.method;return t===Ue.LENGTH||t===Ue.DISTANCE||t===Ue.DOT?"float":t===Ue.CROSS?"vec3":t===Ue.ALL||t===Ue.ANY?"bool":t===Ue.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let s=null;if(r===Ue.ONE_MINUS)s=vi(1,t);else if(r===Ue.RECIPROCAL)s=Ll(1,t);else if(r===Ue.DIFFERENCE)s=gr(vi(t,n));else if(r===Ue.TRANSFORM_DIRECTION){let o=t,a=n;e.isMatrix(o.getNodeType(e))?a=an(Me(a),0):o=an(Me(o),0);const l=jn(o,a).xyz;s=Lh(l)}return s!==null?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const s=this.getNodeType(e),o=this.getInputType(e),a=this.aNode,l=this.bNode,u=this.cNode,h=e.renderer.coordinateSystem;if(r===Ue.NEGATE)return e.format("( - "+a.build(e,o)+" )",s,t);{const d=[];return r===Ue.CROSS?d.push(a.build(e,s),l.build(e,s)):h===qo&&r===Ue.STEP?d.push(a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":o),l.build(e,o)):h===qo&&(r===Ue.MIN||r===Ue.MAX)?d.push(a.build(e,o),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o)):r===Ue.REFRACT?d.push(a.build(e,o),l.build(e,o),u.build(e,"float")):r===Ue.MIX?d.push(a.build(e,o),l.build(e,o),u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":o)):(h===lc&&r===Ue.ATAN&&l!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===Ue.DFDX||r===Ue.DFDY)&&(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),d.push(a.build(e,o)),l!==null&&d.push(l.build(e,o)),u!==null&&d.push(u.build(e,o))),e.format(`${e.getMethod(r,s)}( ${d.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Ue.ALL="all";Ue.ANY="any";Ue.RADIANS="radians";Ue.DEGREES="degrees";Ue.EXP="exp";Ue.EXP2="exp2";Ue.LOG="log";Ue.LOG2="log2";Ue.SQRT="sqrt";Ue.INVERSE_SQRT="inversesqrt";Ue.FLOOR="floor";Ue.CEIL="ceil";Ue.NORMALIZE="normalize";Ue.FRACT="fract";Ue.SIN="sin";Ue.COS="cos";Ue.TAN="tan";Ue.ASIN="asin";Ue.ACOS="acos";Ue.ATAN="atan";Ue.ABS="abs";Ue.SIGN="sign";Ue.LENGTH="length";Ue.NEGATE="negate";Ue.ONE_MINUS="oneMinus";Ue.DFDX="dFdx";Ue.DFDY="dFdy";Ue.ROUND="round";Ue.RECIPROCAL="reciprocal";Ue.TRUNC="trunc";Ue.FWIDTH="fwidth";Ue.TRANSPOSE="transpose";Ue.BITCAST="bitcast";Ue.EQUALS="equals";Ue.MIN="min";Ue.MAX="max";Ue.STEP="step";Ue.REFLECT="reflect";Ue.DISTANCE="distance";Ue.DIFFERENCE="difference";Ue.DOT="dot";Ue.CROSS="cross";Ue.POW="pow";Ue.TRANSFORM_DIRECTION="transformDirection";Ue.MIX="mix";Ue.CLAMP="clamp";Ue.REFRACT="refract";Ue.SMOOTHSTEP="smoothstep";Ue.FACEFORWARD="faceforward";const Yk=me(1e-6),Fle=me(1e6),NS=me(Math.PI),kle=me(Math.PI*2),Qk=st(Ue,Ue.ALL).setParameterLength(1),Kk=st(Ue,Ue.ANY).setParameterLength(1),Zk=st(Ue,Ue.RADIANS).setParameterLength(1),Jk=st(Ue,Ue.DEGREES).setParameterLength(1),J8=st(Ue,Ue.EXP).setParameterLength(1),qm=st(Ue,Ue.EXP2).setParameterLength(1),RT=st(Ue,Ue.LOG).setParameterLength(1),nc=st(Ue,Ue.LOG2).setParameterLength(1),yc=st(Ue,Ue.SQRT).setParameterLength(1),e5=st(Ue,Ue.INVERSE_SQRT).setParameterLength(1),ic=st(Ue,Ue.FLOOR).setParameterLength(1),CT=st(Ue,Ue.CEIL).setParameterLength(1),Lh=st(Ue,Ue.NORMALIZE).setParameterLength(1),zh=st(Ue,Ue.FRACT).setParameterLength(1),Xa=st(Ue,Ue.SIN).setParameterLength(1),uh=st(Ue,Ue.COS).setParameterLength(1),eG=st(Ue,Ue.TAN).setParameterLength(1),tG=st(Ue,Ue.ASIN).setParameterLength(1),t5=st(Ue,Ue.ACOS).setParameterLength(1),n5=st(Ue,Ue.ATAN).setParameterLength(1,2),gr=st(Ue,Ue.ABS).setParameterLength(1),Ty=st(Ue,Ue.SIGN).setParameterLength(1),rc=st(Ue,Ue.LENGTH).setParameterLength(1),nG=st(Ue,Ue.NEGATE).setParameterLength(1),iG=st(Ue,Ue.ONE_MINUS).setParameterLength(1),i5=st(Ue,Ue.DFDX).setParameterLength(1),r5=st(Ue,Ue.DFDY).setParameterLength(1),rG=st(Ue,Ue.ROUND).setParameterLength(1),sG=st(Ue,Ue.RECIPROCAL).setParameterLength(1),s5=st(Ue,Ue.TRUNC).setParameterLength(1),oG=st(Ue,Ue.FWIDTH).setParameterLength(1),aG=st(Ue,Ue.TRANSPOSE).setParameterLength(1),Gle=st(Ue,Ue.BITCAST).setParameterLength(2),lG=(i,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),K8(i,e)),xa=st(Ue,Ue.MIN).setParameterLength(2,1/0),Hr=st(Ue,Ue.MAX).setParameterLength(2,1/0),NT=st(Ue,Ue.STEP).setParameterLength(2),uG=st(Ue,Ue.REFLECT).setParameterLength(2),cG=st(Ue,Ue.DISTANCE).setParameterLength(2),hG=st(Ue,Ue.DIFFERENCE).setParameterLength(2),fd=st(Ue,Ue.DOT).setParameterLength(2),DT=st(Ue,Ue.CROSS).setParameterLength(2),Au=st(Ue,Ue.POW).setParameterLength(2),o5=st(Ue,Ue.POW,2).setParameterLength(1),fG=st(Ue,Ue.POW,3).setParameterLength(1),dG=st(Ue,Ue.POW,4).setParameterLength(1),AG=st(Ue,Ue.TRANSFORM_DIRECTION).setParameterLength(2),pG=i=>jn(Ty(i),Au(gr(i),1/3)),a5=i=>fd(i,i),zi=st(Ue,Ue.MIX).setParameterLength(3),hc=(i,e=0,t=1)=>Ze(new Ue(Ue.CLAMP,Ze(i),Ze(e),Ze(t))),l5=i=>hc(i),u5=st(Ue,Ue.REFRACT).setParameterLength(3),fc=st(Ue,Ue.SMOOTHSTEP).setParameterLength(3),c5=st(Ue,Ue.FACEFORWARD).setParameterLength(3),mG=Ce(([i])=>{const n=43758.5453,r=fd(i.xy,dt(12.9898,78.233)),s=MT(r,NS);return zh(Xa(s).mul(n))}),gG=(i,e,t)=>zi(e,t,i),_G=(i,e,t)=>fc(e,t,i),yG=(i,e)=>NT(e,i),vG=(i,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),n5(i,e)),zle=c5,Vle=e5;tt("all",Qk);tt("any",Kk);tt("equals",lG);tt("radians",Zk);tt("degrees",Jk);tt("exp",J8);tt("exp2",qm);tt("log",RT);tt("log2",nc);tt("sqrt",yc);tt("inverseSqrt",e5);tt("floor",ic);tt("ceil",CT);tt("normalize",Lh);tt("fract",zh);tt("sin",Xa);tt("cos",uh);tt("tan",eG);tt("asin",tG);tt("acos",t5);tt("atan",n5);tt("abs",gr);tt("sign",Ty);tt("length",rc);tt("lengthSq",a5);tt("negate",nG);tt("oneMinus",iG);tt("dFdx",i5);tt("dFdy",r5);tt("round",rG);tt("reciprocal",sG);tt("trunc",s5);tt("fwidth",oG);tt("atan2",vG);tt("min",xa);tt("max",Hr);tt("step",yG);tt("reflect",uG);tt("distance",cG);tt("dot",fd);tt("cross",DT);tt("pow",Au);tt("pow2",o5);tt("pow3",fG);tt("pow4",dG);tt("transformDirection",AG);tt("mix",gG);tt("clamp",hc);tt("refract",u5);tt("smoothstep",_G);tt("faceForward",c5);tt("difference",hG);tt("saturate",l5);tt("cbrt",pG);tt("transpose",aG);tt("rand",mG);class qle extends dn{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const s=n.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(r))return s}return r}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=n.context({nodeBlock:n}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:o,elseNode:a}=e.getNodeProperties(this),l=e.currentFunctionNode,u=t!=="void",h=u?vh(n).build(e):"";r.nodeProperty=h;const d=s.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${d} ) {

`).addFlowTab();let _=o.build(e,n);if(_&&(u?_=h+" = "+_+";":(_="return "+_+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),_="// "+_))),e.removeFlowTab().addFlowCode(e.tab+"	"+_+`

`+e.tab+"}"),a!==null){e.addFlowCode(` else {

`).addFlowTab();let x=a.build(e,n);x&&(u?x=h+" = "+x+";":(x="return "+x+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),x="// "+x))),e.removeFlowTab().addFlowCode(e.tab+"	"+x+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(h,n,t)}}const js=st(qle).setParameterLength(2,3);tt("select",js);class xG extends dn{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const PT=st(xG).setParameterLength(1,2),bG=(i,e)=>PT(i,{label:e});tt("context",PT);tt("label",bG);class Cb extends dn{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:s}=e,o=s.backend.isWebGPUBackend===!0;let a=!1,l=!1;r&&(a=e.isDeterministic(t),l=o?r:a);const u=e.getVectorType(this.getNodeType(e)),h=t.build(e,u),d=e.getVarFromNode(this,n,u,void 0,l),_=e.getPropertyName(d);let x=_;if(l)if(o)x=a?`const ${_}`:`let ${_}`;else{const b=e.getArrayCount(t);x=`const ${e.getVar(d.type,_,b)}`}return e.addLineFlowCode(`${x} = ${h}`,this),_}}const h5=st(Cb),SG=(i,e=null)=>h5(i,e).toStack(),TG=(i,e=null)=>h5(i,e,!0).toStack();tt("toVar",SG);tt("toConst",TG);const EG=i=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),h5(i));tt("temp",EG);class Hle extends dn{static get type(){return"SubBuild"}constructor(e,t,n=null){super(n),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const n=this.node.build(e,...t);return e.removeSubBuild(),n}}const rm=(i,e,t=null)=>Ze(new Hle(Ze(i),e,t));class Wle extends dn{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,s=this.getNodeType(e),o=this.interpolationType,a=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,s,o,a),t.node=rm(this.node,"VERTEX")}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(f_.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(f_.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),n=e.getNodeProperties(this),r=this.setupVarying(e);if(n[t]===void 0){const s=this.getNodeType(e),o=e.getPropertyName(r,f_.VERTEX);e.flowNodeFromShaderStage(f_.VERTEX,n.node,s,o),n[t]=o}return e.getPropertyName(r)}}const vc=st(Wle).setParameterLength(1,2),wG=i=>vc(i);tt("toVarying",vc);tt("toVertexStage",wG);tt("varying",(...i)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),vc(...i)));tt("vertexStage",(...i)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),vc(...i)));const MG=Ce(([i])=>{const e=i.mul(.9478672986).add(.0521327014).pow(2.4),t=i.mul(.0773993808),n=i.lessThanEqual(.04045);return zi(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),RG=Ce(([i])=>{const e=i.pow(.41666).mul(1.055).sub(.055),t=i.mul(12.92),n=i.lessThanEqual(.0031308);return zi(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),f5="WorkingColorSpace",jle="OutputColorSpace";class d5 extends _s{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===f5?In.workingColorSpace:t===jle?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return In.enabled===!1||n===r||!n||!r||(In.getTransfer(n)===Qt&&(s=an(MG(s.rgb),s.a)),In.getPrimaries(n)!==In.getPrimaries(r)&&(s=an(Ro(In._getMatrix(new Hn,n,r)).mul(s.rgb),s.a)),In.getTransfer(r)===Qt&&(s=an(RG(s.rgb),s.a))),s}}const CG=(i,e)=>Ze(new d5(Ze(i),f5,e)),LT=(i,e)=>Ze(new d5(Ze(i),e,f5)),Xle=(i,e,t)=>Ze(new d5(Ze(i),e,t));tt("workingToColorSpace",CG);tt("colorSpaceToWorking",LT);let $le=class extends JA{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class NG extends dn{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=Kn.OBJECT}setGroup(e){return this.group=e,this}element(e){return Ze(new $le(this,Ze(e)))}setNodeType(e){const t=ln(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Yle=(i,e,t)=>Ze(new NG(i,e,t));class Qle extends NG{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(pn)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const DG=(i,e,t=null)=>Ze(new Qle(i,e,t));class Kle extends _s{static get type(){return"ToneMappingNode"}constructor(e,t=LG,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return SS(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(n===_a)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(n);return s!==null?r=an(s(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const PG=(i,e,t)=>Ze(new Kle(i,Ze(e),Ze(t))),LG=DG("toneMappingExposure","float");tt("toneMapping",(i,e,t)=>PG(e,t,i));class Zle extends F8{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Fb,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),s=this.bufferStride||r,o=this.bufferOffset,a=n.isInterleavedBuffer===!0?n:new o8(n,s),l=new $u(a,r,o);a.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=vc(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const n2=(i,e=null,t=0,n=0)=>Ze(new Zle(i,e,t,n)),OG=(i,e=null,t=0,n=0)=>n2(i,e,t,n).setUsage(Fp),DS=(i,e=null,t=0,n=0)=>n2(i,e,t,n).setInstanced(!0),IC=(i,e=null,t=0,n=0)=>OG(i,e,t,n).setInstanced(!0);tt("toAttribute",i=>n2(i.value));class Jle extends dn{static get type(){return"ComputeNode"}constructor(e,t,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=Kn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let r=1;r<t.length;r++)n*=t[r];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const IG=(i,e,t)=>Ze(new Jle(Ze(i),e,t));tt("compute",IG);class eue extends dn{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(n),s}}const P_=(i,e)=>Ze(new eue(Ze(i),e));tt("cache",P_);class tue extends dn{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const BG=st(tue).setParameterLength(2);tt("bypass",BG);class UG extends dn{static get type(){return"RemapNode"}constructor(e,t,n,r=me(0),s=me(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:s,doClamp:o}=this;let a=e.sub(t).div(n.sub(t));return o===!0&&(a=a.clamp()),a.mul(s.sub(r)).add(r)}}const FG=st(UG,null,null,{doClamp:!1}).setParameterLength(3,5),kG=st(UG).setParameterLength(3,5);tt("remap",FG);tt("remapClamp",kG);class Nb extends dn{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const Oh=st(Nb).setParameterLength(1,2),GG=i=>(i?js(i,Oh("discard")):Oh("discard")).toStack(),nue=()=>Oh("return").toStack();tt("discard",GG);class iue extends _s{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||_a,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Go;return n!==_a&&(t=t.toneMapping(n)),r!==Go&&r!==In.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const zG=(i,e=null,t=null)=>Ze(new iue(Ze(i),e,t));tt("renderOutput",zG);class rue extends _s{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let o="";return o+="// #"+r+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+n+` /* ... */
`,o+="// #"+s+`#
`,t!==null?t(e,o):console.log(o),n}}const VG=(i,e=null)=>Ze(new rue(Ze(i),e));tt("debug",VG);function sue(i){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",i)}class qG extends dn{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(s),a=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(a.name,o,n):vc(this).build(e,n)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Ih=(i,e=null)=>Ze(new qG(i,e)),Tr=(i=0)=>Ih("uv"+(i>0?i:""),"vec2");class oue extends dn{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const td=st(oue).setParameterLength(1,2);class aue extends t2{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Kn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:s}=n;this.value=Math.log2(Math.max(r,s))}}}const A5=st(aue).setParameterLength(1),p5=new ps;class dc extends t2{static get type(){return"TextureNode"}constructor(e=p5,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Kn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===mr?"uvec4":this.value.type===Hs?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Tr(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=ln(this.value.matrix)),this._matrixUniform.mul(Me(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?Kn.OBJECT:Kn.NONE,this}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&n.flipY===!0||n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0||n.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(be(td(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,n,r,s,o,a,l){const u=this.value;let h;return r?h=e.generateTextureLevel(u,t,n,r,o):s?h=e.generateTextureBias(u,t,n,s,o):l?h=e.generateTextureGrad(u,t,n,l,o):a?h=e.generateTextureCompare(u,t,n,a,o):this.sampler===!1?h=e.generateTextureLoad(u,t,n,o):h=e.generateTexture(u,t,n,o),h}generate(e,t){const n=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const o=e.getDataFromNode(this);let a=o.propertyName;if(a===void 0){const{uvNode:h,levelNode:d,biasNode:_,compareNode:x,depthNode:b,gradNode:R}=r,E=this.generateUV(e,h),w=d?d.build(e,"float"):null,L=_?_.build(e,"float"):null,D=b?b.build(e,"int"):null,O=x?x.build(e,"float"):null,B=R?[R[0].build(e,"vec2"),R[1].build(e,"vec2")]:null,G=e.getVarFromNode(this);a=e.getPropertyName(G);const k=this.generateSnippet(e,s,E,w,L,D,O,B);e.addLineFlowCode(`${a} = ${k}`,this),o.snippet=k,o.propertyName=a}let l=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(l=LT(Oh(l,u),n.colorSpace).setup(e).build(e,u)),e.format(l,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Ze(e),t.referenceNode=this.getSelf(),Ze(t)}blur(e){const t=this.clone();t.biasNode=Ze(e).mul(A5(t)),t.referenceNode=this.getSelf();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===br||n.magFilter===br)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Ze(t)}level(e){const t=this.clone();return t.levelNode=Ze(e),t.referenceNode=this.getSelf(),Ze(t)}size(e){return td(this,e)}bias(e){const t=this.clone();return t.biasNode=Ze(e),t.referenceNode=this.getSelf(),Ze(t)}compare(e){const t=this.clone();return t.compareNode=Ze(e),t.referenceNode=this.getSelf(),Ze(t)}grad(e,t){const n=this.clone();return n.gradNode=[Ze(e),Ze(t)],n.referenceNode=this.getSelf(),Ze(n)}depth(e){const t=this.clone();return t.depthNode=Ze(e),t.referenceNode=this.getSelf(),Ze(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const lue=st(dc).setParameterLength(1,4).setName("texture"),ui=(i=p5,e=null,t=null,n=null)=>{let r;return i&&i.isTextureNode===!0?(r=Ze(i.clone()),r.referenceNode=i.getSelf(),e!==null&&(r.uvNode=Ze(e)),t!==null&&(r.levelNode=Ze(t)),n!==null&&(r.biasNode=Ze(n))):r=lue(i,e,t,n),r},uue=(i=p5)=>ui(i),Qr=(...i)=>ui(...i).setSampler(!1),cue=i=>(i.isNode===!0?i:ui(i)).convert("sampler"),hue=i=>(i.isNode===!0?i:ui(i)).convert("samplerComparison");class m5 extends t2{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const i2=(i,e,t)=>Ze(new m5(i,e,t));class fue extends JA{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class due extends m5{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?$f(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=Kn.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const s=r*4;t[s]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.r,t[s+1]=o.g,t[s+2]=o.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+3]=o.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+4]=o.elements[3],t[s+5]=o.elements[4],t[s+6]=o.elements[5],t[s+8]=o.elements[6],t[s+9]=o.elements[7],t[s+10]=o.elements[8],t[s+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];for(let a=0;a<o.elements.length;a++)t[s+a]=o.elements[a]}else for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.x,t[s+1]=o.y,t[s+2]=o.z||0,t[s+3]=o.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const s=this.paddedType,o=e.getTypeLength(s);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*o),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return Ze(new fue(this,Ze(e)))}}const Tl=(i,e)=>Ze(new due(i,e));class Aue extends dn{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const r2=st(Aue).setParameterLength(1),OT=ln(0,"uint").label("u_cameraIndex").setGroup(wT("cameraIndex")).toVarying("v_cameraIndex"),Wf=ln("float").label("cameraNear").setGroup(pn).onRenderUpdate(({camera:i})=>i.near),jf=ln("float").label("cameraFar").setGroup(pn).onRenderUpdate(({camera:i})=>i.far),e0=Ce(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const r of i.cameras)t.push(r.projectionMatrix);e=Tl(t).setGroup(pn).label("cameraProjectionMatrices").element(i.isMultiViewCamera?r2("gl_ViewID_OVR"):OT).toVar("cameraProjectionMatrix")}else e=ln("mat4").label("cameraProjectionMatrix").setGroup(pn).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),pue=Ce(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const r of i.cameras)t.push(r.projectionMatrixInverse);e=Tl(t).setGroup(pn).label("cameraProjectionMatricesInverse").element(i.isMultiViewCamera?r2("gl_ViewID_OVR"):OT).toVar("cameraProjectionMatrixInverse")}else e=ln("mat4").label("cameraProjectionMatrixInverse").setGroup(pn).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse);return e}).once()(),Fl=Ce(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const r of i.cameras)t.push(r.matrixWorldInverse);e=Tl(t).setGroup(pn).label("cameraViewMatrices").element(i.isMultiViewCamera?r2("gl_ViewID_OVR"):OT).toVar("cameraViewMatrix")}else e=ln("mat4").label("cameraViewMatrix").setGroup(pn).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),mue=ln("mat4").label("cameraWorldMatrix").setGroup(pn).onRenderUpdate(({camera:i})=>i.matrixWorld),gue=ln("mat3").label("cameraNormalMatrix").setGroup(pn).onRenderUpdate(({camera:i})=>i.normalMatrix),HG=ln(new ce).label("cameraPosition").setGroup(pn).onRenderUpdate(({camera:i},e)=>e.value.setFromMatrixPosition(i.matrixWorld)),BO=new cd;class Ai extends dn{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Kn.OBJECT,this.uniformNode=new t2(null)}getNodeType(){const e=this.scope;if(e===Ai.WORLD_MATRIX)return"mat4";if(e===Ai.POSITION||e===Ai.VIEW_POSITION||e===Ai.DIRECTION||e===Ai.SCALE)return"vec3";if(e===Ai.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===Ai.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===Ai.POSITION)n.value=n.value||new ce,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===Ai.SCALE)n.value=n.value||new ce,n.value.setFromMatrixScale(t.matrixWorld);else if(r===Ai.DIRECTION)n.value=n.value||new ce,t.getWorldDirection(n.value);else if(r===Ai.VIEW_POSITION){const s=e.camera;n.value=n.value||new ce,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(s.matrixWorldInverse)}else if(r===Ai.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),BO.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),n.value=BO.radius}}generate(e){const t=this.scope;return t===Ai.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===Ai.POSITION||t===Ai.VIEW_POSITION||t===Ai.DIRECTION||t===Ai.SCALE?this.uniformNode.nodeType="vec3":t===Ai.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Ai.WORLD_MATRIX="worldMatrix";Ai.POSITION="position";Ai.SCALE="scale";Ai.VIEW_POSITION="viewPosition";Ai.DIRECTION="direction";Ai.RADIUS="radius";const _ue=st(Ai,Ai.DIRECTION).setParameterLength(1),yue=st(Ai,Ai.WORLD_MATRIX).setParameterLength(1),WG=st(Ai,Ai.POSITION).setParameterLength(1),vue=st(Ai,Ai.SCALE).setParameterLength(1),xue=st(Ai,Ai.VIEW_POSITION).setParameterLength(1),bue=st(Ai,Ai.RADIUS).setParameterLength(1);class Ol extends Ai{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Sue=Pt(Ol,Ol.DIRECTION),El=Pt(Ol,Ol.WORLD_MATRIX),Tue=Pt(Ol,Ol.POSITION),Eue=Pt(Ol,Ol.SCALE),wue=Pt(Ol,Ol.VIEW_POSITION),Mue=Pt(Ol,Ol.RADIUS),jG=ln(new Hn).onObjectUpdate(({object:i},e)=>e.value.getNormalMatrix(i.matrixWorld)),Rue=ln(new Cn).onObjectUpdate(({object:i},e)=>e.value.copy(i.matrixWorld).invert()),t0=Ce(i=>i.renderer.overrideNodes.modelViewMatrix||XG).once()().toVar("modelViewMatrix"),XG=Fl.mul(El),BC=Ce(i=>(i.context.isHighPrecisionModelViewMatrix=!0,ln("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),UC=Ce(i=>{const e=i.context.isHighPrecisionModelViewMatrix;return ln("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),s2=Ih("position","vec3"),Zr=s2.toVarying("positionLocal"),PS=s2.toVarying("positionPrevious"),xh=Ce(i=>El.mul(Zr).xyz.toVarying(i.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),g5=Ce(()=>Zr.transformDirection(El).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),Jr=Ce(i=>i.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),Er=Jr.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class Cue extends dn{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{renderer:t,material:n}=e;return t.coordinateSystem===qo&&n.side===Zi?"false":e.getFrontFacing()}}const $G=Pt(Cue),_5=me($G).mul(2).sub(1),Ag=Ce(([i],{material:e})=>{const t=e.side;return t===Zi?i=i.mul(-1):t===ss&&(i=i.mul(_5)),i}),IT=Ih("normal","vec3"),ba=Ce(i=>i.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Me(0,1,0)):IT,"vec3").once()().toVar("normalLocal"),YG=Jr.dFdx().cross(Jr.dFdy()).normalize().toVar("normalFlat"),Hm=Ce(i=>{let e;return i.material.flatShading===!0?e=YG:e=y5(ba).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),QG=Ce(i=>{let e=Hm.transformDirection(Fl);return i.material.flatShading!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Yi=Ce(({subBuildFn:i,material:e,context:t})=>{let n;return i==="NORMAL"||i==="VERTEX"?(n=Hm,e.flatShading!==!0&&(n=Ag(n))):n=t.setupNormal().context({getUV:null}),n},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),dd=Yi.transformDirection(Fl).toVar("normalWorld"),yA=Ce(({subBuildFn:i,context:e})=>{let t;return i==="NORMAL"||i==="VERTEX"?t=Yi:t=e.setupClearcoatNormal().context({getUV:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),KG=Ce(([i,e=El])=>{const t=Ro(e),n=i.div(Me(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),y5=Ce(([i],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(i);const n=jG.mul(i);return Fl.transformDirection(n)}),Nue=Ce(()=>(console.warn('THREE.TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),Yi)).once(["NORMAL","VERTEX"])(),Due=Ce(()=>(console.warn('THREE.TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),dd)).once(["NORMAL","VERTEX"])(),Pue=Ce(()=>(console.warn('THREE.TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),yA)).once(["NORMAL","VERTEX"])(),UO=new ao,sM=new Cn,ZG=ln(0).onReference(({material:i})=>i).onObjectUpdate(({material:i})=>i.refractionRatio),Db=ln(1).onReference(({material:i})=>i).onObjectUpdate(function({material:i,scene:e}){return i.envMap?i.envMapIntensity:e.environmentIntensity}),v5=ln(new Cn).onReference(function(i){return i.material}).onObjectUpdate(function({material:i,scene:e}){const t=e.environment!==null&&i.envMap===null?e.environmentRotation:i.envMapRotation;return t?(UO.copy(t),sM.makeRotationFromEuler(UO)):sM.identity(),sM}),JG=Er.negate().reflect(Yi),ez=Er.negate().refract(Yi,ZG),tz=JG.transformDirection(Fl).toVar("reflectVector"),nz=ez.transformDirection(Fl).toVar("reflectVector"),iz=new Xy;class Lue extends dc{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===oc?tz:e.mapping===ac?nz:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Me(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return(e.renderer.coordinateSystem===lc||!n.isRenderTargetTexture)&&(t=Me(t.x.negate(),t.yz)),v5.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const x5=st(Lue).setParameterLength(1,4).setName("cubeTexture"),Wm=(i=iz,e=null,t=null,n=null)=>{let r;return i&&i.isCubeTextureNode===!0?(r=Ze(i.clone()),r.referenceNode=i.getSelf(),e!==null&&(r.uvNode=Ze(e)),t!==null&&(r.levelNode=Ze(t)),n!==null&&(r.biasNode=Ze(n))):r=x5(i,e,t,n),r},Oue=(i=iz)=>x5(i);class Iue extends JA{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class BT extends dn{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=Kn.OBJECT}element(e){return Ze(new Iue(this,Ze(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=i2(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Tl(null,e):e==="texture"?t=ui(null):e==="cubeTexture"?t=Wm(null):t=ln(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const ar=(i,e,t)=>Ze(new BT(i,e,t)),FC=(i,e,t,n)=>Ze(new BT(i,e,n,t));class Bue extends BT{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const dh=(i,e,t=null)=>Ze(new Bue(i,e,t)),rz=Tr(),Uue=Jr.dFdx(),Fue=Jr.dFdy(),sz=rz.dFdx(),oz=rz.dFdy(),az=Yi,lz=Fue.cross(az),uz=az.cross(Uue),kC=lz.mul(sz.x).add(uz.mul(oz.x)),GC=lz.mul(sz.y).add(uz.mul(oz.y)),FO=kC.dot(kC).max(GC.dot(GC)),cz=FO.equal(0).select(0,FO.inverseSqrt()),kue=kC.mul(cz).toVar("tangentViewFrame"),Gue=GC.mul(cz).toVar("bitangentViewFrame"),UT=Ce(i=>(i.geometry.hasAttribute("tangent")===!1&&i.geometry.computeTangents(),Ih("tangent","vec4")))(),o2=UT.xyz.toVar("tangentLocal"),FT=Ce(({subBuildFn:i,geometry:e,material:t})=>{let n;return i==="VERTEX"||e.hasAttribute("tangent")?n=t0.mul(an(o2,0)).xyz.toVarying("v_tangentView").normalize():n=kue,t.flatShading!==!0&&(n=Ag(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),hz=FT.transformDirection(Fl).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),kT=Ce(([i,e],{subBuildFn:t,material:n})=>{let r=i.mul(UT.w).xyz;return t==="NORMAL"&&n.flatShading!==!0&&(r=r.toVarying(e)),r}).once(["NORMAL"]),zue=kT(IT.cross(UT),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),Vue=kT(ba.cross(o2),"v_bitangentLocal").normalize().toVar("bitangentLocal"),fz=Ce(({subBuildFn:i,geometry:e,material:t})=>{let n;return i==="VERTEX"||e.hasAttribute("tangent")?n=kT(Yi.cross(FT),"v_bitangentView").normalize():n=Gue,t.flatShading!==!0&&(n=Ag(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),que=kT(dd.cross(hz),"v_bitangentWorld").normalize().toVar("bitangentWorld"),vA=Ro(FT,fz,Yi).toVar("TBNViewMatrix"),dz=Er.mul(vA),Hue=(i,e)=>i.sub(dz.mul(e)),Az=Ce(()=>{let i=PA.cross(Er);return i=i.cross(PA).normalize(),i=zi(i,Yi,Vf.mul(qu.oneMinus()).oneMinus().pow2().pow2()).normalize(),i}).once()();class Wue extends _s{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Mh}setup({material:e}){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);if(n!==null){let o=n;e.flatShading===!0&&(o=Ag(o)),r=Me(r.xy.mul(o),r.z)}let s=null;return t===o9?s=y5(r):t===Mh?s=vA.mul(r).normalize():(console.error(`THREE.NodeMaterial: Unsupported normal map type: ${t}`),s=Yi),s}}const zC=st(Wue).setParameterLength(1,2),jue=Ce(({textureNode:i,bumpScale:e})=>{const t=r=>i.cache().context({getUV:s=>r(s.uvNode||Tr()),forceUVContext:!0}),n=me(t(r=>r));return dt(me(t(r=>r.add(r.dFdx()))).sub(n),me(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),Xue=Ce(i=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=i,r=e.dFdx().normalize(),s=e.dFdy().normalize(),o=t,a=s.cross(o),l=o.cross(r),u=r.dot(a).mul(_5),h=u.sign().mul(n.x.mul(a).add(n.y.mul(l)));return u.abs().mul(t).sub(h).normalize()});class $ue extends _s{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=jue({textureNode:this.textureNode,bumpScale:e});return Xue({surf_pos:Jr,surf_norm:Yi,dHdxy:t})}}const pz=st($ue).setParameterLength(1,2),kO=new Map;class Je extends dn{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=kO.get(e);return n===void 0&&(n=dh(e,t),kO.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===Je.COLOR){const s=t.color!==void 0?this.getColor(n):Me();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(n===Je.OPACITY){const s=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(n===Je.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=me(1);else if(n===Je.SPECULAR_INTENSITY){const s=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s}else if(n===Je.SPECULAR_COLOR){const s=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(n).rgb):r=s}else if(n===Je.ROUGHNESS){const s=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).g):r=s}else if(n===Je.METALNESS){const s=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(n).b):r=s}else if(n===Je.EMISSIVE){const s=this.getFloat("emissiveIntensity"),o=this.getColor(n).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=o.mul(this.getTexture(n)):r=o}else if(n===Je.NORMAL)t.normalMap?(r=zC(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=pz(this.getTexture("bump").r,this.getFloat("bumpScale")):r=Yi;else if(n===Je.CLEARCOAT){const s=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===Je.CLEARCOAT_ROUGHNESS){const s=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===Je.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=zC(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=Yi;else if(n===Je.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(n===Je.SHEEN_ROUGHNESS){const s=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s,r=r.clamp(.07,1)}else if(n===Je.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(n);r=ST(Dp.x,Dp.y,Dp.y.negate(),Dp.x).mul(s.rg.mul(2).sub(dt(1)).normalize().mul(s.b))}else r=Dp;else if(n===Je.IRIDESCENCE_THICKNESS){const s=ar("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=ar("0","float",t.iridescenceThicknessRange);r=s.sub(o).mul(this.getTexture(n).g).add(o)}else r=s}else if(n===Je.TRANSMISSION){const s=this.getFloat(n);t.transmissionMap?r=s.mul(this.getTexture(n).r):r=s}else if(n===Je.THICKNESS){const s=this.getFloat(n);t.thicknessMap?r=s.mul(this.getTexture(n).g):r=s}else if(n===Je.IOR)r=this.getFloat(n);else if(n===Je.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Je.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===Je.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):me(0);else{const s=this.getNodeType(e);r=this.getCache(n,s)}return r}}Je.ALPHA_TEST="alphaTest";Je.COLOR="color";Je.OPACITY="opacity";Je.SHININESS="shininess";Je.SPECULAR="specular";Je.SPECULAR_STRENGTH="specularStrength";Je.SPECULAR_INTENSITY="specularIntensity";Je.SPECULAR_COLOR="specularColor";Je.REFLECTIVITY="reflectivity";Je.ROUGHNESS="roughness";Je.METALNESS="metalness";Je.NORMAL="normal";Je.CLEARCOAT="clearcoat";Je.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Je.CLEARCOAT_NORMAL="clearcoatNormal";Je.EMISSIVE="emissive";Je.ROTATION="rotation";Je.SHEEN="sheen";Je.SHEEN_ROUGHNESS="sheenRoughness";Je.ANISOTROPY="anisotropy";Je.IRIDESCENCE="iridescence";Je.IRIDESCENCE_IOR="iridescenceIOR";Je.IRIDESCENCE_THICKNESS="iridescenceThickness";Je.IOR="ior";Je.TRANSMISSION="transmission";Je.THICKNESS="thickness";Je.ATTENUATION_DISTANCE="attenuationDistance";Je.ATTENUATION_COLOR="attenuationColor";Je.LINE_SCALE="scale";Je.LINE_DASH_SIZE="dashSize";Je.LINE_GAP_SIZE="gapSize";Je.LINE_WIDTH="linewidth";Je.LINE_DASH_OFFSET="dashOffset";Je.POINT_SIZE="size";Je.DISPERSION="dispersion";Je.LIGHT_MAP="light";Je.AO="ao";const mz=Pt(Je,Je.ALPHA_TEST),gz=Pt(Je,Je.COLOR),_z=Pt(Je,Je.SHININESS),yz=Pt(Je,Je.EMISSIVE),b5=Pt(Je,Je.OPACITY),vz=Pt(Je,Je.SPECULAR),VC=Pt(Je,Je.SPECULAR_INTENSITY),xz=Pt(Je,Je.SPECULAR_COLOR),L_=Pt(Je,Je.SPECULAR_STRENGTH),Pb=Pt(Je,Je.REFLECTIVITY),bz=Pt(Je,Je.ROUGHNESS),Sz=Pt(Je,Je.METALNESS),Tz=Pt(Je,Je.NORMAL),Ez=Pt(Je,Je.CLEARCOAT),wz=Pt(Je,Je.CLEARCOAT_ROUGHNESS),Mz=Pt(Je,Je.CLEARCOAT_NORMAL),Rz=Pt(Je,Je.ROTATION),Cz=Pt(Je,Je.SHEEN),Nz=Pt(Je,Je.SHEEN_ROUGHNESS),Dz=Pt(Je,Je.ANISOTROPY),Pz=Pt(Je,Je.IRIDESCENCE),Lz=Pt(Je,Je.IRIDESCENCE_IOR),Oz=Pt(Je,Je.IRIDESCENCE_THICKNESS),Iz=Pt(Je,Je.TRANSMISSION),Bz=Pt(Je,Je.THICKNESS),Uz=Pt(Je,Je.IOR),Fz=Pt(Je,Je.ATTENUATION_DISTANCE),kz=Pt(Je,Je.ATTENUATION_COLOR),Gz=Pt(Je,Je.LINE_SCALE),zz=Pt(Je,Je.LINE_DASH_SIZE),Vz=Pt(Je,Je.LINE_GAP_SIZE),Yue=Pt(Je,Je.LINE_WIDTH),qz=Pt(Je,Je.LINE_DASH_OFFSET),Hz=Pt(Je,Je.POINT_SIZE),Wz=Pt(Je,Je.DISPERSION),S5=Pt(Je,Je.LIGHT_MAP),jz=Pt(Je,Je.AO),Dp=ln(new it).onReference(function(i){return i.material}).onRenderUpdate(function({material:i}){this.value.set(i.anisotropy*Math.cos(i.anisotropyRotation),i.anisotropy*Math.sin(i.anisotropyRotation))}),T5=Ce(i=>i.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class wr extends dn{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===wr.VERTEX)r=e.getVertexIndex();else if(n===wr.INSTANCE)r=e.getInstanceIndex();else if(n===wr.DRAW)r=e.getDrawIndex();else if(n===wr.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===wr.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===wr.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=vc(this).build(e,t),s}}wr.VERTEX="vertex";wr.INSTANCE="instance";wr.SUBGROUP="subgroup";wr.INVOCATION_LOCAL="invocationLocal";wr.INVOCATION_SUBGROUP="invocationSubgroup";wr.DRAW="draw";const Xz=Pt(wr,wr.VERTEX),nd=Pt(wr,wr.INSTANCE),Que=Pt(wr,wr.SUBGROUP),Kue=Pt(wr,wr.INVOCATION_SUBGROUP),Zue=Pt(wr,wr.INVOCATION_LOCAL),$z=Pt(wr,wr.DRAW);class Yz extends dn{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Kn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:n,instanceColor:r}=this;let{instanceMatrixNode:s,instanceColorNode:o}=this;if(s===null){if(t<=1e3)s=i2(n.array,"mat4",Math.max(t,1)).element(nd);else{const l=new Vb(n.array,16,1);this.buffer=l;const u=n.usage===Fp?IC:DS,h=[u(l,"vec4",16,0),u(l,"vec4",16,4),u(l,"vec4",16,8),u(l,"vec4",16,12)];s=DA(...h)}this.instanceMatrixNode=s}if(r&&o===null){const l=new ed(r.array,3),u=r.usage===Fp?IC:DS;this.bufferColor=l,o=Me(u(l,"vec3",3,0)),this.instanceColorNode=o}const a=s.mul(Zr).xyz;if(Zr.assign(a),e.hasGeometryAttribute("normal")){const l=KG(ba,s);ba.assign(l)}this.instanceColorNode!==null&&vy("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==Fp&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==Fp&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const Jue=st(Yz).setParameterLength(2,3);class ece extends Yz{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const Qz=st(ece).setParameterLength(1);class tce extends dn{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=nd:this.batchingIdNode=$z);const n=Ce(([b])=>{const R=be(td(Qr(this.batchMesh._indirectTexture),0).x),E=be(b).mod(R),w=be(b).div(R);return Qr(this.batchMesh._indirectTexture,ws(E,w)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(be(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=be(td(Qr(r),0).x),o=me(n).mul(4).toInt().toVar(),a=o.mod(s),l=o.div(s),u=DA(Qr(r,ws(a,l)),Qr(r,ws(a.add(1),l)),Qr(r,ws(a.add(2),l)),Qr(r,ws(a.add(3),l))),h=this.batchMesh._colorsTexture;if(h!==null){const R=Ce(([E])=>{const w=be(td(Qr(h),0).x),L=E,D=L.mod(w),O=L.div(w);return Qr(h,ws(D,O)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);vy("vec3","vBatchColor").assign(R)}const d=Ro(u);Zr.assign(u.mul(Zr));const _=ba.div(Me(d[0].dot(d[0]),d[1].dot(d[1]),d[2].dot(d[2]))),x=d.mul(_).xyz;ba.assign(x),e.hasGeometryAttribute("tangent")&&o2.mulAssign(d)}}const Kz=st(tce).setParameterLength(1);class nce extends JA{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const n=this.storageBufferNode.structTypeNode;return n?n.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let n;const r=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&r!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?n=e.generatePBO(this):n=this.node.build(e):n=super.generate(e),r!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}const ice=st(nce).setParameterLength(2);class rce extends m5{static get type(){return"StorageBufferNode"}constructor(e,t=null,n=0){let r,s=null;t&&t.isStruct?(r="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(n=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(r=ik(e.itemSize),n=e.count):r=t,super(e,r,n),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=To.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return ice(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(To.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=n2(this.value),this._varying=vc(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:n}=this.getAttributeData(),r=n.build(e);return e.registerTransform(r,t),r}}const LA=(i,e=null,t=0)=>Ze(new rce(i,e,t)),sce=(i,e,t)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),LA(i,e,t).setPBO(!0)),GO=new WeakMap;class Zz extends dn{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=Kn.OBJECT,this.skinIndexNode=Ih("skinIndex","uvec4"),this.skinWeightNode=Ih("skinWeight","vec4"),this.bindMatrixNode=ar("bindMatrix","mat4"),this.bindMatrixInverseNode=ar("bindMatrixInverse","mat4"),this.boneMatricesNode=FC("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Zr,this.toPositionNode=Zr,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(n.x),l=e.element(n.y),u=e.element(n.z),h=e.element(n.w),d=s.mul(t),_=gs(a.mul(r.x).mul(d),l.mul(r.y).mul(d),u.mul(r.z).mul(d),h.mul(r.w).mul(d));return o.mul(_).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=ba){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(n.x),l=e.element(n.y),u=e.element(n.z),h=e.element(n.w);let d=gs(r.x.mul(a),r.y.mul(l),r.z.mul(u),r.w.mul(h));return d=o.mul(d).mul(s),d.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=FC("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,PS)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||ok(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&PS.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();ba.assign(n),e.hasGeometryAttribute("tangent")&&o2.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;GO.get(t)!==e.frameId&&(GO.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const Jz=i=>Ze(new Zz(i)),oce=(i,e=null)=>{const t=new Zz(i);return t.positionNode=LA(new ed(i.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(nd).toVar(),t.skinIndexNode=LA(new ed(new Uint32Array(i.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(nd).toVar(),t.skinWeightNode=LA(new ed(i.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(nd).toVar(),t.bindMatrixNode=ln(i.bindMatrix,"mat4"),t.bindMatrixInverseNode=ln(i.bindMatrixInverse,"mat4"),t.boneMatricesNode=i2(i.skeleton.boneMatrices,"mat4",i.skeleton.bones.length),t.toPositionNode=e,Ze(t)};class ace extends dn{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let o=0,a=this.params.length-1;o<a;o++){const l=this.params[o],u=l.isNode!==!0&&l.name||this.getVarName(o),h=l.isNode!==!0&&l.type||"int";n[u]=Oh(u,h)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](n,e),t.stackNode=r;const s=this.params[0];return s.isNode!==!0&&typeof s.update=="function"&&(t.updateNode=Ce(this.params[0].update)(n)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let a=0,l=n.length-1;a<l;a++){const u=n[a];let h=!1,d=null,_=null,x=null,b=null,R=null,E=null;u.isNode?u.getNodeType(e)==="bool"?(h=!0,b="bool",_=u.build(e,b)):(b="int",x=this.getVarName(a),d="0",_=u.build(e,b),R="<"):(b=u.type||"int",x=u.name||this.getVarName(a),d=u.start,_=u.end,R=u.condition,E=u.update,typeof d=="number"?d=e.generateConst(b,d):d&&d.isNode&&(d=d.build(e,b)),typeof _=="number"?_=e.generateConst(b,_):_&&_.isNode&&(_=_.build(e,b)),d!==void 0&&_===void 0?(d=d+" - 1",_="0",R=">="):_!==void 0&&d===void 0&&(d="0",R="<"),R===void 0&&(Number(d)>Number(_)?R=">=":R="<"));let w;if(h)w=`while ( ${_} )`;else{const L={start:d,end:_},D=L.start,O=L.end;let B;const G=()=>R.includes("<")?"+=":"-=";if(E!=null)switch(typeof E){case"function":B=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":B=x+" "+G()+" "+e.generateConst(b,E);break;case"string":B=x+" "+E;break;default:E.isNode?B=x+" "+G()+" "+E.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),B="break /* invalid update */")}else b==="int"||b==="uint"?E=R.includes("<")?"++":"--":E=G()+" 1.",B=x+" "+E;const k=e.getVar(b,x)+" = "+D,z=x+" "+R+" "+O;w=`for ( ${k}; ${z}; ${B} )`}e.addFlowCode((a===0?`
`:"")+e.tab+w+` {

`).addFlowTab()}const s=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,l=this.params.length-1;a<l;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const Qi=(...i)=>Ze(new ace(NA(i,"int"))).toStack(),lce=()=>Oh("continue").toStack(),eV=()=>Oh("break").toStack(),oM=new WeakMap,ka=new mn,zO=Ce(({bufferMap:i,influence:e,stride:t,width:n,depth:r,offset:s})=>{const o=be(Xz).mul(t).add(s),a=o.div(n),l=o.sub(a.mul(n));return Qr(i,ws(l,a)).depth(r).xyz.mul(e)});function uce(i){const e=i.morphAttributes.position!==void 0,t=i.morphAttributes.normal!==void 0,n=i.morphAttributes.color!==void 0,r=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,s=r!==void 0?r.length:0;let o=oM.get(i);if(o===void 0||o.count!==s){let L=function(){E.dispose(),oM.delete(i),i.removeEventListener("dispose",L)};var a=L;o!==void 0&&o.texture.dispose();const l=i.morphAttributes.position||[],u=i.morphAttributes.normal||[],h=i.morphAttributes.color||[];let d=0;e===!0&&(d=1),t===!0&&(d=2),n===!0&&(d=3);let _=i.attributes.position.count*d,x=1;const b=4096;_>b&&(x=Math.ceil(_/b),_=b);const R=new Float32Array(_*x*4*s),E=new n8(R,_,x,s);E.type=os,E.needsUpdate=!0;const w=d*4;for(let D=0;D<s;D++){const O=l[D],B=u[D],G=h[D],k=_*x*4*D;for(let z=0;z<O.count;z++){const F=z*w;e===!0&&(ka.fromBufferAttribute(O,z),R[k+F+0]=ka.x,R[k+F+1]=ka.y,R[k+F+2]=ka.z,R[k+F+3]=0),t===!0&&(ka.fromBufferAttribute(B,z),R[k+F+4]=ka.x,R[k+F+5]=ka.y,R[k+F+6]=ka.z,R[k+F+7]=0),n===!0&&(ka.fromBufferAttribute(G,z),R[k+F+8]=ka.x,R[k+F+9]=ka.y,R[k+F+10]=ka.z,R[k+F+11]=G.itemSize===4?ka.w:1)}}o={count:s,texture:E,stride:d,size:new it(_,x)},oM.set(i,o),i.addEventListener("dispose",L)}return o}class cce extends dn{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=ln(1),this.updateType=Kn.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=s!==void 0?s.length:0,{texture:a,stride:l,size:u}=uce(t);n===!0&&Zr.mulAssign(this.morphBaseInfluence),r===!0&&ba.mulAssign(this.morphBaseInfluence);const h=be(u.width);Qi(o,({i:d})=>{const _=me(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?_.assign(Qr(this.mesh.morphTexture,ws(be(d).add(1),be(nd))).r):_.assign(ar("morphTargetInfluences","float").element(d).toVar()),Xn(_.notEqual(0),()=>{n===!0&&Zr.addAssign(zO({bufferMap:a,influence:_,stride:l,width:h,depth:d,offset:be(0)})),r===!0&&ba.addAssign(zO({bufferMap:a,influence:_,stride:l,width:h,depth:d,offset:be(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const tV=st(cce).setParameterLength(1);class pg extends dn{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class hce extends pg{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class fce extends xG{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=Me().toVar("directDiffuse"),r=Me().toVar("directSpecular"),s=Me().toVar("indirectDiffuse"),o=Me().toVar("indirectSpecular"),a={directDiffuse:n,directSpecular:r,indirectDiffuse:s,indirectSpecular:o};return{radiance:Me().toVar("radiance"),irradiance:Me().toVar("irradiance"),iblIrradiance:Me().toVar("iblIrradiance"),ambientOcclusion:me(1).toVar("ambientOcclusion"),reflectedLight:a,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const nV=st(fce);class dce extends pg{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let I1,B1;class ds extends dn{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===ds.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Kn.NONE;return(this.scope===ds.SIZE||this.scope===ds.VIEWPORT)&&(e=Kn.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===ds.VIEWPORT?t!==null?B1.copy(t.viewport):(e.getViewport(B1),B1.multiplyScalar(e.getPixelRatio())):t!==null?(I1.width=t.width,I1.height=t.height):e.getDrawingBufferSize(I1)}setup(){const e=this.scope;let t=null;return e===ds.SIZE?t=ln(I1||(I1=new it)):e===ds.VIEWPORT?t=ln(B1||(B1=new mn)):t=dt(a2.div(Ey)),t}generate(e){if(this.scope===ds.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(Ey).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}ds.COORDINATE="coordinate";ds.VIEWPORT="viewport";ds.SIZE="size";ds.UV="uv";const bh=Pt(ds,ds.UV),Ey=Pt(ds,ds.SIZE),a2=Pt(ds,ds.COORDINATE),sm=Pt(ds,ds.VIEWPORT),iV=sm.zw,rV=a2.sub(sm.xy),Ace=rV.div(iV),pce=Ce(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),Ey),"vec2").once()(),U1=new it;class GT extends dc{static get type(){return"ViewportTextureNode"}constructor(e=bh,t=null,n=null){n===null&&(n=new A9,n.minFilter=ua),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=Kn.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(U1);const n=this.value;(n.image.width!==U1.width||n.image.height!==U1.height)&&(n.image.width=U1.width,n.image.height=U1.height,n.needsUpdate=!0);const r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const mce=st(GT).setParameterLength(0,3),E5=st(GT,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let aM=null;class gce extends GT{static get type(){return"ViewportDepthTextureNode"}constructor(e=bh,t=null){aM===null&&(aM=new Ja),super(e,t,aM)}}const w5=st(gce).setParameterLength(0,2);class da extends dn{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===da.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===da.DEPTH_BASE)n!==null&&(r=oV().assign(n));else if(t===da.DEPTH)e.isPerspectiveCamera?r=sV(Jr.z,Wf,jf):r=om(Jr.z,Wf,jf);else if(t===da.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const s=M5(n,Wf,jf);r=om(s,Wf,jf)}else r=n;else r=om(Jr.z,Wf,jf);return r}}da.DEPTH_BASE="depthBase";da.DEPTH="depth";da.LINEAR_DEPTH="linearDepth";const om=(i,e,t)=>i.add(e).div(e.sub(t)),_ce=(i,e,t)=>e.sub(t).mul(i).sub(e),sV=(i,e,t)=>e.add(i).mul(t).div(t.sub(e).mul(i)),M5=(i,e,t)=>e.mul(t).div(t.sub(e).mul(i).sub(t)),R5=(i,e,t)=>{e=e.max(1e-6).toVar();const n=nc(i.negate().div(e)),r=nc(t.div(e));return n.div(r)},yce=(i,e,t)=>{const n=i.mul(RT(t.div(e)));return me(Math.E).pow(n).mul(e).negate()},oV=st(da,da.DEPTH_BASE),C5=Pt(da,da.DEPTH),LS=st(da,da.LINEAR_DEPTH).setParameterLength(0,1),vce=LS(w5());C5.assign=i=>oV(i);class Nl extends dn{static get type(){return"ClippingNode"}constructor(e=Nl.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Nl.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===Nl.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return Ce(()=>{const n=me().toVar("distanceToPlane"),r=me().toVar("distanceToGradient"),s=me(1).toVar("clipOpacity"),o=t.length;if(this.hardwareClipping===!1&&o>0){const l=Tl(t);Qi(o,({i:u})=>{const h=l.element(u);n.assign(Jr.dot(h.xyz).negate().add(h.w)),r.assign(n.fwidth().div(2)),s.mulAssign(fc(r.negate(),r,n))})}const a=e.length;if(a>0){const l=Tl(e),u=me(1).toVar("intersectionClipOpacity");Qi(a,({i:h})=>{const d=l.element(h);n.assign(Jr.dot(d.xyz).negate().add(d.w)),r.assign(n.fwidth().div(2)),u.mulAssign(fc(r.negate(),r,n).oneMinus())}),s.mulAssign(u.oneMinus())}Di.a.mulAssign(s),Di.a.equal(0).discard()})()}setupDefault(e,t){return Ce(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const s=Tl(t);Qi(n,({i:o})=>{const a=s.element(o);Jr.dot(a.xyz).greaterThan(a.w).discard()})}const r=e.length;if(r>0){const s=Tl(e),o=cc(!0).toVar("clipped");Qi(r,({i:a})=>{const l=s.element(a);o.assign(Jr.dot(l.xyz).greaterThan(l.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),Ce(()=>{const r=Tl(e),s=r2(t.getClipDistance());Qi(n,({i:o})=>{const a=r.element(o),l=Jr.dot(a.xyz).sub(a.w).negate();s.element(o).assign(l)})})()}}Nl.ALPHA_TO_COVERAGE="alphaToCoverage";Nl.DEFAULT="default";Nl.HARDWARE="hardware";const xce=()=>Ze(new Nl),bce=()=>Ze(new Nl(Nl.ALPHA_TO_COVERAGE)),Sce=()=>Ze(new Nl(Nl.HARDWARE)),Tce=.05,VO=Ce(([i])=>zh(jn(1e4,Xa(jn(17,i.x).add(jn(.1,i.y)))).mul(gs(.1,gr(Xa(jn(13,i.y).add(i.x))))))),qO=Ce(([i])=>VO(dt(VO(i.xy),i.z))),Ece=Ce(([i])=>{const e=Hr(rc(i5(i.xyz)),rc(r5(i.xyz))),t=me(1).div(me(Tce).mul(e)).toVar("pixScale"),n=dt(qm(ic(nc(t))),qm(CT(nc(t)))),r=dt(qO(ic(n.x.mul(i.xyz))),qO(ic(n.y.mul(i.xyz)))),s=zh(nc(t)),o=gs(jn(s.oneMinus(),r.x),jn(s,r.y)),a=xa(s,s.oneMinus()),l=Me(o.mul(o).div(jn(2,a).mul(vi(1,a))),o.sub(jn(.5,a)).div(vi(1,a)),vi(1,vi(1,o).mul(vi(1,o)).div(jn(2,a).mul(vi(1,a))))),u=o.lessThan(a.oneMinus()).select(o.lessThan(a).select(l.x,l.y),l.z);return hc(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class wce extends qG{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new mn(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const aV=(i=0)=>Ze(new wce(i)),lV=Ce(([i,e])=>xa(1,i.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),uV=Ce(([i,e])=>xa(i.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),cV=Ce(([i,e])=>i.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),hV=Ce(([i,e])=>zi(i.mul(2).mul(e),i.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),NT(.5,i))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Mce=Ce(([i,e])=>{const t=e.a.add(i.a.mul(e.a.oneMinus()));return an(e.rgb.mul(e.a).add(i.rgb.mul(i.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),fV=Ce(([i])=>an(i.rgb.mul(i.a),i.a),{color:"vec4",return:"vec4"}),Rce=Ce(([i])=>(Xn(i.a.equal(0),()=>an(0)),an(i.rgb.div(i.a),i.a)),{color:"vec4",return:"vec4"}),Cce=(...i)=>(console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),lV(i)),Nce=(...i)=>(console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),uV(i)),Dce=(...i)=>(console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),cV(i)),Pce=(...i)=>(console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),hV(i));class ts extends wo{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+nk(this)}build(e){this.setup(e)}setupObserver(e){return new ole(e)}setup(e){e.context.setupNormal=()=>rm(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();e.addStack();const r=rm(this.setupVertex(e),"VERTEX"),s=this.vertexNode||r;e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const a=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const l=this.setupLighting(e);a!==null&&e.stack.add(a);const u=an(l,Di.a).max(0);o=this.setupOutput(e,u),im.assign(o);const h=this.outputNode!==null;if(h&&(o=this.outputNode),n!==null){const d=t.getMRT(),_=this.mrtNode;d!==null?(h&&im.assign(o),o=d,_!==null&&(o=d.merge(_))):_!==null&&(o=_)}}else{let l=this.fragmentNode;l.isOutputStructNode!==!0&&(l=an(l)),o=this.setupOutput(e,l)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const s=e.renderer.samples;this.alphaToCoverage&&s>1?r=bce():e.stack.add(xce())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(Sce()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=R5(Jr.z,Wf,jf):r=om(Jr.z,Wf,jf))}r!==null&&C5.assign(r).toStack()}setupPositionView(){return t0.mul(Zr).xyz}setupModelViewProjection(){return e0.mul(Jr)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),T5}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&tV(t).toStack(),t.isSkinnedMesh===!0&&Jz(t).toStack(),this.displacementMap){const r=dh("displacementMap","texture"),s=dh("displacementScale","float"),o=dh("displacementBias","float");Zr.addAssign(ba.normalize().mul(r.x.mul(s).add(o)))}return t.isBatchedMesh&&Kz(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&Qz(t).toStack(),this.positionNode!==null&&Zr.assign(rm(this.positionNode,"POSITION","vec3")),Zr}setupDiffuseColor({object:e,geometry:t}){this.maskNode!==null&&cc(this.maskNode).not().discard();let n=this.colorNode?an(this.colorNode):gz;this.vertexColors===!0&&t.hasAttribute("color")&&(n=n.mul(aV())),e.instanceColor&&(n=vy("vec3","vInstanceColor").mul(n)),e.isBatchedMesh&&e._colorsTexture&&(n=vy("vec3","vBatchColor").mul(n)),Di.assign(n);const r=this.opacityNode?me(this.opacityNode):b5;Di.a.assign(Di.a.mul(r));let s=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(s=this.alphaTestNode!==null?me(this.alphaTestNode):mz,Di.a.lessThanEqual(s).discard()),this.alphaHash===!0&&Di.a.lessThan(Ece(Zr)).discard(),this.transparent===!1&&this.blending===Wo&&this.alphaToCoverage===!1?Di.a.assign(1):s===null&&Di.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Me(0):Di.rgb}setupNormal(){return this.normalNode?Me(this.normalNode):Tz}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?dh("envMap","cubeTexture"):dh("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new dce(S5)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:jz;t.push(new hce(o))}let s=this.lightsNode||e.lightsNode;return t.length>0&&(s=e.renderer.lighting.createNode([...s.getLights(),...t])),s}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:s}=this,a=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){const u=this.setupLightingModel(e)||null;l=nV(a,u,n,r)}else n!==null&&(l=Me(r!==null?zi(l,n,r):n));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(LC.assign(Me(s||yz)),l=l.add(LC)),l}setupFog(e,t){const n=e.fogNode;return n&&(im.assign(t),t=an(n)),t}setupPremultipliedAlpha(e,t){return fV(t)}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),this.premultipliedAlpha===!0&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=wo.prototype.toJSON.call(this,e),r=TS(this);n.inputNodes={};for(const{property:o,childNode:a}of r)n.inputNodes[o]=a.toJSON(e).uuid;function s(o){const a=[];for(const l in o){const u=o[l];delete u.metadata,a.push(u)}return a}if(t){const o=s(e.textures),a=s(e.images),l=s(e.nodes);o.length>0&&(n.textures=o),a.length>0&&(n.images=a),l.length>0&&(n.nodes=l)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Lce=new hg;class Oce extends ts{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(Lce),this.setValues(e)}}const Ice=new iQ;class Bce extends ts{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Ice),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?me(this.offsetNode):qz,t=this.dashScaleNode?me(this.dashScaleNode):Gz,n=this.dashSizeNode?me(this.dashSizeNode):zz,r=this.gapSizeNode?me(this.gapSizeNode):Vz;Rb.assign(n),OC.assign(r);const s=vc(Ih("lineDistance").mul(t));(e?s.add(e):s).mod(Rb.add(OC)).greaterThan(Rb).discard()}}let lM=null;class Uce extends GT{static get type(){return"ViewportSharedTextureNode"}constructor(e=bh,t=null){lM===null&&(lM=new A9),super(e,t,lM)}updateReference(){return this}}const Fce=st(Uce).setParameterLength(0,2),dV=i=>Ze(i).mul(.5).add(.5),kce=i=>Ze(i).mul(2).sub(1),Gce=new JY;class zce extends ts{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Gce),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?me(this.opacityNode):b5;Di.assign(LT(an(dV(Yi),e),qs))}}const N5=Ce(([i=g5])=>{const e=i.z.atan(i.x).mul(1/(Math.PI*2)).add(.5),t=i.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return dt(e,t)});class AV extends f9{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new hd(5,5,5),o=N5(g5),a=new ts;a.colorNode=ui(t,o,0),a.side=Zi,a.blending=ga;const l=new Ri(s,a),u=new uT;u.add(l),t.minFilter===ua&&(t.minFilter=Ms);const h=new h9(1,10,this),d=e.getMRT();return e.setMRT(null),h.update(e,u),e.setMRT(d),t.minFilter=n,t.currentGenerateMipmaps=r,l.geometry.dispose(),l.material.dispose(),this}}const O_=new WeakMap;class Vce extends _s{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Wm(null);const t=new Xy;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Kn.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:n[r.property];if(s&&s.isTexture){const o=s.mapping;if(o===Am||o===pm){if(O_.has(s)){const a=O_.get(s);HO(a,s.mapping),this._cubeTexture=a}else{const a=s.image;if(qce(a)){const l=new AV(a.height);l.fromEquirectangularTexture(t,s),HO(l.texture,s.mapping),this._cubeTexture=l.texture,O_.set(s,l.texture),s.addEventListener("dispose",pV)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function qce(i){return i==null?!1:i.height>0}function pV(i){const e=i.target;e.removeEventListener("dispose",pV);const t=O_.get(e);t!==void 0&&(O_.delete(e),t.dispose())}function HO(i,e){e===Am?i.mapping=oc:e===pm&&(i.mapping=ac)}const mV=st(Vce).setParameterLength(1);class D5 extends pg{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=mV(this.envNode)}}class Hce extends pg{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=me(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class zT{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class gV extends zT{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign(an(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign(an(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(Di.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case Vy:r.rgb.assign(zi(r.rgb,r.rgb.mul(s.rgb),L_.mul(Pb)));break;case ZU:r.rgb.assign(zi(r.rgb,s.rgb,L_.mul(Pb)));break;case JU:r.rgb.addAssign(s.rgb.mul(L_.mul(Pb)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const Wce=new $a;class jce extends ts{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Wce),this.setValues(e)}setupNormal(){return Ag(Hm)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new D5(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Hce(S5)),t}setupOutgoingLight(){return Di.rgb}setupLightingModel(){return new gV}}const jm=Ce(({f0:i,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return i.mul(n.oneMinus()).add(e.mul(n))}),XA=Ce(i=>i.diffuseColor.mul(1/Math.PI)),Xce=()=>me(.25),$ce=Ce(({dotNH:i})=>RS.mul(me(.5)).add(1).mul(me(1/Math.PI)).mul(i.pow(RS))),Yce=Ce(({lightDirection:i})=>{const e=i.add(Er).normalize(),t=Yi.dot(e).clamp(),n=Er.dot(e).clamp(),r=jm({f0:na,f90:1,dotVH:n}),s=Xce(),o=$ce({dotNH:t});return r.mul(s).mul(o)});class _V extends gV{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Yi.dot(e).clamp().mul(t);n.directDiffuse.addAssign(s.mul(XA({diffuseColor:Di.rgb}))),this.specular===!0&&n.directSpecular.addAssign(s.mul(Yce({lightDirection:e})).mul(L_))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(XA({diffuseColor:Di}))),r.indirectDiffuse.mulAssign(t)}}const Qce=new Gh;class Kce extends ts{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Qce),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new D5(t):null}setupLightingModel(){return new _V(!1)}}const Zce=new w9;class Jce extends ts{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(Zce),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new D5(t):null}setupLightingModel(){return new _V}setupVariants(){const e=(this.shininessNode?me(this.shininessNode):_z).max(1e-4);RS.assign(e);const t=this.specularNode||vz;na.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const yV=Ce(i=>{if(i.geometry.hasAttribute("normal")===!1)return me(0);const e=Hm.dFdx().abs().max(Hm.dFdy().abs());return e.x.max(e.y).max(e.z)}),P5=Ce(i=>{const{roughness:e}=i,t=yV();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),vV=Ce(({alpha:i,dotNL:e,dotNV:t})=>{const n=i.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return Ll(.5,r.add(s).max(Yk))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),ehe=Ce(({alphaT:i,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:s,dotNV:o,dotNL:a})=>{const l=a.mul(Me(i.mul(t),e.mul(n),o).length()),u=o.mul(Me(i.mul(r),e.mul(s),a).length());return Ll(.5,l.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),xV=Ce(({alpha:i,dotNH:e})=>{const t=i.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),the=me(1/Math.PI),nhe=Ce(({alphaT:i,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const s=i.mul(e),o=Me(e.mul(n),i.mul(r),s.mul(t)),a=o.dot(o),l=s.div(a);return the.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),qC=Ce(({lightDirection:i,f0:e,f90:t,roughness:n,f:r,normalView:s=Yi,USE_IRIDESCENCE:o,USE_ANISOTROPY:a})=>{const l=n.pow2(),u=i.add(Er).normalize(),h=s.dot(i).clamp(),d=s.dot(Er).clamp(),_=s.dot(u).clamp(),x=Er.dot(u).clamp();let b=jm({f0:e,f90:t,dotVH:x}),R,E;if(_y(o)&&(b=ET.mix(b,r)),_y(a)){const w=N_.dot(i),L=N_.dot(Er),D=N_.dot(u),O=PA.dot(i),B=PA.dot(Er),G=PA.dot(u);R=ehe({alphaT:MS,alphaB:l,dotTV:L,dotBV:B,dotTL:w,dotBL:O,dotNV:d,dotNL:h}),E=nhe({alphaT:MS,alphaB:l,dotNH:_,dotTH:D,dotBH:G})}else R=vV({alpha:l,dotNL:h,dotNV:d}),E=xV({alpha:l,dotNH:_});return b.mul(R).mul(E)}),L5=Ce(({roughness:i,dotNV:e})=>{const t=an(-1,-.0275,-.572,.022),n=an(1,.0425,1.04,-.04),r=i.mul(t).add(n),s=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return dt(-1.04,1.04).mul(s).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),bV=Ce(i=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=i,s=L5({dotNV:e,roughness:r});return t.mul(s.x).add(n.mul(s.y))}),SV=Ce(({f:i,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),s=n.mul(r,r).clamp(0,.9999);return i.sub(Me(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),ihe=Ce(({roughness:i,dotNH:e})=>{const t=i.pow2(),n=me(1).div(t),s=e.pow2().oneMinus().max(.0078125);return me(2).add(n).mul(s.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),rhe=Ce(({dotNV:i,dotNL:e})=>me(1).div(me(4).mul(e.add(i).sub(e.mul(i))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),she=Ce(({lightDirection:i})=>{const e=i.add(Er).normalize(),t=Yi.dot(i).clamp(),n=Yi.dot(Er).clamp(),r=Yi.dot(e).clamp(),s=ihe({roughness:TT,dotNH:r}),o=rhe({dotNV:n,dotNL:t});return _A.mul(s).mul(o)}),ohe=Ce(({N:i,V:e,roughness:t})=>{const s=.0078125,o=i.dot(e).saturate(),a=dt(t,o.oneMinus().sqrt());return a.assign(a.mul(.984375).add(s)),a}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),ahe=Ce(({f:i})=>{const e=i.length();return Hr(e.mul(e).add(i.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Sx=Ce(({v1:i,v2:e})=>{const t=i.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),s=n.add(4.1616724).mul(n).add(3.417594).toVar(),o=r.div(s),a=t.greaterThan(0).select(o,Hr(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return i.cross(e).mul(a)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),WO=Ce(({N:i,V:e,P:t,mInv:n,p0:r,p1:s,p2:o,p3:a})=>{const l=s.sub(r).toVar(),u=a.sub(r).toVar(),h=l.cross(u),d=Me().toVar();return Xn(h.dot(t.sub(r)).greaterThanEqual(0),()=>{const _=e.sub(i.mul(e.dot(i))).normalize(),x=i.cross(_).negate(),b=n.mul(Ro(_,x,i).transpose()).toVar(),R=b.mul(r.sub(t)).normalize().toVar(),E=b.mul(s.sub(t)).normalize().toVar(),w=b.mul(o.sub(t)).normalize().toVar(),L=b.mul(a.sub(t)).normalize().toVar(),D=Me(0).toVar();D.addAssign(Sx({v1:R,v2:E})),D.addAssign(Sx({v1:E,v2:w})),D.addAssign(Sx({v1:w,v2:L})),D.addAssign(Sx({v1:L,v2:R})),d.assign(Me(ahe({f:D})))}),d}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),VT=1/6,TV=i=>jn(VT,jn(i,jn(i,i.negate().add(3)).sub(3)).add(1)),HC=i=>jn(VT,jn(i,jn(i,jn(3,i).sub(6))).add(4)),EV=i=>jn(VT,jn(i,jn(i,jn(-3,i).add(3)).add(3)).add(1)),WC=i=>jn(VT,Au(i,3)),jO=i=>TV(i).add(HC(i)),XO=i=>EV(i).add(WC(i)),$O=i=>gs(-1,HC(i).div(TV(i).add(HC(i)))),YO=i=>gs(1,WC(i).div(EV(i).add(WC(i)))),QO=(i,e,t)=>{const n=i.uvNode,r=jn(n,e.zw).add(.5),s=ic(r),o=zh(r),a=jO(o.x),l=XO(o.x),u=$O(o.x),h=YO(o.x),d=$O(o.y),_=YO(o.y),x=dt(s.x.add(u),s.y.add(d)).sub(.5).mul(e.xy),b=dt(s.x.add(h),s.y.add(d)).sub(.5).mul(e.xy),R=dt(s.x.add(u),s.y.add(_)).sub(.5).mul(e.xy),E=dt(s.x.add(h),s.y.add(_)).sub(.5).mul(e.xy),w=jO(o.y).mul(gs(a.mul(i.sample(x).level(t)),l.mul(i.sample(b).level(t)))),L=XO(o.y).mul(gs(a.mul(i.sample(R).level(t)),l.mul(i.sample(E).level(t))));return w.add(L)},O5=Ce(([i,e])=>{const t=dt(i.size(be(e))),n=dt(i.size(be(e.add(1)))),r=Ll(1,t),s=Ll(1,n),o=QO(i,an(r,t),ic(e)),a=QO(i,an(s,n),CT(e));return zh(e).mix(o,a)}),lhe=Ce(([i,e])=>{const t=e.mul(A5(i));return O5(i,t)}),KO=Ce(([i,e,t,n,r])=>{const s=Me(u5(e.negate(),Lh(i),Ll(1,n))),o=Me(rc(r[0].xyz),rc(r[1].xyz),rc(r[2].xyz));return Lh(s).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),uhe=Ce(([i,e])=>i.mul(hc(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),che=E5(),hhe=E5(),ZO=Ce(([i,e,t],{material:n})=>{const s=(n.side===Zi?che:hhe).sample(i),o=nc(Ey.x).mul(uhe(e,t));return O5(s,o)}),JO=Ce(([i,e,t])=>(Xn(t.notEqual(0),()=>{const n=RT(e).negate().div(t);return J8(n.negate().mul(i))}),Me(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),fhe=Ce(([i,e,t,n,r,s,o,a,l,u,h,d,_,x,b])=>{let R,E;if(b){R=an().toVar(),E=Me().toVar();const B=h.sub(1).mul(b.mul(.025)),G=Me(h.sub(B),h,h.add(B));Qi({start:0,end:3},({i:k})=>{const z=G.element(k),F=KO(i,e,d,z,a),q=o.add(F),H=u.mul(l.mul(an(q,1))),Q=dt(H.xy.div(H.w)).toVar();Q.addAssign(1),Q.divAssign(2),Q.assign(dt(Q.x,Q.y.oneMinus()));const K=ZO(Q,t,z);R.element(k).assign(K.element(k)),R.a.addAssign(K.a),E.element(k).assign(n.element(k).mul(JO(rc(F),_,x).element(k)))}),R.a.divAssign(3)}else{const B=KO(i,e,d,h,a),G=o.add(B),k=u.mul(l.mul(an(G,1))),z=dt(k.xy.div(k.w)).toVar();z.addAssign(1),z.divAssign(2),z.assign(dt(z.x,z.y.oneMinus())),R=ZO(z,t,h),E=n.mul(JO(rc(B),_,x))}const w=E.rgb.mul(R.rgb),L=i.dot(e).clamp(),D=Me(bV({dotNV:L,specularColor:r,specularF90:s,roughness:t})),O=E.r.add(E.g,E.b).div(3);return an(D.oneMinus().mul(w),R.a.oneMinus().mul(O).oneMinus())}),dhe=Ro(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Ahe=i=>{const e=i.sqrt();return Me(1).add(e).div(Me(1).sub(e))},eI=(i,e)=>i.sub(e).div(i.add(e)).pow2(),phe=(i,e)=>{const t=i.mul(2*Math.PI*1e-9),n=Me(54856e-17,44201e-17,52481e-17),r=Me(1681e3,1795300,2208400),s=Me(43278e5,93046e5,66121e5),o=me(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let a=n.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return a=Me(a.x.add(o),a.y,a.z).div(10685e-11),dhe.mul(a)},mhe=Ce(({outsideIOR:i,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const s=zi(i,e,fc(0,.03,n)),a=i.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();Xn(a.lessThan(0),()=>Me(1));const l=a.sqrt(),u=eI(s,i),h=jm({f0:u,f90:1,dotVH:t}),d=h.oneMinus(),_=s.lessThan(i).select(Math.PI,0),x=me(Math.PI).sub(_),b=Ahe(r.clamp(0,.9999)),R=eI(b,s.toVec3()),E=jm({f0:R,f90:1,dotVH:l}),w=Me(b.x.lessThan(s).select(Math.PI,0),b.y.lessThan(s).select(Math.PI,0),b.z.lessThan(s).select(Math.PI,0)),L=s.mul(n,l,2),D=Me(x).add(w),O=h.mul(E).clamp(1e-5,.9999),B=O.sqrt(),G=d.pow2().mul(E).div(Me(1).sub(O)),z=h.add(G).toVar(),F=G.sub(d).toVar();return Qi({start:1,end:2,condition:"<=",name:"m"},({m:q})=>{F.mulAssign(B);const H=phe(me(q).mul(L),me(q).mul(D)).mul(2);z.addAssign(F.mul(H))}),z.max(Me(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),ghe=Ce(({normal:i,viewDir:e,roughness:t})=>{const n=i.dot(e).saturate(),r=t.pow2(),s=js(t.lessThan(.25),me(-339.2).mul(r).add(me(161.4).mul(t)).sub(25.9),me(-8.48).mul(r).add(me(14.3).mul(t)).sub(9.95)),o=js(t.lessThan(.25),me(44).mul(r).sub(me(23.7).mul(t)).add(3.26),me(1.97).mul(r).sub(me(3.27).mul(t)).add(.72));return js(t.lessThan(.25),0,me(.1).mul(t).sub(.025)).add(s.mul(n).add(o).exp()).mul(1/Math.PI).saturate()}),uM=Me(.04),cM=me(1);class wV extends zT{constructor(e=!1,t=!1,n=!1,r=!1,s=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=s,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Me().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Me().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Me().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Me().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Me().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=Yi.dot(Er).clamp();this.iridescenceFresnel=mhe({outsideIOR:me(1),eta2:H8,cosTheta1:t,thinFilmThickness:W8,baseF0:na}),this.iridescenceF0=SV({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=xh,n=HG.sub(xh).normalize(),r=dd,s=e.context;s.backdrop=fhe(r,n,qu,Di,na,Sy,t,El,Fl,e0,D_,j8,$8,X8,this.dispersion?Y8:null),s.backdropAlpha=CS,Di.a.mulAssign(zi(1,s.backdrop.a,CS))}super.start(e)}computeMultiscattering(e,t,n){const r=Yi.dot(Er).clamp(),s=L5({roughness:qu,dotNV:r}),a=(this.iridescenceF0?ET.mix(na,this.iridescenceF0):na).mul(s.x).add(n.mul(s.y)),u=s.x.add(s.y).oneMinus(),h=na.add(na.oneMinus().mul(.047619)),d=a.mul(h).div(u.mul(h).oneMinus());e.addAssign(a),t.addAssign(d.mul(u))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Yi.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(she({lightDirection:e}))),this.clearcoat===!0){const a=yA.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(a.mul(qC({lightDirection:e,f0:uM,f90:cM,roughness:by,normalView:yA})))}n.directDiffuse.addAssign(s.mul(XA({diffuseColor:Di.rgb}))),n.directSpecular.addAssign(s.mul(qC({lightDirection:e,f0:na,f90:1,roughness:qu,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:s,ltc_1:o,ltc_2:a}){const l=t.add(n).sub(r),u=t.sub(n).sub(r),h=t.sub(n).add(r),d=t.add(n).add(r),_=Yi,x=Er,b=Jr.toVar(),R=ohe({N:_,V:x,roughness:qu}),E=o.sample(R).toVar(),w=a.sample(R).toVar(),L=Ro(Me(E.x,0,E.y),Me(0,1,0),Me(E.z,0,E.w)).toVar(),D=na.mul(w.x).add(na.oneMinus().mul(w.y)).toVar();s.directSpecular.addAssign(e.mul(D).mul(WO({N:_,V:x,P:b,mInv:L,p0:l,p1:u,p2:h,p3:d}))),s.directDiffuse.addAssign(e.mul(Di).mul(WO({N:_,V:x,P:b,mInv:Ro(1,0,0,0,1,0,0,0,1),p0:l,p1:u,p2:h,p3:d})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(t.mul(XA({diffuseColor:Di})))}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(_A,ghe({normal:Yi,viewDir:Er,roughness:TT}))),this.clearcoat===!0){const h=yA.dot(Er).clamp(),d=bV({dotNV:h,specularColor:uM,specularF90:cM,roughness:by});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(d))}const s=Me().toVar("singleScattering"),o=Me().toVar("multiScattering"),a=n.mul(1/Math.PI);this.computeMultiscattering(s,o,Sy);const l=s.add(o),u=Di.mul(l.r.max(l.g).max(l.b).oneMinus());r.indirectSpecular.addAssign(t.mul(s)),r.indirectSpecular.addAssign(o.mul(a)),r.indirectDiffuse.addAssign(u.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,s=Yi.dot(Er).clamp().add(t),o=qu.mul(-16).oneMinus().negate().exp2(),a=t.sub(s.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(a)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=yA.dot(Er).clamp(),r=jm({dotVH:n,f0:uM,f90:cM}),s=t.mul(wS.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(wS));t.assign(s)}if(this.sheen===!0){const n=_A.r.max(_A.g).max(_A.b).mul(.157).oneMinus(),r=t.mul(n).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const tI=me(1),jC=me(-2),Tx=me(.8),hM=me(-1),Ex=me(.4),fM=me(2),wx=me(.305),dM=me(3),nI=me(.21),_he=me(4),iI=me(4),yhe=me(16),vhe=Ce(([i])=>{const e=Me(gr(i)).toVar(),t=me(-1).toVar();return Xn(e.x.greaterThan(e.z),()=>{Xn(e.x.greaterThan(e.y),()=>{t.assign(js(i.x.greaterThan(0),0,3))}).Else(()=>{t.assign(js(i.y.greaterThan(0),1,4))})}).Else(()=>{Xn(e.z.greaterThan(e.y),()=>{t.assign(js(i.z.greaterThan(0),2,5))}).Else(()=>{t.assign(js(i.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),xhe=Ce(([i,e])=>{const t=dt().toVar();return Xn(e.equal(0),()=>{t.assign(dt(i.z,i.y).div(gr(i.x)))}).ElseIf(e.equal(1),()=>{t.assign(dt(i.x.negate(),i.z.negate()).div(gr(i.y)))}).ElseIf(e.equal(2),()=>{t.assign(dt(i.x.negate(),i.y).div(gr(i.z)))}).ElseIf(e.equal(3),()=>{t.assign(dt(i.z.negate(),i.y).div(gr(i.x)))}).ElseIf(e.equal(4),()=>{t.assign(dt(i.x.negate(),i.z).div(gr(i.y)))}).Else(()=>{t.assign(dt(i.x,i.y).div(gr(i.z)))}),jn(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),bhe=Ce(([i])=>{const e=me(0).toVar();return Xn(i.greaterThanEqual(Tx),()=>{e.assign(tI.sub(i).mul(hM.sub(jC)).div(tI.sub(Tx)).add(jC))}).ElseIf(i.greaterThanEqual(Ex),()=>{e.assign(Tx.sub(i).mul(fM.sub(hM)).div(Tx.sub(Ex)).add(hM))}).ElseIf(i.greaterThanEqual(wx),()=>{e.assign(Ex.sub(i).mul(dM.sub(fM)).div(Ex.sub(wx)).add(fM))}).ElseIf(i.greaterThanEqual(nI),()=>{e.assign(wx.sub(i).mul(_he.sub(dM)).div(wx.sub(nI)).add(dM))}).Else(()=>{e.assign(me(-2).mul(nc(jn(1.16,i))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),MV=Ce(([i,e])=>{const t=i.toVar();t.assign(jn(2,t).sub(1));const n=Me(t,1).toVar();return Xn(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),RV=Ce(([i,e,t,n,r,s])=>{const o=me(t),a=Me(e),l=hc(bhe(o),jC,s),u=zh(l),h=ic(l),d=Me(XC(i,a,h,n,r,s)).toVar();return Xn(u.notEqual(0),()=>{const _=Me(XC(i,a,h.add(1),n,r,s)).toVar();d.assign(zi(d,_,u))}),d}),XC=Ce(([i,e,t,n,r,s])=>{const o=me(t).toVar(),a=Me(e),l=me(vhe(a)).toVar(),u=me(Hr(iI.sub(o),0)).toVar();o.assign(Hr(o,iI));const h=me(qm(o)).toVar(),d=dt(xhe(a,l).mul(h.sub(2)).add(1)).toVar();return Xn(l.greaterThan(2),()=>{d.y.addAssign(h),l.subAssign(3)}),d.x.addAssign(l.mul(h)),d.x.addAssign(u.mul(jn(3,yhe))),d.y.addAssign(jn(4,qm(s).sub(h))),d.x.mulAssign(n),d.y.mulAssign(r),i.sample(d).grad(dt(),dt())}),AM=Ce(({envMap:i,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:a})=>{const l=uh(n),u=t.mul(l).add(r.cross(t).mul(Xa(n))).add(r.mul(r.dot(t).mul(l.oneMinus())));return XC(i,u,e,s,o,a)}),CV=Ce(({n:i,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:s,dTheta:o,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d})=>{const _=Me(js(e,t,DT(t,n))).toVar();Xn(_.equal(Me(0)),()=>{_.assign(Me(n.z,0,n.x.negate()))}),_.assign(Lh(_));const x=Me().toVar();return x.addAssign(r.element(0).mul(AM({theta:0,axis:_,outputDirection:n,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),Qi({start:be(1),end:i},({i:b})=>{Xn(b.greaterThanEqual(s),()=>{eV()});const R=me(o.mul(me(b))).toVar();x.addAssign(r.element(b).mul(AM({theta:R.mul(-1),axis:_,outputDirection:n,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),x.addAssign(r.element(b).mul(AM({theta:R,axis:_,outputDirection:n,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d})))}),an(x,1)}),jp=4,rI=[.125,.215,.35,.446,.526,.582],uA=20,pM=new Qy(-1,1,1,-1,0,1),She=new Ws(90,1),sI=new Jt;let mM=null,gM=0,_M=0;const sA=(1+Math.sqrt(5))/2,dp=1/sA,oI=[new ce(-sA,dp,0),new ce(sA,dp,0),new ce(-dp,0,sA),new ce(dp,0,sA),new ce(0,sA,-dp),new ce(0,sA,dp),new ce(-1,1,-1),new ce(1,1,-1),new ce(-1,1,1),new ce(1,1,1)],The=new ce,NV=new WeakMap,Ehe=[3,1,5,0,4,2],yM=MV(Tr(),Ih("faceIndex")).normalize(),I5=Me(yM.x,yM.y,yM.z);class whe{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,s={}){const{size:o=256,position:a=The,renderTarget:l=null}=s;if(this._setSize(o),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const h=l||this._allocateTarget();return s.renderTarget=h,this.fromSceneAsync(e,t,n,r,s),h}mM=this._renderer.getRenderTarget(),gM=this._renderer.getActiveCubeFace(),_M=this._renderer.getActiveMipmapLevel();const u=l||this._allocateTarget();return u.depthBuffer=!0,this._init(u),this._sceneToCubeUV(e,n,r,u,a),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,t=0,n=.1,r=100,s={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,n,r,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lI(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=uI(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===oc||e.mapping===ac?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(mM,gM,_M),e.scissorTest=!1,Mx(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),mM=this._renderer.getRenderTarget(),gM=this._renderer.getActiveCubeFace(),_M=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return aI(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=aI(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=Mhe(t)),this._blurMaterial=Rhe(t,e.width,e.height)}}async _compileMaterial(e){const t=new Ri(this._lodPlanes[0],e);await this._renderer.compile(t,pM)}_sceneToCubeUV(e,t,n,r,s){const o=She;o.near=t,o.far=n;const a=[1,1,1,1,-1,1],l=[1,-1,1,-1,1,-1],u=this._renderer,h=u.autoClear;u.getClearColor(sI),u.autoClear=!1;let d=this._backgroundBox;if(d===null){const b=new $a({name:"PMREM.Background",side:Zi,depthWrite:!1,depthTest:!1});d=new Ri(new hd,b)}let _=!1;const x=e.background;x?x.isColor&&(d.material.color.copy(x),e.background=null,_=!0):(d.material.color.copy(sI),_=!0),u.setRenderTarget(r),u.clear(),_&&u.render(d,o);for(let b=0;b<6;b++){const R=b%3;R===0?(o.up.set(0,a[b],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x+l[b],s.y,s.z)):R===1?(o.up.set(0,0,a[b]),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y+l[b],s.z)):(o.up.set(0,a[b],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y,s.z+l[b]));const E=this._cubeSize;Mx(r,R*E,b>2?E:0,E,E),u.render(e,o)}u.autoClear=h,e.background=x}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===oc||e.mapping===ac;r?this._cubemapMaterial===null&&(this._cubemapMaterial=lI(e)):this._equirectMaterial===null&&(this._equirectMaterial=uI(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=s;const a=this._cubeSize;Mx(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(o,pM)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=oI[(r-s-1)%oI.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,d=this._lodMeshes[r];d.material=u;const _=NV.get(u),x=this._sizeLods[n]-1,b=isFinite(s)?Math.PI/(2*x):2*Math.PI/(2*uA-1),R=s/b,E=isFinite(s)?1+Math.floor(h*R):uA;E>uA&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${uA}`);const w=[];let L=0;for(let k=0;k<uA;++k){const z=k/R,F=Math.exp(-z*z/2);w.push(F),k===0?L+=F:k<E&&(L+=2*F)}for(let k=0;k<w.length;k++)w[k]=w[k]/L;e.texture.frame=(e.texture.frame||0)+1,_.envMap.value=e.texture,_.samples.value=E,_.weights.array=w,_.latitudinal.value=o==="latitudinal"?1:0,a&&(_.poleAxis.value=a);const{_lodMax:D}=this;_.dTheta.value=b,_.mipInt.value=D-n;const O=this._sizeLods[r],B=3*O*(r>D-jp?r-D+jp:0),G=4*(this._cubeSize-O);Mx(t,B,G,3*O,2*O),l.setRenderTarget(t),l.render(d,pM)}}function Mhe(i){const e=[],t=[],n=[],r=[];let s=i;const o=i-jp+1+rI.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);t.push(l);let u=1/l;a>i-jp?u=rI[a-i+jp-1]:a===0&&(u=0),n.push(u);const h=1/(l-2),d=-h,_=1+h,x=[d,d,_,d,_,_,d,d,_,_,d,_],b=6,R=6,E=3,w=2,L=1,D=new Float32Array(E*R*b),O=new Float32Array(w*R*b),B=new Float32Array(L*R*b);for(let k=0;k<b;k++){const z=k%3*2/3-1,F=k>2?0:-1,q=[z,F,0,z+2/3,F,0,z+2/3,F+1,0,z,F,0,z+2/3,F+1,0,z,F+1,0],H=Ehe[k];D.set(q,E*R*H),O.set(x,w*R*H);const Q=[H,H,H,H,H,H];B.set(Q,L*R*H)}const G=new Vi;G.setAttribute("position",new _r(D,E)),G.setAttribute("uv",new _r(O,w)),G.setAttribute("faceIndex",new _r(B,L)),e.push(G),r.push(new Ri(G,null)),s>jp&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n,lodMeshes:r}}function aI(i,e){const t={magFilter:Ms,minFilter:Ms,generateMipmaps:!1,type:As,format:es,colorSpace:pu},n=new Fh(i,e,t);return n.texture.mapping=FA,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function Mx(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function B5(i){const e=new ts;return e.depthTest=!1,e.depthWrite=!1,e.blending=ga,e.name=`PMREM_${i}`,e}function Rhe(i,e,t){const n=Tl(new Array(uA).fill(0)),r=ln(new ce(0,1,0)),s=ln(0),o=me(uA),a=ln(0),l=ln(1),u=ui(null),h=ln(0),d=me(1/e),_=me(1/t),x=me(i),b={n:o,latitudinal:a,weights:n,poleAxis:r,outputDirection:I5,dTheta:s,samples:l,envMap:u,mipInt:h,CUBEUV_TEXEL_WIDTH:d,CUBEUV_TEXEL_HEIGHT:_,CUBEUV_MAX_MIP:x},R=B5("blur");return R.fragmentNode=CV({...b,latitudinal:a.equal(1)}),NV.set(R,b),R}function lI(i){const e=B5("cubemap");return e.fragmentNode=Wm(i,I5),e}function uI(i){const e=B5("equirect");return e.fragmentNode=ui(i,N5(I5),0),e}const cI=new WeakMap;function Che(i){const e=Math.log2(i)-2,t=1/i;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:t,maxMip:e}}function Nhe(i,e,t){const n=Dhe(e);let r=n.get(i);if((r!==void 0?r.pmremVersion:-1)!==i.pmremVersion){const o=i.image;if(i.isCubeTexture)if(Lhe(o))r=t.fromCubemap(i,r);else return null;else if(Ohe(o))r=t.fromEquirectangular(i,r);else return null;r.pmremVersion=i.pmremVersion,n.set(i,r)}return r.texture}function Dhe(i){let e=cI.get(i);return e===void 0&&(e=new WeakMap,cI.set(i,e)),e}class Phe extends _s{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new ps;r.isRenderTargetTexture=!0,this._texture=ui(r),this._width=ln(0),this._height=ln(0),this._maxMip=ln(0),this.updateBeforeType=Kn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=Che(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=Nhe(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new whe(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=v5.mul(Me(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),RV(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function Lhe(i){if(i==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)i[n]!==void 0&&e++;return e===t}function Ohe(i){return i==null?!1:i.height>0}const U5=st(Phe).setParameterLength(1,3),hI=new WeakMap;class Ihe extends pg{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const d=n.isTextureNode?n.value:t[n.property];let _=hI.get(d);_===void 0&&(_=U5(d),hI.set(d,_)),n=_}const s=t.useAnisotropy===!0||t.anisotropy>0?Az:Yi,o=n.context(fI(qu,s)).mul(Db),a=n.context(Bhe(dd)).mul(Math.PI).mul(Db),l=P_(o),u=P_(a);e.context.radiance.addAssign(l),e.context.iblIrradiance.addAssign(u);const h=e.context.lightingModel.clearcoatRadiance;if(h){const d=n.context(fI(by,yA)).mul(Db),_=P_(d);h.addAssign(_)}}}const fI=(i,e)=>{let t=null;return{getUV:()=>(t===null&&(t=Er.negate().reflect(e),t=i.mul(i).mix(t,e).normalize(),t=t.transformDirection(Fl)),t),getTextureLevel:()=>i}},Bhe=i=>({getUV:()=>i,getTextureLevel:()=>me(1)}),Uhe=new E9;class DV extends ts{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Uhe),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Ihe(t):null}setupLightingModel(){return new wV}setupSpecular(){const e=zi(Me(.04),Di.rgb,xy);na.assign(e),Sy.assign(1)}setupVariants(){const e=this.metalnessNode?me(this.metalnessNode):Sz;xy.assign(e);let t=this.roughnessNode?me(this.roughnessNode):bz;t=P5({roughness:t}),qu.assign(t),this.setupSpecular(),Di.assign(an(Di.rgb.mul(e.oneMinus()),Di.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Fhe=new KY;class khe extends DV{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Fhe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?me(this.iorNode):Uz;D_.assign(e),na.assign(zi(xa(o5(D_.sub(1).div(D_.add(1))).mul(xz),Me(1)).mul(VC),Di.rgb,xy)),Sy.assign(zi(VC,1,xy))}setupLightingModel(){return new wV(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?me(this.clearcoatNode):Ez,n=this.clearcoatRoughnessNode?me(this.clearcoatRoughnessNode):wz;wS.assign(t),by.assign(P5({roughness:n}))}if(this.useSheen){const t=this.sheenNode?Me(this.sheenNode):Cz,n=this.sheenRoughnessNode?me(this.sheenRoughnessNode):Nz;_A.assign(t),TT.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?me(this.iridescenceNode):Pz,n=this.iridescenceIORNode?me(this.iridescenceIORNode):Lz,r=this.iridescenceThicknessNode?me(this.iridescenceThicknessNode):Oz;ET.assign(t),H8.assign(n),W8.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?dt(this.anisotropyNode):Dz).toVar();Vf.assign(t.length()),Xn(Vf.equal(0),()=>{t.assign(dt(1,0))}).Else(()=>{t.divAssign(dt(Vf)),Vf.assign(Vf.saturate())}),MS.assign(Vf.pow2().mix(qu.pow2(),1)),N_.assign(vA[0].mul(t.x).add(vA[1].mul(t.y))),PA.assign(vA[1].mul(t.x).sub(vA[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?me(this.transmissionNode):Iz,n=this.thicknessNode?me(this.thicknessNode):Bz,r=this.attenuationDistanceNode?me(this.attenuationDistanceNode):Fz,s=this.attenuationColorNode?Me(this.attenuationColorNode):kz;if(CS.assign(t),j8.assign(n),X8.assign(r),$8.assign(s),this.useDispersion){const o=this.dispersionNode?me(this.dispersionNode):Wz;Y8.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Me(this.clearcoatNormalNode):Mz}setup(e){e.context.setupClearcoatNormal=()=>rm(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Ghe=Ce(({normal:i,lightDirection:e,builder:t})=>{const n=i.dot(e),r=dt(n.mul(.5).add(.5),0);if(t.material.gradientMap){const s=dh("gradientMap","texture").context({getUV:()=>r});return Me(s.r)}else{const s=r.fwidth().mul(.5);return zi(Me(.7),Me(1),fc(me(.7).sub(s.x),me(.7).add(s.x),r.x))}});class zhe extends zT{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const s=Ghe({normal:IT,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(s.mul(XA({diffuseColor:Di.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(XA({diffuseColor:Di}))),r.indirectDiffuse.mulAssign(t)}}const Vhe=new ZY;class qhe extends ts{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Vhe),this.setValues(e)}setupLightingModel(){return new zhe}}const PV=Ce(()=>{const i=Me(Er.z,0,Er.x.negate()).normalize(),e=Er.cross(i);return dt(i.dot(Yi),e.dot(Yi)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),Hhe=new nQ;class Whe extends ts{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(Hhe),this.setValues(e)}setupVariants(e){const t=PV;let n;e.material.matcap?n=dh("matcap","texture").context({getUV:()=>t}):n=Me(zi(.2,.8,t.y)),Di.rgb.mulAssign(n.rgb)}}class jhe extends _s{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),o=t.sin();return ST(s,o,o.negate(),s).mul(n)}else{const s=t,o=DA(an(1,0,0,0),an(0,uh(s.x),Xa(s.x).negate(),0),an(0,Xa(s.x),uh(s.x),0),an(0,0,0,1)),a=DA(an(uh(s.y),0,Xa(s.y),0),an(0,1,0,0),an(Xa(s.y).negate(),0,uh(s.y),0),an(0,0,0,1)),l=DA(an(uh(s.z),Xa(s.z).negate(),0,0),an(Xa(s.z),uh(s.z),0,0),an(0,0,1,0),an(0,0,0,1));return o.mul(a).mul(l).mul(an(n,1)).xyz}}}const qT=st(jhe).setParameterLength(2),Xhe=new fY;class LV extends ts{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(Xhe),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,r=this.sizeAttenuation,{positionNode:s,rotationNode:o,scaleNode:a}=this,l=t0.mul(Me(s||0));let u=dt(El[0].xyz.length(),El[1].xyz.length());if(a!==null&&(u=u.mul(dt(a))),r===!1)if(n.isPerspectiveCamera)u=u.mul(l.z.negate());else{const x=me(2).div(e0.element(1).element(1));u=u.mul(x.mul(2))}let h=s2.xy;if(t.center&&t.center.isVector2===!0){const x=Yle("center","vec2",t);h=h.sub(x.sub(.5))}h=h.mul(u);const d=me(o||Rz),_=qT(h,d);return an(l.xy.add(_),l.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const $he=new l8;class Yhe extends LV{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues($he),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return t0.mul(Me(e||Zr)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:n,scaleNode:r,sizeNode:s}=this,o=s2.xy.toVar(),a=sm.z.div(sm.w);if(n&&n.isNode){const u=me(n);o.assign(qT(o,u))}let l=s!==null?dt(s):Hz;return this.sizeAttenuation===!0&&(l=l.mul(l.div(Jr.z.negate()))),r&&r.isNode&&(l=l.mul(dt(r))),o.mulAssign(l.mul(2)),o.assign(o.div(sm.z)),o.y.assign(o.y.mul(a)),o.assign(o.mul(t.w)),t.addAssign(an(o,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class Qhe extends zT{constructor(){super(),this.shadowNode=me(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Di.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Di.rgb)}}const Khe=new QY;class Zhe extends ts{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Khe),this.setValues(e)}setupLightingModel(){return new Qhe}}vh("vec3");vh("vec3");vh("vec3");class Jhe{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,n)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class yu{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let r=0;r<e.length-1;r++){const s=e[r];n.has(s)===!1&&n.set(s,new WeakMap),n=n.get(s)}return n.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}let efe=0;function tfe(i){const e=Object.keys(i);let t=Object.getPrototypeOf(i);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const s=n[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class nfe{constructor(e,t,n,r,s,o,a,l,u,h){this.id=efe++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=s,this.scene=o,this.camera=a,this.lightsNode=l,this.context=u,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=h,this.clippingContextCacheKey=h!==null?h.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set,s={};for(const o of e){let a;if(o.node&&o.node.attribute?a=o.node.attribute:(a=t.getAttribute(o.name),s[o.name]=a.version),a===void 0)continue;n.push(a);const l=a.isInterleavedBufferAttribute?a.data:a;r.add(l)}return this.attributes=n,this.attributesId=s,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:s}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),l=a!==null;let u=1;if(n.isInstancedBufferGeometry===!0?u=n.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(o.instanceCount=u,e.isBatchedMesh===!0)return o;let h=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(h=2);let d=s.start*h,_=(s.start+s.count)*h;r!==null&&(d=Math.max(d,r.start*h),_=Math.min(_,(r.start+r.count)*h));const x=n.attributes.position;let b=1/0;l?b=a.count:x!=null&&(b=x.count),d=Math.max(d,0),_=Math.min(_,b);const R=_-d;return R<0||R===1/0?null:(o.vertexCount=R,o.firstVertex=d,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let s=0,o=r.length;s<o;s++){const a=r[s];t+=a.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const r of tfe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const s=t[r];let o;if(s!==null){const a=typeof s;a==="number"?o=s!==0?"1":"0":a==="object"?(o="{",s.isTexture&&(o+=s.mapping),o+="}"):o=String(s)}else o=String(s);n+=o+","}return n+=this.clippingContextCacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),n+=e.receiveShadow+",",tk(n)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const t in e){const n=this.geometry.getAttribute(t);if(n===void 0||e[t]!==n.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=SS(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=SS(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Wd=[];class ife{constructor(e,t,n,r,s,o){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=s,this.info=o,this.chainMaps={}}get(e,t,n,r,s,o,a,l){const u=this.getChainMap(l);Wd[0]=e,Wd[1]=t,Wd[2]=o,Wd[3]=s;let h=u.get(Wd);return h===void 0?(h=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,s,o,a,l),u.set(Wd,h)):(h.updateClipping(a),h.needsGeometryUpdate&&h.setGeometry(e.geometry),(h.version!==t.version||h.needsUpdate)&&(h.initialCacheKey!==h.getCacheKey()?(h.dispose(),h=this.get(e,t,n,r,s,o,a,l)):h.version=t.version)),Wd.length=0,h}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new yu)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,s,o,a,l,u,h,d){const _=this.getChainMap(d),x=new nfe(e,t,n,r,s,o,a,l,u,h);return x.onDispose=()=>{this.pipelines.delete(x),this.bindings.delete(x),this.nodes.delete(x),_.delete(x.getChainArray())},x}}class Ad{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const wl={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},Xf=16,rfe=211,sfe=212;class ofe extends Ad{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===wl.VERTEX?this.backend.createAttribute(e):t===wl.INDEX?this.backend.createIndexAttribute(e):t===wl.STORAGE?this.backend.createStorageAttribute(e):t===wl.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===Fp)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function OV(i){return i.index!==null?i.index.version:i.attributes.position.version}function dI(i){const e=[],t=i.index,n=i.attributes.position;if(t!==null){const s=t.array;for(let o=0,a=s.length;o<a;o+=3){const l=s[o+0],u=s[o+1],h=s[o+2];e.push(l,u,u,h,h,l)}}else{const s=n.array;for(let o=0,a=s.length/3-1;o<a;o+=3){const l=o+0,u=o+1,h=o+2;e.push(l,u,u,h,h,l)}}const r=new(e8(e)?s8:r8)(e,1);return r.version=OV(i),r}class afe extends Ad{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,o=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of o)this.attributes.delete(l);const a=this.wireframes.get(t);a!==void 0&&this.attributes.delete(a),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,wl.STORAGE):this.updateAttribute(s,wl.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,wl.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,wl.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const s=this.wireframes;let o=s.get(t);o===void 0?(o=dI(t),s.set(t,o)):o.version!==OV(t)&&(this.attributes.delete(o),o=dI(t),s.set(t,o)),r=o}return r}}class lfe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class IV{constructor(e){this.cacheKey=e,this.usedTimes=0}}class ufe extends IV{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class cfe extends IV{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let hfe=0;class vM{constructor(e,t,n,r=null,s=null){this.id=hfe++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=s,this.usedTimes=0}}class ffe extends Ad{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let a=this.programs.compute.get(o.computeShader);a===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),a=new vM(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,a),n.createProgram(a));const l=this._getComputeCacheKey(e,a);let u=this.caches.get(l);u===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),u=this._getComputePipeline(e,a,l,t)),u.usedTimes++,a.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),a=e.material?e.material.name:"";let l=this.programs.vertex.get(o.vertexShader);l===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),l=new vM(o.vertexShader,"vertex",a),this.programs.vertex.set(o.vertexShader,l),n.createProgram(l));let u=this.programs.fragment.get(o.fragmentShader);u===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),u=new vM(o.fragmentShader,"fragment",a),this.programs.fragment.set(o.fragmentShader,u),n.createProgram(u));const h=this._getRenderCacheKey(e,l,u);let d=this.caches.get(h);d===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),d=this._getRenderPipeline(e,l,u,h,t)):e.pipeline=d,d.usedTimes++,l.usedTimes++,u.usedTimes++,r.pipeline=d}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let s=this.caches.get(n);return s===void 0&&(s=new cfe(n,t),this.caches.set(n,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,n,r,s){r=r||this._getRenderCacheKey(e,t,n);let o=this.caches.get(r);return o===void 0&&(o=new ufe(r,t,n),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,s)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class dfe extends Ad{constructor(e,t,n,r,s,o){super(),this.backend=e,this.textures=n,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?wl.INDIRECT:wl.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,s=!0,o=0,a=0;for(const l of e.bindings)if(!(l.isNodeUniformsGroup&&this.nodes.updateGroup(l)===!1)){if(l.isStorageBuffer){const u=l.attribute,h=u.isIndirectStorageBufferAttribute?wl.INDIRECT:wl.STORAGE;this.attributes.update(u,h)}if(l.isUniformBuffer)l.update()&&n.updateBinding(l);else if(l.isSampler)l.update();else if(l.isSampledTexture){const u=this.textures.get(l.texture);l.needsBindingsUpdate(u.generation)&&(r=!0);const h=l.update(),d=l.texture;h&&this.textures.updateTexture(d);const _=n.get(d);if(_.externalTexture!==void 0||u.isDefaultTexture?s=!1:(o=o*10+d.id,a+=d.version),n.isWebGPUBackend===!0&&_.texture===void 0&&_.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",l,h,d,l.textureNode.value,r),this.textures.updateTexture(d),r=!0),d.isStorageTexture===!0){const x=this.get(d);l.store===!0?x.needsMipmap=!0:this.textures.needsMipmaps(d)&&x.needsMipmap===!0&&(this.backend.generateMipmaps(d),x.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,s?o:0,a)}}function Afe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?i.z-e.z:i.id-e.id}function AI(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function pI(i){return(i.transmission>0||i.transmissionNode)&&i.side===ss&&i.forceSinglePass===!1}class pfe{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,s,o,a){let l=this.renderItems[this.renderItemsIndex];return l===void 0?(l={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:s,group:o,clippingContext:a},this.renderItems[this.renderItemsIndex]=l):(l.id=e.id,l.object=e,l.geometry=t,l.material=n,l.groupOrder=r,l.renderOrder=e.renderOrder,l.z=s,l.group=o,l.clippingContext=a),this.renderItemsIndex++,l}push(e,t,n,r,s,o,a){const l=this.getNextRenderItem(e,t,n,r,s,o,a);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0?(pI(n)&&this.transparentDoublePass.push(l),this.transparent.push(l)):this.opaque.push(l)}unshift(e,t,n,r,s,o,a){const l=this.getNextRenderItem(e,t,n,r,s,o,a);n.transparent===!0||n.transmission>0?(pI(n)&&this.transparentDoublePass.unshift(l),this.transparent.unshift(l)):this.opaque.unshift(l)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||Afe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||AI),this.transparent.length>1&&this.transparent.sort(t||AI)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const F1=[];class mfe{constructor(e){this.lighting=e,this.lists=new yu}get(e,t){const n=this.lists;F1[0]=e,F1[1]=t;let r=n.get(F1);return r===void 0&&(r=new pfe(this.lighting,e,t),n.set(F1,r)),F1.length=0,r}dispose(){this.lists=new yu}}let gfe=0;class _fe{constructor(){this.id=gfe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new mn,this.scissor=!1,this.scissorValue=new mn,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return BV(this)}}function BV(i){const{textures:e,activeCubeFace:t}=i,n=[t];for(const r of e)n.push(r.id);return yT(n)}const k1=[],yfe=new uT,vfe=new jy;class xfe{constructor(){this.chainMaps={}}get(e,t,n=null){k1[0]=e,k1[1]=t;let r;if(n===null)r="default";else{const a=n.texture.format;r=`${n.textures.length}:${a}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const s=this._getChainMap(r);let o=s.get(k1);return o===void 0&&(o=new _fe,s.set(k1,o)),k1.length=0,n!==null&&(o.sampleCount=n.samples===0?1:n.samples),o}getForClear(e=null){return this.get(yfe,vfe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new yu)}dispose(){this.chainMaps={}}}const bfe=new ce;class Sfe extends Ad{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,s=n.depthTextureMips||(n.depthTextureMips={}),o=e.textures,a=this.getSize(o[0]),l=a.width>>t,u=a.height>>t;let h=e.depthTexture||s[t];const d=e.depthBuffer===!0||e.stencilBuffer===!0;let _=!1;h===void 0&&d&&(h=new Ja,h.format=e.stencilBuffer?Ka:Qa,h.type=e.stencilBuffer?Ya:mr,h.image.width=l,h.image.height=u,h.image.depth=a.depth,h.isArrayTexture=e.multiview===!0&&a.depth>1,s[t]=h),(n.width!==a.width||a.height!==n.height)&&(_=!0,h&&(h.needsUpdate=!0,h.image.width=l,h.image.height=u,h.image.depth=h.isArrayTexture?h.image.depth:1)),n.width=a.width,n.height=a.height,n.textures=o,n.depthTexture=h||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(_=!0,h&&(h.needsUpdate=!0),n.sampleCount=r);const x={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let b=0;b<o.length;b++){const R=o[b];_&&(R.needsUpdate=!0),this.updateTexture(R,x)}h&&this.updateTexture(h,x)}if(n.initialized!==!0){n.initialized=!0;const b=()=>{e.removeEventListener("dispose",b);for(let R=0;R<o.length;R++)this._destroyTexture(o[R]);h&&this._destroyTexture(h),this.delete(e)};e.addEventListener("dispose",b)}}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&n.initialized===!0&&(s.destroySampler(e),s.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=Vr}const{width:o,height:a,depth:l}=this.getSize(e);if(t.width=o,t.height=a,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,a):1,r||e.isStorageTexture===!0)s.createSampler(e),s.createTexture(e,t),n.generation=e.version;else if(n.initialized!==!0&&s.createSampler(e),e.version>0){const h=e.image;if(h===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(h.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const d=[];for(const _ of e.images)d.push(_);t.images=d}else t.image=h;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(s.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&s.generateMipmaps(e)}}else s.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;if(n.initialized!==!0){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e)};e.addEventListener("dispose",u)}n.version=e.version}getSize(e,t=bfe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class F5 extends Jt{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class UV extends qi{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}const Tfe=(i,e)=>Ze(new UV(i,e));class Efe extends dn{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new Wp(t);return this._currentCond=js(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new Wp(t),r=js(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new Wp(e),this}Switch(e){return this._expressionNode=Ze(e),this}Case(...e){const t=[];if(e.length>=2)for(let a=0;a<e.length-1;a++)t.push(this._expressionNode.equal(Ze(e[a])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],r=new Wp(n);let s=t[0];for(let a=1;a<t.length;a++)s=s.or(t[a]);const o=js(s,r);return this._currentCond===null?(this._currentCond=o,this.add(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}build(e,...t){const n=e.currentStack,r=V8();yy(this),e.currentStack=this;const s=e.buildStage;for(const a of this.nodes)if(s==="setup")a.build(e);else if(s==="analyze")a.build(e,this);else if(s==="generate"){const l=e.getDataFromNode(a,"any").stages,u=l&&l[e.shaderStage];if(a.isVarNode&&u&&u.length===1&&u[0]&&u[0].isStackNode)continue;a.build(e,"void")}const o=this.outputNode?this.outputNode.build(e,...t):super.build(e,...t);return yy(r),e.currentStack=n,o}}const Lb=st(Efe).setParameterLength(0,1);function wfe(i){return Object.entries(i).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class Mfe extends dn{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=wfe(e),this.name=t,this.isStructLayoutNode=!0}getLength(){const t=Float32Array.BYTES_PER_ELEMENT;let n=0;for(const r of this.membersLayout){const s=r.type,o=lle(s)*t,a=ule(s),l=n%8,u=l%a,h=l+u;n+=u,h!==0&&8-h<o&&(n+=8-h),n+=o}return Math.ceil(n/8)*8/t}getMemberType(e,t){const n=this.membersLayout.find(r=>r.name===t);return n?n.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.addInclude(this)}generate(e){return this.getNodeType(e)}}class Rfe extends dn{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structLayoutNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structLayoutNode.getNodeType(e)}getMemberType(e,t){return this.structLayoutNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),n=t.type,r=e.getPropertyName(t);return e.addLineFlowCode(`${r} = ${e.generateStruct(n,this.structLayoutNode.membersLayout,this.values)}`,this),t.name}}const Cfe=(i,e=null)=>{const t=new Mfe(i,e),n=(...r)=>{let s=null;if(r.length>0)if(r[0].isNode){s={};const o=Object.keys(i);for(let a=0;a<r.length;a++)s[o[a]]=r[a]}else s=r[0];return Ze(new Rfe(t,s))};return n.layout=t,n.isStruct=!0,n};class FV extends dn{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(t.membersLayout===void 0){const n=this.members,r=[];for(let s=0;s<n.length;s++){const o="m"+s,a=n[s].getNodeType(e);r.push({name:o,type:a,index:s})}t.membersLayout=r,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),n=this.members,r=t!==""?t+".":"";for(let s=0;s<n.length;s++){const o=n[s].build(e);e.addLineFlowCode(`${r}m${s} = ${o}`,this)}return t}}const Nfe=st(FV);function kV(i,e){for(let t=0;t<i.length;t++)if(i[t].name===e)return t;return-1}class Dfe extends FV{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return GV(t)}setup(e){const t=this.outputNodes,n=e.renderer.getRenderTarget(),r=[],s=n.textures;for(const o in t){const a=kV(s,o);r[a]=an(t[o])}return this.members=r,super.setup(e)}}const GV=st(Dfe),Pfe=Ce(([i])=>{const e=i.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),$C=(i,e)=>Au(jn(4,i.mul(vi(1,i))),e),Lfe=(i,e)=>i.lessThan(.5)?$C(i.mul(2),e).div(2):vi(1,$C(jn(vi(1,i),2),e).div(2)),Ofe=(i,e,t)=>Au(Ll(Au(i,e),gs(Au(i,e),Au(vi(1,i),t))),1/e),Ife=(i,e)=>Xa(NS.mul(e.mul(i).sub(1))).div(NS.mul(e.mul(i).sub(1))),ch=Ce(([i])=>i.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Bfe=Ce(([i])=>Me(ch(i.z.add(ch(i.y.mul(1)))),ch(i.z.add(ch(i.x.mul(1)))),ch(i.y.add(ch(i.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Ufe=Ce(([i,e,t])=>{const n=Me(i).toVar(),r=me(1.4).toVar(),s=me(0).toVar(),o=Me(n).toVar();return Qi({start:me(0),end:me(3),type:"float",condition:"<="},()=>{const a=Me(Bfe(o.mul(2))).toVar();n.addAssign(a.add(t.mul(me(.1).mul(e)))),o.mulAssign(1.8),r.mulAssign(1.5),n.mulAssign(1.2);const l=me(ch(n.z.add(ch(n.x.add(ch(n.y)))))).toVar();s.addAssign(l.div(r)),o.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Ffe extends dn{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let n=this._candidateFnCall;if(n===null){let r=null,s=-1;for(const o of this.functionNodes){const l=o.shaderNode.layout;if(l===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const u=l.inputs;if(t.length===u.length){let h=0;for(let d=0;d<t.length;d++){const _=t[d],x=u[d];_.getNodeType(e)===x.type?h++:h=0}h>s&&(r=o,s=h)}}this._candidateFnCall=n=r(...t)}return n}}const kfe=st(Ffe),co=i=>(...e)=>kfe(i,...e),n0=ln(0).setGroup(pn).onRenderUpdate(i=>i.time),zV=ln(0).setGroup(pn).onRenderUpdate(i=>i.deltaTime),Gfe=ln(0,"uint").setGroup(pn).onRenderUpdate(i=>i.frameId),zfe=(i=1)=>(console.warn('TSL: timerLocal() is deprecated. Use "time" instead.'),n0.mul(i)),Vfe=(i=1)=>(console.warn('TSL: timerGlobal() is deprecated. Use "time" instead.'),n0.mul(i)),qfe=(i=1)=>(console.warn('TSL: timerDelta() is deprecated. Use "deltaTime" instead.'),zV.mul(i)),Hfe=(i=n0)=>i.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),Wfe=(i=n0)=>i.fract().round(),jfe=(i=n0)=>i.add(.5).fract().mul(2).sub(1).abs(),Xfe=(i=n0)=>i.fract(),$fe=Ce(([i,e,t=dt(.5)])=>qT(i.sub(t),e).add(t)),Yfe=Ce(([i,e,t=dt(.5)])=>{const n=i.sub(t),r=n.dot(n),o=r.mul(r).mul(e);return i.add(n.mul(o))}),Qfe=Ce(({position:i=null,horizontal:e=!0,vertical:t=!1})=>{let n;i!==null?(n=El.toVar(),n[3][0]=i.x,n[3][1]=i.y,n[3][2]=i.z):n=El;const r=Fl.mul(n);return _y(e)&&(r[0][0]=El[0].length(),r[0][1]=0,r[0][2]=0),_y(t)&&(r[1][0]=0,r[1][1]=El[1].length(),r[1][2]=0),r[2][0]=0,r[2][1]=0,r[2][2]=1,e0.mul(r).mul(Zr)}),Kfe=Ce(([i=null])=>{const e=LS();return LS(w5(i)).sub(e).lessThan(0).select(bh,i)});class Zfe extends dn{static get type(){return"SpriteSheetUVNode"}constructor(e,t=Tr(),n=me(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=n}setup(){const{frameNode:e,uvNode:t,countNode:n}=this,{width:r,height:s}=n,o=e.mod(r.mul(s)).floor(),a=o.mod(r),l=s.sub(o.add(1).div(r).ceil()),u=n.reciprocal(),h=dt(a,l);return t.add(h).mul(u)}}const Jfe=st(Zfe).setParameterLength(3),VV=Ce(([i,e=null,t=null,n=me(1),r=Zr,s=ba])=>{let o=s.abs().normalize();o=o.div(o.dot(Me(1)));const a=r.yz.mul(n),l=r.zx.mul(n),u=r.xy.mul(n),h=i.value,d=e!==null?e.value:h,_=t!==null?t.value:h,x=ui(h,a).mul(o.x),b=ui(d,l).mul(o.y),R=ui(_,u).mul(o.z);return gs(x,b,R)}),ede=(...i)=>VV(...i),Ap=new Gu,jd=new ce,pp=new ce,xM=new ce,G1=new Cn,Rx=new ce(0,0,-1),Iu=new mn,z1=new ce,Cx=new ce,V1=new mn,Nx=new it,OS=new Fh,tde=bh.flipX();OS.depthTexture=new Ja(1,1);let Dx=!1;class k5 extends dc{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||OS.texture,tde),this._reflectorBaseNode=e.reflector||new nde(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=Ze(new k5({defaultTexture:OS.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class nde extends dn{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:n=new Rr,resolution:r=1,generateMipmaps:s=!1,bounces:o=!0,depth:a=!1}=t;this.textureNode=e,this.target=n,this.resolution=r,this.generateMipmaps=s,this.bounces=o,this.depth=a,this.updateBeforeType=o?Kn.RENDER:Kn.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const n=this.resolution;t.getDrawingBufferSize(Nx),e.setSize(Math.round(Nx.width*n),Math.round(Nx.height*n))}setup(e){return this._updateResolution(OS,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new Fh(0,0,{type:As}),this.generateMipmaps===!0&&(t.texture.minFilter=o$,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new Ja),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&Dx)return!1;Dx=!0;const{scene:t,camera:n,renderer:r,material:s}=e,{target:o}=this,a=this.getVirtualCamera(n),l=this.getRenderTarget(a);r.getDrawingBufferSize(Nx),this._updateResolution(l,r),pp.setFromMatrixPosition(o.matrixWorld),xM.setFromMatrixPosition(n.matrixWorld),G1.extractRotation(o.matrixWorld),jd.set(0,0,1),jd.applyMatrix4(G1),z1.subVectors(pp,xM);const u=z1.dot(jd)>0;let h=!1;if(u===!0&&this.forceUpdate===!1){if(this.hasOutput===!1){Dx=!1;return}h=!0}z1.reflect(jd).negate(),z1.add(pp),G1.extractRotation(n.matrixWorld),Rx.set(0,0,-1),Rx.applyMatrix4(G1),Rx.add(xM),Cx.subVectors(pp,Rx),Cx.reflect(jd).negate(),Cx.add(pp),a.coordinateSystem=n.coordinateSystem,a.position.copy(z1),a.up.set(0,1,0),a.up.applyMatrix4(G1),a.up.reflect(jd),a.lookAt(Cx),a.near=n.near,a.far=n.far,a.updateMatrixWorld(),a.projectionMatrix.copy(n.projectionMatrix),Ap.setFromNormalAndCoplanarPoint(jd,pp),Ap.applyMatrix4(a.matrixWorldInverse),Iu.set(Ap.normal.x,Ap.normal.y,Ap.normal.z,Ap.constant);const d=a.projectionMatrix;V1.x=(Math.sign(Iu.x)+d.elements[8])/d.elements[0],V1.y=(Math.sign(Iu.y)+d.elements[9])/d.elements[5],V1.z=-1,V1.w=(1+d.elements[10])/d.elements[14],Iu.multiplyScalar(1/Iu.dot(V1));const _=0;d.elements[2]=Iu.x,d.elements[6]=Iu.y,d.elements[10]=r.coordinateSystem===lc?Iu.z-_:Iu.z+1-_,d.elements[14]=Iu.w,this.textureNode.value=l.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=l.depthTexture),s.visible=!1;const x=r.getRenderTarget(),b=r.getMRT(),R=r.autoClear;r.setMRT(null),r.setRenderTarget(l),r.autoClear=!0,h?(r.clear(),this.hasOutput=!1):(r.render(t,a),this.hasOutput=!0),r.setMRT(b),r.setRenderTarget(x),r.autoClear=R,s.visible=!0,Dx=!1,this.forceUpdate=!1}}const ide=i=>Ze(new k5(i)),bM=new Qy(-1,1,1,-1,0,1);class rde extends Vi{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Si([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Si(t,2))}}const sde=new rde;class HT extends Ri{constructor(e=null){super(sde,e),this.camera=bM,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,bM)}render(e){e.render(this,bM)}}const ode=new it;class ade extends dc{static get type(){return"RTTNode"}constructor(e,t=null,n=null,r={type:As}){const s=new Fh(t,n,r);super(s.texture,Tr()),this.node=e,this.width=t,this.height=n,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new HT(new ts),this.updateBeforeType=Kn.RENDER}get autoResize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const n=e*this.pixelRatio,r=t*this.pixelRatio;this.renderTarget.setSize(n,r),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoResize===!0){const n=e.getPixelRatio(),r=e.getSize(ode),s=r.width*n,o=r.height*n;(s!==this.renderTarget.width||o!==this.renderTarget.height)&&(this.renderTarget.setSize(s,o),this.textureNeedsUpdate=!0)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new dc(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const qV=(i,...e)=>Ze(new ade(Ze(i),...e)),lde=(i,...e)=>i.isTextureNode?i:i.isPassNode?i.getTextureNode():qV(i,...e),Pp=Ce(([i,e,t],n)=>{let r;n.renderer.coordinateSystem===lc?(i=dt(i.x,i.y.oneMinus()).mul(2).sub(1),r=an(Me(i,e),1)):r=an(Me(i.x,i.y.oneMinus(),e).mul(2).sub(1),1);const s=an(t.mul(r));return s.xyz.div(s.w)}),ude=Ce(([i,e])=>{const t=e.mul(an(i,1)),n=t.xy.div(t.w).mul(.5).add(.5).toVar();return dt(n.x,n.y.oneMinus())}),cde=Ce(([i,e,t])=>{const n=td(Qr(e)),r=ws(i.mul(n)).toVar(),s=Qr(e,r).toVar(),o=Qr(e,r.sub(ws(2,0))).toVar(),a=Qr(e,r.sub(ws(1,0))).toVar(),l=Qr(e,r.add(ws(1,0))).toVar(),u=Qr(e,r.add(ws(2,0))).toVar(),h=Qr(e,r.add(ws(0,2))).toVar(),d=Qr(e,r.add(ws(0,1))).toVar(),_=Qr(e,r.sub(ws(0,1))).toVar(),x=Qr(e,r.sub(ws(0,2))).toVar(),b=gr(vi(me(2).mul(a).sub(o),s)).toVar(),R=gr(vi(me(2).mul(l).sub(u),s)).toVar(),E=gr(vi(me(2).mul(d).sub(h),s)).toVar(),w=gr(vi(me(2).mul(_).sub(x),s)).toVar(),L=Pp(i,s,t).toVar(),D=b.lessThan(R).select(L.sub(Pp(i.sub(dt(me(1).div(n.x),0)),a,t)),L.negate().add(Pp(i.add(dt(me(1).div(n.x),0)),l,t))),O=E.lessThan(w).select(L.sub(Pp(i.add(dt(0,me(1).div(n.y))),d,t)),L.negate().add(Pp(i.sub(dt(0,me(1).div(n.y))),_,t)));return Lh(DT(D,O))});class hde extends dn{static get type(){return"SampleNode"}constructor(e){super(),this.callback=e,this.isSampleNode=!0}setup(){return this.sample(Tr())}sample(e){return this.callback(e)}}const fde=i=>Ze(new hde(i));class Ob extends ed{constructor(e,t,n=Float32Array){const r=ArrayBuffer.isView(e)?e:new n(e*t);super(r,t),this.isStorageInstancedBufferAttribute=!0}}class dde extends _r{constructor(e,t,n=Float32Array){const r=ArrayBuffer.isView(e)?e:new n(e*t);super(r,t),this.isStorageBufferAttribute=!0}}const Ade=(i,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=ES("float")):(t=rk(e),n=ES(e));const r=new dde(i,t,n);return LA(r,e,i)},pde=(i,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=ES("float")):(t=rk(e),n=ES(e));const r=new Ob(i,t,n);return LA(r,e,i)};class mde extends dn{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const gde=Pt(mde),q1=new ao,SM=new Cn;class Aa extends dn{static get type(){return"SceneNode"}constructor(e=Aa.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let r;return t===Aa.BACKGROUND_BLURRINESS?r=ar("backgroundBlurriness","float",n):t===Aa.BACKGROUND_INTENSITY?r=ar("backgroundIntensity","float",n):t===Aa.BACKGROUND_ROTATION?r=ln("mat4").label("backgroundRotation").setGroup(pn).onRenderUpdate(()=>{const s=n.background;return s!==null&&s.isTexture&&s.mapping!==q4?(q1.copy(n.backgroundRotation),q1.x*=-1,q1.y*=-1,q1.z*=-1,SM.makeRotationFromEuler(q1)):SM.identity(),SM}):console.error("THREE.SceneNode: Unknown scope:",t),r}}Aa.BACKGROUND_BLURRINESS="backgroundBlurriness";Aa.BACKGROUND_INTENSITY="backgroundIntensity";Aa.BACKGROUND_ROTATION="backgroundRotation";const HV=Pt(Aa,Aa.BACKGROUND_BLURRINESS),YC=Pt(Aa,Aa.BACKGROUND_INTENSITY),WV=Pt(Aa,Aa.BACKGROUND_ROTATION);class _de extends dc{static get type(){return"StorageTextureNode"}constructor(e,t,n=null){super(e,t),this.storeNode=n,this.isStorageTextureNode=!0,this.access=To.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}generate(e,t){let n;return this.storeNode!==null?n=this.generateStore(e):n=super.generate(e,t),n}toReadWrite(){return this.setAccess(To.READ_WRITE)}toReadOnly(){return this.setAccess(To.READ_ONLY)}toWriteOnly(){return this.setAccess(To.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:n,storeNode:r,depthNode:s}=t,o=super.generate(e,"property"),a=n.build(e,"uvec2"),l=r.build(e,"vec4"),u=s?s.build(e,"int"):null,h=e.generateTextureStore(e,o,a,u,l);e.addLineFlowCode(h,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e}}const jV=st(_de).setParameterLength(1,3),yde=(i,e,t)=>{const n=jV(i,e,t);return t!==null&&n.toStack(),n},vde=Ce(({texture:i,uv:e})=>{const n=Me().toVar();return Xn(e.x.lessThan(1e-4),()=>{n.assign(Me(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(Me(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(Me(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(Me(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(Me(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(Me(0,0,-1))}).Else(()=>{const s=i.sample(e.add(Me(-.01,0,0))).r.sub(i.sample(e.add(Me(.01,0,0))).r),o=i.sample(e.add(Me(0,-.01,0))).r.sub(i.sample(e.add(Me(0,.01,0))).r),a=i.sample(e.add(Me(0,0,-.01))).r.sub(i.sample(e.add(Me(0,0,.01))).r);n.assign(Me(s,o,a))}),n.normalize()});class xde extends dc{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Me(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(be(td(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return vde({texture:this,uv:e})}}const XV=st(xde).setParameterLength(1,3);class bde extends BT{static get type(){return"UserDataNode"}constructor(e,t,n=null){super(e,t,n),this.userData=n}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const Sde=(i,e,t)=>Ze(new bde(i,e,t)),mI=new WeakMap;class Tde extends _s{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=Kn.OBJECT,this.updateAfterType=Kn.OBJECT,this.previousModelWorldMatrix=ln(new Cn),this.previousProjectionMatrix=ln(new Cn).setGroup(pn),this.previousCameraViewMatrix=ln(new Cn)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:n}){const r=gI(n);this.previousModelWorldMatrix.value.copy(r);const s=$V(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new Cn,s.previousCameraViewMatrix=new Cn,s.currentProjectionMatrix=new Cn,s.currentCameraViewMatrix=new Cn,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){gI(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?e0:ln(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),n=e.mul(t0).mul(Zr),r=this.previousProjectionMatrix.mul(t).mul(PS),s=n.xy.div(n.w),o=r.xy.div(r.w);return vi(s,o)}}function $V(i){let e=mI.get(i);return e===void 0&&(e={},mI.set(i,e)),e}function gI(i,e=0){const t=$V(i);let n=t[e];return n===void 0&&(t[e]=n=new Cn,t[e].copy(i.matrixWorld)),n}const Ede=Pt(Tde),wde=Ce(([i])=>G5(i.rgb)),Mde=Ce(([i,e=me(1)])=>e.mix(G5(i.rgb),i.rgb)),Rde=Ce(([i,e=me(1)])=>{const t=gs(i.r,i.g,i.b).div(3),n=i.r.max(i.g.max(i.b)),r=n.sub(t).mul(e).mul(-3);return zi(i.rgb,n,r)}),Cde=Ce(([i,e=me(1)])=>{const t=Me(.57735,.57735,.57735),n=e.cos();return Me(i.rgb.mul(n).add(t.cross(i.rgb).mul(e.sin()).add(t.mul(fd(t,i.rgb).mul(n.oneMinus())))))}),G5=(i,e=Me(In.getLuminanceCoefficients(new ce)))=>fd(i,e),Nde=Ce(([i,e=Me(1),t=Me(0),n=Me(1),r=me(1),s=Me(In.getLuminanceCoefficients(new ce,pu))])=>{const o=i.rgb.dot(Me(s)),a=Hr(i.rgb.mul(e).add(t),0).toVar(),l=a.pow(n).toVar();return Xn(a.r.greaterThan(0),()=>{a.r.assign(l.r)}),Xn(a.g.greaterThan(0),()=>{a.g.assign(l.g)}),Xn(a.b.greaterThan(0),()=>{a.b.assign(l.b)}),a.assign(o.add(a.sub(o).mul(r))),an(a.rgb,i.a)});class Dde extends _s{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const Pde=st(Dde).setParameterLength(2),Px=new it;class YV extends dc{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class _I extends YV{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}class Ac extends _s{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new Ja;s.isRenderTargetTexture=!0,s.name="depth";const o=new Fh(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:As,...r});o.texture.name="output",o.depthTexture=s,this.renderTarget=o,this._textures={output:o.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=ln(0),this._cameraFar=ln(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=Kn.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=Ze(new _I(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=Ze(new _I(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=M5(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=om(s,n,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getColorBufferType(),this.scope===Ac.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,s;const o=t.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),Px.set(o.width,o.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(Px)),this._pixelRatio=s,this.setSize(Px.width,Px.height);const a=t.getRenderTarget(),l=t.getMRT(),u=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const h in this._previousTextures)this.toggleTexture(h);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(a),t.setMRT(l),r.layers.mask=u}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Ac.COLOR="color";Ac.DEPTH="depth";const Lde=(i,e,t)=>Ze(new Ac(Ac.COLOR,i,e,t)),Ode=(i,e)=>Ze(new YV(i,e)),Ide=(i,e,t)=>Ze(new Ac(Ac.DEPTH,i,e,t));class Bde extends Ac{static get type(){return"ToonOutlinePassNode"}constructor(e,t,n,r,s){super(Ac.COLOR,e,t),this.colorNode=n,this.thicknessNode=r,this.alphaNode=s,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,n=t.getRenderObjectFunction();t.setRenderObjectFunction((r,s,o,a,l,u,h,d)=>{if((l.isMeshToonMaterial||l.isMeshToonNodeMaterial)&&l.wireframe===!1){const _=this._getOutlineMaterial(l);t.renderObject(r,s,o,a,_,u,h,d)}t.renderObject(r,s,o,a,l,u,h,d)}),super.updateBefore(e),t.setRenderObjectFunction(n)}_createMaterial(){const e=new ts;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=Zi;const t=ba.negate(),n=e0.mul(t0),r=me(1),s=n.mul(an(Zr,1)),o=n.mul(an(Zr.add(t),1)),a=Lh(s.sub(o));return e.vertexNode=s.add(a.mul(this.thicknessNode).mul(s.w).mul(r)),e.colorNode=an(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const Ude=(i,e,t=new Jt(0,0,0),n=.003,r=1)=>Ze(new Bde(i,e,Ze(t),Ze(n),Ze(r))),QV=Ce(([i,e])=>i.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),KV=Ce(([i,e])=>(i=i.mul(e),i.div(i.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),ZV=Ce(([i,e])=>{i=i.mul(e),i=i.sub(.004).max(0);const t=i.mul(i.mul(6.2).add(.5)),n=i.mul(i.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Fde=Ce(([i])=>{const e=i.mul(i.add(.0245786)).sub(90537e-9),t=i.mul(i.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),JV=Ce(([i,e])=>{const t=Ro(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=Ro(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return i=i.mul(e).div(.6),i=t.mul(i),i=Fde(i),i=n.mul(i),i.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),kde=Ro(Me(1.6605,-.1246,-.0182),Me(-.5876,1.1329,-.1006),Me(-.0728,-.0083,1.1187)),Gde=Ro(Me(.6274,.0691,.0164),Me(.3293,.9195,.088),Me(.0433,.0113,.8956)),zde=Ce(([i])=>{const e=Me(i).toVar(),t=Me(e.mul(e)).toVar(),n=Me(t.mul(t)).toVar();return me(15.5).mul(n.mul(t)).sub(jn(40.14,n.mul(e))).add(jn(31.96,n).sub(jn(6.868,t.mul(e))).add(jn(.4298,t).add(jn(.1191,e).sub(.00232))))}),eq=Ce(([i,e])=>{const t=Me(i).toVar(),n=Ro(Me(.856627153315983,.137318972929847,.11189821299995),Me(.0951212405381588,.761241990602591,.0767994186031903),Me(.0482516061458583,.101439036467562,.811302368396859)),r=Ro(Me(1.1271005818144368,-.1413297634984383,-.14132976349843826),Me(-.11060664309660323,1.157823702216272,-.11060664309660294),Me(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=me(-12.47393),o=me(4.026069);return t.mulAssign(e),t.assign(Gde.mul(t)),t.assign(n.mul(t)),t.assign(Hr(t,1e-10)),t.assign(nc(t)),t.assign(t.sub(s).div(o.sub(s))),t.assign(hc(t,0,1)),t.assign(zde(t)),t.assign(r.mul(t)),t.assign(Au(Hr(Me(0),t),Me(2.2))),t.assign(kde.mul(t)),t.assign(hc(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),tq=Ce(([i,e])=>{const t=me(.76),n=me(.15);i=i.mul(e);const r=xa(i.r,xa(i.g,i.b)),s=js(r.lessThan(.08),r.sub(jn(6.25,r.mul(r))),.04);i.subAssign(s);const o=Hr(i.r,Hr(i.g,i.b));Xn(o.lessThan(t),()=>i);const a=vi(1,t),l=vi(1,a.mul(a).div(o.add(a.sub(t))));i.mulAssign(l.div(o));const u=vi(1,Ll(1,n.mul(o.sub(l)).add(1)));return zi(i,Me(l),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class hs extends dn{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const WT=st(hs).setParameterLength(1,3),Vde=(i,e)=>WT(i,e,"js"),qde=(i,e)=>WT(i,e,"wgsl"),Hde=(i,e)=>WT(i,e,"glsl");class nq extends hs{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,s=n.type,o=e.getCodeFromNode(this,s);r!==""&&(o.name=r);const a=e.getPropertyName(o),l=this.getNodeFunction(e).getCode(a);return o.code=l+`
`,t==="property"?a:e.format(`${a}()`,s,t)}}const iq=(i,e=[],t="")=>{for(let s=0;s<e.length;s++){const o=e[s];typeof o=="function"&&(e[s]=o.functionNode)}const n=Ze(new nq(i,e,t)),r=(...s)=>n.call(...s);return r.functionNode=n,r},Wde=(i,e)=>iq(i,e,"glsl"),jde=(i,e)=>iq(i,e,"wgsl");class Xde extends dn{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new gc,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:me()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=ak(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;e.value!==null&&(e.inputType==="ArrayBuffer"?t=lk(e.value):e.inputType==="Texture"?t=e.meta.textures[e.value]:t=e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const Ib=st(Xde).setParameterLength(1);class rq extends Map{get(e,t=null,...n){if(this.has(e))return super.get(e);if(t!==null){const r=t(...n);return this.set(e,r),r}}}class $de{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const Bb=new rq;class Yde extends dn{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new rq,this._output=Ib(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const n=this._outputs;return n[e]===void 0?n[e]=Ib(t):n[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const n=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),n[e]=t,n[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),n[e]=t,n[e].events.addEventListener("refresh",this.onRefresh)):n[e]===void 0?(n[e]=Ib(t),n[e].events.addEventListener("refresh",this.onRefresh)):n[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r(...t)}async callAsync(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r.constructor.name==="AsyncFunction"?await r(...t):r(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),t=(u,h)=>this.setOutput(u,h),n=new $de(this),r=Bb.get("THREE"),s=Bb.get("TSL"),o=this.getMethod(),a=[n,this._local,Bb,e,t,r,s];this._object=o(...a);const l=this._object.layout;if(l&&(l.cache===!1&&this._local.clear(),this._output.outputType=l.outputType||null,Array.isArray(l.elements)))for(const u of l.elements){const h=u.id||u.name;u.inputType&&(this.getParameter(h)===void 0&&this.setParameter(h,null),this.getParameter(h).inputType=u.inputType),u.outputType&&(this.getOutput(h)===void 0&&this.setOutput(h,null),this.getOutput(h).outputType=u.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let n=this.parameters[t];n.isScriptableNode&&(n=n.getDefaultOutput()),n.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:me()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],n=["layout","init","main","dispose"].join(", "),r="var "+n+`; var output = {};
`,s=`
return { ...output, `+n+" };",o=r+this.codeNode.code+s;return this._method=new Function(...e,o),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[tk(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const n in this.parameters)t.push(this.parameters[n].getCacheKey(e));return yT(t)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const Qde=st(Yde).setParameterLength(1,2);function sq(i){let e;const t=i.context.getViewZ;return t!==void 0&&(e=t(this)),(e||Jr.z).negate()}const z5=Ce(([i,e],t)=>{const n=sq(t);return fc(i,e,n)}),V5=Ce(([i],e)=>{const t=sq(e);return i.mul(i,t,t).negate().exp().oneMinus()}),wy=Ce(([i,e])=>an(e.toFloat().mix(im.rgb,i.toVec3()),im.a));function Kde(i,e,t){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),wy(i,z5(e,t))}function Zde(i,e){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),wy(i,V5(e))}let Xd=null,$d=null;class Jde extends dn{static get type(){return"RangeNode"}constructor(e=me(),t=me()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength($f(this.minNode.value)),n=e.getTypeLength($f(this.maxNode.value));return t>n?t:n}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let n=null;if(t.count>1){const r=this.minNode.value,s=this.maxNode.value,o=e.getTypeLength($f(r)),a=e.getTypeLength($f(s));Xd=Xd||new mn,$d=$d||new mn,Xd.setScalar(0),$d.setScalar(0),o===1?Xd.setScalar(r):r.isColor?Xd.set(r.r,r.g,r.b,1):Xd.set(r.x,r.y,r.z||0,r.w||0),a===1?$d.setScalar(s):s.isColor?$d.set(s.r,s.g,s.b,1):$d.set(s.x,s.y,s.z||0,s.w||0);const l=4,u=l*t.count,h=new Float32Array(u);for(let _=0;_<u;_++){const x=_%l,b=Xd.getComponent(x),R=$d.getComponent(x);h[_]=Lm.lerp(b,R,Math.random())}const d=this.getNodeType(e);if(t.count<=4096)n=i2(h,"vec4",t.count).element(nd).convert(d);else{const _=new ed(h,4);e.geometry.setAttribute("__range"+this.id,_),n=DS(_).convert(d)}}else n=me(0);return n}}const eAe=st(Jde).setParameterLength(2);class tAe extends dn{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const n=this.getBuiltinName(e),r=this.getNodeType(e);return e.shaderStage==="compute"?e.format(n,r,t):(console.warn(`ComputeBuiltinNode: Compute built-in value ${n} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(r))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const l2=(i,e)=>Ze(new tAe(i,e)),nAe=l2("numWorkgroups","uvec3"),iAe=l2("workgroupId","uvec3"),rAe=l2("globalId","uvec3"),sAe=l2("localId","uvec3"),oAe=l2("subgroupSize","uint");class aAe extends dn{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const q5=st(aAe),lAe=()=>q5("workgroup").toStack(),uAe=()=>q5("storage").toStack(),cAe=()=>q5("texture").toStack();class hAe extends JA{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let n;const r=e.context.assign;if(n=super.generate(e),r!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}class fAe extends dn{constructor(e,t,n=0){super(t),this.bufferType=t,this.bufferCount=n,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e}label(e){return this.name=e,this}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return Ze(new hAe(this,e))}generate(e){return e.getScopedArray(this.name||`${this.scope}Array_${this.id}`,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const dAe=(i,e)=>Ze(new fAe("Workgroup",i,e));class Ps extends dn{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,s=this.getNodeType(e),o=this.getInputType(e),a=this.pointerNode,l=this.valueNode,u=[];u.push(`&${a.build(e,o)}`),l!==null&&u.push(l.build(e,o));const h=`${e.getMethod(r,s)}( ${u.join(", ")} )`;if(n.length===1&&n[0].isStackNode===!0)e.addLineFlowCode(h,this);else return t.constNode===void 0&&(t.constNode=Oh(h,s).toConst()),t.constNode.build(e)}}Ps.ATOMIC_LOAD="atomicLoad";Ps.ATOMIC_STORE="atomicStore";Ps.ATOMIC_ADD="atomicAdd";Ps.ATOMIC_SUB="atomicSub";Ps.ATOMIC_MAX="atomicMax";Ps.ATOMIC_MIN="atomicMin";Ps.ATOMIC_AND="atomicAnd";Ps.ATOMIC_OR="atomicOr";Ps.ATOMIC_XOR="atomicXor";const AAe=st(Ps),xc=(i,e,t)=>AAe(i,e,t).toStack(),pAe=i=>xc(Ps.ATOMIC_LOAD,i,null),mAe=(i,e)=>xc(Ps.ATOMIC_STORE,i,e),gAe=(i,e)=>xc(Ps.ATOMIC_ADD,i,e),_Ae=(i,e)=>xc(Ps.ATOMIC_SUB,i,e),yAe=(i,e)=>xc(Ps.ATOMIC_MAX,i,e),vAe=(i,e)=>xc(Ps.ATOMIC_MIN,i,e),xAe=(i,e)=>xc(Ps.ATOMIC_AND,i,e),bAe=(i,e)=>xc(Ps.ATOMIC_OR,i,e),SAe=(i,e)=>xc(Ps.ATOMIC_XOR,i,e);let Lx;function jT(i){Lx=Lx||new WeakMap;let e=Lx.get(i);return e===void 0&&Lx.set(i,e={}),e}function H5(i){const e=jT(i);return e.shadowMatrix||(e.shadowMatrix=ln("mat4").setGroup(pn).onRenderUpdate(t=>((i.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&i.shadow.updateMatrices(i),i.shadow.matrix)))}function oq(i,e=xh){const t=H5(i).mul(e);return t.xyz.div(t.w)}function W5(i){const e=jT(i);return e.position||(e.position=ln(new ce).setGroup(pn).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.matrixWorld)))}function aq(i){const e=jT(i);return e.targetPosition||(e.targetPosition=ln(new ce).setGroup(pn).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.target.matrixWorld)))}function j5(i){const e=jT(i);return e.viewPosition||(e.viewPosition=ln(new ce).setGroup(pn).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new ce,n.value.setFromMatrixPosition(i.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const X5=i=>Fl.transformDirection(W5(i).sub(aq(i))),TAe=i=>i.sort((e,t)=>e.id-t.id),EAe=(i,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===i)return t;return null},TM=new WeakMap,H1=[];class $5 extends dn{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=vh("vec3","totalDiffuse"),this.totalSpecularNode=vh("vec3","totalSpecular"),this.outgoingLightNode=vh("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(H1.push(r.id),H1.push(r.castShadow?1:0),r.isSpotLight===!0){const s=r.map!==null?r.map.id:-1,o=r.colorNode?r.colorNode.getCacheKey():-1;H1.push(s,o)}}const t=yT(H1);return H1.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=TAe(this._lights),s=e.renderer.library;for(const o of r)if(o.isNode)t.push(Ze(o));else{let a=null;if(n!==null&&(a=EAe(o.id,n)),a===null){const l=s.getLightNodeClass(o.constructor);if(l===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let u=null;TM.has(o)?u=TM.get(o):(u=Ze(new l(o)),TM.set(o,u)),t.push(u)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.direct({...n,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,s=r.lightingModel,o=e.getNodeProperties(this);if(s){const{totalDiffuseNode:a,totalSpecularNode:l}=this;r.outgoingLight=n;const u=e.addStack();o.nodes=u.nodes,s.start(e);const{backdrop:h,backdropAlpha:d}=r,{directDiffuse:_,directSpecular:x,indirectDiffuse:b,indirectSpecular:R}=r.reflectedLight;let E=_.add(b);h!==null&&(d!==null?E=Me(d.mix(E,h)):E=Me(h),r.material.transparent=!0),a.assign(E),l.assign(x.add(R)),n.assign(a.add(l)),s.finish(e),n=n.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const wAe=(i=[])=>Ze(new $5).setLights(i);class MAe extends dn{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=Kn.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){Y5.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||xh)}}const Y5=vh("vec3","shadowPositionWorld");function RAe(i,e={}){return e.toneMapping=i.toneMapping,e.toneMappingExposure=i.toneMappingExposure,e.outputColorSpace=i.outputColorSpace,e.renderTarget=i.getRenderTarget(),e.activeCubeFace=i.getActiveCubeFace(),e.activeMipmapLevel=i.getActiveMipmapLevel(),e.renderObjectFunction=i.getRenderObjectFunction(),e.pixelRatio=i.getPixelRatio(),e.mrt=i.getMRT(),e.clearColor=i.getClearColor(e.clearColor||new Jt),e.clearAlpha=i.getClearAlpha(),e.autoClear=i.autoClear,e.scissorTest=i.getScissorTest(),e}function CAe(i,e){return e=RAe(i,e),i.setMRT(null),i.setRenderObjectFunction(null),i.setClearColor(0,1),i.autoClear=!0,e}function NAe(i,e){i.toneMapping=e.toneMapping,i.toneMappingExposure=e.toneMappingExposure,i.outputColorSpace=e.outputColorSpace,i.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),i.setRenderObjectFunction(e.renderObjectFunction),i.setPixelRatio(e.pixelRatio),i.setMRT(e.mrt),i.setClearColor(e.clearColor,e.clearAlpha),i.autoClear=e.autoClear,i.setScissorTest(e.scissorTest)}function DAe(i,e={}){return e.background=i.background,e.backgroundNode=i.backgroundNode,e.overrideMaterial=i.overrideMaterial,e}function PAe(i,e){return e=DAe(i,e),i.background=null,i.backgroundNode=null,i.overrideMaterial=null,e}function LAe(i,e){i.background=e.background,i.backgroundNode=e.backgroundNode,i.overrideMaterial=e.overrideMaterial}function OAe(i,e,t){return t=CAe(i,t),t=PAe(e,t),t}function IAe(i,e,t){NAe(i,t),LAe(e,t)}const yI=new WeakMap,lq=Ce(({depthTexture:i,shadowCoord:e,depthLayer:t})=>{let n=ui(i,e.xy).label("t_basic");return i.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),uq=Ce(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(E,w)=>{let L=ui(i,E);return i.isArrayTexture&&(L=L.depth(n)),L.compare(w)},s=ar("mapSize","vec2",t).setGroup(pn),o=ar("radius","float",t).setGroup(pn),a=dt(1).div(s),l=a.x.negate().mul(o),u=a.y.negate().mul(o),h=a.x.mul(o),d=a.y.mul(o),_=l.div(2),x=u.div(2),b=h.div(2),R=d.div(2);return gs(r(e.xy.add(dt(l,u)),e.z),r(e.xy.add(dt(0,u)),e.z),r(e.xy.add(dt(h,u)),e.z),r(e.xy.add(dt(_,x)),e.z),r(e.xy.add(dt(0,x)),e.z),r(e.xy.add(dt(b,x)),e.z),r(e.xy.add(dt(l,0)),e.z),r(e.xy.add(dt(_,0)),e.z),r(e.xy,e.z),r(e.xy.add(dt(b,0)),e.z),r(e.xy.add(dt(h,0)),e.z),r(e.xy.add(dt(_,R)),e.z),r(e.xy.add(dt(0,R)),e.z),r(e.xy.add(dt(b,R)),e.z),r(e.xy.add(dt(l,d)),e.z),r(e.xy.add(dt(0,d)),e.z),r(e.xy.add(dt(h,d)),e.z)).mul(1/17)}),cq=Ce(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(d,_)=>{let x=ui(i,d);return i.isArrayTexture&&(x=x.depth(n)),x.compare(_)},s=ar("mapSize","vec2",t).setGroup(pn),o=dt(1).div(s),a=o.x,l=o.y,u=e.xy,h=zh(u.mul(s).add(.5));return u.subAssign(h.mul(o)),gs(r(u,e.z),r(u.add(dt(a,0)),e.z),r(u.add(dt(0,l)),e.z),r(u.add(o),e.z),zi(r(u.add(dt(a.negate(),0)),e.z),r(u.add(dt(a.mul(2),0)),e.z),h.x),zi(r(u.add(dt(a.negate(),l)),e.z),r(u.add(dt(a.mul(2),l)),e.z),h.x),zi(r(u.add(dt(0,l.negate())),e.z),r(u.add(dt(0,l.mul(2))),e.z),h.y),zi(r(u.add(dt(a,l.negate())),e.z),r(u.add(dt(a,l.mul(2))),e.z),h.y),zi(zi(r(u.add(dt(a.negate(),l.negate())),e.z),r(u.add(dt(a.mul(2),l.negate())),e.z),h.x),zi(r(u.add(dt(a.negate(),l.mul(2))),e.z),r(u.add(dt(a.mul(2),l.mul(2))),e.z),h.x),h.y)).mul(1/9)}),hq=Ce(({depthTexture:i,shadowCoord:e,depthLayer:t})=>{const n=me(1).toVar();let r=ui(i).sample(e.xy);i.isArrayTexture&&(r=r.depth(t)),r=r.rg;const s=NT(e.z,r.x);return Xn(s.notEqual(me(1)),()=>{const o=e.z.sub(r.x),a=Hr(0,r.y.mul(r.y));let l=a.div(a.add(o.mul(o)));l=hc(vi(l,.3).div(.95-.3)),n.assign(hc(Hr(s,l)))}),n}),BAe=Ce(([i,e,t])=>{let n=xh.sub(i).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),UAe=i=>{const e=i.shadow.camera,t=ar("near","float",e).setGroup(pn),n=ar("far","float",e).setGroup(pn),r=WG(i);return BAe(r,t,n)},fq=i=>{let e=yI.get(i);if(e===void 0){const t=i.isPointLight?UAe(i):null;e=new ts,e.colorNode=an(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,yI.set(i,e)}return e},vI=new yu,mp=[],dq=(i,e,t,n)=>{mp[0]=i,mp[1]=e;let r=vI.get(mp);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(s,o,a,l,u,h,...d)=>{(s.castShadow===!0||s.receiveShadow&&t===Va)&&(n&&(ok(s).useVelocity=!0),s.onBeforeShadow(i,s,a,e.camera,l,o.overrideMaterial,h),i.renderObject(s,o,a,l,u,h,...d),s.onAfterShadow(i,s,a,e.camera,l,o.overrideMaterial,h))},r.shadowType=t,r.useVelocity=n,vI.set(mp,r)),mp[0]=null,mp[1]=null,r},FAe=Ce(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=me(0).toVar("meanVertical"),o=me(0).toVar("squareMeanVertical"),a=i.lessThanEqual(me(1)).select(me(0),me(2).div(i.sub(1))),l=i.lessThanEqual(me(1)).select(me(0),me(-1));Qi({start:be(0),end:be(i),type:"int",condition:"<"},({i:h})=>{const d=l.add(me(h).mul(a));let _=n.sample(gs(a2.xy,dt(0,d).mul(e)).div(t));n.value.isArrayTexture&&(_=_.depth(r)),_=_.x,s.addAssign(_),o.addAssign(_.mul(_))}),s.divAssign(i),o.divAssign(i);const u=yc(o.sub(s.mul(s)));return dt(s,u)}),kAe=Ce(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=me(0).toVar("meanHorizontal"),o=me(0).toVar("squareMeanHorizontal"),a=i.lessThanEqual(me(1)).select(me(0),me(2).div(i.sub(1))),l=i.lessThanEqual(me(1)).select(me(0),me(-1));Qi({start:be(0),end:be(i),type:"int",condition:"<"},({i:h})=>{const d=l.add(me(h).mul(a));let _=n.sample(gs(a2.xy,dt(d,0).mul(e)).div(t));n.value.isArrayTexture&&(_=_.depth(r)),s.addAssign(_.x),o.addAssign(gs(_.y.mul(_.y),_.x.mul(_.x)))}),s.divAssign(i),o.divAssign(i);const u=yc(o.sub(s.mul(s)));return dt(s,u)}),GAe=[lq,uq,cq,hq];let EM;const Ox=new HT;class Aq extends MAe{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:s,depthLayer:o}){const a=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),l=t({depthTexture:n,shadowCoord:r,shadow:s,depthLayer:o});return a.select(l,me(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,s=ar("bias","float",n).setGroup(pn);let o=t,a;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),a=o.z,r.coordinateSystem===lc&&(a=a.mul(2).sub(1));else{const l=o.w;o=o.xy.div(l);const u=ar("near","float",n.camera).setGroup(pn),h=ar("far","float",n.camera).setGroup(pn);a=R5(l.negate(),u,h)}return o=Me(o.x,o.y.oneMinus(),a.add(s)),o}getShadowFilterFn(e){return GAe[e]}setupRenderTarget(e,t){const n=new Ja(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=oT;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t}=e,{light:n,shadow:r}=this,s=t.shadowMap.type,{depthTexture:o,shadowMap:a}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),s===Va&&r.isPointLightShadow!==!0){o.compareFunction=null,a.depth>1?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:mh,type:As,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:mh,type:As,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:mh,type:As,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:mh,type:As,depthBuffer:!1}));let w=ui(o);o.isArrayTexture&&(w=w.depth(this.depthLayer));let L=ui(this.vsmShadowMapVertical.texture);o.isArrayTexture&&(L=L.depth(this.depthLayer));const D=ar("blurSamples","float",r).setGroup(pn),O=ar("radius","float",r).setGroup(pn),B=ar("mapSize","vec2",r).setGroup(pn);let G=this.vsmMaterialVertical||(this.vsmMaterialVertical=new ts);G.fragmentNode=FAe({samples:D,radius:O,size:B,shadowPass:w,depthLayer:this.depthLayer}).context(e.getSharedContext()),G.name="VSMVertical",G=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new ts),G.fragmentNode=kAe({samples:D,radius:O,size:B,shadowPass:L,depthLayer:this.depthLayer}).context(e.getSharedContext()),G.name="VSMHorizontal"}const l=ar("intensity","float",r).setGroup(pn),u=ar("normalBias","float",r).setGroup(pn),h=H5(n).mul(Y5.add(dd.mul(u))),d=this.setupShadowCoord(e,h),_=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(_===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const x=s===Va&&r.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:o,b=this.setupShadowFilter(e,{filterFn:_,shadowTexture:a.texture,depthTexture:x,shadowCoord:d,shadow:r,depthLayer:this.depthLayer});let R=ui(a.texture,d);o.isArrayTexture&&(R=R.depth(this.depthLayer));const E=zi(1,b.rgb.mix(R,1),l.mul(R.a)).toVar();return this.shadowMap=a,this.shadow.map=a,E}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Ce(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:o}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth),s.render(o,t.camera)}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:s,scene:o,camera:a}=e,l=s.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const h=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=a.layers.mask);const d=s.getRenderObjectFunction(),_=s.getMRT(),x=_?_.has("velocity"):!1;EM=OAe(s,o,EM),o.overrideMaterial=fq(n),s.setRenderObjectFunction(dq(s,r,l,x)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(d),l===Va&&r.isPointLightShadow!==!0&&this.vsmPass(s),r.camera.layers.mask=h,IAe(s,o,EM)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),Ox.material=this.vsmMaterialVertical,Ox.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),Ox.material=this.vsmMaterialHorizontal,Ox.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const pq=(i,e)=>Ze(new Aq(i,e)),zAe=new Jt,ou=Ce(([i,e])=>{const t=i.toVar(),n=gr(t),r=Ll(1,Hr(n.x,Hr(n.y,n.z)));n.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const s=dt(t.xy).toVar(),a=e.mul(1.5).oneMinus();return Xn(n.z.greaterThanEqual(a),()=>{Xn(t.z.greaterThan(0),()=>{s.x.assign(vi(4,t.x))})}).ElseIf(n.x.greaterThanEqual(a),()=>{const l=Ty(t.x);s.x.assign(t.z.mul(l).add(l.mul(2)))}).ElseIf(n.y.greaterThanEqual(a),()=>{const l=Ty(t.y);s.x.assign(t.x.add(l.mul(2)).add(2)),s.y.assign(t.z.mul(l).sub(2))}),dt(.125,.25).mul(s).add(dt(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),mq=Ce(({depthTexture:i,bd3D:e,dp:t,texelSize:n})=>ui(i,ou(e,n.y)).compare(t)),gq=Ce(({depthTexture:i,bd3D:e,dp:t,texelSize:n,shadow:r})=>{const s=ar("radius","float",r).setGroup(pn),o=dt(-1,1).mul(s).mul(n.y);return ui(i,ou(e.add(o.xyy),n.y)).compare(t).add(ui(i,ou(e.add(o.yyy),n.y)).compare(t)).add(ui(i,ou(e.add(o.xyx),n.y)).compare(t)).add(ui(i,ou(e.add(o.yyx),n.y)).compare(t)).add(ui(i,ou(e,n.y)).compare(t)).add(ui(i,ou(e.add(o.xxy),n.y)).compare(t)).add(ui(i,ou(e.add(o.yxy),n.y)).compare(t)).add(ui(i,ou(e.add(o.xxx),n.y)).compare(t)).add(ui(i,ou(e.add(o.yxx),n.y)).compare(t)).mul(1/9)}),VAe=Ce(({filterFn:i,depthTexture:e,shadowCoord:t,shadow:n})=>{const r=t.xyz.toVar(),s=r.length(),o=ln("float").setGroup(pn).onRenderUpdate(()=>n.camera.near),a=ln("float").setGroup(pn).onRenderUpdate(()=>n.camera.far),l=ar("bias","float",n).setGroup(pn),u=ln(n.mapSize).setGroup(pn),h=me(1).toVar();return Xn(s.sub(a).lessThanEqual(0).and(s.sub(o).greaterThanEqual(0)),()=>{const d=s.sub(o).div(a.sub(o)).toVar();d.addAssign(l);const _=r.normalize(),x=dt(1).div(u.mul(dt(4,2)));h.assign(i({depthTexture:e,bd3D:_,dp:d,texelSize:x,shadow:n}))}),h}),xI=new mn,gp=new it,W1=new it;class qAe extends Aq{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===JX?mq:gq}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:s,shadow:o}){return VAe({filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:s,shadow:o})}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:o}=e,a=t.getFrameExtents();W1.copy(t.mapSize),W1.multiply(a),n.setSize(W1.width,W1.height),gp.copy(t.mapSize);const l=s.autoClear,u=s.getClearColor(zAe),h=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha),s.clear();const d=t.getViewportCount();for(let _=0;_<d;_++){const x=t.getViewport(_),b=gp.x*x.x,R=W1.y-gp.y-gp.y*x.y;xI.set(b,R,gp.x*x.z,gp.y*x.w),n.viewport.copy(xI),t.updateMatrices(r,_),s.render(o,t.camera)}s.autoClear=l,s.setClearColor(u,h)}}const _q=(i,e)=>Ze(new qAe(i,e));class i0 extends pg{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Jt,this.colorNode=e&&e.colorNode||ln(this.color).setGroup(pn),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=Kn.FRAME}getHash(){return this.light.uuid}getLightVector(e){return j5(this.light).sub(e.context.positionView||Jr)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return pq(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=Ze(r):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=n=this.colorNode.mul(s),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const Q5=Ce(({lightDistance:i,cutoffDistance:e,decayExponent:t})=>{const n=i.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(i.div(e).pow4().oneMinus().clamp().pow2()),n)}),yq=({color:i,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),s=e.length(),o=Q5({lightDistance:s,cutoffDistance:t,decayExponent:n}),a=i.mul(o);return{lightDirection:r,lightColor:a}};class HAe extends i0{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=ln(0).setGroup(pn),this.decayExponentNode=ln(2).setGroup(pn)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return _q(this.light)}setupDirect(e){return yq({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const WAe=Ce(([i=Tr()])=>{const e=i.mul(2),t=e.x.floor(),n=e.y.floor();return t.add(n).mod(2).sign()}),jAe=Ce(([i=Tr()],{renderer:e,material:t})=>{const n=a5(i.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.samples>1){const s=me(n.fwidth()).toVar();r=fc(s.oneMinus(),s.add(1),n).oneMinus()}else r=js(n.greaterThan(1),0,1);return r}),I_=Ce(([i,e,t])=>{const n=me(t).toVar(),r=me(e).toVar(),s=cc(i).toVar();return js(s,r,n)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),IS=Ce(([i,e])=>{const t=cc(e).toVar(),n=me(i).toVar();return js(t,n.negate(),n)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),as=Ce(([i])=>{const e=me(i).toVar();return be(ic(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),Cr=Ce(([i,e])=>{const t=me(i).toVar();return e.assign(as(t)),t.sub(me(e))}),XAe=Ce(([i,e,t,n,r,s])=>{const o=me(s).toVar(),a=me(r).toVar(),l=me(n).toVar(),u=me(t).toVar(),h=me(e).toVar(),d=me(i).toVar(),_=me(vi(1,a)).toVar();return vi(1,o).mul(d.mul(_).add(h.mul(a))).add(o.mul(u.mul(_).add(l.mul(a))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),$Ae=Ce(([i,e,t,n,r,s])=>{const o=me(s).toVar(),a=me(r).toVar(),l=Me(n).toVar(),u=Me(t).toVar(),h=Me(e).toVar(),d=Me(i).toVar(),_=me(vi(1,a)).toVar();return vi(1,o).mul(d.mul(_).add(h.mul(a))).add(o.mul(u.mul(_).add(l.mul(a))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),vq=co([XAe,$Ae]),YAe=Ce(([i,e,t,n,r,s,o,a,l,u,h])=>{const d=me(h).toVar(),_=me(u).toVar(),x=me(l).toVar(),b=me(a).toVar(),R=me(o).toVar(),E=me(s).toVar(),w=me(r).toVar(),L=me(n).toVar(),D=me(t).toVar(),O=me(e).toVar(),B=me(i).toVar(),G=me(vi(1,x)).toVar(),k=me(vi(1,_)).toVar();return me(vi(1,d)).toVar().mul(k.mul(B.mul(G).add(O.mul(x))).add(_.mul(D.mul(G).add(L.mul(x))))).add(d.mul(k.mul(w.mul(G).add(E.mul(x))).add(_.mul(R.mul(G).add(b.mul(x))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),QAe=Ce(([i,e,t,n,r,s,o,a,l,u,h])=>{const d=me(h).toVar(),_=me(u).toVar(),x=me(l).toVar(),b=Me(a).toVar(),R=Me(o).toVar(),E=Me(s).toVar(),w=Me(r).toVar(),L=Me(n).toVar(),D=Me(t).toVar(),O=Me(e).toVar(),B=Me(i).toVar(),G=me(vi(1,x)).toVar(),k=me(vi(1,_)).toVar();return me(vi(1,d)).toVar().mul(k.mul(B.mul(G).add(O.mul(x))).add(_.mul(D.mul(G).add(L.mul(x))))).add(d.mul(k.mul(w.mul(G).add(E.mul(x))).add(_.mul(R.mul(G).add(b.mul(x))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),xq=co([YAe,QAe]),KAe=Ce(([i,e,t])=>{const n=me(t).toVar(),r=me(e).toVar(),s=Vt(i).toVar(),o=Vt(s.bitAnd(Vt(7))).toVar(),a=me(I_(o.lessThan(Vt(4)),r,n)).toVar(),l=me(jn(2,I_(o.lessThan(Vt(4)),n,r))).toVar();return IS(a,cc(o.bitAnd(Vt(1)))).add(IS(l,cc(o.bitAnd(Vt(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),ZAe=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=me(e).toVar(),a=Vt(i).toVar(),l=Vt(a.bitAnd(Vt(15))).toVar(),u=me(I_(l.lessThan(Vt(8)),o,s)).toVar(),h=me(I_(l.lessThan(Vt(4)),s,I_(l.equal(Vt(12)).or(l.equal(Vt(14))),o,r))).toVar();return IS(u,cc(l.bitAnd(Vt(1)))).add(IS(h,cc(l.bitAnd(Vt(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),zs=co([KAe,ZAe]),JAe=Ce(([i,e,t])=>{const n=me(t).toVar(),r=me(e).toVar(),s=dg(i).toVar();return Me(zs(s.x,r,n),zs(s.y,r,n),zs(s.z,r,n))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),e0e=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=me(e).toVar(),a=dg(i).toVar();return Me(zs(a.x,o,s,r),zs(a.y,o,s,r),zs(a.z,o,s,r))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),vl=co([JAe,e0e]),t0e=Ce(([i])=>{const e=me(i).toVar();return jn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),n0e=Ce(([i])=>{const e=me(i).toVar();return jn(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),i0e=Ce(([i])=>{const e=Me(i).toVar();return jn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),bq=co([t0e,i0e]),r0e=Ce(([i])=>{const e=Me(i).toVar();return jn(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),Sq=co([n0e,r0e]),Wa=Ce(([i,e])=>{const t=be(e).toVar(),n=Vt(i).toVar();return n.shiftLeft(t).bitOr(n.shiftRight(be(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),Tq=Ce(([i,e,t])=>{i.subAssign(t),i.bitXorAssign(Wa(t,be(4))),t.addAssign(e),e.subAssign(i),e.bitXorAssign(Wa(i,be(6))),i.addAssign(t),t.subAssign(e),t.bitXorAssign(Wa(e,be(8))),e.addAssign(i),i.subAssign(t),i.bitXorAssign(Wa(t,be(16))),t.addAssign(e),e.subAssign(i),e.bitXorAssign(Wa(i,be(19))),i.addAssign(t),t.subAssign(e),t.bitXorAssign(Wa(e,be(4))),e.addAssign(i)}),u2=Ce(([i,e,t])=>{const n=Vt(t).toVar(),r=Vt(e).toVar(),s=Vt(i).toVar();return n.bitXorAssign(r),n.subAssign(Wa(r,be(14))),s.bitXorAssign(n),s.subAssign(Wa(n,be(11))),r.bitXorAssign(s),r.subAssign(Wa(s,be(25))),n.bitXorAssign(r),n.subAssign(Wa(r,be(16))),s.bitXorAssign(n),s.subAssign(Wa(n,be(4))),r.bitXorAssign(s),r.subAssign(Wa(s,be(14))),n.bitXorAssign(r),n.subAssign(Wa(r,be(24))),n}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),Eo=Ce(([i])=>{const e=Vt(i).toVar();return me(e).div(me(Vt(be(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),sc=Ce(([i])=>{const e=me(i).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),s0e=Ce(([i])=>{const e=be(i).toVar(),t=Vt(Vt(1)).toVar(),n=Vt(Vt(be(3735928559)).add(t.shiftLeft(Vt(2))).add(Vt(13))).toVar();return u2(n.add(Vt(e)),n,n)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),o0e=Ce(([i,e])=>{const t=be(e).toVar(),n=be(i).toVar(),r=Vt(Vt(2)).toVar(),s=Vt().toVar(),o=Vt().toVar(),a=Vt().toVar();return s.assign(o.assign(a.assign(Vt(be(3735928559)).add(r.shiftLeft(Vt(2))).add(Vt(13))))),s.addAssign(Vt(n)),o.addAssign(Vt(t)),u2(s,o,a)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),a0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=be(e).toVar(),s=be(i).toVar(),o=Vt(Vt(3)).toVar(),a=Vt().toVar(),l=Vt().toVar(),u=Vt().toVar();return a.assign(l.assign(u.assign(Vt(be(3735928559)).add(o.shiftLeft(Vt(2))).add(Vt(13))))),a.addAssign(Vt(s)),l.addAssign(Vt(r)),u.addAssign(Vt(n)),u2(a,l,u)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),l0e=Ce(([i,e,t,n])=>{const r=be(n).toVar(),s=be(t).toVar(),o=be(e).toVar(),a=be(i).toVar(),l=Vt(Vt(4)).toVar(),u=Vt().toVar(),h=Vt().toVar(),d=Vt().toVar();return u.assign(h.assign(d.assign(Vt(be(3735928559)).add(l.shiftLeft(Vt(2))).add(Vt(13))))),u.addAssign(Vt(a)),h.addAssign(Vt(o)),d.addAssign(Vt(s)),Tq(u,h,d),u.addAssign(Vt(r)),u2(u,h,d)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),u0e=Ce(([i,e,t,n,r])=>{const s=be(r).toVar(),o=be(n).toVar(),a=be(t).toVar(),l=be(e).toVar(),u=be(i).toVar(),h=Vt(Vt(5)).toVar(),d=Vt().toVar(),_=Vt().toVar(),x=Vt().toVar();return d.assign(_.assign(x.assign(Vt(be(3735928559)).add(h.shiftLeft(Vt(2))).add(Vt(13))))),d.addAssign(Vt(u)),_.addAssign(Vt(l)),x.addAssign(Vt(a)),Tq(d,_,x),d.addAssign(Vt(o)),_.addAssign(Vt(s)),u2(d,_,x)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),$i=co([s0e,o0e,a0e,l0e,u0e]),c0e=Ce(([i,e])=>{const t=be(e).toVar(),n=be(i).toVar(),r=Vt($i(n,t)).toVar(),s=dg().toVar();return s.x.assign(r.bitAnd(be(255))),s.y.assign(r.shiftRight(be(8)).bitAnd(be(255))),s.z.assign(r.shiftRight(be(16)).bitAnd(be(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),h0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=be(e).toVar(),s=be(i).toVar(),o=Vt($i(s,r,n)).toVar(),a=dg().toVar();return a.x.assign(o.bitAnd(be(255))),a.y.assign(o.shiftRight(be(8)).bitAnd(be(255))),a.z.assign(o.shiftRight(be(16)).bitAnd(be(255))),a}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),xl=co([c0e,h0e]),f0e=Ce(([i])=>{const e=dt(i).toVar(),t=be().toVar(),n=be().toVar(),r=me(Cr(e.x,t)).toVar(),s=me(Cr(e.y,n)).toVar(),o=me(sc(r)).toVar(),a=me(sc(s)).toVar(),l=me(vq(zs($i(t,n),r,s),zs($i(t.add(be(1)),n),r.sub(1),s),zs($i(t,n.add(be(1))),r,s.sub(1)),zs($i(t.add(be(1)),n.add(be(1))),r.sub(1),s.sub(1)),o,a)).toVar();return bq(l)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),d0e=Ce(([i])=>{const e=Me(i).toVar(),t=be().toVar(),n=be().toVar(),r=be().toVar(),s=me(Cr(e.x,t)).toVar(),o=me(Cr(e.y,n)).toVar(),a=me(Cr(e.z,r)).toVar(),l=me(sc(s)).toVar(),u=me(sc(o)).toVar(),h=me(sc(a)).toVar(),d=me(xq(zs($i(t,n,r),s,o,a),zs($i(t.add(be(1)),n,r),s.sub(1),o,a),zs($i(t,n.add(be(1)),r),s,o.sub(1),a),zs($i(t.add(be(1)),n.add(be(1)),r),s.sub(1),o.sub(1),a),zs($i(t,n,r.add(be(1))),s,o,a.sub(1)),zs($i(t.add(be(1)),n,r.add(be(1))),s.sub(1),o,a.sub(1)),zs($i(t,n.add(be(1)),r.add(be(1))),s,o.sub(1),a.sub(1)),zs($i(t.add(be(1)),n.add(be(1)),r.add(be(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,h)).toVar();return Sq(d)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),K5=co([f0e,d0e]),A0e=Ce(([i])=>{const e=dt(i).toVar(),t=be().toVar(),n=be().toVar(),r=me(Cr(e.x,t)).toVar(),s=me(Cr(e.y,n)).toVar(),o=me(sc(r)).toVar(),a=me(sc(s)).toVar(),l=Me(vq(vl(xl(t,n),r,s),vl(xl(t.add(be(1)),n),r.sub(1),s),vl(xl(t,n.add(be(1))),r,s.sub(1)),vl(xl(t.add(be(1)),n.add(be(1))),r.sub(1),s.sub(1)),o,a)).toVar();return bq(l)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),p0e=Ce(([i])=>{const e=Me(i).toVar(),t=be().toVar(),n=be().toVar(),r=be().toVar(),s=me(Cr(e.x,t)).toVar(),o=me(Cr(e.y,n)).toVar(),a=me(Cr(e.z,r)).toVar(),l=me(sc(s)).toVar(),u=me(sc(o)).toVar(),h=me(sc(a)).toVar(),d=Me(xq(vl(xl(t,n,r),s,o,a),vl(xl(t.add(be(1)),n,r),s.sub(1),o,a),vl(xl(t,n.add(be(1)),r),s,o.sub(1),a),vl(xl(t.add(be(1)),n.add(be(1)),r),s.sub(1),o.sub(1),a),vl(xl(t,n,r.add(be(1))),s,o,a.sub(1)),vl(xl(t.add(be(1)),n,r.add(be(1))),s.sub(1),o,a.sub(1)),vl(xl(t,n.add(be(1)),r.add(be(1))),s,o.sub(1),a.sub(1)),vl(xl(t.add(be(1)),n.add(be(1)),r.add(be(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,h)).toVar();return Sq(d)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Z5=co([A0e,p0e]),m0e=Ce(([i])=>{const e=me(i).toVar(),t=be(as(e)).toVar();return Eo($i(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),g0e=Ce(([i])=>{const e=dt(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar();return Eo($i(t,n))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),_0e=Ce(([i])=>{const e=Me(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar(),r=be(as(e.z)).toVar();return Eo($i(t,n,r))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),y0e=Ce(([i])=>{const e=an(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar(),r=be(as(e.z)).toVar(),s=be(as(e.w)).toVar();return Eo($i(t,n,r,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),v0e=co([m0e,g0e,_0e,y0e]),x0e=Ce(([i])=>{const e=me(i).toVar(),t=be(as(e)).toVar();return Me(Eo($i(t,be(0))),Eo($i(t,be(1))),Eo($i(t,be(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),b0e=Ce(([i])=>{const e=dt(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar();return Me(Eo($i(t,n,be(0))),Eo($i(t,n,be(1))),Eo($i(t,n,be(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),S0e=Ce(([i])=>{const e=Me(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar(),r=be(as(e.z)).toVar();return Me(Eo($i(t,n,r,be(0))),Eo($i(t,n,r,be(1))),Eo($i(t,n,r,be(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),T0e=Ce(([i])=>{const e=an(i).toVar(),t=be(as(e.x)).toVar(),n=be(as(e.y)).toVar(),r=be(as(e.z)).toVar(),s=be(as(e.w)).toVar();return Me(Eo($i(t,n,r,s,be(0))),Eo($i(t,n,r,s,be(1))),Eo($i(t,n,r,s,be(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),Eq=co([x0e,b0e,S0e,T0e]),BS=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=be(e).toVar(),a=Me(i).toVar(),l=me(0).toVar(),u=me(1).toVar();return Qi(o,()=>{l.addAssign(u.mul(K5(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),wq=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=be(e).toVar(),a=Me(i).toVar(),l=Me(0).toVar(),u=me(1).toVar();return Qi(o,()=>{l.addAssign(u.mul(Z5(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),E0e=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=be(e).toVar(),a=Me(i).toVar();return dt(BS(a,o,s,r),BS(a.add(Me(be(19),be(193),be(17))),o,s,r))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),w0e=Ce(([i,e,t,n])=>{const r=me(n).toVar(),s=me(t).toVar(),o=be(e).toVar(),a=Me(i).toVar(),l=Me(wq(a,o,s,r)).toVar(),u=me(BS(a.add(Me(be(19),be(193),be(17))),o,s,r)).toVar();return an(l,u)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),M0e=Ce(([i,e,t,n,r,s,o])=>{const a=be(o).toVar(),l=me(s).toVar(),u=be(r).toVar(),h=be(n).toVar(),d=be(t).toVar(),_=be(e).toVar(),x=dt(i).toVar(),b=Me(Eq(dt(_.add(h),d.add(u)))).toVar(),R=dt(b.x,b.y).toVar();R.subAssign(.5),R.mulAssign(l),R.addAssign(.5);const E=dt(dt(me(_),me(d)).add(R)).toVar(),w=dt(E.sub(x)).toVar();return Xn(a.equal(be(2)),()=>gr(w.x).add(gr(w.y))),Xn(a.equal(be(3)),()=>Hr(gr(w.x),gr(w.y))),fd(w,w)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),R0e=Ce(([i,e,t,n,r,s,o,a,l])=>{const u=be(l).toVar(),h=me(a).toVar(),d=be(o).toVar(),_=be(s).toVar(),x=be(r).toVar(),b=be(n).toVar(),R=be(t).toVar(),E=be(e).toVar(),w=Me(i).toVar(),L=Me(Eq(Me(E.add(x),R.add(_),b.add(d)))).toVar();L.subAssign(.5),L.mulAssign(h),L.addAssign(.5);const D=Me(Me(me(E),me(R),me(b)).add(L)).toVar(),O=Me(D.sub(w)).toVar();return Xn(u.equal(be(2)),()=>gr(O.x).add(gr(O.y)).add(gr(O.z))),Xn(u.equal(be(3)),()=>Hr(gr(O.x),gr(O.y),gr(O.z))),fd(O,O)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),mg=co([M0e,R0e]),C0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=dt(i).toVar(),o=be().toVar(),a=be().toVar(),l=dt(Cr(s.x,o),Cr(s.y,a)).toVar(),u=me(1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:h})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:d})=>{const _=me(mg(l,h,d,o,a,r,n)).toVar();u.assign(xa(u,_))})}),Xn(n.equal(be(0)),()=>{u.assign(yc(u))}),u}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),N0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=dt(i).toVar(),o=be().toVar(),a=be().toVar(),l=dt(Cr(s.x,o),Cr(s.y,a)).toVar(),u=dt(1e6,1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:h})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:d})=>{const _=me(mg(l,h,d,o,a,r,n)).toVar();Xn(_.lessThan(u.x),()=>{u.y.assign(u.x),u.x.assign(_)}).ElseIf(_.lessThan(u.y),()=>{u.y.assign(_)})})}),Xn(n.equal(be(0)),()=>{u.assign(yc(u))}),u}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),D0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=dt(i).toVar(),o=be().toVar(),a=be().toVar(),l=dt(Cr(s.x,o),Cr(s.y,a)).toVar(),u=Me(1e6,1e6,1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:h})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:d})=>{const _=me(mg(l,h,d,o,a,r,n)).toVar();Xn(_.lessThan(u.x),()=>{u.z.assign(u.y),u.y.assign(u.x),u.x.assign(_)}).ElseIf(_.lessThan(u.y),()=>{u.z.assign(u.y),u.y.assign(_)}).ElseIf(_.lessThan(u.z),()=>{u.z.assign(_)})})}),Xn(n.equal(be(0)),()=>{u.assign(yc(u))}),u}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),P0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=Me(i).toVar(),o=be().toVar(),a=be().toVar(),l=be().toVar(),u=Me(Cr(s.x,o),Cr(s.y,a),Cr(s.z,l)).toVar(),h=me(1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:d})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:_})=>{Qi({start:-1,end:be(1),name:"z",condition:"<="},({z:x})=>{const b=me(mg(u,d,_,x,o,a,l,r,n)).toVar();h.assign(xa(h,b))})})}),Xn(n.equal(be(0)),()=>{h.assign(yc(h))}),h}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),L0e=co([C0e,P0e]),O0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=Me(i).toVar(),o=be().toVar(),a=be().toVar(),l=be().toVar(),u=Me(Cr(s.x,o),Cr(s.y,a),Cr(s.z,l)).toVar(),h=dt(1e6,1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:d})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:_})=>{Qi({start:-1,end:be(1),name:"z",condition:"<="},({z:x})=>{const b=me(mg(u,d,_,x,o,a,l,r,n)).toVar();Xn(b.lessThan(h.x),()=>{h.y.assign(h.x),h.x.assign(b)}).ElseIf(b.lessThan(h.y),()=>{h.y.assign(b)})})})}),Xn(n.equal(be(0)),()=>{h.assign(yc(h))}),h}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),I0e=co([N0e,O0e]),B0e=Ce(([i,e,t])=>{const n=be(t).toVar(),r=me(e).toVar(),s=Me(i).toVar(),o=be().toVar(),a=be().toVar(),l=be().toVar(),u=Me(Cr(s.x,o),Cr(s.y,a),Cr(s.z,l)).toVar(),h=Me(1e6,1e6,1e6).toVar();return Qi({start:-1,end:be(1),name:"x",condition:"<="},({x:d})=>{Qi({start:-1,end:be(1),name:"y",condition:"<="},({y:_})=>{Qi({start:-1,end:be(1),name:"z",condition:"<="},({z:x})=>{const b=me(mg(u,d,_,x,o,a,l,r,n)).toVar();Xn(b.lessThan(h.x),()=>{h.z.assign(h.y),h.y.assign(h.x),h.x.assign(b)}).ElseIf(b.lessThan(h.y),()=>{h.z.assign(h.y),h.y.assign(b)}).ElseIf(b.lessThan(h.z),()=>{h.z.assign(b)})})})}),Xn(n.equal(be(0)),()=>{h.assign(yc(h))}),h}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),U0e=co([D0e,B0e]),F0e=Ce(([i])=>{const e=i.y,t=i.z,n=Me().toVar();return Xn(e.lessThan(1e-4),()=>{n.assign(Me(t,t,t))}).Else(()=>{let r=i.x;r=r.sub(ic(r)).mul(6).toVar();const s=be(s5(r)),o=r.sub(me(s)),a=t.mul(e.oneMinus()),l=t.mul(e.mul(o).oneMinus()),u=t.mul(e.mul(o.oneMinus()).oneMinus());Xn(s.equal(be(0)),()=>{n.assign(Me(t,u,a))}).ElseIf(s.equal(be(1)),()=>{n.assign(Me(l,t,a))}).ElseIf(s.equal(be(2)),()=>{n.assign(Me(a,t,u))}).ElseIf(s.equal(be(3)),()=>{n.assign(Me(a,l,t))}).ElseIf(s.equal(be(4)),()=>{n.assign(Me(u,a,t))}).Else(()=>{n.assign(Me(t,a,l))})}),n}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),k0e=Ce(([i])=>{const e=Me(i).toVar(),t=me(e.x).toVar(),n=me(e.y).toVar(),r=me(e.z).toVar(),s=me(xa(t,xa(n,r))).toVar(),o=me(Hr(t,Hr(n,r))).toVar(),a=me(o.sub(s)).toVar(),l=me().toVar(),u=me().toVar(),h=me().toVar();return h.assign(o),Xn(o.greaterThan(0),()=>{u.assign(a.div(o))}).Else(()=>{u.assign(0)}),Xn(u.lessThanEqual(0),()=>{l.assign(0)}).Else(()=>{Xn(t.greaterThanEqual(o),()=>{l.assign(n.sub(r).div(a))}).ElseIf(n.greaterThanEqual(o),()=>{l.assign(gs(2,r.sub(t).div(a)))}).Else(()=>{l.assign(gs(4,t.sub(n).div(a)))}),l.mulAssign(1/6),Xn(l.lessThan(0),()=>{l.addAssign(1)})}),Me(l,u,h)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),G0e=Ce(([i])=>{const e=Me(i).toVar(),t=q8(Z8(e,Me(.04045))).toVar(),n=Me(e.div(12.92)).toVar(),r=Me(Au(Hr(e.add(Me(.055)),Me(0)).div(1.055),Me(2.4))).toVar();return zi(n,r,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Mq=(i,e)=>{i=me(i),e=me(e);const t=dt(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return fc(i.sub(t),i.add(t),e)},Rq=(i,e,t,n)=>zi(i,e,t[n].clamp()),z0e=(i,e,t=Tr())=>Rq(i,e,t,"x"),V0e=(i,e,t=Tr())=>Rq(i,e,t,"y"),Cq=(i,e,t,n,r)=>zi(i,e,Mq(t,n[r])),q0e=(i,e,t,n=Tr())=>Cq(i,e,t,n,"x"),H0e=(i,e,t,n=Tr())=>Cq(i,e,t,n,"y"),W0e=(i=1,e=0,t=Tr())=>t.mul(i).add(e),j0e=(i,e=1)=>(i=me(i),i.abs().pow(e).mul(i.sign())),X0e=(i,e=1,t=.5)=>me(i).sub(t).mul(e).add(t),$0e=(i=Tr(),e=1,t=0)=>K5(i.convert("vec2|vec3")).mul(e).add(t),Y0e=(i=Tr(),e=1,t=0)=>Z5(i.convert("vec2|vec3")).mul(e).add(t),Q0e=(i=Tr(),e=1,t=0)=>(i=i.convert("vec2|vec3"),an(Z5(i),K5(i.add(dt(19,73)))).mul(e).add(t)),K0e=(i=Tr(),e=1)=>L0e(i.convert("vec2|vec3"),e,be(1)),Z0e=(i=Tr(),e=1)=>I0e(i.convert("vec2|vec3"),e,be(1)),J0e=(i=Tr(),e=1)=>U0e(i.convert("vec2|vec3"),e,be(1)),epe=(i=Tr())=>v0e(i.convert("vec2|vec3")),tpe=(i=Tr(),e=3,t=2,n=.5,r=1)=>BS(i,be(e),t,n).mul(r),npe=(i=Tr(),e=3,t=2,n=.5,r=1)=>E0e(i,be(e),t,n).mul(r),ipe=(i=Tr(),e=3,t=2,n=.5,r=1)=>wq(i,be(e),t,n).mul(r),rpe=(i=Tr(),e=3,t=2,n=.5,r=1)=>w0e(i,be(e),t,n).mul(r),spe=Ce(([i,e,t])=>{const n=Lh(i).toVar(),r=vi(me(.5).mul(e.sub(t)),xh).div(n).toVar(),s=vi(me(-.5).mul(e.sub(t)),xh).div(n).toVar(),o=Me().toVar();o.x=n.x.greaterThan(me(0)).select(r.x,s.x),o.y=n.y.greaterThan(me(0)).select(r.y,s.y),o.z=n.z.greaterThan(me(0)).select(r.z,s.z);const a=xa(o.x,o.y,o.z).toVar();return xh.add(n.mul(a)).toVar().sub(t)}),Nq=Ce(([i,e])=>{const t=i.x,n=i.y,r=i.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(n)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(n)),s=s.add(e.element(5).mul(2*.429043).mul(n).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(jn(t,t).sub(jn(n,n)))),s});var W=Object.freeze({__proto__:null,BRDF_GGX:qC,BRDF_Lambert:XA,BasicPointShadowFilter:mq,BasicShadowFilter:lq,Break:eV,Const:TG,Continue:lce,DFGApprox:L5,D_GGX:xV,Discard:GG,EPSILON:Yk,F_Schlick:jm,Fn:Ce,INFINITY:Fle,If:Xn,Loop:Qi,NodeAccess:To,NodeShaderStage:f_,NodeType:cle,NodeUpdateType:Kn,PCFShadowFilter:uq,PCFSoftShadowFilter:cq,PI:NS,PI2:kle,PointShadowFilter:gq,Return:nue,Schlick_to_F0:SV,ScriptableNodeResources:Bb,ShaderNode:Wp,Stack:bT,Switch:Cle,TBNViewMatrix:vA,VSMShadowFilter:hq,V_GGX_SmithCorrelated:vV,Var:SG,abs:gr,acesFilmicToneMapping:JV,acos:t5,add:gs,addMethodChaining:tt,addNodeElement:sue,agxToneMapping:eq,all:Qk,alphaT:MS,and:Ok,anisotropy:Vf,anisotropyB:PA,anisotropyT:N_,any:Kk,append:Lle,array:Mk,arrayBuffer:Dle,asin:tG,assign:Rk,atan:n5,atan2:vG,atomicAdd:gAe,atomicAnd:xAe,atomicFunc:xc,atomicLoad:pAe,atomicMax:yAe,atomicMin:vAe,atomicOr:bAe,atomicStore:mAe,atomicSub:_Ae,atomicXor:SAe,attenuationColor:$8,attenuationDistance:X8,attribute:Ih,attributeArray:Ade,backgroundBlurriness:HV,backgroundIntensity:YC,backgroundRotation:WV,batch:Kz,bentNormalView:Az,billboarding:Qfe,bitAnd:Fk,bitNot:kk,bitOr:Gk,bitXor:zk,bitangentGeometry:zue,bitangentLocal:Vue,bitangentView:fz,bitangentWorld:que,bitcast:Gle,blendBurn:lV,blendColor:Mce,blendDodge:uV,blendOverlay:hV,blendScreen:cV,blur:CV,bool:cc,buffer:i2,bufferAttribute:n2,bumpMap:pz,burn:Cce,bvec2:gk,bvec3:q8,bvec4:xk,bypass:BG,cache:P_,call:Ck,cameraFar:jf,cameraIndex:OT,cameraNear:Wf,cameraNormalMatrix:gue,cameraPosition:HG,cameraProjectionMatrix:e0,cameraProjectionMatrixInverse:pue,cameraViewMatrix:Fl,cameraWorldMatrix:mue,cbrt:pG,cdl:Nde,ceil:CT,checker:WAe,cineonToneMapping:ZV,clamp:hc,clearcoat:wS,clearcoatNormalView:yA,clearcoatRoughness:by,code:WT,color:pk,colorSpaceToWorking:LT,colorToDirection:kce,compute:IG,computeSkinning:oce,context:PT,convert:Sk,convertColorSpace:Xle,convertToTexture:lde,cos:uh,cross:DT,cubeTexture:Wm,cubeTextureBase:x5,cubeToUV:ou,dFdx:i5,dFdy:r5,dashSize:Rb,debug:VG,decrement:Xk,decrementBefore:Wk,defaultBuildStages:CC,defaultShaderStages:uk,defined:_y,degrees:Jk,deltaTime:zV,densityFog:Zde,densityFogFactor:V5,depth:C5,depthPass:Ide,difference:hG,diffuseColor:Di,directPointLight:yq,directionToColor:dV,directionToFaceDirection:Ag,dispersion:Y8,distance:cG,div:Ll,dodge:Nce,dot:fd,drawIndex:$z,dynamicBufferAttribute:OG,element:bk,emissive:LC,equal:K8,equals:lG,equirectUV:N5,exp:J8,exp2:qm,expression:Oh,faceDirection:_5,faceForward:c5,faceforward:zle,float:me,floor:ic,fog:wy,fract:zh,frameGroup:wk,frameId:Gfe,frontFacing:$G,fwidth:oG,gain:Lfe,gapSize:OC,getConstNodeType:Ak,getCurrentStack:V8,getDirection:MV,getDistanceAttenuation:Q5,getGeometryRoughness:yV,getNormalFromDepth:cde,getParallaxCorrectNormal:spe,getRoughness:P5,getScreenPosition:ude,getShIrradianceAt:Nq,getShadowMaterial:fq,getShadowRenderObjectFunction:dq,getTextureIndex:kV,getViewPosition:Pp,globalId:rAe,glsl:Hde,glslFn:Wde,grayscale:wde,greaterThan:Z8,greaterThanEqual:Lk,hash:Pfe,highpModelNormalViewMatrix:UC,highpModelViewMatrix:BC,hue:Cde,increment:jk,incrementBefore:Hk,instance:Jue,instanceIndex:nd,instancedArray:pde,instancedBufferAttribute:DS,instancedDynamicBufferAttribute:IC,instancedMesh:Qz,int:be,inverseSqrt:e5,inversesqrt:Vle,invocationLocalIndex:Zue,invocationSubgroupIndex:Kue,ior:D_,iridescence:ET,iridescenceIOR:H8,iridescenceThickness:W8,ivec2:ws,ivec3:_k,ivec4:yk,js:Vde,label:bG,length:rc,lengthSq:a5,lessThan:Dk,lessThanEqual:Pk,lightPosition:W5,lightProjectionUV:oq,lightShadowMatrix:H5,lightTargetDirection:X5,lightTargetPosition:aq,lightViewPosition:j5,lightingContext:nV,lights:wAe,linearDepth:LS,linearToneMapping:QV,localId:sAe,log:RT,log2:nc,logarithmicDepthToViewZ:yce,luminance:G5,mat2:ST,mat3:Ro,mat4:DA,matcapUV:PV,materialAO:jz,materialAlphaTest:mz,materialAnisotropy:Dz,materialAnisotropyVector:Dp,materialAttenuationColor:kz,materialAttenuationDistance:Fz,materialClearcoat:Ez,materialClearcoatNormal:Mz,materialClearcoatRoughness:wz,materialColor:gz,materialDispersion:Wz,materialEmissive:yz,materialEnvIntensity:Db,materialEnvRotation:v5,materialIOR:Uz,materialIridescence:Pz,materialIridescenceIOR:Lz,materialIridescenceThickness:Oz,materialLightMap:S5,materialLineDashOffset:qz,materialLineDashSize:zz,materialLineGapSize:Vz,materialLineScale:Gz,materialLineWidth:Yue,materialMetalness:Sz,materialNormal:Tz,materialOpacity:b5,materialPointSize:Hz,materialReference:dh,materialReflectivity:Pb,materialRefractionRatio:ZG,materialRotation:Rz,materialRoughness:bz,materialSheen:Cz,materialSheenRoughness:Nz,materialShininess:_z,materialSpecular:vz,materialSpecularColor:xz,materialSpecularIntensity:VC,materialSpecularStrength:L_,materialThickness:Bz,materialTransmission:Iz,max:Hr,maxMipLevel:A5,mediumpModelViewMatrix:XG,metalness:xy,min:xa,mix:zi,mixElement:gG,mod:MT,modInt:$k,modelDirection:Sue,modelNormalMatrix:jG,modelPosition:Tue,modelRadius:Mue,modelScale:Eue,modelViewMatrix:t0,modelViewPosition:wue,modelViewProjection:T5,modelWorldMatrix:El,modelWorldMatrixInverse:Rue,morphReference:tV,mrt:GV,mul:jn,mx_aastep:Mq,mx_cell_noise_float:epe,mx_contrast:X0e,mx_fractal_noise_float:tpe,mx_fractal_noise_vec2:npe,mx_fractal_noise_vec3:ipe,mx_fractal_noise_vec4:rpe,mx_hsvtorgb:F0e,mx_noise_float:$0e,mx_noise_vec3:Y0e,mx_noise_vec4:Q0e,mx_ramplr:z0e,mx_ramptb:V0e,mx_rgbtohsv:k0e,mx_safepower:j0e,mx_splitlr:q0e,mx_splittb:H0e,mx_srgb_texture_to_lin_rec709:G0e,mx_transform_uv:W0e,mx_worley_noise_float:K0e,mx_worley_noise_vec2:Z0e,mx_worley_noise_vec3:J0e,negate:nG,neutralToneMapping:tq,nodeArray:NA,nodeImmutable:Pt,nodeObject:Ze,nodeObjects:e2,nodeProxy:st,normalFlat:YG,normalGeometry:IT,normalLocal:ba,normalMap:zC,normalView:Yi,normalViewGeometry:Hm,normalWorld:dd,normalWorldGeometry:QG,normalize:Lh,not:Bk,notEqual:Nk,numWorkgroups:nAe,objectDirection:_ue,objectGroup:Q8,objectPosition:WG,objectRadius:bue,objectScale:vue,objectViewPosition:xue,objectWorldMatrix:yue,oneMinus:iG,or:Ik,orthographicDepthToViewZ:_ce,oscSawtooth:Xfe,oscSine:Hfe,oscSquare:Wfe,oscTriangle:jfe,output:im,outputStruct:Nfe,overlay:Pce,overloadingFn:co,parabola:$C,parallaxDirection:dz,parallaxUV:Hue,parameter:Tfe,pass:Lde,passTexture:Ode,pcurve:Ofe,perspectiveDepthToViewZ:M5,pmremTexture:U5,pointShadow:_q,pointUV:gde,pointWidth:Ole,positionGeometry:s2,positionLocal:Zr,positionPrevious:PS,positionView:Jr,positionViewDirection:Er,positionWorld:xh,positionWorldDirection:g5,posterize:Pde,pow:Au,pow2:o5,pow3:fG,pow4:dG,premultiplyAlpha:fV,property:vh,radians:Zk,rand:mG,range:eAe,rangeFog:Kde,rangeFogFactor:z5,reciprocal:sG,reference:ar,referenceBuffer:FC,reflect:uG,reflectVector:tz,reflectView:JG,reflector:ide,refract:u5,refractVector:nz,refractView:ez,reinhardToneMapping:KV,remap:FG,remapClamp:kG,renderGroup:pn,renderOutput:zG,rendererReference:DG,rotate:qT,rotateUV:$fe,roughness:qu,round:rG,rtt:qV,sRGBTransferEOTF:MG,sRGBTransferOETF:RG,sample:fde,sampler:cue,samplerComparison:hue,saturate:l5,saturation:Mde,screen:Dce,screenCoordinate:a2,screenSize:Ey,screenUV:bh,scriptable:Qde,scriptableValue:Ib,select:js,setCurrentStack:yy,shaderStages:NC,shadow:pq,shadowPositionWorld:Y5,shapeCircle:jAe,sharedUniformGroup:wT,sheen:_A,sheenRoughness:TT,shiftLeft:Vk,shiftRight:qk,shininess:RS,sign:Ty,sin:Xa,sinc:Ife,skinning:Jz,smoothstep:fc,smoothstepElement:_G,specularColor:na,specularF90:Sy,spherizeUV:Yfe,split:Ple,spritesheetUV:Jfe,sqrt:yc,stack:Lb,step:NT,stepElement:yG,storage:LA,storageBarrier:uAe,storageObject:sce,storageTexture:jV,string:Nle,struct:Cfe,sub:vi,subBuild:rm,subgroupIndex:Que,subgroupSize:oAe,tan:eG,tangentGeometry:UT,tangentLocal:o2,tangentView:FT,tangentWorld:hz,temp:EG,texture:ui,texture3D:XV,textureBarrier:cAe,textureBicubic:lhe,textureBicubicLevel:O5,textureCubeUV:RV,textureLoad:Qr,textureSize:td,textureStore:yde,thickness:j8,time:n0,timerDelta:qfe,timerGlobal:Vfe,timerLocal:zfe,toneMapping:PG,toneMappingExposure:LG,toonOutlinePass:Ude,transformDirection:AG,transformNormal:KG,transformNormalToView:y5,transformedClearcoatNormalView:Pue,transformedNormalView:Nue,transformedNormalWorld:Due,transmission:CS,transpose:aG,triNoise3D:Ufe,triplanarTexture:ede,triplanarTextures:VV,trunc:s5,uint:Vt,uniform:ln,uniformArray:Tl,uniformCubeTexture:Oue,uniformGroup:Ek,uniformTexture:uue,unpremultiplyAlpha:Rce,userData:Sde,uv:Tr,uvec2:mk,uvec3:dg,uvec4:vk,varying:vc,varyingProperty:vy,vec2:dt,vec3:Me,vec4:an,vectorComponents:ZA,velocity:Ede,vertexColor:aV,vertexIndex:Xz,vertexStage:wG,vibrance:Rde,viewZToLogarithmicDepth:R5,viewZToOrthographicDepth:om,viewZToPerspectiveDepth:sV,viewport:sm,viewportCoordinate:rV,viewportDepthTexture:w5,viewportLinearDepth:vce,viewportMipTexture:E5,viewportResolution:pce,viewportSafeUV:Kfe,viewportSharedTexture:Fce,viewportSize:iV,viewportTexture:mce,viewportUV:Ace,wgsl:qde,wgslFn:jde,workgroupArray:dAe,workgroupBarrier:lAe,workgroupId:iAe,workingToColorSpace:CG,xor:Uk});const eu=new F5;class ope extends Ad{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(s===null)r._clearColor.getRGB(eu),eu.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(eu),eu.a=1,o=!0;else if(s.isNode===!0){const u=this.get(e),h=s;eu.copy(r._clearColor);let d=u.backgroundMesh;if(d===void 0){let E=function(){s.removeEventListener("dispose",E),d.material.dispose(),d.geometry.dispose()};var l=E;const x=PT(an(h).mul(YC),{getUV:()=>WV.mul(QG),getTextureLevel:()=>HV});let b=T5;b=b.setZ(b.w);const R=new ts;R.name="Background.material",R.side=Zi,R.depthTest=!1,R.depthWrite=!1,R.allowOverride=!1,R.fog=!1,R.lights=!1,R.vertexNode=b,R.colorNode=x,u.backgroundMeshNode=x,u.backgroundMesh=d=new Ri(new _c(1,32,32),R),d.frustumCulled=!1,d.name="Background.mesh",d.onBeforeRender=function(w,L,D){this.matrixWorld.copyPosition(D.matrixWorld)},s.addEventListener("dispose",E)}const _=h.getCacheKey();u.backgroundCacheKey!==_&&(u.backgroundMeshNode.node=an(h).mul(YC),u.backgroundMeshNode.needsUpdate=!0,d.material.needsUpdate=!0,u.backgroundCacheKey=_),t.unshift(d,d.geometry,d.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",s);const a=r.xr.getEnvironmentBlendMode();if(a==="additive"?eu.set(0,0,0,1):a==="alpha-blend"&&eu.set(0,0,0,0),r.autoClear===!0||o===!0){const u=n.clearColorValue;u.r=eu.r,u.g=eu.g,u.b=eu.b,u.a=eu.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(u.r*=u.a,u.g*=u.a,u.b*=u.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let ape=0;class QC{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=ape++}}class lpe{constructor(e,t,n,r,s,o,a,l,u,h=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=h,this.nodeAttributes=r,this.bindings=s,this.updateNodes=o,this.updateBeforeNodes=a,this.updateAfterNodes=l,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new QC(t.name,[],t.index,t);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class bI{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class upe{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class Dq{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class cpe extends Dq{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class hpe{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let fpe=0;class wM{constructor(e=null){this.id=fpe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class dpe{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class pd{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Ape extends pd{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class ppe extends pd{constructor(e,t=new it){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class mpe extends pd{constructor(e,t=new ce){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class gpe extends pd{constructor(e,t=new mn){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class _pe extends pd{constructor(e,t=new Jt){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class ype extends pd{constructor(e,t=new dT){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class vpe extends pd{constructor(e,t=new Hn){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class xpe extends pd{constructor(e,t=new Cn){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class bpe extends Ape{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Spe extends ppe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Tpe extends mpe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Epe extends gpe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class wpe extends _pe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Mpe extends ype{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Rpe extends vpe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Cpe extends xpe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const SI=new WeakMap,Npe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),Ix=i=>/e/g.test(i)?String(i).replace(/\+/g,""):(i=Number(i),i+(i%1?"":".0"));class Pq{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=Lb(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new wM,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.currentStack=null,this.subBuildFn=null}getBindGroupsCache(){let e=SI.get(this.renderer);return e===void 0&&(e=new yu,SI.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new Fh(e,t,n)}createCubeRenderTarget(e,t){return new AV(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let s=!0;for(const a of t)r.push(a),s=s&&a.groupNode.shared!==!0;let o;return s?(o=n.get(r),o===void 0&&(o=new QC(e,r,this.bindingsIndexes[e].group,r),n.set(r,o))):o=new QC(e,r,this.bindingsIndexes[e].group,r),o}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of NC)for(const s in n[r]){const o=n[r][s];(t[s]||(t[s]=[])).push(...o)}e=[];for(const r in t){const s=t[r],o=this._getBindGroup(r,s);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Kn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==Kn.NONE&&this.updateBeforeNodes.push(e.getSelf()),n!==Kn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Ms||e.magFilter===Zp||e.magFilter===ph||e.magFilter===ua||e.minFilter===Ms||e.minFilter===Zp||e.minFilter===ph||e.minFilter===ua}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new wM(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const o=n?n[s]:null;o!==null?r+=o.build(this,e):r+=this.generateConst(e),s<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const s of t){const{name:o,type:a}=s;n&&n[o]&&n[o].isNode?r.push(n[o].build(this,a)):r.push(this.generateConst(a))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Jt:e==="vec2"?t=new it:e==="vec3"?t=new ce:e==="vec4"&&(t=new mn)),e==="float")return Ix(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${Ix(t.r)}, ${Ix(t.g)}, ${Ix(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),s=o=>this.generateConst(r,o);if(n===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(n===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const s of n)if(s.name===e)return s;const r=new bI(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Hs)return"int";if(t===mr)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=ik(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return Npe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,s=e.normalized;let o;return!(e instanceof u9)&&s!==!0&&(o=this.getTypeFromArray(n)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=Lb(this.stack),this.stacks.push(V8()||this.stack),yy(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,yy(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={});let s=r[t];const o=r.any?r.any.subBuilds:null,a=this.getClosestSubBuild(o);return a&&(s.subBuildsCache===void 0&&(s.subBuildsCache={}),s=s.subBuildsCache[a]||(s.subBuildsCache[a]={}),s.subBuilds=o),s}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let r=n.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new bI("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const s=this.getDataFromNode(e,r,this.globalCache);let o=s.structType;if(o===void 0){const a=this.structs.index++;n===null&&(n="StructType"+a),o=new dpe(n,t),this.structs[r].push(o),s.structType=o}return o}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const s=this.getDataFromNode(e,n,this.globalCache);let o=s.uniform;if(o===void 0){const a=this.uniforms.index++;o=new upe(r||"nodeUniform"+a,t,e),this.uniforms[n].push(o),this.registerDeclaration(o),s.uniform=o}return o}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,s=!1){const o=this.getDataFromNode(e,r),a=this.getSubBuildProperty("variable",o.subBuilds);let l=o[a];if(l===void 0){const u=s?"_const":"_var",h=this.vars[r]||(this.vars[r]=[]),d=this.vars[u]||(this.vars[u]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+d,this.vars[u]++),a!=="variable"&&(t=this.getSubBuildProperty(t,o.subBuilds));const _=this.getArrayCount(e);l=new Dq(t,n,s,_),s||h.push(l),this.registerDeclaration(l),o[a]=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,s=null){const o=this.getDataFromNode(e,"any"),a=this.getSubBuildProperty("varying",o.subBuilds);let l=o[a];if(l===void 0){const u=this.varyings,h=u.length;t===null&&(t="nodeVarying"+h),a!=="varying"&&(t=this.getSubBuildProperty(t,o.subBuilds)),l=new cpe(t,n,r,s),u.push(l),this.registerDeclaration(l),o[a]=l}return l}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let s=1,o=r;for(;n[o]!==void 0;)o=r+"_"+s++;s>1&&(e.name=o,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${o}'.`)),n[o]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const o=this.codes[n]||(this.codes[n]=[]),a=o.length;s=new hpe("nodeCode"+a,t),o.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,o=t;for(;o;){if(r.get(o)===!0){s=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(s)for(const a of n)this.addLineFlowCode(a)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),o.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new nq,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let o=0;const a=Object.values(this);return{next:()=>({value:a[o],done:o++>=a.length})}}};for(const o of t.inputs)n[o.name]=new UV(o.type,o.name);e.layout=null;const r=e.call(n),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,s=this.declarations,o=this.cache,a=this.buildStage,l=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new wM,this.stack=Lb();for(const h of CC)this.setBuildStage(h),u.result=e.build(this,t);return u.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=s,this.cache=o,this.stack=l,this.setBuildStage(a),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const s=this.tab,o=this.cache,a=this.shaderStage,l=this.context;this.setShaderStage(e);const u={...this.context};delete u.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=u;let h=null;if(this.buildStage==="generate"){const d=this.flowChildNode(t,n);r!==null&&(d.code+=`${this.tab+r} = ${d.result};
`),this.flowCode[e]=this.flowCode[e]+d.code,h=d}else h=t.build(this);return this.setShaderStage(a),this.cache=o,this.tab=s,this.context=l,h}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(e&&e.isNode?e.isShaderCallNodeInternal?t=e.shaderNode.subBuilds:e.isStackNode?t=[e.subBuild]:t=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?t=[...e]:t=e,!t)return null;const n=this.subBuildLayers;for(let r=t.length-1;r>=0;r--){const s=t[r];if(n.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let n;t!==null?n=this.getClosestSubBuild(t):n=this.subBuildFn;let r;return n?r=e?n+"_"+e:n:r=e,r}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new ts),r.build(this)}else this.addFlow("compute",e);for(const r of CC){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of NC){this.setShaderStage(s);const o=this.flowNodes[s];for(const a of o)r==="generate"?this.flowNode(a):a.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new bpe(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new Spe(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new Tpe(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new Epe(e);if(t==="color")return new wpe(e);if(t==="mat2")return new Mpe(e);if(t==="mat3")return new Rpe(e);if(t==="mat4")return new Cpe(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),s=this.getTypeLength(n);return r===16&&s===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&s===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||s>4||s===0?e:r===s?`${this.getType(n)}( ${e} )`:r>s?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),n)):s===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${og} - Node System
`}*[Symbol.iterator](){}}class TI{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===Kn.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(n,this.frameId)}else if(t===Kn.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(n,this.renderId)}else t===Kn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===Kn.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(n,this.frameId)}else if(t===Kn.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(n,this.renderId)}else t===Kn.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===Kn.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.frameId&&e.update(this)!==!1&&r.set(n,this.frameId)}else if(t===Kn.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.renderId&&e.update(this)!==!1&&r.set(n,this.renderId)}else t===Kn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class J5{constructor(e,t,n=null,r="",s=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=s}}J5.isNodeFunctionInput=!0;class Dpe extends i0{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:X5(this.light),lightColor:e}}}const MM=new Cn,Bx=new Cn;let j1=null;class Ppe extends i0{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=ln(new ce).setGroup(pn),this.halfWidth=ln(new ce).setGroup(pn),this.updateType=Kn.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;Bx.identity(),MM.copy(t.matrixWorld),MM.premultiply(n),Bx.extractRotation(MM),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(Bx),this.halfHeight.value.applyMatrix4(Bx)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=ui(j1.LTC_FLOAT_1),n=ui(j1.LTC_FLOAT_2)):(t=ui(j1.LTC_HALF_1),n=ui(j1.LTC_HALF_2));const{colorNode:r,light:s}=this,o=j5(s);return{lightColor:r,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){j1=e}}class e6 extends i0{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=ln(0).setGroup(pn),this.penumbraCosNode=ln(0).setGroup(pn),this.cutoffDistanceNode=ln(0).setGroup(pn),this.decayExponentNode=ln(0).setGroup(pn),this.colorNode=ln(this.color).setGroup(pn)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return fc(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=oq(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:s}=this,o=this.getLightVector(e),a=o.normalize(),l=a.dot(X5(s)),u=this.getSpotAttenuation(e,l),h=o.length(),d=Q5({lightDistance:h,cutoffDistance:n,decayExponent:r});let _=t.mul(u).mul(d),x,b;return s.colorNode?(b=this.getLightCoord(e),x=s.colorNode(b)):s.map&&(b=this.getLightCoord(e),x=ui(s.map,b.xy).onRenderUpdate(()=>s.map)),x&&(_=b.mul(2).sub(1).abs().lessThan(1).all().select(_.mul(x),_)),{lightColor:_,lightDirection:a}}}class Lpe extends e6{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const s=t.acos().mul(1/Math.PI);r=ui(n,dt(s,0),0).r}else r=super.getSpotAttenuation(t);return r}}const Ope=Ce(([i,e])=>{const t=i.abs().sub(e);return rc(Hr(t,0)).add(xa(Hr(t.x,t.y),0))});class Ipe extends e6{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=this.penumbraCosNode,n=this.getLightCoord(e),r=n.xyz.div(n.w),s=Ope(r.xy.sub(dt(.5)),dt(.5)),o=Ll(-1,vi(1,t5(t)).sub(1));return l5(s.mul(-2).mul(o))}}class Bpe extends i0{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Upe extends i0{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=W5(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=ln(new Jt).setGroup(pn)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,o=dd.dot(r).mul(.5).add(.5),a=zi(n,t,o);e.context.irradiance.addAssign(a)}}class Fpe extends i0{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new ce);this.lightProbe=Tl(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=Nq(dd,this.lightProbe);e.context.irradiance.addAssign(t)}}class Lq{parseFunction(){console.warn("Abstract function.")}}class t6{constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){console.warn("Abstract function.")}}t6.isNodeFunction=!0;const kpe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,Gpe=/[a-z_0-9]+/ig,EI="#pragma main",zpe=i=>{i=i.trim();const e=i.indexOf(EI),t=e!==-1?i.slice(e+EI.length):i,n=t.match(kpe);if(n!==null&&n.length===5){const r=n[4],s=[];let o=null;for(;(o=Gpe.exec(r))!==null;)s.push(o);const a=[];let l=0;for(;l<s.length;){const b=s[l][0]==="const";b===!0&&l++;let R=s[l][0];R==="in"||R==="out"||R==="inout"?l++:R="";const E=s[l++][0];let w=Number.parseInt(s[l][0]);Number.isNaN(w)===!1?l++:w=null;const L=s[l++][0];a.push(new J5(E,L,w,R,b))}const u=t.substring(n[0].length),h=n[3]!==void 0?n[3]:"",d=n[2],_=n[1]!==void 0?n[1]:"",x=e!==-1?i.slice(0,e):"";return{type:d,inputs:a,name:h,precision:_,inputsCode:r,blockCode:u,headerCode:x}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class Vpe extends t6{constructor(e){const{type:t,inputs:n,name:r,precision:s,inputsCode:o,blockCode:a,headerCode:l}=zpe(e);super(t,n,r,s),this.inputsCode=o,this.blockCode=a,this.headerCode=l}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:s,headerCode:o,precision:a}=this;let l=`${r} ${e} ( ${s.trim()} )`;a!==""&&(l=`${a} ${l}`),t=o+l+n}else t="";return t}}class qpe extends Lq{parseFunction(e){return new Vpe(e)}}const wI=new WeakMap,Bu=[],Yd=[];class Hpe extends Ad{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new TI,this.nodeBuilderCache=new Map,this.callHashCache=new yu,this.groupsData=new yu,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===Q8.name)return!0;if(n===pn.name){const s=this.get(e),o=this.nodeFrame.renderId;return s.renderId!==o?(s.renderId=o,!0):!1}if(n===wk.name){const s=this.get(e),o=this.nodeFrame.frameId;return s.frameId!==o?(s.frameId=o,!0):!1}Bu[0]=t,Bu[1]=e;let r=this.groupsData.get(Bu);return r===void 0&&this.groupsData.set(Bu,r={}),Bu.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(n=r.get(s),n===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&o.enableMultiview(),o.build(),n=this._createNodeBuilderState(o),r.set(s,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new lpe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Bu[0]=e,Bu[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(Bu)||{};if(r.callId!==n){const s=this.getEnvironmentNode(e),o=this.getFogNode(e);t&&Yd.push(t.getCacheKey(!0)),s&&Yd.push(s.getCacheKey()),o&&Yd.push(o.getCacheKey()),Yd.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),Yd.push(this.renderer.shadowMap.enabled?1:0),r.callId=n,r.cacheKey=yT(Yd),this.callHashCache.set(Bu,r),Yd.length=0}return Bu.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const s=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===Am||n.mapping===pm||n.mapping===FA){if(e.backgroundBlurriness>0||n.mapping===FA)return U5(n);{let o;return n.isCubeTexture===!0?o=Wm(n):o=ui(n),mV(o)}}else{if(n.isTexture===!0)return ui(n,bh.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=s,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=s.get(t);return(o===void 0||r)&&(o=n(),s.set(t,o)),o}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const s=ar("color","color",n).setGroup(pn),o=ar("density","float",n).setGroup(pn);return wy(s,V5(o))}else if(n.isFog){const s=ar("color","color",n).setGroup(pn),o=ar("near","float",n).setGroup(pn),a=ar("far","float",n).setGroup(pn);return wy(s,z5(o,a))}else console.error("THREE.Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return Wm(n);if(n.isTexture===!0)return ui(n);console.error("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,s=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=n,o.camera=r,o.material=s,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return wI.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?XV(e,Me(bh,r2("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):ui(e,bh).renderOutput(t.toneMapping,t.currentColorSpace);return wI.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new TI,this.nodeBuilderCache=new Map,this.cacheLib={}}}const RM=new Gu;class US{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Hn,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let s=0;s<r;s++){RM.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=t[n+s],a=RM.normal;o.x=-a.x,o.y=-a.y,o.z=-a.z,o.w=RM.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,s=r.length;let o,a;if(this.clipIntersection?(o=this.intersectionPlanes,a=e.intersectionPlanes.length):(o=this.unionPlanes,a=e.unionPlanes.length),o.length!==a+s){o.length=a+s;for(let l=0;l<s;l++)o[a+l]=new mn;n=!0}this.projectPlanes(r,o,a),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new US(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class Wpe{constructor(e,t){this.bundleGroup=e,this.camera=t}}const X1=[];class jpe{constructor(){this.bundles=new yu}get(e,t){const n=this.bundles;X1[0]=e,X1[1]=t;let r=n.get(X1);return r===void 0&&(r=new Wpe(e,t),n.set(X1,r)),X1.length=0,r}dispose(){this.bundles=new yu}}class Oq{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const Xpe=new $5,$1=[];class $pe extends yu{constructor(){super()}createNode(e=[]){return new $5().setLights(e)}getNode(e,t){if(e.isQuadMesh)return Xpe;$1[0]=e,$1[1]=t;let n=this.get($1);return n===void 0&&(n=this.createNode(),this.set($1,n)),$1.length=0,n}}class d_ extends Fh{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const MI=new ce,RI=new ce;class Ype extends gc{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Ws,this._cameraL.viewport=new mn,this._cameraR=new Ws,this._cameraR.viewport=new mn,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new R9,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._frameBufferTargets=null,this._createXRLayer=tme.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new it,this._onSessionEvent=Zpe.bind(this),this._onSessionEnd=Jpe.bind(this),this._onInputSourcesChange=eme.bind(this),this._onAnimationFrame=nme.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,s,o,a,l={}){const u=new $y(e,t),h=new d_(s,o,{format:es,type:Vr,depthTexture:new Ja(s,o,l.stencil?Ya:mr,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?Ka:Qa),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});h._autoAllocateDepthBuffer=!0;const d=new $a({color:16777215,side:ma});d.map=h.texture,d.map.offset.y=1,d.map.repeat.y=-1;const _=new Ri(u,d);_.position.copy(n),_.quaternion.copy(r);const x={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:s,pixelheight:o,plane:_,material:d,rendercall:a,renderTarget:h};if(this._layers.push(x),this._session!==null){x.plane.material=new $a({color:16777215,side:ma}),x.plane.material.blending=Kp,x.plane.material.blendEquation=bo,x.plane.material.blendSrc=ah,x.plane.material.blendDst=ah,x.xrlayer=this._createXRLayer(x);const b=this._session.renderState.layers;b.unshift(x.xrlayer),this._session.updateRenderState({layers:b})}else h.isXRRenderTarget=!1;return _}createCylinderLayer(e,t,n,r,s,o,a,l,u={}){const h=new fT(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),d=new d_(o,a,{format:es,type:Vr,depthTexture:new Ja(o,a,u.stencil?Ya:mr,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Ka:Qa),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});d._autoAllocateDepthBuffer=!0;const _=new $a({color:16777215,side:Zi});_.map=d.texture,_.map.offset.y=1,_.map.repeat.y=-1;const x=new Ri(h,_);x.position.copy(r),x.quaternion.copy(s);const b={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:s,pixelwidth:o,pixelheight:a,plane:x,material:_,rendercall:l,renderTarget:d};if(this._layers.push(b),this._session!==null){b.plane.material=new $a({color:16777215,side:Zi}),b.plane.material.blending=Kp,b.plane.material.blendEquation=bo,b.plane.material.blendSrc=ah,b.plane.material.blendDst=ah,b.xrlayer=this._createXRLayer(b);const R=this._session.renderState.layers;R.unshift(b.xrlayer),this._session.updateRenderState({layers:R})}else d.isXRRenderTarget=!1;return x}renderLayers(){const e=new ce,t=new _u,n=this._renderer,r=this.isPresenting,s=n.getOutputRenderTarget(),o=n._frameBufferTarget;this.isPresenting=!1;const a=new it;n.getSize(a);const l=n._quad;for(const u of this._layers)if(u.renderTarget.isXRRenderTarget=this._session!==null,u.renderTarget._hasExternalTextures=u.renderTarget.isXRRenderTarget,u.renderTarget.isXRRenderTarget&&this._supportsLayers){u.xrlayer.transform=new XRRigidTransform(u.plane.getWorldPosition(e),u.plane.getWorldQuaternion(t));const h=this._glBinding.getSubImage(u.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(u.renderTarget,h.colorTexture,void 0),n._setXRLayerSize(u.renderTarget.width,u.renderTarget.height),n.setOutputRenderTarget(u.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:d,quad:_}=this._frameBufferTargets.get(u.renderTarget)||{frameBufferTarget:null,quad:null};d?(n._frameBufferTarget=d,n._quad=_):(n._quad=new HT(new ts),this._frameBufferTargets.set(u.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),u.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(u.renderTarget),u.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(s),n._frameBufferTarget=o,n._setXRLayerSize(a.x,a.y),n._quad=l,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,s=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let o=null,a=null,l=null;t.depth&&(l=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,o=t.stencil?Ka:Qa,a=t.stencil?Ya:mr);const u={colorFormat:r.RGBA8,depthFormat:l,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0);const h=new XRWebGLBinding(e,r),d=h.createProjectionLayer(u),_=[d];this._glBinding=h,this._glProjLayer=d,t.setPixelRatio(1),t._setXRLayerSize(d.textureWidth,d.textureHeight);const x=this._useMultiview?2:1,b=new Ja(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,o,x);if(this._xrRenderTarget=new d_(d.textureWidth,d.textureHeight,{format:es,type:Vr,colorSpace:t.outputColorSpace,depthTexture:b,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const R of this._layers)R.plane.material=new $a({color:16777215,side:R.type==="cylinder"?Zi:ma}),R.plane.material.blending=Kp,R.plane.material.blendEquation=bo,R.plane.material.blendSrc=ah,R.plane.material.blendDst=ah,R.xrlayer=this._createXRLayer(R),_.unshift(R.xrlayer);e.updateRenderState({layers:_})}else{const o={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},a=new XRWebGLLayer(e,r,o);this._glBaseLayer=a,e.updateRenderState({baseLayer:a}),t.setPixelRatio(1),t._setXRLayerSize(a.framebufferWidth,a.framebufferHeight),this._xrRenderTarget=new d_(a.framebufferWidth,a.framebufferHeight,{format:es,type:Vr,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:a.ignoreDepthValues===!1,resolveStencilBuffer:a.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,s=this._cameraXR,o=this._cameraL,a=this._cameraR;s.near=a.near=o.near=n,s.far=a.far=o.far=r,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),o.layers.mask=e.layers.mask|2,a.layers.mask=e.layers.mask|4,s.layers.mask=o.layers.mask|a.layers.mask;const l=e.parent,u=s.cameras;CI(s,l);for(let h=0;h<u.length;h++)CI(u[h],l);u.length===2?Qpe(s,o,a):s.projectionMatrix.copy(o.projectionMatrix),Kpe(e,s,l)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new _b,this._controllers[e]=t),t}}function Qpe(i,e,t){MI.setFromMatrixPosition(e.matrixWorld),RI.setFromMatrixPosition(t.matrixWorld);const n=MI.distanceTo(RI),r=e.projectionMatrix.elements,s=t.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],h=(r[8]-1)/r[0],d=(s[8]+1)/s[0],_=o*h,x=o*d,b=n/(-h+d),R=b*-h;if(e.matrixWorld.decompose(i.position,i.quaternion,i.scale),i.translateX(R),i.translateZ(b),i.matrixWorld.compose(i.position,i.quaternion,i.scale),i.matrixWorldInverse.copy(i.matrixWorld).invert(),r[10]===-1)i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const E=o+b,w=a+b,L=_-R,D=x+(n-R),O=l*a/w*E,B=u*a/w*E;i.projectionMatrix.makePerspective(L,D,O,B,E,w),i.projectionMatrixInverse.copy(i.projectionMatrix).invert()}}function CI(i,e){e===null?i.matrixWorld.copy(i.matrix):i.matrixWorld.multiplyMatrices(e.matrixWorld,i.matrix),i.matrixWorldInverse.copy(i.matrixWorld).invert()}function Kpe(i,e,t){t===null?i.matrix.copy(e.matrixWorld):(i.matrix.copy(t.matrixWorld),i.matrix.invert(),i.matrix.multiply(e.matrixWorld)),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld(!0),i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse),i.isPerspectiveCamera&&(i.fov=zA*2*Math.atan(1/i.projectionMatrix.elements[5]),i.zoom=1)}function Zpe(i){const e=this._controllerInputSources.indexOf(i.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(i.inputSource,i.frame,n),t.dispatchEvent({type:i.type,data:i.inputSource})}}function Jpe(){const i=this._session,e=this._renderer;i.removeEventListener("select",this._onSessionEvent),i.removeEventListener("selectstart",this._onSessionEvent),i.removeEventListener("selectend",this._onSessionEvent),i.removeEventListener("squeeze",this._onSessionEvent),i.removeEventListener("squeezestart",this._onSessionEvent),i.removeEventListener("squeezeend",this._onSessionEvent),i.removeEventListener("end",this._onSessionEnd),i.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new d_(t.pixelwidth,t.pixelheight,{format:es,type:Vr,depthTexture:new Ja(t.pixelwidth,t.pixelheight,t.stencilBuffer?Ya:mr,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?Ka:Qa),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function eme(i){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<i.removed.length;n++){const r=i.removed[n],s=t.indexOf(r);s>=0&&(t[s]=null,e[s].disconnect(r))}for(let n=0;n<i.added.length;n++){const r=i.added[n];let s=t.indexOf(r);if(s===-1){for(let a=0;a<e.length;a++)if(a>=t.length){t.push(r),s=a;break}else if(t[a]===null){t[a]=r,s=a;break}if(s===-1)break}const o=e[s];o&&o.connect(r)}}function tme(i){return i.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(i.translation,i.quaternion),width:i.width/2,height:i.height/2,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(i.translation,i.quaternion),radius:i.radius,centralAngle:i.centralAngle,aspectRatio:i.aspectRatio,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1})}function nme(i,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,s=this._glBaseLayer,o=this.getReferenceSpace(),a=e.getViewerPose(o);if(this._xrFrame=e,a!==null){const l=a.views;this._glBaseLayer!==null&&r.setXRTarget(s.framebuffer);let u=!1;l.length!==t.cameras.length&&(t.cameras.length=0,u=!0);for(let h=0;h<l.length;h++){const d=l[h];let _;if(this._useLayers===!0){const b=this._glBinding.getViewSubImage(this._glProjLayer,d);_=b.viewport,h===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,b.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:b.depthStencilTexture)}else _=s.getViewport(d);let x=this._cameras[h];x===void 0&&(x=new Ws,x.layers.enable(h),x.viewport=new mn,this._cameras[h]=x),x.matrix.fromArray(d.transform.matrix),x.matrix.decompose(x.position,x.quaternion,x.scale),x.projectionMatrix.fromArray(d.projectionMatrix),x.projectionMatrixInverse.copy(x.projectionMatrix).invert(),x.viewport.set(_.x,_.y,_.width,_.height),h===0&&(t.matrix.copy(x.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),u===!0&&t.cameras.push(x)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let l=0;l<this._controllers.length;l++){const u=this._controllerInputSources[l],h=this._controllers[l];u!==null&&h!==void 0&&h.update(u,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(i,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const NI=new uT,Ux=new it,CM=new mn,NM=new cg,DM=new a8,Fx=new Cn,Cf=new mn;class ime{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:s=!0,stencil:o=!1,antialias:a=!1,samples:l=0,getFallback:u=null,colorBufferType:h=As,multiview:d=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=l||a===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=qs,this.toneMapping=_a,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=o,this.info=new lfe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new Oq,this.lighting=new $pe,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new mn(0,0,this._width,this._height),this._scissor=new mn(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new HT(new ts),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const _=this.alpha===!0?0:1;this._clearColor=new F5(0,0,0,_),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=h,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:P4},this.xr=new Ype(this,d),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(x,b,R)=>{await this.compileAsync(x,b);const E=this._renderLists.get(x,b),w=this._renderContexts.get(x,b,this._renderTarget),L=x.overrideMaterial||R.material,D=this._objects.get(R,L,x,b,E.lightsNode,w,w.clippingContext),{fragmentShader:O,vertexShader:B}=D.getNodeBuilderState();return{fragmentShader:O,vertexShader:B}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new Hpe(this,n),this._animation=new Jhe(this._nodes,this.info),this._attributes=new ofe(n),this._background=new ope(this,this._nodes),this._geometries=new afe(this._attributes,this.info),this._textures=new Sfe(this,n,this.info),this._pipelines=new ffe(n,this._nodes),this._bindings=new dfe(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new ife(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new mfe(this.lighting),this._bundles=new jpe,this._renderContexts=new xfe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,o=this._currentRenderContext,a=this._currentRenderObjectFunction,l=this._compilationPromises,u=e.isScene===!0?e:NI;n===null&&(n=e);const h=this._renderTarget,d=this._renderContexts.get(n,t,h),_=this._activeMipmapLevel,x=[];this._currentRenderContext=d,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=x,r.renderId++,r.update(),d.depth=this.depth,d.stencil=this.stencil,d.clippingContext||(d.clippingContext=new US),d.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,h);const b=this._renderLists.get(e,t);if(b.begin(),this._projectObject(e,t,0,b,d.clippingContext),n!==e&&n.traverseVisible(function(D){D.isLight&&D.layers.test(t.layers)&&b.pushLight(D)}),b.finish(),h!==null){this._textures.updateRenderTarget(h,_);const D=this._textures.get(h);d.textures=D.textures,d.depthTexture=D.depthTexture}else d.textures=null,d.depthTexture=null;this._background.update(u,b,d);const R=b.opaque,E=b.transparent,w=b.transparentDoublePass,L=b.lightsNode;this.opaque===!0&&R.length>0&&this._renderObjects(R,t,u,L),this.transparent===!0&&E.length>0&&this._renderTransparents(E,w,t,u,L),r.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=a,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(x)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=BC,this.overrideNodes.modelNormalViewMatrix=UC):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===BC&&this.overrideNodes.modelNormalViewMatrix===UC}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:s,renderList:o}=e,a=this._currentRenderContext,l=this._bundles.get(r,s),u=this.backend.get(l);u.renderContexts===void 0&&(u.renderContexts=new Set);const h=r.version!==u.version,d=u.renderContexts.has(a)===!1||h;if(u.renderContexts.add(a),d){this.backend.beginBundle(a),(u.renderObjects===void 0||h)&&(u.renderObjects=[]),this._currentRenderBundle=l;const{transparentDoublePass:_,transparent:x,opaque:b}=o;this.opaque===!0&&b.length>0&&this._renderObjects(b,s,t,n),this.transparent===!0&&x.length>0&&this._renderTransparents(x,_,s,t,n),this._currentRenderBundle=null,this.backend.finishBundle(a,l),u.version=r.version}else{const{renderObjects:_}=u;for(let x=0,b=_.length;x<b;x++){const R=_[x];this._nodes.needsRefresh(R)&&(this._nodes.updateBefore(R),this._nodes.updateForRender(R),this._bindings.updateForRender(R),this._nodes.updateAfter(R))}}this.backend.addBundle(a,l)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==_a===!1&&t!==pu===!1)return null;const{width:s,height:o}=this.getDrawingBufferSize(Ux),{depth:a,stencil:l}=this;let u=this._frameBufferTarget;u===null&&(u=new Fh(s,o,{depthBuffer:a,stencilBuffer:l,type:this._colorBufferType,format:es,colorSpace:pu,generateMipmaps:!1,minFilter:Ms,magFilter:Ms,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const h=this.getOutputRenderTarget();return u.depthBuffer=a,u.stencilBuffer=l,h!==null?u.setSize(h.width,h.height,h.depth):u.setSize(s,o,1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=h!==null?h.multiview:!1,u.resolveDepthBuffer=h!==null?h.resolveDepthBuffer:!0,u._autoAllocateDepthBuffer=h!==null?h._autoAllocateDepthBuffer:!1,u}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,u=e.isScene===!0?e:NI,h=this._renderTarget||this._outputRenderTarget,d=this._activeCubeFace,_=this._activeMipmapLevel;let x;r!==null?(x=r,this.setRenderTarget(x)):x=h;const b=this._renderContexts.get(e,t,x);this._currentRenderContext=b,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls;const R=this.coordinateSystem,E=this.xr;if(t.coordinateSystem!==R&&E.isPresenting===!1&&(t.coordinateSystem=R,t.updateProjectionMatrix(),t.isArrayCamera))for(const K of t.cameras)K.coordinateSystem=R,K.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),E.enabled===!0&&E.isPresenting===!0&&(E.cameraAutoUpdate===!0&&E.updateCamera(t),t=E.getCamera());let w=this._viewport,L=this._scissor,D=this._pixelRatio;x!==null&&(w=x.viewport,L=x.scissor,D=1),this.getDrawingBufferSize(Ux),CM.set(0,0,Ux.width,Ux.height);const O=w.minDepth===void 0?0:w.minDepth,B=w.maxDepth===void 0?1:w.maxDepth;b.viewportValue.copy(w).multiplyScalar(D).floor(),b.viewportValue.width>>=_,b.viewportValue.height>>=_,b.viewportValue.minDepth=O,b.viewportValue.maxDepth=B,b.viewport=b.viewportValue.equals(CM)===!1,b.scissorValue.copy(L).multiplyScalar(D).floor(),b.scissor=this._scissorTest&&b.scissorValue.equals(CM)===!1,b.scissorValue.width>>=_,b.scissorValue.height>>=_,b.clippingContext||(b.clippingContext=new US),b.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,x);const G=t.isArrayCamera?DM:NM;t.isArrayCamera||(Fx.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),G.setFromProjectionMatrix(Fx,R));const k=this._renderLists.get(e,t);if(k.begin(),this._projectObject(e,t,0,k,b.clippingContext),k.finish(),this.sortObjects===!0&&k.sort(this._opaqueSort,this._transparentSort),x!==null){this._textures.updateRenderTarget(x,_);const K=this._textures.get(x);b.textures=K.textures,b.depthTexture=K.depthTexture,b.width=K.width,b.height=K.height,b.renderTarget=x,b.depth=x.depthBuffer,b.stencil=x.stencilBuffer}else b.textures=null,b.depthTexture=null,b.width=this.domElement.width,b.height=this.domElement.height,b.depth=this.depth,b.stencil=this.stencil;b.width>>=_,b.height>>=_,b.activeCubeFace=d,b.activeMipmapLevel=_,b.occlusionQueryCount=k.occlusionQueryCount,this._background.update(u,k,b),b.camera=t,this.backend.beginRender(b);const{bundles:z,lightsNode:F,transparentDoublePass:q,transparent:H,opaque:Q}=k;return z.length>0&&this._renderBundles(z,u,F),this.opaque===!0&&Q.length>0&&this._renderObjects(Q,t,u,F),this.transparent===!0&&H.length>0&&this._renderTransparents(H,q,t,u,F),this.backend.finishRender(b),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,r!==null&&(this.setRenderTarget(h,d,_),this._renderOutput(x)),u.onAfterRender(this,e,t,x),b}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,s=0,o=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,n,r),a.minDepth=s,a.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null){this._textures.updateRenderTarget(r);const o=this._textures.get(r);s=this._renderContexts.getForClear(r),s.textures=o.textures,s.depthTexture=o.depthTexture,s.width=o.width,s.height=o.height,s.renderTarget=r,s.depth=r.depthBuffer,s.stencil=r.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,s),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){this._initialized===!1&&await this.init(),this.clear(e,t,n)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:_a}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:pu}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,s=this._pipelines,o=this._bindings,a=this._nodes,l=Array.isArray(e)?e:[e];if(l[0]===void 0||l[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const u of l){if(s.has(u)===!1){const _=()=>{u.removeEventListener("dispose",_),s.delete(u),o.delete(u),a.delete(u)};u.addEventListener("dispose",_);const x=u.onInitFunction;x!==null&&x.call(u,{renderer:this})}a.updateForCompute(u),o.updateForCompute(u);const h=o.getForCompute(u),d=s.getForCompute(u,h);r.compute(e,u,h,d)}r.finishCompute(e),t.renderId=n}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=Cf.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=Cf.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=Cf.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t)}copyTextureToTexture(e,t,n=null,r=null,s=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,s,o)}async readRenderTargetPixelsAsync(e,t,n,r,s,o=0,a=0){return this.backend.copyTextureToBuffer(e.textures[o],t,n,r,s,a)}_projectObject(e,t,n,r,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const l=t.isArrayCamera?DM:NM;if(!e.frustumCulled||l.intersectsSprite(e,t)){this.sortObjects===!0&&Cf.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Fx);const{geometry:u,material:h}=e;h.visible&&r.push(e,u,h,n,Cf.z,null,s)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const l=t.isArrayCamera?DM:NM;if(!e.frustumCulled||l.intersectsObject(e,t)){const{geometry:u,material:h}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),Cf.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(Fx)),Array.isArray(h)){const d=u.groups;for(let _=0,x=d.length;_<x;_++){const b=d[_],R=h[b.materialIndex];R&&R.visible&&r.push(e,u,R,n,Cf.z,b,s)}}else h.visible&&r.push(e,u,h,n,Cf.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=r;r=this._renderLists.get(e,t),r.begin(),l.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const a=e.children;for(let l=0,u=a.length;l<u;l++)this._projectObject(a[l],t,n,r,s)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,s){if(t.length>0){for(const{material:o}of t)o.side=Zi;this._renderObjects(t,n,r,s,"backSide");for(const{material:o}of t)o.side=ma;this._renderObjects(e,n,r,s);for(const{material:o}of t)o.side=ss}else this._renderObjects(e,n,r,s)}_renderObjects(e,t,n,r,s=null){for(let o=0,a=e.length;o<a;o++){const{object:l,geometry:u,material:h,group:d,clippingContext:_}=e[o];this._currentRenderObjectFunction(l,n,t,u,h,d,r,_,s)}}renderObject(e,t,n,r,s,o,a,l=null,u=null){let h,d,_;if(e.onBeforeRender(this,t,n,r,s,o),s.allowOverride===!0&&t.overrideMaterial!==null){const x=t.overrideMaterial;s.positionNode&&s.positionNode.isNode&&(h=x.positionNode,x.positionNode=s.positionNode),x.alphaTest=s.alphaTest,x.alphaMap=s.alphaMap,x.transparent=s.transparent||s.transmission>0,x.isShadowPassMaterial&&(x.side=s.shadowSide===null?s.side:s.shadowSide,s.depthNode&&s.depthNode.isNode&&(_=x.depthNode,x.depthNode=s.depthNode),s.castShadowNode&&s.castShadowNode.isNode&&(d=x.colorNode,x.colorNode=s.castShadowNode),s.castShadowPositionNode&&s.castShadowPositionNode.isNode&&(h=x.positionNode,x.positionNode=s.castShadowPositionNode)),s=x}s.transparent===!0&&s.side===ss&&s.forceSinglePass===!1?(s.side=Zi,this._handleObjectFunction(e,s,t,n,a,o,l,"backSide"),s.side=ma,this._handleObjectFunction(e,s,t,n,a,o,l,u),s.side=ss):this._handleObjectFunction(e,s,t,n,a,o,l,u),h!==void 0&&(t.overrideMaterial.positionNode=h),_!==void 0&&(t.overrideMaterial.depthNode=_),d!==void 0&&(t.overrideMaterial.colorNode=d),e.onAfterRender(this,t,n,r,s,o)}_renderObjectDirect(e,t,n,r,s,o,a,l){const u=this._objects.get(e,t,n,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o;const h=this._nodes.needsRefresh(u);h&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),h&&this._nodes.updateAfter(u)}_createObjectPipeline(e,t,n,r,s,o,a,l){const u=this._objects.get(e,t,n,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class n6{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function rme(i){return i+(Xf-i%Xf)%Xf}class Iq extends n6{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return rme(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class Bq extends Iq{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let sme=0;class Uq extends Bq{constructor(e,t){super("UniformBuffer_"+sme++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class ome extends Bq{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const s=this.uniforms[n],o=s.boundary,a=s.itemSize*e,l=t%Xf,u=l%o,h=l+u;t+=u,h!==0&&Xf-h<a&&(t+=Xf-h),s.offset=t/e,t+=a}return Math.ceil(t/Xf)*Xf}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(n[s]!==r){const a=this._getBufferForType(o);a[s]=n[s]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y){const a=this._getBufferForType(o);a[s+0]=n[s+0]=r.x,a[s+1]=n[s+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z){const a=this._getBufferForType(o);a[s+0]=n[s+0]=r.x,a[s+1]=n[s+1]=r.y,a[s+2]=n[s+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z||n[s+4]!==r.w){const a=this._getBufferForType(o);a[s+0]=n[s+0]=r.x,a[s+1]=n[s+1]=r.y,a[s+2]=n[s+2]=r.z,a[s+3]=n[s+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset;if(n[s+0]!==r.r||n[s+1]!==r.g||n[s+2]!==r.b){const o=this.buffer;o[s+0]=n[s+0]=r.r,o[s+1]=n[s+1]=r.g,o[s+2]=n[s+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;if(n[s+0]!==r[0]||n[s+1]!==r[1]||n[s+2]!==r[2]||n[s+4]!==r[3]||n[s+5]!==r[4]||n[s+6]!==r[5]||n[s+8]!==r[6]||n[s+9]!==r[7]||n[s+10]!==r[8]){const o=this.buffer;o[s+0]=n[s+0]=r[0],o[s+1]=n[s+1]=r[1],o[s+2]=n[s+2]=r[2],o[s+4]=n[s+4]=r[3],o[s+5]=n[s+5]=r[4],o[s+6]=n[s+6]=r[5],o[s+8]=n[s+8]=r[6],o[s+9]=n[s+9]=r[7],o[s+10]=n[s+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;return lme(n,r,s)===!1&&(this.buffer.set(r,s),ame(n,r,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function ame(i,e,t){for(let n=0,r=e.length;n<r;n++)i[t+n]=e[n]}function lme(i,e,t){for(let n=0,r=e.length;n<r;n++)if(i[t+n]!==e[n])return!1;return!0}let ume=0;class Fq extends ome{constructor(e,t){super(e),this.id=ume++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let cme=0;class hme extends n6{constructor(e,t){super(e),this.id=cme++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class XT extends hme{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class kq extends XT{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class Gq extends XT{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}const fme={textureDimensions:"textureSize",equals:"equal"},dme={low:"lowp",medium:"mediump",high:"highp"},DI={swizzleAssign:!0,storageBuffer:!1},PI={perspective:"smooth",linear:"noperspective"},LI={centroid:"centroid"},OI=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class Ame extends Pq{constructor(e,t){super(e,t,new qpe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Go}getMethod(e){return fme[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:s}=t,o=t.array.constructor.name.toLowerCase().includes("int");let a=o?ag:Hy;s===2?a=o?lg:mh:s===3?a=o?a$:qy:s===4&&(a=o?ug:es);const l={Float32Array:os,Uint8Array:Vr,Uint16Array:hu,Uint32Array:mr,Int8Array:EA,Int16Array:wA,Int32Array:Hs,Uint8ClampedArray:Vr},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let h=Math.ceil(r/s/u);u*h*s<r&&h++;const d=u*h*s,_=new n.constructor(d);_.set(n,0),t.array=_;const x=new dY(t.array,u,h,a,l[t.array.constructor.name]||os);x.needsUpdate=!0,x.isPBOTexture=!0;const b=new dc(x,null,null);b.setPrecision("high"),t.pboNode=b,t.pbo=b.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const h=this.renderer.backend.get(r);h.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(s);this.increaseUsage(n);const a=n.build(this,"uint"),l=this.getDataFromNode(e);let u=l.propertyName;if(u===void 0){const h=this.getVarFromNode(e);u=this.getPropertyName(h);const d=this.getDataFromNode(t);let _=d.propertySizeName;_===void 0&&(_=u+"Size",this.getVarFromNode(t,_,"uint"),this.addLineFlowCode(`${_} = uint( textureSize( ${o}, 0 ).x )`,e),d.propertySizeName=_);const{itemSize:x}=r,b="."+ZA.join("").slice(0,x),R=`ivec2(${a} % ${_}, ${a} / ${_})`,E=this.generateTextureLoad(null,o,R,null,"0");let w="vec4";r.pbo.type===mr?w="uvec4":r.pbo.type===Hs&&(w="ivec4"),this.addLineFlowCode(`${u} = ${w}(${E})${b}`,e),l.propertyName=u}return u}generateTextureLoad(e,t,n,r,s="0"){return r?`texelFetch( ${t}, ivec3( ${n}, ${r} ), ${s} )`:`texelFetch( ${t}, ${n}, ${s} )`}generateTexture(e,t,n,r){return e.isDepthTexture?(r&&(n=`vec4( ${n}, ${r} )`),`texture( ${t}, ${n} ).x`):(r&&(n=`vec3( ${n}, ${r} )`),`texture( ${t}, ${n} )`)}generateTextureLevel(e,t,n,r){return`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r){return`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r){return`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,s,o=this.shaderStage){if(o==="fragment")return s?`texture( ${t}, vec4( ${n}, ${s}, ${r} ) )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const o of t){let a=null,l=!1;if(o.type==="texture"||o.type==="texture3D"){const h=o.node.value;let d="";(h.isDataTexture===!0||h.isData3DTexture===!0)&&(h.type===mr?d="u":h.type===Hs&&(d="i")),o.type==="texture3D"&&h.isArrayTexture===!1?a=`${d}sampler3D ${o.name};`:h.compareFunction?h.isArrayTexture===!0?a=`sampler2DArrayShadow ${o.name};`:a=`sampler2DShadow ${o.name};`:h.isArrayTexture===!0||h.isDataArrayTexture===!0||h.isCompressedArrayTexture===!0?a=`${d}sampler2DArray ${o.name};`:a=`${d}sampler2D ${o.name};`}else if(o.type==="cubeTexture")a=`samplerCube ${o.name};`;else if(o.type==="buffer"){const h=o.node,d=this.getType(h.bufferType),_=h.bufferCount,x=_>0?_:"";a=`${h.name} {
	${d} ${o.name}[${x}];
};
`}else a=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,l=!0;const u=o.node.precision;if(u!==null&&(a=dme[u]+" "+a),l){a="	"+a;const h=o.groupNode.name;(r[h]||(r[h]=[])).push(a)}else a="uniform "+a,n.push(a)}let s="";for(const o in r){const a=r[o];s+=this._getGLSLUniformStruct(e+"_"+o,a.join(`
`))+`
`}return s+=n.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Hs){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const s of n)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const s of n)if(s.output)for(const o of s.members)r.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+s.name+` {
`;o+=this.getStructMembers(s),o+=`
};
`,t.push(o)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const s=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const o=PI[r.interpolationType]||r.interpolationType,a=LI[r.interpolationSampling]||"";t+=`${o} ${a} out ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}out ${s} ${r.name};
`}else t+=`${s} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const s=this.getType(r.type);if(r.interpolationType){const o=PI[r.interpolationType]||r.interpolationType,a=LI[r.interpolationSampling]||"";t+=`${o} ${a} in ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}in ${s} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:s}of n.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=DI[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}DI[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],s=this.getPropertyName(r.attributeNode);s&&(t+=`${r.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${OI}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${OI}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const a of r){const l=this.getFlowData(a),u=a.name;u&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${u}
	`),n+=`${l.code}
	`,a===s&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${l.result};`):t==="fragment"&&(a.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${l.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);let a=o.uniformGPU;if(a===void 0){const l=e.groupNode,u=l.name,h=this.getBindGroupArray(u,n);if(t==="texture")a=new XT(s.name,s.node,l),h.push(a);else if(t==="cubeTexture")a=new kq(s.name,s.node,l),h.push(a);else if(t==="texture3D")a=new Gq(s.name,s.node,l),h.push(a);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,s.name=`buffer${e.id}`;const d=new Uq(e,l);d.name=e.name,h.push(d),a=d}else{const d=this.uniformGroups[n]||(this.uniformGroups[n]={});let _=d[u];_===void 0&&(_=new Fq(n+"_"+u,l),d[u]=_,h.push(_)),a=this.getNodeUniform(s,t),_.addUniform(a)}o.uniformGPU=a}return s}}let PM=null,_p=null;class zq{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Za("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){Za(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return PM=PM||new it,this.renderer.getDrawingBufferSize(PM)}setScissorTest(){}getClearColor(){const e=this.renderer;return _p=_p||new F5,e.getClearColor(_p),_p.getRGB(_p),_p}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:a9(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${og} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let pme=0;class mme{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class gme{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,s=e.array,o=e.usage||r.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,l=n.get(a);let u=l.bufferGPU;u===void 0&&(u=this._createBuffer(r,t,s,o),l.bufferGPU=u,l.bufferType=t,l.version=a.version);let h;if(s instanceof Float32Array)h=r.FLOAT;else if(typeof Float16Array<"u"&&s instanceof Float16Array)h=r.HALF_FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?h=r.HALF_FLOAT:h=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)h=r.SHORT;else if(s instanceof Uint32Array)h=r.UNSIGNED_INT;else if(s instanceof Int32Array)h=r.INT;else if(s instanceof Int8Array)h=r.BYTE;else if(s instanceof Uint8Array)h=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)h=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let d={bufferGPU:u,bufferType:t,type:h,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:h===r.INT||h===r.UNSIGNED_INT||e.gpuType===Hs,id:pme++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const _=this._createBuffer(r,t,s,o);d=new mme(d,_)}n.set(e,d)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,o=t.get(s),a=o.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(a,o.bufferGPU),l.length===0)n.bufferSubData(a,0,r);else{for(let u=0,h=l.length;u<h;u++){const d=l[u];n.bufferSubData(a,d.start*r.BYTES_PER_ELEMENT,r,d.start,d.count)}s.clearUpdateRanges()}n.bindBuffer(a,null),o.version=s.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),o=e.array,a=o.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,s);const l=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.bufferData(n.COPY_WRITE_BUFFER,a,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,u),n.deleteBuffer(l),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,n,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,n,r),e.bindBuffer(t,null),s}}let LM,Y1;class _me{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;LM={[bo]:e.FUNC_ADD,[L4]:e.FUNC_SUBTRACT,[O4]:e.FUNC_REVERSE_SUBTRACT},Y1={[ah]:e.ZERO,[I4]:e.ONE,[B4]:e.SRC_COLOR,[k_]:e.SRC_ALPHA,[V4]:e.SRC_ALPHA_SATURATE,[G4]:e.DST_COLOR,[F4]:e.DST_ALPHA,[U4]:e.ONE_MINUS_SRC_COLOR,[G_]:e.ONE_MINUS_SRC_ALPHA,[z4]:e.ONE_MINUS_DST_COLOR,[k4]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new mn().fromArray(t),this.currentViewport=new mn().fromArray(n),this._tempVec4=new mn}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==$U?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===IR?t.cullFace(t.BACK):e===YU?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,r,s,o,a,l){const{gl:u}=this;if(e===ga){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==Kp){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==bo||this.currentBlendEquationAlpha!==bo)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=bo,this.currentBlendEquationAlpha=bo),l)switch(e){case Wo:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case hm:u.blendFunc(u.ONE,u.ONE);break;case fm:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case dm:u.blendFuncSeparate(u.DST_COLOR,u.ONE_MINUS_SRC_ALPHA,u.ZERO,u.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Wo:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case hm:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE,u.ONE,u.ONE);break;case fm:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case dm:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,o=o||n,a=a||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(LM[t],LM[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(n!==this.currentBlendSrc||r!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||a!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(Y1[n],Y1[r],Y1[o],Y1[a]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case z_:t.depthFunc(t.NEVER);break;case V_:t.depthFunc(t.ALWAYS);break;case q_:t.depthFunc(t.LESS);break;case od:t.depthFunc(t.LEQUAL);break;case H_:t.depthFunc(t.EQUAL);break;case W_:t.depthFunc(t.GEQUAL);break;case j_:t.depthFunc(t.GREATER);break;case X_:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(s)===!1){const{gl:o}=this;o.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(s)===!1){const{gl:o}=this;o.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===ss?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let s=e.side===Zi;t&&(s=!s),this.setFlipSided(s),e.blending===Wo&&e.transparent===!1?this.setBlending(ga):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let l=0;l<8;l++)l<n?this.enable(12288+l):this.disable(12288+l)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==n.COLOR_ATTACHMENT0){for(let a=0,l=o.length;a<l;a++)r[a]=n.COLOR_ATTACHMENT0+a;r.length=o.length,s=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,s=!0);s&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:s,currentBoundTextures:o,maxTextures:a}=this;n===void 0&&(s===null?n=r.TEXTURE0+a-1:n=s);let l=o[n];l===void 0&&(l={type:void 0,texture:void 0},o[n]=l),(l.type!==e||l.texture!==t)&&(s!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[s]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class yme{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Go){const{gl:n,extensions:r}=this;let s;const o=In.getTransfer(t);if(e===Vr)return n.UNSIGNED_BYTE;if(e===iT)return n.UNSIGNED_SHORT_4_4_4_4;if(e===rT)return n.UNSIGNED_SHORT_5_5_5_1;if(e===sT)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===EA)return n.BYTE;if(e===wA)return n.SHORT;if(e===hu)return n.UNSIGNED_SHORT;if(e===Hs)return n.INT;if(e===mr)return n.UNSIGNED_INT;if(e===os)return n.FLOAT;if(e===As)return n.HALF_FLOAT;if(e===W4)return n.ALPHA;if(e===qy)return n.RGB;if(e===es)return n.RGBA;if(e===Qa)return n.DEPTH_COMPONENT;if(e===Ka)return n.DEPTH_STENCIL;if(e===Hy)return n.RED;if(e===ag)return n.RED_INTEGER;if(e===mh)return n.RG;if(e===lg)return n.RG_INTEGER;if(e===ug)return n.RGBA_INTEGER;if(e===MA||e===Kf||e===Zf||e===Jf)if(o===Qt)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===MA)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Kf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Zf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Jf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===MA)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Kf)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Zf)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Jf)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===$_||e===Y_||e===Q_||e===K_)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===$_)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Y_)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Q_)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===K_)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Z_||e===mm||e===gm)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===Z_||e===mm)return o===Qt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===gm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===_m||e===ym||e===vm||e===xm||e===bm||e===Sm||e===Tm||e===Em||e===wm||e===Mm||e===Rm||e===Cm||e===Nm||e===Dm)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===_m)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===ym)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===vm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===xm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===bm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Sm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Tm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Em)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===wm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Mm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Rm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Cm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Nm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Dm)return o===Qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===RA)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===RA)return o===Qt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===j4||e===J_||e===ey||e===ty)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===RA)return s.COMPRESSED_RED_RGTC1_EXT;if(e===J_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===ey)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===ty)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Ya?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function s(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),r();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),n()}s()})}}let II=!1,kx,OM,BI;class vme{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},II===!1&&(this._init(),II=!0)}_init(){const e=this.gl;kx={[kA]:e.REPEAT,[Xu]:e.CLAMP_TO_EDGE,[GA]:e.MIRRORED_REPEAT},OM={[br]:e.NEAREST,[H4]:e.NEAREST_MIPMAP_NEAREST,[ph]:e.NEAREST_MIPMAP_LINEAR,[Ms]:e.LINEAR,[Zp]:e.LINEAR_MIPMAP_NEAREST,[ua]:e.LINEAR_MIPMAP_LINEAR},BI={[X4]:e.NEVER,[Z4]:e.ALWAYS,[oT]:e.LESS,[aT]:e.LEQUAL,[$4]:e.EQUAL,[K4]:e.GEQUAL,[Y4]:e.GREATER,[Q4]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,s=!1){const{gl:o,extensions:a}=this;if(e!==null){if(o[e]!==void 0)return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;if(t===o.RED&&(n===o.FLOAT&&(l=o.R32F),n===o.HALF_FLOAT&&(l=o.R16F),n===o.UNSIGNED_BYTE&&(l=o.R8),n===o.UNSIGNED_SHORT&&(l=o.R16),n===o.UNSIGNED_INT&&(l=o.R32UI),n===o.BYTE&&(l=o.R8I),n===o.SHORT&&(l=o.R16I),n===o.INT&&(l=o.R32I)),t===o.RED_INTEGER&&(n===o.UNSIGNED_BYTE&&(l=o.R8UI),n===o.UNSIGNED_SHORT&&(l=o.R16UI),n===o.UNSIGNED_INT&&(l=o.R32UI),n===o.BYTE&&(l=o.R8I),n===o.SHORT&&(l=o.R16I),n===o.INT&&(l=o.R32I)),t===o.RG&&(n===o.FLOAT&&(l=o.RG32F),n===o.HALF_FLOAT&&(l=o.RG16F),n===o.UNSIGNED_BYTE&&(l=o.RG8),n===o.UNSIGNED_SHORT&&(l=o.RG16),n===o.UNSIGNED_INT&&(l=o.RG32UI),n===o.BYTE&&(l=o.RG8I),n===o.SHORT&&(l=o.RG16I),n===o.INT&&(l=o.RG32I)),t===o.RG_INTEGER&&(n===o.UNSIGNED_BYTE&&(l=o.RG8UI),n===o.UNSIGNED_SHORT&&(l=o.RG16UI),n===o.UNSIGNED_INT&&(l=o.RG32UI),n===o.BYTE&&(l=o.RG8I),n===o.SHORT&&(l=o.RG16I),n===o.INT&&(l=o.RG32I)),t===o.RGB){const u=s?Pm:In.getTransfer(r);n===o.FLOAT&&(l=o.RGB32F),n===o.HALF_FLOAT&&(l=o.RGB16F),n===o.UNSIGNED_BYTE&&(l=o.RGB8),n===o.UNSIGNED_SHORT&&(l=o.RGB16),n===o.UNSIGNED_INT&&(l=o.RGB32UI),n===o.BYTE&&(l=o.RGB8I),n===o.SHORT&&(l=o.RGB16I),n===o.INT&&(l=o.RGB32I),n===o.UNSIGNED_BYTE&&(l=u===Qt?o.SRGB8:o.RGB8),n===o.UNSIGNED_SHORT_5_6_5&&(l=o.RGB565),n===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1),n===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGB4),n===o.UNSIGNED_INT_5_9_9_9_REV&&(l=o.RGB9_E5)}if(t===o.RGB_INTEGER&&(n===o.UNSIGNED_BYTE&&(l=o.RGB8UI),n===o.UNSIGNED_SHORT&&(l=o.RGB16UI),n===o.UNSIGNED_INT&&(l=o.RGB32UI),n===o.BYTE&&(l=o.RGB8I),n===o.SHORT&&(l=o.RGB16I),n===o.INT&&(l=o.RGB32I)),t===o.RGBA){const u=s?Pm:In.getTransfer(r);n===o.FLOAT&&(l=o.RGBA32F),n===o.HALF_FLOAT&&(l=o.RGBA16F),n===o.UNSIGNED_BYTE&&(l=o.RGBA8),n===o.UNSIGNED_SHORT&&(l=o.RGBA16),n===o.UNSIGNED_INT&&(l=o.RGBA32UI),n===o.BYTE&&(l=o.RGBA8I),n===o.SHORT&&(l=o.RGBA16I),n===o.INT&&(l=o.RGBA32I),n===o.UNSIGNED_BYTE&&(l=u===Qt?o.SRGB8_ALPHA8:o.RGBA8),n===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGBA4),n===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1)}return t===o.RGBA_INTEGER&&(n===o.UNSIGNED_BYTE&&(l=o.RGBA8UI),n===o.UNSIGNED_SHORT&&(l=o.RGBA16UI),n===o.UNSIGNED_INT&&(l=o.RGBA32UI),n===o.BYTE&&(l=o.RGBA8I),n===o.SHORT&&(l=o.RGBA16I),n===o.INT&&(l=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(n===o.UNSIGNED_SHORT&&(l=o.DEPTH_COMPONENT16),n===o.UNSIGNED_INT&&(l=o.DEPTH_COMPONENT24),n===o.FLOAT&&(l=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&n===o.UNSIGNED_INT_24_8&&(l=o.DEPTH24_STENCIL8),(l===o.R16F||l===o.R32F||l===o.RG16F||l===o.RG32F||l===o.RGBA16F||l===o.RGBA32F)&&a.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:n,extensions:r,backend:s}=this,o=In.getPrimaries(In.workingColorSpace),a=t.colorSpace===Go?null:In.getPrimaries(t.colorSpace),l=t.colorSpace===Go||o===a?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,l),n.texParameteri(e,n.TEXTURE_WRAP_S,kx[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,kx[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,kx[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,OM[t.magFilter]);const u=t.mipmaps!==void 0&&t.mipmaps.length>0,h=t.minFilter===Ms&&u?ua:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,OM[h]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,BI[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===br||t.minFilter!==ph&&t.minFilter!==ua||t.type===os&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const d=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,s=this.getGLTextureType(e);let o=r[s];o===void 0&&(o=t.createTexture(),n.state.bindTexture(s,o),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=o),n.set(e,{textureGPU:o,glTextureType:s,isDefault:!0})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:s,width:o,height:a,depth:l}=t,u=r.utils.convert(e.format,e.colorSpace),h=r.utils.convert(e.type),d=this.getInternalFormat(e.internalFormat,u,h,e.colorSpace,e.isVideoTexture),_=n.createTexture(),x=this.getGLTextureType(e);r.state.bindTexture(x,_),this.setTextureParameters(x,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,s,d,o,a,l):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,s,d,o,a,l):e.isVideoTexture||n.texStorage2D(x,s,d,o,a),r.set(e,{textureGPU:_,glTextureType:x,glFormat:u,glType:h,glInternalFormat:d})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:s,glTextureType:o,glFormat:a,glType:l}=r.get(t),{width:u,height:h}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,s),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(o,0,0,0,u,h,a,l,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:s}=t,{textureGPU:o,glTextureType:a,glFormat:l,glType:u,glInternalFormat:h}=this.backend.get(e);if(!(e.isRenderTargetTexture||o===void 0))if(this.backend.state.bindTexture(a,o),this.setTextureParameters(a,e),e.isCompressedTexture){const d=e.mipmaps,_=t.image;for(let x=0;x<d.length;x++){const b=d[x];e.isCompressedArrayTexture?e.format!==n.RGBA?l!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,x,0,0,0,b.width,b.height,_.depth,l,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,x,0,0,0,b.width,b.height,_.depth,l,u,b.data):l!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,x,0,0,b.width,b.height,l,b.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const d=t.images;for(let _=0;_<6;_++){const x=UI(d[_]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,0,0,r,s,l,u,x)}}else if(e.isDataArrayTexture||e.isArrayTexture){const d=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,d.width,d.height,d.depth,l,u,d.data)}else if(e.isData3DTexture){const d=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,d.width,d.height,d.depth,l,u,d.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(a,0,h,l,u,t.image);else{const d=UI(t.image);n.texSubImage2D(a,0,0,0,r,s,l,u,d)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:s}=n.get(e);n.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:r,renderTarget:s}=n.get(e);this.deallocateRenderBuffers(s),t.deleteTexture(r),n.delete(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,o=0){const{gl:a,backend:l}=this,{state:u}=this.backend,{textureGPU:h,glTextureType:d,glType:_,glFormat:x}=l.get(t);u.bindTexture(d,h);let b,R,E,w,L,D,O,B,G;const k=e.isCompressedTexture?e.mipmaps[o]:e.image;if(n!==null)b=n.max.x-n.min.x,R=n.max.y-n.min.y,E=n.isBox3?n.max.z-n.min.z:1,w=n.min.x,L=n.min.y,D=n.isBox3?n.min.z:0;else{const se=Math.pow(2,-s);b=Math.floor(k.width*se),R=Math.floor(k.height*se),e.isDataArrayTexture||e.isArrayTexture?E=k.depth:e.isData3DTexture?E=Math.floor(k.depth*se):E=1,w=0,L=0,D=0}r!==null?(O=r.x,B=r.y,G=r.z):(O=0,B=0,G=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const z=a.getParameter(a.UNPACK_ROW_LENGTH),F=a.getParameter(a.UNPACK_IMAGE_HEIGHT),q=a.getParameter(a.UNPACK_SKIP_PIXELS),H=a.getParameter(a.UNPACK_SKIP_ROWS),Q=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,k.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,k.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,w),a.pixelStorei(a.UNPACK_SKIP_ROWS,L),a.pixelStorei(a.UNPACK_SKIP_IMAGES,D);const K=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const se=l.get(e),ee=l.get(t),$=l.get(se.renderTarget),re=l.get(ee.renderTarget),ae=$.framebuffers[se.cacheKey],_e=re.framebuffers[ee.cacheKey];u.bindFramebuffer(a.READ_FRAMEBUFFER,ae),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,_e);let ne=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(ne=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(w,L,b,R,O,B,b,R,ne,a.NEAREST),u.bindFramebuffer(a.READ_FRAMEBUFFER,null),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else K?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(d,o,O,B,G,b,R,E,x,_,k.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(d,o,O,B,G,b,R,E,x,k.data):a.texSubImage3D(d,o,O,B,G,b,R,E,x,_,k):e.isDataTexture?a.texSubImage2D(d,o,O,B,b,R,x,_,k.data):e.isCompressedTexture?a.compressedTexSubImage2D(d,o,O,B,k.width,k.height,x,k.data):a.texSubImage2D(d,o,O,B,b,R,x,_,k);a.pixelStorei(a.UNPACK_ROW_LENGTH,z),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,F),a.pixelStorei(a.UNPACK_SKIP_PIXELS,q),a.pixelStorei(a.UNPACK_SKIP_ROWS,H),a.pixelStorei(a.UNPACK_SKIP_IMAGES,Q),o===0&&t.generateMipmaps&&a.generateMipmap(d),u.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:s}=this.backend,{textureGPU:o}=this.backend.get(e),{x:a,y:l,z:u,w:h}=n,d=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,_=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(d){const x=a!==0||l!==0;let b,R;if(e.isDepthTexture===!0?(b=r.DEPTH_BUFFER_BIT,R=r.DEPTH_ATTACHMENT,t.stencil&&(b|=r.STENCIL_BUFFER_BIT)):(b=r.COLOR_BUFFER_BIT,R=r.COLOR_ATTACHMENT0),x){const E=this.backend.get(t.renderTarget),w=E.framebuffers[t.getCacheKey()],L=E.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,w),s.bindFramebuffer(r.READ_FRAMEBUFFER,L);const D=_-l-h;r.blitFramebuffer(a,D,a+u,D+h,a,D,a+u,D+h,b,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,w),s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,D,u,h),s.unbindTexture()}else{const E=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,E),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,R,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,u,h,0,0,u,h,b,r.NEAREST),r.deleteFramebuffer(E)}}else s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,_-h-l,u,h),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:s}=this,o=t.renderTarget,{depthTexture:a,depthBuffer:l,stencilBuffer:u,width:h,height:d}=o;if(s.bindRenderbuffer(s.RENDERBUFFER,e),l&&!u){let _=s.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,o.samples,_,h,d):n>0?(a&&a.isDepthTexture&&a.type===s.FLOAT&&(_=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,n,_,h,d)):s.renderbufferStorage(s.RENDERBUFFER,_,h,d),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else l&&u&&(n>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,s.DEPTH24_STENCIL8,h,d):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,h,d),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e));s.bindRenderbuffer(s.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,n,r,s,o){const{backend:a,gl:l}=this,{textureGPU:u,glFormat:h,glType:d}=this.backend.get(e),_=l.createFramebuffer();l.bindFramebuffer(l.READ_FRAMEBUFFER,_);const x=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+o:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,x,u,0);const b=this._getTypedArrayType(d),R=this._getBytesPerTexel(d,h),w=r*s*R,L=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,L),l.bufferData(l.PIXEL_PACK_BUFFER,w,l.STREAM_READ),l.readPixels(t,n,r,s,h,d,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const D=new b(w/b.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,L),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,D),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),l.deleteFramebuffer(_),D}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}}function UI(i){return i.isDataTexture?i.image.data:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?i:i.data}class xme{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class bme{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const FI={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class Sme{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:s,type:o,info:a,index:l}=this;l!==0?n.drawElements(r,t,o,e):n.drawArrays(r,e,t),a.update(s,t,1)}renderInstances(e,t,n){const{gl:r,mode:s,type:o,index:a,object:l,info:u}=this;n!==0&&(a!==0?r.drawElementsInstanced(s,t,o,e,n):r.drawArraysInstanced(s,e,t,n),u.update(l,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:s,object:o,info:a}=this;if(n===0)return;const l=r.get("WEBGL_multi_draw");if(l===null)for(let u=0;u<n;u++)this.render(e[u],t[u]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,n):l.multiDrawArraysWEBGL(s,e,0,t,0,n);let u=0;for(let h=0;h<n;h++)u+=t[h];a.update(o,u,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:s,mode:o,object:a,info:l}=this;if(n===0)return;const u=s.get("WEBGL_multi_draw");if(u===null)for(let h=0;h<n;h++)this.renderInstances(e[h],t[h],r[h]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,n):u.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,n);let h=0;for(let d=0;d<n;d++)h+=t[d]*r[d];l.update(a,h,1)}}}class Vq{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class Tme extends Vq{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Za(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){console.error("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,s]of this.queryStates)if(s==="ended"){const o=this.queries[r];e.push(this.resolveQuery(o))}if(e.length===0)return this.lastValue;const n=(await Promise.all(e)).reduce((r,s)=>r+s,0);return this.lastValue=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,n}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const s=()=>{n&&(clearTimeout(n),n=null)},o=l=>{r||(r=!0,s(),t(l))},a=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(a,1);return}const h=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(h)/1e6)}catch(l){console.error("Error checking query:",l),t(this.lastValue)}};a()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}const kI=new it;class GI extends zq{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function s(o){o.preventDefault();const a={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(a)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=r,this.extensions=new xme(this),this.capabilities=new bme(this),this.attributeUtils=new gme(this),this.textureUtils=new vme(this),this.bufferRenderer=new Sme(this),this.state=new _me(this),this.utils=new yme(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return qo}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const s=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new Tme(this.gl,t,2048));const n=this.timestampQueryPool[t];n.allocateQueriesForContext(e)!==null&&n.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:s,height:o}=this.getDrawingBufferSize(kI);t.viewport(0,0,s,o)}if(e.scissor){const{x:s,y:o,width:a,height:l}=e.scissorValue;t.scissor(s,e.height-l-o,a,l)}this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),s=r.previousContext;n.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(a!==null)for(let u=0;u<a.length;u++){const h=a[u];h.generateMipmaps&&this.generateMipmaps(h)}this._currentContext=s;const l=e.renderTarget;if(e.textures!==null&&l){const u=this.get(l);if(l.samples>0&&this._useMultisampledExtension(l)===!1){const h=u.framebuffers[e.getCacheKey()];let d=t.COLOR_BUFFER_BIT;l.resolveDepthBuffer&&(l.depthBuffer&&(d|=t.DEPTH_BUFFER_BIT),l.stencilBuffer&&l.resolveStencilBuffer&&(d|=t.STENCIL_BUFFER_BIT));const _=u.msaaFrameBuffer,x=u.msaaRenderbuffers,b=e.textures,R=b.length>1;if(n.bindFramebuffer(t.READ_FRAMEBUFFER,_),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,h),R)for(let E=0;E<b.length;E++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+E,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+E,t.TEXTURE_2D,null,0);for(let E=0;E<b.length;E++){if(R){const{textureGPU:w}=this.get(b[E]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,x[E]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,w,0)}if(e.scissor){const{x:w,y:L,width:D,height:O}=e.scissorValue,B=e.height-O-L;t.blitFramebuffer(w,B,w+D,B+O,w,B,w+D,B+O,d,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,d,t.NEAREST)}if(R)for(let E=0;E<b.length;E++){const{textureGPU:w}=this.get(b[E]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+E,t.RENDERBUFFER,x[E]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+E,t.TEXTURE_2D,w,0)}this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,u.invalidationArray)}else if(l.resolveDepthBuffer===!1&&u.framebuffers){const h=u.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,h),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,u.depthInvalidationArray)}}if(s!==null)if(this._setFramebuffer(s),s.viewport)this.updateViewport(s);else{const{width:u,height:h}=this.getDrawingBufferSize(kI);n.viewport(0,0,u,h)}this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const a=()=>{let l=0;for(let u=0;u<n.length;u++){const h=n[u];h!==null&&o.getQueryParameter(h,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(h,o.QUERY_RESULT)===0&&s.add(r[u]),n[u]=null,o.deleteQuery(h),l++)}l<n.length?requestAnimationFrame(a):t.occluded=s};a()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:s,height:o}=e.viewportValue;t.viewport(n,e.height-o-r,s,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,s=!0){const{gl:o,renderer:a}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let l=0;if(e&&(l|=o.COLOR_BUFFER_BIT),t&&(l|=o.DEPTH_BUFFER_BIT),n&&(l|=o.STENCIL_BUFFER_BIT),l!==0){let u;r.clearColorValue?u=r.clearColorValue:u=this.getClearColor();const h=a.getClearDepth(),d=a.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(u.r,u.g,u.b,u.a),o.clear(l);else{if(s&&this._setFramebuffer(r),e)for(let _=0;_<r.textures.length;_++)_===0?o.clearBufferfv(o.COLOR,_,[u.r,u.g,u.b,u.a]):o.clearBufferfv(o.COLOR,_,[0,0,0,1]);t&&n?o.clearBufferfi(o.DEPTH_STENCIL,0,h,d):t?o.clearBufferfv(o.DEPTH,0,[h]):n&&o.clearBufferiv(o.STENCIL,0,[d])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,r){const{state:s,gl:o}=this;this.discard===!1&&(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:a,transformBuffers:l,attributes:u}=this.get(r),h=this._getVaoKey(u),d=this.vaoCache[h];d===void 0?this.vaoCache[h]=this._createVao(u):s.setVertexState(d),s.useProgram(a),this._bindUniforms(n);const _=this._getTransformFeedback(l);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,_),o.beginTransformFeedback(o.POINTS),u[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let x=0;x<l.length;x++){const b=l[x];b.pbo&&this.has(b.pbo)&&this.textureUtils.copyBufferToTexture(b.transformBuffer,b.pbo),b.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:s,hardwareClippingPlanes:o}=e,{programGPU:a}=this.get(n),{gl:l,state:u}=this,h=this.get(s),d=e.getDrawParameters();if(d===null)return;this._bindUniforms(e.getBindings());const _=t.isMesh&&t.matrixWorld.determinant()<0;u.setMaterial(r,_,o),u.useProgram(a);const x=e.getAttributes(),b=this.get(x);let R=b.vaoGPU;if(R===void 0){const z=this._getVaoKey(x);R=this.vaoCache[z],R===void 0&&(R=this._createVao(x),this.vaoCache[z]=R,b.vaoGPU=R)}const E=e.getIndex(),w=E!==null?this.get(E).bufferGPU:null;u.setVertexState(R,w);const L=h.lastOcclusionObject;if(L!==t&&L!==void 0){if(L!==null&&L.occlusionTest===!0&&(l.endQuery(l.ANY_SAMPLES_PASSED),h.occlusionQueryIndex++),t.occlusionTest===!0){const z=l.createQuery();l.beginQuery(l.ANY_SAMPLES_PASSED,z),h.occlusionQueries[h.occlusionQueryIndex]=z,h.occlusionQueryObjects[h.occlusionQueryIndex]=t}h.lastOcclusionObject=t}const D=this.bufferRenderer;t.isPoints?D.mode=l.POINTS:t.isLineSegments?D.mode=l.LINES:t.isLine?D.mode=l.LINE_STRIP:t.isLineLoop?D.mode=l.LINE_LOOP:r.wireframe===!0?(u.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),D.mode=l.LINES):D.mode=l.TRIANGLES;const{vertexCount:O,instanceCount:B}=d;let{firstVertex:G}=d;if(D.object=t,E!==null){G*=E.array.BYTES_PER_ELEMENT;const z=this.get(E);D.index=E.count,D.type=z.type}else D.index=0;const k=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(Za("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),D.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?D.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Za("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):B>1?D.renderInstances(G,O,B):D.render(G,O)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const z=this.get(e.camera),F=e.camera.cameras,q=e.getBindingGroup("cameraIndex").bindings[0];if(z.indexesGPU===void 0||z.indexesGPU.length!==F.length){const $=new Uint32Array([0,0,0,0]),re=[];for(let ae=0,_e=F.length;ae<_e;ae++){const ne=l.createBuffer();$[0]=ae,l.bindBuffer(l.UNIFORM_BUFFER,ne),l.bufferData(l.UNIFORM_BUFFER,$,l.STATIC_DRAW),re.push(ne)}z.indexesGPU=re}const H=this.get(q),Q=this.renderer.getPixelRatio(),K=this._currentContext.renderTarget,se=this._isRenderCameraDepthArray(this._currentContext),ee=this._currentContext.activeCubeFace;if(se){const $=this.get(K.depthTexture);if($.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){$.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:re}=K;for(let ae=0,_e=F.length;ae<_e;ae++)this.renderer._activeCubeFace=ae,this._currentContext.activeCubeFace=ae,this._setFramebuffer(this._currentContext),this.clear(!1,!0,re,this._currentContext,!1);this.renderer._activeCubeFace=ee,this._currentContext.activeCubeFace=ee}}for(let $=0,re=F.length;$<re;$++){const ae=F[$];if(t.layers.test(ae.layers)){se&&(this.renderer._activeCubeFace=$,this._currentContext.activeCubeFace=$,this._setFramebuffer(this._currentContext));const _e=ae.viewport;if(_e!==void 0){const ne=_e.x*Q,ye=_e.y*Q,ve=_e.width*Q,Pe=_e.height*Q;u.viewport(Math.floor(ne),Math.floor(e.context.height-Pe-ye),Math.floor(ve),Math.floor(Pe))}u.bindBufferBase(l.UNIFORM_BUFFER,H.index,z.indexesGPU[$]),k()}this._currentContext.activeCubeFace=ee,this.renderer._activeCubeFace=ee}}else k()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new Ame(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,s=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:o}=r,a=n.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU;if(n.attachShader(a,l),n.attachShader(a,u),n.linkProgram(a),this.set(r,{programGPU:a,fragmentShader:l,vertexShader:u}),t!==null&&this.parallel){const h=new Promise(d=>{const _=this.parallel,x=()=>{n.getProgramParameter(a,_.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),d()):requestAnimationFrame(x)};x()});t.push(h);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],s=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let a=s;a<o;a++){const l=a+1;r.push(`${l===t?">":" "} ${l}: ${n[a]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+this._handleSource(e.getShaderSource(t),a)}else return s}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,s=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const o=this._getShaderErrors(r,n,"vertex"),a=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+s+`
`+o+`
`+a)}else s!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",s)}}_completeCompile(e,t){const{state:n,gl:r}=this,s=this.get(t),{programGPU:o,fragmentShader:a,vertexShader:l}=s;r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,a,l),n.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:n,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:o}=e,a=r.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU,h=o.transforms,d=[],_=[];for(let E=0;E<h.length;E++){const w=h[E];d.push(w.varyingName),_.push(w.attributeNode)}r.attachShader(a,l),r.attachShader(a,u),r.transformFeedbackVaryings(a,d,r.SEPARATE_ATTRIBS),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,l,u),n.useProgram(a),this._setupBindings(t,a);const x=o.attributes,b=[],R=[];for(let E=0;E<x.length;E++){const w=x[E].node.attribute;b.push(w),this.has(w)||this.attributeUtils.createAttribute(w,r.ARRAY_BUFFER)}for(let E=0;E<_.length;E++){const w=_[E].attribute;this.has(w)||this.attributeUtils.createAttribute(w,r.ARRAY_BUFFER);const L=this.get(w);R.push(L)}this.set(e,{programGPU:a,transformBuffers:R,attributes:b})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:n});for(const o of s.bindings)o.isUniformBuffer&&n++,o.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,s=n.textures;for(const o of e.bindings)if(o.isUniformsGroup||o.isUniformBuffer){const a=o.buffer,l=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,l),t.bufferData(t.UNIFORM_BUFFER,a,t.DYNAMIC_DRAW),this.set(o,{index:r++,bufferGPU:l})}else if(o.isSampledTexture){const{textureGPU:a,glTextureType:l}=this.get(o.texture);this.set(o,{index:s++,textureGPU:a,glTextureType:l})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(FI).filter(r=>FI[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,s=0,o=0){this.textureUtils.copyTextureToTexture(e,t,n,r,s,o)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,o=this.get(s),{samples:a,depthBuffer:l,stencilBuffer:u}=s,h=s.isWebGLCubeRenderTarget===!0,d=s.isRenderTarget3D===!0,_=s.depth>1,x=s.isXRRenderTarget===!0,b=x===!0&&s._hasExternalTextures===!0;let R=o.msaaFrameBuffer,E=o.depthRenderbuffer;const w=this.extensions.get("WEBGL_multisampled_render_to_texture"),L=this.extensions.get("OVR_multiview2"),D=this._useMultisampledExtension(s),O=BV(e);let B;if(h?(o.cubeFramebuffers||(o.cubeFramebuffers={}),B=o.cubeFramebuffers[O]):x&&b===!1?B=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),B=o.framebuffers[O]),B===void 0){B=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,B);const G=e.textures,k=[];if(h){o.cubeFramebuffers[O]=B;const{textureGPU:F}=this.get(G[0]),q=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+q,F,0)}else{o.framebuffers[O]=B;for(let F=0;F<G.length;F++){const q=G[F],H=this.get(q);H.renderTarget=e.renderTarget,H.cacheKey=O;const Q=t.COLOR_ATTACHMENT0+F;if(s.multiview)L.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Q,H.textureGPU,0,a,0,2);else if(d||_){const K=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,Q,H.textureGPU,0,K)}else D?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Q,t.TEXTURE_2D,H.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,Q,t.TEXTURE_2D,H.textureGPU,0)}}const z=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const F=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(F,e,0,D),o.xrDepthRenderbuffer=F,k.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,F),t.framebufferRenderbuffer(t.FRAMEBUFFER,z,t.RENDERBUFFER,F)}else if(e.depthTexture!==null){k.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const F=this.get(e.depthTexture);if(F.renderTarget=e.renderTarget,F.cacheKey=O,s.multiview)L.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,z,F.textureGPU,0,a,0,2);else if(b&&D)w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,z,t.TEXTURE_2D,F.textureGPU,0,a);else if(e.depthTexture.isArrayTexture){const q=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,z,F.textureGPU,0,q)}else t.framebufferTexture2D(t.FRAMEBUFFER,z,t.TEXTURE_2D,F.textureGPU,0)}o.depthInvalidationArray=k}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,B);const k=this.renderer._activeCubeFace,z=this.get(e.depthTexture),F=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,F,z.textureGPU,0,k)}if((x||D||s.multiview)&&s._isOpaqueFramebuffer!==!0){n.bindFramebuffer(t.FRAMEBUFFER,B);const k=this.get(e.textures[0]);s.multiview?L.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,k.textureGPU,0,a,0,2):D?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,k.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,k.textureGPU,0);const z=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const F=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,F),t.framebufferRenderbuffer(t.FRAMEBUFFER,z,t.RENDERBUFFER,F)}else{const F=this.get(e.depthTexture);s.multiview?L.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,z,F.textureGPU,0,a,0,2):D?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,z,t.TEXTURE_2D,F.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,z,t.TEXTURE_2D,F.textureGPU,0)}}}if(a>0&&D===!1&&!s.multiview){if(R===void 0){const G=[];R=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,R);const k=[],z=e.textures;for(let F=0;F<z.length;F++){k[F]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,k[F]),G.push(t.COLOR_ATTACHMENT0+F);const q=e.textures[F],H=this.get(q);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,H.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+F,t.RENDERBUFFER,k[F])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),o.msaaFrameBuffer=R,o.msaaRenderbuffers=k,l&&E===void 0){E=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(E,e,a),o.depthRenderbuffer=E;const F=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;G.push(F)}o.invalidationArray=G}r=o.msaaFrameBuffer}else r=B;n.drawBuffers(e,B)}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();t.bindVertexArray(n);for(let r=0;r<e.length;r++){const s=e[r],o=this.get(s);t.bindBuffer(t.ARRAY_BUFFER,o.bufferGPU),t.enableVertexAttribArray(r);let a,l;s.isInterleavedBufferAttribute===!0?(a=s.data.stride*o.bytesPerElement,l=s.offset*o.bytesPerElement):(a=0,l=0),o.isInteger?t.vertexAttribIPointer(r,s.itemSize,o.type,a,l):t.vertexAttribPointer(r,s.itemSize,o.type,s.normalized,a,l),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),n}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let s=0;s<e.length;s++){const o=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,o.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const s of r.bindings){const a=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=n.getUniformBlockIndex(t,s.name);n.uniformBlockBinding(t,l,a)}else if(s.isSampledTexture){const l=n.getUniformLocation(t,s.name);n.uniform1i(l,a)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const s of r.bindings){const o=this.get(s),a=o.index;s.isUniformsGroup||s.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,a,o.bufferGPU):s.isSampledTexture&&n.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+a)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const Xp={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},no={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Io={Store:"store"},ki={Load:"load",Clear:"clear"},IM={CCW:"ccw"},BM={None:"none",Front:"front",Back:"back"},Xm={Uint16:"uint16",Uint32:"uint32"},we={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},UM={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},cA={Linear:"linear",Nearest:"nearest"},yi={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},Qd={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},zI={None:0,All:15},Nf={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},FM={Storage:"storage",ReadOnlyStorage:"read-only-storage"},kM={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},VI={NonFiltering:"non-filtering",Comparison:"comparison"},Kd={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},qI={TwoD:"2d",ThreeD:"3d"},fs={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},Eme={All:"all"},Gx={Vertex:"vertex",Instance:"instance"},KC={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"};class wme extends n6{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class Mme extends wme{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class Rme extends Iq{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let Cme=0;class Nme extends Rme{constructor(e,t){super("StorageBuffer_"+Cme++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:To.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class Dme extends Ad{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:cA.Linear}),this.flipYSampler=e.createSampler({minFilter:cA.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Xp.TriangleStrip,stripIndexFormat:Xm.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Xp.TriangleStrip,stripIndexFormat:Xm.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:s,height:o}=t.size,a=this.getTransferPipeline(r),l=this.getFlipYPipeline(r),u=this.device.createTexture({size:{width:s,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),h=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:fs.TwoD,baseArrayLayer:n}),d=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:fs.TwoD,baseArrayLayer:0}),_=this.device.createCommandEncoder({}),x=(b,R,E)=>{const w=b.getBindGroupLayout(0),L=this.device.createBindGroup({layout:w,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:R}]}),D=_.beginRenderPass({colorAttachments:[{view:E,loadOp:ki.Clear,storeOp:Io.Store,clearValue:[0,0,0,0]}]});D.setPipeline(b),D.setBindGroup(0,L),D.draw(4,1,0,0),D.end()};x(a,h,d),x(l,d,h),this.device.queue.submit([_.finish()]),u.destroy()}generateMipmaps(e,t,n=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const s=r.layers[n]||this._mipmapCreateBundles(e,t,n),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,s),this.device.queue.submit([o.finish()]),r.useCount!==0&&(r.layers[n]=s),r.useCount++}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),s=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:fs.TwoD,baseArrayLayer:n});const a=[];for(let l=1;l<t.mipLevelCount;l++){const u=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),h=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:fs.TwoD,baseArrayLayer:n}),d={colorAttachments:[{view:h,loadOp:ki.Clear,storeOp:Io.Store,clearValue:[0,0,0,0]}]},_=this.device.createRenderBundleEncoder({colorFormats:[t.format]});_.setPipeline(r),_.setBindGroup(0,u),_.draw(4,1,0,0),a.push({renderBundles:[_.finish()],passDescriptor:d}),o=h}return a}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const s=t[r],o=e.beginRenderPass(s.passDescriptor);o.executeBundles(s.renderBundles),o.end()}}}const Pme={[X4]:"never",[oT]:"less",[$4]:"equal",[aT]:"less-equal",[Y4]:"greater",[K4]:"greater-equal",[Z4]:"always",[Q4]:"not-equal"},Lme=[0,1,3,2,4,5];class Ome{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new Ja,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,r=t.get(e),s={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};s.magFilter===cA.Linear&&s.minFilter===cA.Linear&&s.mipmapFilter===cA.Linear&&(s.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(s.compare=Pme[e.compareFunction]),r.sampler=n.createSampler(s)}createDefaultTexture(e){let t;const n=ZC(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:o,depth:a,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),h=e.internalFormat||t.format||ZC(e,n.device);r.format=h;const{samples:d,primarySamples:_,isMSAA:x}=n.utils.getTextureSampleData(e);let b=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(b|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(b|=GPUTextureUsage.RENDER_ATTACHMENT);const R={label:e.name,size:{width:s,height:o,depthOrArrayLayers:a},mipLevelCount:l,sampleCount:_,dimension:u,format:h,usage:b};if(e.isVideoTexture){const E=e.source.data,w=new VideoFrame(E);R.size.width=w.displayWidth,R.size.height=w.displayHeight,w.close(),r.externalTexture=E}else{if(h===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(R.textureBindingViewDimension=fs.Cube),r.texture=n.device.createTexture(R)}if(x){const E=Object.assign({},R);E.label=E.label+"-msaa",E.sampleCount=d,r.msaaTexture=n.device.createTexture(E)}r.initialized=!0,r.textureDescriptorGPU=R}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture!==void 0&&n.texture.destroy(),n.msaaTexture!==void 0&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const n=this.backend.get(e);delete n.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let r=0;r<n;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const n=this.backend,{width:r,height:s}=n.getDrawingBufferSize(),o=this.depthTexture,a=n.get(o).texture;let l,u;if(t?(l=Ka,u=Ya):e&&(l=Qa,u=mr),a!==void 0){if(o.image.width===r&&o.image.height===s&&o.format===l&&o.type===u)return a;this.destroyTexture(o)}return o.name="depthBuffer",o.format=l,o.type=u,o.image.width=r,o.image.height=s,this.createTexture(o,{width:r,height:s}),n.get(o).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:r}=n;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,n.texture,r,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY,e.premultiplyAlpha);else if(e.isVideoTexture){const s=e.source.data;n.externalTexture=s}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY,e.premultiplyAlpha);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,r,s,o){const a=this.backend.device,l=this.backend.get(e),u=l.texture,h=l.textureDescriptorGPU.format,d=this._getBytesPerTexel(h);let _=r*d;_=Math.ceil(_/256)*256;const x=a.createBuffer({size:r*s*d,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),b=a.createCommandEncoder();b.copyTextureToBuffer({texture:u,origin:{x:t,y:n,z:o}},{buffer:x,bytesPerRow:_},{width:r,height:s});const R=this._getTypedArrayType(h);a.queue.submit([b.finish()]),await x.mapAsync(GPUMapMode.READ);const E=x.getMappedRange();return new R(E)}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new ps;n.minFilter=br,n.magFilter=br,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new Xy;n.minFilter=br,n.magFilter=br,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,r,s){for(let o=0;o<6;o++){const a=e[o],l=r===!0?Lme[o]:o;a.isDataTexture?this._copyBufferToTexture(a.image,t,n,l,r):this._copyImageToTexture(a,t,n,l,r,s)}}_copyImageToTexture(e,t,n,r,s,o){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r},premultipliedAlpha:o},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new Dme(this.backend.device)),e}_generateMipmaps(e,t,n=0){this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,s,o=0){const a=this.backend.device,l=e.data,u=this._getBytesPerTexel(n.format),h=e.width*u;a.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},l,{offset:e.width*e.height*u*o,bytesPerRow:h},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,s=this._getBlockData(n.format),o=n.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const l=e[a],u=l.width,h=l.height,d=o?n.size.depthOrArrayLayers:1,_=Math.ceil(u/s.width)*s.byteLength,x=_*Math.ceil(h/s.height);for(let b=0;b<d;b++)r.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:b}},l.data,{offset:b*x,bytesPerRow:_,rowsPerImage:Math.ceil(h/s.height)},{width:Math.ceil(u/s.width)*s.width,height:Math.ceil(h/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===we.BC1RGBAUnorm||e===we.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.BC2RGBAUnorm||e===we.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.BC3RGBAUnorm||e===we.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.BC4RUnorm||e===we.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===we.BC5RGUnorm||e===we.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===we.BC6HRGBUFloat||e===we.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===we.BC7RGBAUnorm||e===we.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.ETC2RGB8Unorm||e===we.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.ETC2RGB8A1Unorm||e===we.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.ETC2RGBA8Unorm||e===we.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===we.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===we.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===we.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===we.ASTC4x4Unorm||e===we.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.ASTC5x4Unorm||e===we.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===we.ASTC5x5Unorm||e===we.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===we.ASTC6x5Unorm||e===we.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===we.ASTC6x6Unorm||e===we.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===we.ASTC8x5Unorm||e===we.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===we.ASTC8x6Unorm||e===we.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===we.ASTC8x8Unorm||e===we.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===we.ASTC10x5Unorm||e===we.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===we.ASTC10x6Unorm||e===we.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===we.ASTC10x8Unorm||e===we.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===we.ASTC10x10Unorm||e===we.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===we.ASTC12x10Unorm||e===we.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===we.ASTC12x12Unorm||e===we.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=UM.ClampToEdge;return e===kA?t=UM.Repeat:e===GA&&(t=UM.MirrorRepeat),t}_convertFilterMode(e){let t=cA.Linear;return(e===br||e===H4||e===ph)&&(t=cA.Nearest),t}_getBytesPerTexel(e){if(e===we.R8Unorm||e===we.R8Snorm||e===we.R8Uint||e===we.R8Sint)return 1;if(e===we.R16Uint||e===we.R16Sint||e===we.R16Float||e===we.RG8Unorm||e===we.RG8Snorm||e===we.RG8Uint||e===we.RG8Sint)return 2;if(e===we.R32Uint||e===we.R32Sint||e===we.R32Float||e===we.RG16Uint||e===we.RG16Sint||e===we.RG16Float||e===we.RGBA8Unorm||e===we.RGBA8UnormSRGB||e===we.RGBA8Snorm||e===we.RGBA8Uint||e===we.RGBA8Sint||e===we.BGRA8Unorm||e===we.BGRA8UnormSRGB||e===we.RGB9E5UFloat||e===we.RGB10A2Unorm||e===we.RG11B10UFloat||e===we.Depth32Float||e===we.Depth24Plus||e===we.Depth24PlusStencil8||e===we.Depth32FloatStencil8)return 4;if(e===we.RG32Uint||e===we.RG32Sint||e===we.RG32Float||e===we.RGBA16Uint||e===we.RGBA16Sint||e===we.RGBA16Float)return 8;if(e===we.RGBA32Uint||e===we.RGBA32Sint||e===we.RGBA32Float)return 16}_getTypedArrayType(e){if(e===we.R8Uint)return Uint8Array;if(e===we.R8Sint)return Int8Array;if(e===we.R8Unorm)return Uint8Array;if(e===we.R8Snorm)return Int8Array;if(e===we.RG8Uint)return Uint8Array;if(e===we.RG8Sint)return Int8Array;if(e===we.RG8Unorm)return Uint8Array;if(e===we.RG8Snorm)return Int8Array;if(e===we.RGBA8Uint)return Uint8Array;if(e===we.RGBA8Sint)return Int8Array;if(e===we.RGBA8Unorm)return Uint8Array;if(e===we.RGBA8Snorm)return Int8Array;if(e===we.R16Uint)return Uint16Array;if(e===we.R16Sint)return Int16Array;if(e===we.RG16Uint)return Uint16Array;if(e===we.RG16Sint)return Int16Array;if(e===we.RGBA16Uint)return Uint16Array;if(e===we.RGBA16Sint)return Int16Array;if(e===we.R16Float||e===we.RG16Float||e===we.RGBA16Float)return Uint16Array;if(e===we.R32Uint)return Uint32Array;if(e===we.R32Sint)return Int32Array;if(e===we.R32Float)return Float32Array;if(e===we.RG32Uint)return Uint32Array;if(e===we.RG32Sint)return Int32Array;if(e===we.RG32Float)return Float32Array;if(e===we.RGBA32Uint)return Uint32Array;if(e===we.RGBA32Sint)return Int32Array;if(e===we.RGBA32Float)return Float32Array;if(e===we.BGRA8Unorm||e===we.BGRA8UnormSRGB)return Uint8Array;if(e===we.RGB10A2Unorm||e===we.RGB9E5UFloat||e===we.RG11B10UFloat)return Uint32Array;if(e===we.Depth32Float)return Float32Array;if(e===we.Depth24Plus||e===we.Depth24PlusStencil8)return Uint32Array;if(e===we.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.is3DTexture||e.isData3DTexture?t=qI.ThreeD:t=qI.TwoD,t}}function ZC(i,e=null){const t=i.format,n=i.type,r=i.colorSpace,s=In.getTransfer(r);let o;if(i.isCompressedTexture===!0||i.isCompressedArrayTexture===!0)switch(t){case Kf:o=s===Qt?we.BC1RGBAUnormSRGB:we.BC1RGBAUnorm;break;case Zf:o=s===Qt?we.BC2RGBAUnormSRGB:we.BC2RGBAUnorm;break;case Jf:o=s===Qt?we.BC3RGBAUnormSRGB:we.BC3RGBAUnorm;break;case mm:o=s===Qt?we.ETC2RGB8UnormSRGB:we.ETC2RGB8Unorm;break;case gm:o=s===Qt?we.ETC2RGBA8UnormSRGB:we.ETC2RGBA8Unorm;break;case _m:o=s===Qt?we.ASTC4x4UnormSRGB:we.ASTC4x4Unorm;break;case ym:o=s===Qt?we.ASTC5x4UnormSRGB:we.ASTC5x4Unorm;break;case vm:o=s===Qt?we.ASTC5x5UnormSRGB:we.ASTC5x5Unorm;break;case xm:o=s===Qt?we.ASTC6x5UnormSRGB:we.ASTC6x5Unorm;break;case bm:o=s===Qt?we.ASTC6x6UnormSRGB:we.ASTC6x6Unorm;break;case Sm:o=s===Qt?we.ASTC8x5UnormSRGB:we.ASTC8x5Unorm;break;case Tm:o=s===Qt?we.ASTC8x6UnormSRGB:we.ASTC8x6Unorm;break;case Em:o=s===Qt?we.ASTC8x8UnormSRGB:we.ASTC8x8Unorm;break;case wm:o=s===Qt?we.ASTC10x5UnormSRGB:we.ASTC10x5Unorm;break;case Mm:o=s===Qt?we.ASTC10x6UnormSRGB:we.ASTC10x6Unorm;break;case Rm:o=s===Qt?we.ASTC10x8UnormSRGB:we.ASTC10x8Unorm;break;case Cm:o=s===Qt?we.ASTC10x10UnormSRGB:we.ASTC10x10Unorm;break;case Nm:o=s===Qt?we.ASTC12x10UnormSRGB:we.ASTC12x10Unorm;break;case Dm:o=s===Qt?we.ASTC12x12UnormSRGB:we.ASTC12x12Unorm;break;case es:o=s===Qt?we.RGBA8UnormSRGB:we.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case es:switch(n){case EA:o=we.RGBA8Snorm;break;case wA:o=we.RGBA16Sint;break;case hu:o=we.RGBA16Uint;break;case mr:o=we.RGBA32Uint;break;case Hs:o=we.RGBA32Sint;break;case Vr:o=s===Qt?we.RGBA8UnormSRGB:we.RGBA8Unorm;break;case As:o=we.RGBA16Float;break;case os:o=we.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case qy:switch(n){case sT:o=we.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case Hy:switch(n){case EA:o=we.R8Snorm;break;case wA:o=we.R16Sint;break;case hu:o=we.R16Uint;break;case mr:o=we.R32Uint;break;case Hs:o=we.R32Sint;break;case Vr:o=we.R8Unorm;break;case As:o=we.R16Float;break;case os:o=we.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case mh:switch(n){case EA:o=we.RG8Snorm;break;case wA:o=we.RG16Sint;break;case hu:o=we.RG16Uint;break;case mr:o=we.RG32Uint;break;case Hs:o=we.RG32Sint;break;case Vr:o=we.RG8Unorm;break;case As:o=we.RG16Float;break;case os:o=we.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case Qa:switch(n){case hu:o=we.Depth16Unorm;break;case mr:o=we.Depth24Plus;break;case os:o=we.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case Ka:switch(n){case Ya:o=we.Depth24PlusStencil8;break;case os:e&&e.features.has(KC.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=we.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case ag:switch(n){case Hs:o=we.R32Sint;break;case mr:o=we.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case lg:switch(n){case Hs:o=we.RG32Sint;break;case mr:o=we.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case ug:switch(n){case Hs:o=we.RGBA32Sint;break;case mr:o=we.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return o}const Ime=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Bme=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,HI={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},Ume=i=>{i=i.trim();const e=i.match(Ime);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=Bme.exec(t))!==null;)n.push({name:r[1],type:r[2]});const s=[];for(let h=0;h<n.length;h++){const{name:d,type:_}=n[h];let x=_;x.startsWith("ptr")?x="pointer":(x.startsWith("texture")&&(x=_.split("<")[0]),x=HI[x]),s.push(new J5(x,d))}const o=i.substring(e[0].length),a=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:HI[a]||a,inputs:s,name:l,inputsCode:t,blockCode:o,outputType:a}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class Fme extends t6{constructor(e){const{type:t,inputs:n,name:r,inputsCode:s,blockCode:o,outputType:a}=Ume(e);super(t,n,r),this.inputsCode=s,this.blockCode=o,this.outputType=a}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class kme extends Lq{parseFunction(e){return new Fme(e)}}const yp=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Gme={[To.READ_ONLY]:"read",[To.WRITE_ONLY]:"write",[To.READ_WRITE]:"read_write"},WI={[kA]:"repeat",[Xu]:"clamp",[GA]:"mirror"},zx={vertex:yp?yp.VERTEX:1,fragment:yp?yp.FRAGMENT:2,compute:yp?yp.COMPUTE:4},jI={instance:!0,swizzleAssign:!1,storageBuffer:!0},zme={"^^":"tsl_xor"},Vme={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},XI={},bl={tsl_xor:new hs("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new hs("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new hs("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new hs("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new hs("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new hs("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new hs("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new hs("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new hs("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new hs("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new hs("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new hs("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new hs(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},A_={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(bl.pow_float=new hs("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),bl.pow_vec2=new hs("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[bl.pow_float]),bl.pow_vec3=new hs("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[bl.pow_float]),bl.pow_vec4=new hs("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[bl.pow_float]),A_.pow_float="tsl_pow_float",A_.pow_vec2="tsl_pow_vec2",A_.pow_vec3="tsl_pow_vec3",A_.pow_vec4="tsl_pow_vec4");let qq="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(qq+=`diagnostic( off, derivative_uniformity );
`);class qme extends Pq{constructor(e,t){super(e,t,new kme),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Go}_generateTextureSample(e,t,n,r,s=this.shaderStage){return s==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this._generateTextureSampleLevel(e,t,n,"0",r)}_generateVideoSample(e,t,n=this.shaderStage){if(n==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,t,n,r,s){return this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,s,r)}generateWrapFunction(e){const t=`tsl_coord_${WI[e.wrapS]}S_${WI[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let n=XI[t];if(n===void 0){const r=[],s=e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const a=(l,u)=>{l===kA?(r.push(bl.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${u} )`):l===Xu?(r.push(bl.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${u} )`):l===GA?(r.push(bl.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${u} )`):(o+=`		coord.${u}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${l}" for vertex shader.`))};a(e.wrapS,"x"),o+=`,
`,a(e.wrapT,"y"),e.isData3DTexture&&(o+=`,
`,a(e.wrapR,"z")),o+=`
	);

}
`,XI[t]=n=new hs(o,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let s=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let o,a;const{primarySamples:l}=this.renderer.backend.utils.getTextureSampleData(e),u=l>1;e.isData3DTexture?a="vec3<u32>":a="vec2<u32>",u||e.isVideoTexture||e.isStorageTexture?o=t:o=`${t}${n?`, u32( ${n} )`:""}`,s=new Cb(new Nb(`textureDimensions( ${o} )`,a)),r.dimensionsSnippet[n]=s,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new Cb(new Nb(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new Cb(new Nb("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,n,r="0u"){this._include("biquadraticTexture");const s=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${s}( ${n} ), ${o}, u32( ${r} ) )`}generateTextureLod(e,t,n,r,s="0u"){const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,s),l=e.isData3DTexture?"vec3":"vec2",u=`${l}<u32>( ${o}( ${n} ) * ${l}<f32>( ${a} ) )`;return this.generateTextureLoad(e,t,u,r,s)}generateTextureLoad(e,t,n,r,s="0u"){let o;return e.isVideoTexture===!0?o=`textureLoad( ${t}, ${n} )`:r?o=`textureLoad( ${t}, ${n}, ${r}, u32( ${s} ) )`:(o=`textureLoad( ${t}, ${n}, u32( ${s} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,n,r,s){let o;return r?o=`textureStore( ${t}, ${n}, ${r}, ${s} )`:o=`textureStore( ${t}, ${n}, ${s} )`,o}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===os||this.isSampleCompare(e)===!1&&e.minFilter===br&&e.magFilter===br||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,s=this.shaderStage){let o=null;return e.isVideoTexture===!0?o=this._generateVideoSample(t,n,s):this.isUnfilterable(e)?o=this.generateTextureLod(e,t,n,r,"0",s):o=this._generateTextureSample(e,t,n,r,s),o}generateTextureGrad(e,t,n,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,n,r,s,o=this.shaderStage){if(o==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,n,r,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,n,o):a=this._generateTextureSampleLevel(e,t,n,r,s),a}generateTextureBias(e,t,n,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=zme[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?To.READ_ONLY:e.access}getStorageAccess(e,t){return Gme[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);if(o.uniformGPU===void 0){let a;const l=e.groupNode,u=l.name,h=this.getBindGroupArray(u,n);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let d=null;const _=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?d=new XT(s.name,s.node,l,_):t==="cubeTexture"?d=new kq(s.name,s.node,l,_):t==="texture3D"&&(d=new Gq(s.name,s.node,l,_)),d.store=e.isStorageTextureNode===!0,d.setVisibility(zx[n]),this.isUnfilterable(e.value)===!1&&d.store===!1){const x=new Mme(`${s.name}_sampler`,s.node,l);x.setVisibility(zx[n]),h.push(x,d),a=[x,d]}else h.push(d),a=[d]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const d=t==="buffer"?Uq:Nme,_=new d(e,l);_.setVisibility(zx[n]),h.push(_),a=_,s.name=r||"NodeBuffer_"+s.id}else{const d=this.uniformGroups[n]||(this.uniformGroups[n]={});let _=d[u];_===void 0&&(_=new Fq(u,l),_.setVisibility(zx[n]),d[u]=_,h.push(_)),a=this.getNodeUniform(s,t),_.addUniform(a)}o.uniformGPU=a}return s}getBuiltin(e,t,n,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(o.name+" : "+this.getType(o.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(s+=`	return ${n.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:s,type:o}of n.values())t.push(`@builtin( ${r} ) ${s} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:s,bufferCount:o}of this.scopedArrays.values()){const a=this.getType(s);t.push(`var<${r}> ${n}: array< ${a}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let s=0,o=r.length;s<o;s++){const a=r[s],l=a.name,u=this.getType(a.type);t.push(`@location( ${s} ) ${l} : ${u}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let s=this.getType(n.type);n.atomic&&(s="atomic< "+s+" >"),t.push(`	${r+n.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const s of n){let o=`struct ${s.name} {
`;o+=this.getStructMembers(s),o+=`
};`,r.push(o)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,o=this.vars[e];for(let a=0;a<s.length;a++){const l=s[a];if(l.needsInterpolation){let u=`@location( ${a} )`;if(l.interpolationType){const h=l.interpolationSampling!==null?`, ${l.interpolationSampling} )`:" )";u+=` @interpolate( ${l.interpolationType}${h}`}else/^(int|uint|ivec|uvec)/.test(l.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${u} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&o.includes(l)===!1&&o.push(l)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,s=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!s}getUniforms(e){const t=this.uniforms[e],n=[],r=[],s=[],o={};for(const l of t){const u=l.groupNode.name,h=this.bindingsIndexes[u];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="storageTexture"||l.type==="texture3D"){const d=l.node.value;this.isUnfilterable(d)===!1&&l.node.isStorageTextureNode!==!0&&(this.isSampleCompare(d)?n.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${l.name}_sampler : sampler_comparison;`):n.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${l.name}_sampler : sampler;`));let _,x="";const{primarySamples:b}=this.renderer.backend.utils.getTextureSampleData(d);if(b>1&&(x="_multisampled"),d.isCubeTexture===!0)_="texture_cube<f32>";else if(d.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&d.compareFunction===null?_=`texture${x}_2d<f32>`:_=`texture_depth${x}_2d${d.isArrayTexture===!0?"_array":""}`;else if(l.node.isStorageTextureNode===!0){const R=ZC(d),E=this.getStorageAccess(l.node,e),w=l.node.value.is3DTexture,L=l.node.value.isArrayTexture;_=`texture_storage_${w?"3d":`2d${L?"_array":""}`}<${R}, ${E}>`}else if(d.isArrayTexture===!0||d.isDataArrayTexture===!0||d.isCompressedArrayTexture===!0)_="texture_2d_array<f32>";else if(d.is3DTexture===!0||d.isData3DTexture===!0)_="texture_3d<f32>";else if(d.isVideoTexture===!0)_="texture_external";else{const R=this.getComponentTypeFromTexture(d).charAt(0);_=`texture${x}_2d<${R}32>`}n.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${l.name} : ${_};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const d=l.node,_=this.getType(d.getNodeType(this)),x=d.bufferCount,b=x>0&&l.type==="buffer"?", "+x:"",R=d.isStorageBufferNode?`storage, ${this.getStorageAccess(d,e)}`:"uniform";if(this.isCustomStruct(l))r.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var<${R}> ${l.name} : ${_};`);else{const w=`	value : array< ${d.isAtomic?`atomic<${_}>`:`${_}`}${b} >`;r.push(this._getWGSLStructBinding(l.name,w,R,h.binding++,h.group))}}else{const d=this.getType(this.getVectorType(l.type)),_=l.groupNode.name;(o[_]||(o[_]={index:h.binding++,id:h.group,snippets:[]})).snippets.push(`	${l.name} : ${d}`)}}for(const l in o){const u=o[l];s.push(this._getWGSLStructBinding(l,u.snippets.join(`,
`),"uniform",u.index,u.id))}let a=n.join(`
`);return a+=r.join(`
`),a+=s.join(`
`),a}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],o=s[s.length-1],a=o.outputNode,l=a!==void 0&&a.isOutputStructNode===!0;for(const u of s){const h=this.getFlowData(u),d=u.name;if(d&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${d}
`),r+=`${h.code}
	`,u===o&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${h.result};`;else if(t==="fragment")if(l)n.returnType=a.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${h.result};`;else{let _="	@location(0) color: vec4<f32>";const x=this.getBuiltins("output");x&&(_+=`,
	`+x),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",_),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${h.result};

	return output;`}}}n.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getType(e){return Vme[e]||e}isAvailable(e){let t=jI[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),jI[e]=t),t}_getWGSLMethod(e){return bl[e]!==void 0&&this._include(e),A_[e]}_include(e){const t=bl[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${qq}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,s=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${r} ) @group( ${s} )
var<${n}> ${e} : ${o};`}}class Hme{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=we.Depth24PlusStencil8:e.depth&&(t=we.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,o=s.getRenderTarget();t=o?o.samples:s.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return Xp.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return Xp.LineList;if(e.isLine)return Xp.LineStrip;if(e.isMesh)return Xp.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===Vr)return we.BGRA8Unorm;if(e===As)return we.RGBA16Float;throw new Error("Unsupported outputType")}}const Hq=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&Hq.set(Float16Array,["float16"]);const Wme=new Map([[u9,["float16"]]]),jme=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class Xme{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,s=r.get(n);let o=s.buffer;if(o===void 0){const a=r.device;let l=n.array;if(e.normalized===!1){if(l.constructor===Int16Array||l.constructor===Int8Array)l=new Int32Array(l);else if((l.constructor===Uint16Array||l.constructor===Uint8Array)&&(l=new Uint32Array(l),t&GPUBufferUsage.INDEX))for(let d=0;d<l.length;d++)l[d]===65535&&(l[d]=4294967295)}if(n.array=l,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){l=new l.constructor(n.count*4);for(let d=0;d<n.count;d++)l.set(n.array.subarray(d*3,d*3+3),d*4);n.itemSize=4,n.array=l,s._force3to4BytesAlignment=!0}const u=l.byteLength,h=u+(4-u%4)%4;o=a.createBuffer({label:n.name,size:h,usage:t,mappedAtCreation:!0}),new l.constructor(o.getMappedRange()).set(l),o.unmap(),s.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,s=n.get(t),o=n.get(t).buffer;let a=t.array;if(s._force3to4BytesAlignment===!0){a=new a.constructor(t.count*4);for(let h=0;h<t.count;h++)a.set(t.array.subarray(h*3,h*3+3),h*4);t.array=a}const l=this._isTypedArray(a),u=t.updateRanges;if(u.length===0)r.queue.writeBuffer(o,0,a,0);else{const h=l?1:a.BYTES_PER_ELEMENT;for(let d=0,_=u.length;d<_;d++){const x=u[d];let b,R;if(s._force3to4BytesAlignment===!0){const w=Math.floor(x.start/3),L=Math.ceil(x.count/3);b=w*4*h,R=L*4*h}else b=x.start*h,R=x.count*h;const E=b*(l?a.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(o,E,a,b,R)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const s=t[r],o=s.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(s);let l=n.get(a);if(l===void 0){let d,_;s.isInterleavedBufferAttribute===!0?(d=s.data.stride*o,_=s.data.isInstancedInterleavedBuffer?Gx.Instance:Gx.Vertex):(d=s.itemSize*o,_=s.isInstancedBufferAttribute?Gx.Instance:Gx.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(d=4),l={arrayStride:d,attributes:[],stepMode:_},n.set(a,l)}const u=this._getVertexFormat(s),h=s.isInterleavedBufferAttribute===!0?s.offset*o:0;l.attributes.push({shaderLocation:r,offset:h,format:u})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,s=t.get(this._getBufferAttribute(e)).buffer,o=s.size,a=n.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=n.createCommandEncoder({label:`readback_encoder_${e.name}`});l.copyBufferToBuffer(s,0,a,0,o);const u=l.finish();n.queue.submit([u]),await a.mapAsync(GPUMapMode.READ);const h=a.getMappedRange(),d=new e.array.constructor(h.slice(0));return a.unmap(),d.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,s=e.constructor;let o;if(t===1)o=jme.get(r);else{const l=(Wme.get(s)||Hq.get(r))[n?1:0];if(l){const u=r.BYTES_PER_ELEMENT*t,d=Math.floor((u+3)/4)*4/r.BYTES_PER_ELEMENT;if(d%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${l}x${d}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class $me{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,n=t.device,r=[];let s=0;for(const o of e.bindings){const a={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const l={};o.isStorageBuffer&&(o.visibility&4&&(o.access===To.READ_WRITE||o.access===To.WRITE_ONLY)?l.type=FM.Storage:l.type=FM.ReadOnlyStorage),a.buffer=l}else if(o.isSampler){const l={};o.texture.isDepthTexture&&(o.texture.compareFunction!==null?l.type=VI.Comparison:t.compatibilityMode&&(l.type=VI.NonFiltering)),a.sampler=l}else if(o.isSampledTexture&&o.texture.isVideoTexture)a.externalTexture={};else if(o.isSampledTexture&&o.store){const l={};l.format=this.backend.get(o.texture).texture.format;const u=o.access;u===To.READ_WRITE?l.access=kM.ReadWrite:u===To.WRITE_ONLY?l.access=kM.WriteOnly:l.access=kM.ReadOnly,o.texture.isArrayTexture?l.viewDimension=fs.TwoDArray:o.texture.is3DTexture&&(l.viewDimension=fs.ThreeD),a.storageTexture=l}else if(o.isSampledTexture){const l={},{primarySamples:u}=t.utils.getTextureSampleData(o.texture);if(u>1&&(l.multisampled=!0,o.texture.isDepthTexture||(l.sampleType=Kd.UnfilterableFloat)),o.texture.isDepthTexture)t.compatibilityMode&&o.texture.compareFunction===null?l.sampleType=Kd.UnfilterableFloat:l.sampleType=Kd.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const h=o.texture.type;h===Hs?l.sampleType=Kd.SInt:h===mr?l.sampleType=Kd.UInt:h===os&&(this.backend.hasFeature("float32-filterable")?l.sampleType=Kd.Float:l.sampleType=Kd.UnfilterableFloat)}o.isSampledCubeTexture?l.viewDimension=fs.Cube:o.texture.isArrayTexture||o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?l.viewDimension=fs.TwoDArray:o.isSampledTexture3D&&(l.viewDimension=fs.ThreeD),a.texture=l}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);r.push(a)}return n.createBindGroupLayout({entries:r})}createBindings(e,t,n,r=0){const{backend:s,bindGroupLayoutCache:o}=this,a=s.get(e);let l=o.get(e.bindingsReference);l===void 0&&(l=this.createBindingsLayout(e),o.set(e.bindingsReference,l));let u;n>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[n]===r&&(u=a.groups[n])),u===void 0&&(u=this.createBindGroup(e,l),n>0&&(a.groups[n]=u,a.versions[n]=r)),a.group=u,a.layout=l}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,s=t.get(e).buffer;n.queue.writeBuffer(s,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],a=r.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:s});r.queue.writeBuffer(a,0,e,0);const l=[{binding:0,resource:{buffer:a}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:t,entries:l})}createBindGroup(e,t){const n=this.backend,r=n.device;let s=0;const o=[];for(const a of e.bindings){if(a.isUniformBuffer){const l=n.get(a);if(l.buffer===void 0){const u=a.byteLength,h=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,d=r.createBuffer({label:"bindingBuffer_"+a.name,size:u,usage:h});l.buffer=d}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isStorageBuffer){const l=n.get(a);if(l.buffer===void 0){const u=a.attribute;l.buffer=n.get(u).buffer}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isSampler){const l=n.get(a.texture);o.push({binding:s,resource:l.sampler})}else if(a.isSampledTexture){const l=n.get(a.texture);let u;if(l.externalTexture!==void 0)u=r.importExternalTexture({source:l.externalTexture});else{const h=a.store?1:l.texture.mipLevelCount,d=`view-${l.texture.width}-${l.texture.height}-${h}`;if(u=l[d],u===void 0){const _=Eme.All;let x;a.isSampledCubeTexture?x=fs.Cube:a.isSampledTexture3D?x=fs.ThreeD:a.texture.isArrayTexture||a.texture.isDataArrayTexture||a.texture.isCompressedArrayTexture?x=fs.TwoDArray:x=fs.TwoD,u=l[d]=l.texture.createView({aspect:_,dimension:x,mipLevelCount:h})}}o.push({binding:s,resource:u})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class Yme{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:s,pipeline:o}=e,{vertexProgram:a,fragmentProgram:l}=o,u=this.backend,h=u.device,d=u.utils,_=u.get(o),x=[];for(const K of e.getBindings()){const se=u.get(K);x.push(se.layout)}const b=u.attributeUtils.createShaderVertexBuffers(e);let R;r.blending!==ga&&(r.blending!==Wo||r.transparent!==!1)&&(R=this._getBlending(r));let E={};r.stencilWrite===!0&&(E={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const w=this._getColorWriteMask(r),L=[];if(e.context.textures!==null){const K=e.context.textures;for(let se=0;se<K.length;se++){const ee=d.getTextureFormatGPU(K[se]);L.push({format:ee,blend:R,writeMask:w})}}else{const K=d.getCurrentColorFormat(e.context);L.push({format:K,blend:R,writeMask:w})}const D=u.get(a).module,O=u.get(l).module,B=this._getPrimitiveState(n,s,r),G=this._getDepthCompare(r),k=d.getCurrentDepthStencilFormat(e.context),z=this._getSampleCount(e.context),F={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},D,{buffers:b}),fragment:Object.assign({},O,{targets:L}),primitive:B,multisample:{count:z,alphaToCoverageEnabled:r.alphaToCoverage&&z>1},layout:h.createPipelineLayout({bindGroupLayouts:x})},q={},H=e.context.depth,Q=e.context.stencil;if((H===!0||Q===!0)&&(H===!0&&(q.format=k,q.depthWriteEnabled=r.depthWrite,q.depthCompare=G),Q===!0&&(q.stencilFront=E,q.stencilBack={},q.stencilReadMask=r.stencilFuncMask,q.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(q.depthBias=r.polygonOffsetUnits,q.depthBiasSlopeScale=r.polygonOffsetFactor,q.depthBiasClamp=0),F.depthStencil=q),t===null)_.pipeline=h.createRenderPipeline(F);else{const K=new Promise(se=>{h.createRenderPipelineAsync(F).then(ee=>{_.pipeline=ee,se()})});t.push(K)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:s}=n,o=r.getCurrentDepthStencilFormat(e),a=r.getCurrentColorFormat(e),l=this._getSampleCount(e),u={label:t,colorFormats:[a],depthStencilFormat:o,sampleCount:l};return s.createRenderBundleEncoder(u)}createComputePipeline(e,t){const n=this.backend,r=n.device,s=n.get(e.computeProgram).module,o=n.get(e),a=[];for(const l of t){const u=n.get(l);a.push(u.layout)}o.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,n;const r=e.blending,s=e.blendSrc,o=e.blendDst,a=e.blendEquation;if(r===Kp){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,u=e.blendDstAlpha!==null?e.blendDstAlpha:o,h=e.blendEquationAlpha!==null?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(a)},n={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(h)}}else{const l=e.premultipliedAlpha,u=(h,d,_,x)=>{t={srcFactor:h,dstFactor:d,operation:Qd.Add},n={srcFactor:_,dstFactor:x,operation:Qd.Add}};if(l)switch(r){case Wo:u(yi.One,yi.OneMinusSrcAlpha,yi.One,yi.OneMinusSrcAlpha);break;case hm:u(yi.One,yi.One,yi.One,yi.One);break;case fm:u(yi.Zero,yi.OneMinusSrc,yi.Zero,yi.One);break;case dm:u(yi.Dst,yi.OneMinusSrcAlpha,yi.Zero,yi.One);break}else switch(r){case Wo:u(yi.SrcAlpha,yi.OneMinusSrcAlpha,yi.One,yi.OneMinusSrcAlpha);break;case hm:u(yi.SrcAlpha,yi.One,yi.One,yi.One);break;case fm:console.error("THREE.WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case dm:console.error("THREE.WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true");break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case ah:t=yi.Zero;break;case I4:t=yi.One;break;case B4:t=yi.Src;break;case U4:t=yi.OneMinusSrc;break;case k_:t=yi.SrcAlpha;break;case G_:t=yi.OneMinusSrcAlpha;break;case G4:t=yi.Dst;break;case z4:t=yi.OneMinusDst;break;case F4:t=yi.DstAlpha;break;case k4:t=yi.OneMinusDstAlpha;break;case V4:t=yi.SrcAlphaSaturated;break;case rfe:t=yi.Constant;break;case sfe:t=yi.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case y$:t=no.Never;break;case FR:t=no.Always;break;case v$:t=no.Less;break;case b$:t=no.LessEqual;break;case x$:t=no.Equal;break;case E$:t=no.GreaterEqual;break;case S$:t=no.Greater;break;case T$:t=no.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case nA:t=Nf.Keep;break;case f$:t=Nf.Zero;break;case d$:t=Nf.Replace;break;case _$:t=Nf.Invert;break;case A$:t=Nf.IncrementClamp;break;case p$:t=Nf.DecrementClamp;break;case m$:t=Nf.IncrementWrap;break;case g$:t=Nf.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case bo:t=Qd.Add;break;case L4:t=Qd.Subtract;break;case O4:t=Qd.ReverseSubtract;break;case QU:t=Qd.Min;break;case KU:t=Qd.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},s=this.backend.utils;switch(r.topology=s.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?Xm.Uint16:Xm.Uint32),n.side){case ma:r.frontFace=IM.CCW,r.cullMode=BM.Back;break;case Zi:r.frontFace=IM.CCW,r.cullMode=BM.Front;break;case ss:r.frontFace=IM.CCW,r.cullMode=BM.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?zI.All:zI.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=no.Always;else{const n=e.depthFunc;switch(n){case z_:t=no.Never;break;case V_:t=no.Always;break;case q_:t=no.Less;break;case od:t=no.LessEqual;break;case H_:t=no.Equal;break;case W_:t=no.GreaterEqual;break;case j_:t=no.Greater;break;case X_:t=no.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class Qme extends Vq{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Za(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const s=r.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,n));let a=0;for(const[,l]of e){const u=o[l],h=o[l+1],d=Number(h-u)/1e6;a+=d}return this.resultBuffer.unmap(),this.lastValue=a,a}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class Kme extends zq{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new Hme(this),this.attributeUtils=new Xme(this),this.bindingUtils=new $me(this),this.pipelineUtils=new Yme(this),this.textureUtils=new Ome(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const o={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},a=typeof navigator<"u"?await navigator.gpu.requestAdapter(o):null;if(a===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const l=Object.values(KC),u=[];for(const d of l)a.features.has(d)&&u.push(d);const h={requiredFeatures:u,requiredLimits:t.requiredLimits};n=await a.requestDevice(h)}else n=t.device;n.lost.then(o=>{const a={api:"WebGPU",message:o.message||"Unknown reason",reason:o.reason||null,originalEvent:o};e.onDeviceLost(a)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=r;const s=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(KC.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s}),this.updateSize()}get coordinateSystem(){return lc}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const n=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(n.depth,n.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let s=r.descriptors;if(s===void 0||r.width!==n.width||r.height!==n.height||r.dimensions!==n.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==n.samples){s={},r.descriptors=s;const u=()=>{n.removeEventListener("dispose",u),this.delete(n)};n.hasEventListener("dispose",u)===!1&&n.addEventListener("dispose",u)}const o=e.getCacheKey();let a=s[o];if(a===void 0){const u=e.textures,h=[];let d;const _=this._isRenderCameraDepthArray(e);for(let x=0;x<u.length;x++){const b=this.get(u[x]),R={label:`colorAttachment_${x}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:fs.TwoD};if(n.isRenderTarget3D)d=e.activeCubeFace,R.baseArrayLayer=0,R.dimension=fs.ThreeD,R.depthOrArrayLayers=u[x].image.depth;else if(n.isRenderTarget&&u[x].image.depth>1)if(_===!0){const E=e.camera.cameras;for(let w=0;w<E.length;w++){const L={...R,baseArrayLayer:w,arrayLayerCount:1,dimension:fs.TwoD},D=b.texture.createView(L);h.push({view:D,resolveTarget:void 0,depthSlice:void 0})}}else R.dimension=fs.TwoDArray,R.depthOrArrayLayers=u[x].image.depth;if(_!==!0){const E=b.texture.createView(R);let w,L;b.msaaTexture!==void 0?(w=b.msaaTexture.createView(),L=E):(w=E,L=void 0),h.push({view:w,resolveTarget:L,depthSlice:d})}}if(a={textureViews:h},e.depth){const x=this.get(e.depthTexture),b={};e.depthTexture.isArrayTexture&&(b.dimension=fs.TwoD,b.arrayLayerCount=1,b.baseArrayLayer=e.activeCubeFace),a.depthStencilView=x.texture.createView(b)}s[o]=a,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=n.dimensions}const l={colorAttachments:[]};for(let u=0;u<a.textureViews.length;u++){const h=a.textureViews[u];let d={r:0,g:0,b:0,a:1};u===0&&t.clearValue&&(d=t.clearValue),l.colorAttachments.push({view:h.view,depthSlice:h.depthSlice,resolveTarget:h.resolveTarget,loadOp:t.loadOp||ki.Load,storeOp:t.storeOp||Io.Store,clearValue:d})}return a.depthStencilView&&(l.depthStencilAttachment={view:a.depthStencilView}),l}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:ki.Load}),this.initTimestampQuery(e,o),o.occlusionQuerySet=s;const a=o.depthStencilAttachment;if(e.textures!==null){const u=o.colorAttachments;for(let h=0;h<u.length;h++){const d=u[h];e.clearColor?(d.clearValue=h===0?e.clearColorValue:{r:0,g:0,b:0,a:1},d.loadOp=ki.Clear):d.loadOp=ki.Load,d.storeOp=Io.Store}}else{const u=o.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=ki.Clear):u.loadOp=ki.Load,u.storeOp=Io.Store}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=ki.Clear):a.depthLoadOp=ki.Load,a.depthStoreOp=Io.Store),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=ki.Clear):a.stencilLoadOp=ki.Load,a.stencilStoreOp=Io.Store);const l=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,t,o,u):this._updateDepthLayerDescriptors(e,t,u),t.bundleEncoders=[],t.bundleSets=[];for(let h=0;h<u.length;h++){const d=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+h),_={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(d),t.bundleSets.push(_)}t.currentPass=null}else{const u=l.beginRenderPass(o);if(t.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor){const{x:h,y:d,width:_,height:x}=e.scissorValue;u.setScissorRect(h,d,_,x)}}t.descriptor=o,t.encoder=l,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const s=n.depthStencilAttachment;t.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let a=0;a<r.length;a++){const l={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[a].view}]};if(n.depthStencilAttachment){const u=a;o.viewCache[u]||(o.viewCache[u]=o.texture.createView({dimension:fs.TwoD,baseArrayLayer:a,arrayLayerCount:1})),l.depthStencilAttachment={view:o.viewCache[u],depthLoadOp:s.depthLoadOp||ki.Clear,depthStoreOp:s.depthStoreOp||Io.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(l.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,l.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,l.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else l.depthStencilAttachment={...s};t.layerDescriptors.push(l)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const s=t.layerDescriptors[r];if(s.depthStencilAttachment){const o=s.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=ki.Clear):o.depthLoadOp=ki.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=ki.Clear):o.stencilLoadOp=ki.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let o=0;o<t.bundleEncoders.length;o++){const a=t.bundleEncoders[o];s.push(a.finish())}for(let o=0;o<t.layerDescriptors.length;o++)if(o<s.length){const a=t.layerDescriptors[o],l=r.beginRenderPass(a);if(e.viewport){const{x:u,y:h,width:d,height:_,minDepth:x,maxDepth:b}=e.viewportValue;l.setViewport(u,h,d,_,x,b)}if(e.scissor){const{x:u,y:h,width:d,height:_}=e.scissorValue;l.setScissorRect(u,h,d,_)}l.executeBundles([s[o]]),l.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const s=n*8;let o=this.occludedResolveCache.get(s);o===void 0&&(o=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,o));const a=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,o,0),t.encoder.copyBufferToBuffer(o,0,a,0,s),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let o=0;o<s.length;o++){const a=s[o];a.generateMipmaps===!0&&this.textureUtils.generateMipmaps(a)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const o=n.getMappedRange(),a=new BigUint64Array(o);for(let l=0;l<r.length;l++)a[l]===BigInt(0)&&s.add(r[l]);n.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:s,height:o,minDepth:a,maxDepth:l}=e.viewportValue;t.setViewport(n,r,s,o,a,l)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const s=this.device,o=this.renderer;let a=[],l,u,h,d;if(e){const b=this.getClearColor();u={r:b.r,g:b.g,b:b.b,a:b.a}}if(r===null){h=o.depth,d=o.stencil;const b=this._getDefaultRenderPassDescriptor();if(e){a=b.colorAttachments;const R=a[0];R.clearValue=u,R.loadOp=ki.Clear,R.storeOp=Io.Store}(h||d)&&(l=b.depthStencilAttachment)}else{h=r.depth,d=r.stencil;const b={loadOp:e?ki.Clear:ki.Load,clearValue:e?u:void 0};h&&(b.depthLoadOp=t?ki.Clear:ki.Load,b.depthClearValue=t?o.getClearDepth():void 0,b.depthStoreOp=Io.Store),d&&(b.stencilLoadOp=n?ki.Clear:ki.Load,b.stencilClearValue=n?o.getClearStencil():void 0,b.stencilStoreOp=Io.Store);const R=this._getRenderPassDescriptor(r,b);a=R.colorAttachments,l=R.depthStencilAttachment}h&&l&&l.depthLoadOp===void 0&&(t?(l.depthLoadOp=ki.Clear,l.depthClearValue=o.getClearDepth(),l.depthStoreOp=Io.Store):(l.depthLoadOp=ki.Load,l.depthStoreOp=Io.Store)),d&&l&&l.stencilLoadOp===void 0&&(n?(l.stencilLoadOp=ki.Clear,l.stencilClearValue=o.getClearStencil(),l.stencilStoreOp=Io.Store):(l.stencilLoadOp=ki.Load,l.stencilStoreOp=Io.Store));const _=s.createCommandEncoder({label:"clear"});_.beginRenderPass({colorAttachments:a,depthStencilAttachment:l}).end(),s.queue.submit([_.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r){const{passEncoderGPU:s}=this.get(e),o=this.get(r).pipeline;this.pipelineUtils.setPipeline(s,o);for(let h=0,d=n.length;h<d;h++){const _=n[h],x=this.get(_);s.setBindGroup(h,x.group)}const a=this.device.limits.maxComputeWorkgroupsPerDimension,l=this.get(t);l.dispatchSize===void 0&&(l.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=l;t.dispatchCount>a?(u.x=Math.min(t.dispatchCount,a),u.y=Math.ceil(t.dispatchCount/a)):u.x=t.dispatchCount,s.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:n,material:r,context:s,pipeline:o}=e,a=e.getBindings(),l=this.get(s),u=this.get(o).pipeline,h=e.getIndex(),d=h!==null,_=e.getDrawParameters();if(_===null)return;const x=(R,E)=>{this.pipelineUtils.setPipeline(R,u),E.pipeline=u;const w=E.bindingGroups;for(let D=0,O=a.length;D<O;D++){const B=a[D],G=this.get(B);w[B.index]!==B.id&&(R.setBindGroup(B.index,G.group),w[B.index]=B.id)}if(d===!0&&E.index!==h){const D=this.get(h).buffer,O=h.array instanceof Uint16Array?Xm.Uint16:Xm.Uint32;R.setIndexBuffer(D,O),E.index=h}const L=e.getVertexBuffers();for(let D=0,O=L.length;D<O;D++){const B=L[D];if(E.attributes[D]!==B){const G=this.get(B).buffer;R.setVertexBuffer(D,G),E.attributes[D]=B}}s.stencil===!0&&r.stencilWrite===!0&&l.currentStencilRef!==r.stencilRef&&(R.setStencilReference(r.stencilRef),l.currentStencilRef=r.stencilRef)},b=(R,E)=>{if(x(R,E),n.isBatchedMesh===!0){const w=n._multiDrawStarts,L=n._multiDrawCounts,D=n._multiDrawCount,O=n._multiDrawInstances;O!==null&&Za("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let B=0;B<D;B++){const G=O?O[B]:1,k=G>1?0:B;d===!0?R.drawIndexed(L[B],G,w[B]/h.array.BYTES_PER_ELEMENT,0,k):R.draw(L[B],G,w[B],k),t.update(n,L[B],G)}}else if(d===!0){const{vertexCount:w,instanceCount:L,firstVertex:D}=_,O=e.getIndirect();if(O!==null){const B=this.get(O).buffer;R.drawIndexedIndirect(B,0)}else R.drawIndexed(w,L,D,0,0);t.update(n,w,L)}else{const{vertexCount:w,instanceCount:L,firstVertex:D}=_,O=e.getIndirect();if(O!==null){const B=this.get(O).buffer;R.drawIndirect(B,0)}else R.draw(w,L,D,0);t.update(n,w,L)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const R=this.get(e.camera),E=e.camera.cameras,w=e.getBindingGroup("cameraIndex");if(R.indexesGPU===void 0||R.indexesGPU.length!==E.length){const D=this.get(w),O=[],B=new Uint32Array([0,0,0,0]);for(let G=0,k=E.length;G<k;G++){B[0]=G;const z=this.bindingUtils.createBindGroupIndex(B,D.layout);O.push(z)}R.indexesGPU=O}const L=this.renderer.getPixelRatio();for(let D=0,O=E.length;D<O;D++){const B=E[D];if(n.layers.test(B.layers)){const G=B.viewport;let k=l.currentPass,z=l.currentSets;if(l.bundleEncoders){const F=l.bundleEncoders[D],q=l.bundleSets[D];k=F,z=q}G&&k.setViewport(Math.floor(G.x*L),Math.floor(G.y*L),Math.floor(G.width*L),Math.floor(G.height*L),s.viewportValue.minDepth,s.viewportValue.maxDepth),w&&R.indexesGPU&&(k.setBindGroup(w.index,R.indexesGPU[D]),z.bindingGroups[w.index]=w.id),b(k,z)}}}else if(l.currentPass){if(l.occlusionQuerySet!==void 0){const R=l.lastOcclusionObject;R!==n&&(R!==null&&R.occlusionTest===!0&&(l.currentPass.endOcclusionQuery(),l.occlusionQueryIndex++),n.occlusionTest===!0&&(l.currentPass.beginOcclusionQuery(l.occlusionQueryIndex),l.occlusionQueryObjects[l.occlusionQueryIndex]=n),l.lastOcclusionObject=n)}b(l.currentPass,l.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,s=this.utils,o=s.getSampleCountRenderContext(e.context),a=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),u=s.getCurrentDepthStencilFormat(e.context),h=s.getPrimitiveTopology(n,r);let d=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==a||t.colorFormat!==l||t.depthStencilFormat!==u||t.primitiveTopology!==h||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=a,t.colorFormat=l,t.depthStencilFormat=u,t.primitiveTopology=h,t.clippingContextCacheKey=e.clippingContextCacheKey,d=!0),d}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,s=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new Qme(this.device,n,2048));const r=this.timestampQueryPool[n],s=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new qme(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),s=n.currentPass.finish();this.get(t).bundleGPU=s,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,o=0){let a=0,l=0,u=0,h=0,d=0,_=0,x=e.image.width,b=e.image.height,R=1;n!==null&&(n.isBox3===!0?(h=n.min.x,d=n.min.y,_=n.min.z,x=n.max.x-n.min.x,b=n.max.y-n.min.y,R=n.max.z-n.min.z):(h=n.min.x,d=n.min.y,x=n.max.x-n.min.x,b=n.max.y-n.min.y,R=1)),r!==null&&(a=r.x,l=r.y,u=r.z||0);const E=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),w=this.get(e).texture,L=this.get(t).texture;E.copyTextureToTexture({texture:w,mipLevel:s,origin:{x:h,y:d,z:_}},{texture:L,mipLevel:o,origin:{x:a,y:l,z:u}},[x,b,R]),this.device.queue.submit([E.finish()]),o===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format!==o.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,o.format);return}let a;if(r.currentPass?(r.currentPass.end(),a=r.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:s,origin:[n.x,n.y,0]},{texture:o},[n.z,n.w]),r.currentPass){const{descriptor:l}=r;for(let u=0;u<l.colorAttachments.length;u++)l.colorAttachments[u].loadOp=ki.Load;if(t.depth&&(l.depthStencilAttachment.depthLoadOp=ki.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=ki.Load),r.currentPass=a.beginRenderPass(l),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:u,y:h,width:d,height:_}=t.scissorValue;r.currentPass.setScissorRect(u,h,d,_)}}else this.device.queue.submit([a.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class Zme extends p8{constructor(e,t,n,r,s,o){super(e,t,n,r,s,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class Jme extends p8{constructor(e,t,n,r,s,o){super(e,t,n,r,s,o),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class ege extends Oq{constructor(){super(),this.addMaterial(Jce,"MeshPhongMaterial"),this.addMaterial(DV,"MeshStandardMaterial"),this.addMaterial(khe,"MeshPhysicalMaterial"),this.addMaterial(qhe,"MeshToonMaterial"),this.addMaterial(jce,"MeshBasicMaterial"),this.addMaterial(Kce,"MeshLambertMaterial"),this.addMaterial(zce,"MeshNormalMaterial"),this.addMaterial(Whe,"MeshMatcapMaterial"),this.addMaterial(Oce,"LineBasicMaterial"),this.addMaterial(Bce,"LineDashedMaterial"),this.addMaterial(Yhe,"PointsMaterial"),this.addMaterial(LV,"SpriteMaterial"),this.addMaterial(Zhe,"ShadowMaterial"),this.addLight(HAe,fQ),this.addLight(Dpe,M9),this.addLight(Ppe,AQ),this.addLight(e6,p8),this.addLight(Bpe,m8),this.addLight(Upe,uQ),this.addLight(Fpe,mQ),this.addLight(Lpe,Zme),this.addLight(Ipe,Jme),this.addToneMapping(QV,e9),this.addToneMapping(KV,t9),this.addToneMapping(ZV,n9),this.addToneMapping(JV,i9),this.addToneMapping(eq,r9),this.addToneMapping(tq,s9)}}class Wq extends ime{constructor(e={}){let t;e.forceWebGL?t=GI:(t=Kme,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new GI(e)));const n=new t(e);super(n,e),this.library=new ege,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */W.BRDF_GGX;W.BRDF_Lambert;W.BasicShadowFilter;W.Break;W.Continue;W.DFGApprox;W.D_GGX;W.Discard;W.EPSILON;W.F_Schlick;const tge=W.Fn;W.INFINITY;const nge=W.If;W.Switch;const ige=W.Loop;W.NodeShaderStage;W.NodeType;W.NodeUpdateType;W.NodeAccess;W.PCFShadowFilter;W.PCFSoftShadowFilter;W.PI;W.PI2;W.Return;W.Schlick_to_F0;W.ScriptableNodeResources;W.ShaderNode;W.TBNViewMatrix;W.VSMShadowFilter;W.V_GGX_SmithCorrelated;W.abs;W.acesFilmicToneMapping;W.acos;W.add;W.addNodeElement;W.agxToneMapping;W.all;W.alphaT;W.and;W.anisotropy;W.anisotropyB;W.anisotropyT;W.any;W.append;W.array;W.arrayBuffer;const rge=W.asin;W.assign;W.atan;W.atan2;W.atomicAdd;W.atomicAnd;W.atomicFunc;W.atomicMax;W.atomicMin;W.atomicOr;W.atomicStore;W.atomicSub;W.atomicXor;W.atomicLoad;W.attenuationColor;W.attenuationDistance;W.attribute;W.attributeArray;W.backgroundBlurriness;W.backgroundIntensity;W.backgroundRotation;W.batch;W.bentNormalView;W.billboarding;W.bitAnd;W.bitNot;W.bitOr;W.bitXor;W.bitangentGeometry;W.bitangentLocal;W.bitangentView;W.bitangentWorld;W.bitcast;W.blendBurn;W.blendColor;W.blendDodge;W.blendOverlay;W.blendScreen;W.blur;W.bool;W.buffer;W.bufferAttribute;W.bumpMap;W.burn;W.bvec2;W.bvec3;W.bvec4;W.bypass;W.cache;W.call;W.cameraFar;W.cameraIndex;W.cameraNear;W.cameraNormalMatrix;W.cameraPosition;W.cameraProjectionMatrix;W.cameraProjectionMatrixInverse;W.cameraViewMatrix;W.cameraWorldMatrix;W.cbrt;W.cdl;W.ceil;W.checker;W.cineonToneMapping;W.clamp;W.clearcoat;W.clearcoatRoughness;W.code;W.color;W.colorSpaceToWorking;W.colorToDirection;W.compute;W.computeSkinning;W.cond;W.Const;W.context;W.convert;W.convertColorSpace;W.convertToTexture;const sge=W.cos;W.cross;W.cubeTexture;W.dFdx;W.dFdy;W.dashSize;W.debug;W.decrement;W.decrementBefore;W.defaultBuildStages;W.defaultShaderStages;W.defined;W.degrees;W.deltaTime;W.densityFog;W.densityFogFactor;W.depth;W.depthPass;W.difference;W.diffuseColor;W.directPointLight;W.directionToColor;W.dispersion;W.distance;W.div;W.dodge;W.dot;W.drawIndex;W.dynamicBufferAttribute;W.element;W.emissive;W.equal;W.equals;W.equirectUV;const oge=W.exp;W.exp2;W.expression;W.faceDirection;W.faceForward;W.faceforward;const age=W.float;W.floor;W.fog;W.fract;W.frameGroup;W.frameId;W.frontFacing;W.fwidth;W.gain;W.gapSize;W.getConstNodeType;W.getCurrentStack;W.getDirection;W.getDistanceAttenuation;W.getGeometryRoughness;W.getNormalFromDepth;W.getParallaxCorrectNormal;W.getRoughness;W.getScreenPosition;W.getShIrradianceAt;W.getTextureIndex;W.getViewPosition;W.getShadowMaterial;W.getShadowRenderObjectFunction;W.glsl;W.glslFn;W.grayscale;W.greaterThan;W.greaterThanEqual;W.hash;W.highpModelNormalViewMatrix;W.highpModelViewMatrix;W.hue;W.increment;W.incrementBefore;W.instance;const lge=W.instanceIndex;W.instancedArray;W.instancedBufferAttribute;W.instancedDynamicBufferAttribute;W.instancedMesh;W.int;W.inverseSqrt;W.inversesqrt;W.invocationLocalIndex;W.invocationSubgroupIndex;W.ior;W.iridescence;W.iridescenceIOR;W.iridescenceThickness;W.ivec2;W.ivec3;W.ivec4;W.js;W.label;W.length;W.lengthSq;W.lessThan;W.lessThanEqual;W.lightPosition;W.lightShadowMatrix;W.lightTargetDirection;W.lightTargetPosition;W.lightViewPosition;W.lightingContext;W.lights;W.linearDepth;W.linearToneMapping;W.localId;W.globalId;W.log;W.log2;W.logarithmicDepthToViewZ;W.loop;W.luminance;W.mediumpModelViewMatrix;W.mat2;W.mat3;W.mat4;W.matcapUV;W.materialAO;W.materialAlphaTest;W.materialAnisotropy;W.materialAnisotropyVector;W.materialAttenuationColor;W.materialAttenuationDistance;W.materialClearcoat;W.materialClearcoatNormal;W.materialClearcoatRoughness;W.materialColor;W.materialDispersion;W.materialEmissive;W.materialIOR;W.materialIridescence;W.materialIridescenceIOR;W.materialIridescenceThickness;W.materialLightMap;W.materialLineDashOffset;W.materialLineDashSize;W.materialLineGapSize;W.materialLineScale;W.materialLineWidth;W.materialMetalness;W.materialNormal;W.materialOpacity;W.materialPointSize;W.materialReference;W.materialReflectivity;W.materialRefractionRatio;W.materialRotation;W.materialRoughness;W.materialSheen;W.materialSheenRoughness;W.materialShininess;W.materialSpecular;W.materialSpecularColor;W.materialSpecularIntensity;W.materialSpecularStrength;W.materialThickness;W.materialTransmission;W.max;W.maxMipLevel;W.metalness;W.min;W.mix;W.mixElement;W.mod;W.modInt;W.modelDirection;W.modelNormalMatrix;W.modelPosition;W.modelRadius;W.modelScale;W.modelViewMatrix;W.modelViewPosition;W.modelViewProjection;W.modelWorldMatrix;W.modelWorldMatrixInverse;W.morphReference;W.mrt;W.mul;W.mx_aastep;W.mx_cell_noise_float;W.mx_contrast;W.mx_fractal_noise_float;W.mx_fractal_noise_vec2;W.mx_fractal_noise_vec3;W.mx_fractal_noise_vec4;W.mx_hsvtorgb;W.mx_noise_float;W.mx_noise_vec3;W.mx_noise_vec4;W.mx_ramplr;W.mx_ramptb;W.mx_rgbtohsv;W.mx_safepower;W.mx_splitlr;W.mx_splittb;W.mx_srgb_texture_to_lin_rec709;W.mx_transform_uv;W.mx_worley_noise_float;W.mx_worley_noise_vec2;W.mx_worley_noise_vec3;const uge=W.negate;W.neutralToneMapping;W.nodeArray;W.nodeImmutable;W.nodeObject;W.nodeObjects;W.nodeProxy;W.normalFlat;W.normalGeometry;W.normalLocal;W.normalMap;W.normalView;W.normalViewGeometry;W.normalWorld;W.normalWorldGeometry;W.normalize;W.not;W.notEqual;W.numWorkgroups;W.objectDirection;W.objectGroup;W.objectPosition;W.objectRadius;W.objectScale;W.objectViewPosition;W.objectWorldMatrix;W.oneMinus;W.or;W.orthographicDepthToViewZ;W.oscSawtooth;W.oscSine;W.oscSquare;W.oscTriangle;W.output;W.outputStruct;W.overlay;W.overloadingFn;W.parabola;W.parallaxDirection;W.parallaxUV;W.parameter;W.pass;W.passTexture;W.pcurve;W.perspectiveDepthToViewZ;W.pmremTexture;W.pointUV;W.pointWidth;W.positionGeometry;W.positionLocal;W.positionPrevious;W.positionView;W.positionViewDirection;W.positionWorld;W.positionWorldDirection;W.posterize;W.pow;W.pow2;W.pow3;W.pow4;W.premultiplyAlpha;W.property;W.radians;W.rand;W.range;W.rangeFog;W.rangeFogFactor;W.reciprocal;W.lightProjectionUV;W.reference;W.referenceBuffer;W.reflect;W.reflectVector;W.reflectView;W.reflector;W.refract;W.refractVector;W.refractView;W.reinhardToneMapping;W.remainder;W.remap;W.remapClamp;W.renderGroup;W.renderOutput;W.rendererReference;W.rotate;W.rotateUV;W.roughness;W.round;W.rtt;W.sRGBTransferEOTF;W.sRGBTransferOETF;W.sample;W.sampler;W.samplerComparison;W.saturate;W.saturation;W.screen;W.screenCoordinate;W.screenSize;W.screenUV;W.scriptable;W.scriptableValue;W.select;W.setCurrentStack;W.shaderStages;W.shadow;W.pointShadow;W.shadowPositionWorld;W.sharedUniformGroup;W.shapeCircle;W.sheen;W.sheenRoughness;W.shiftLeft;W.shiftRight;W.shininess;W.sign;const cge=W.sin;W.sinc;W.skinning;W.smoothstep;W.smoothstepElement;W.specularColor;W.specularF90;W.spherizeUV;W.split;W.spritesheetUV;const hge=W.sqrt;W.stack;W.step;const fge=W.storage;W.storageBarrier;W.storageObject;W.storageTexture;W.string;W.struct;W.sub;W.subBuild;W.subgroupIndex;W.subgroupSize;W.tan;W.tangentGeometry;W.tangentLocal;W.tangentView;W.tangentWorld;W.temp;W.texture;W.texture3D;W.textureBarrier;W.textureBicubic;W.textureBicubicLevel;W.textureCubeUV;W.textureLoad;W.textureSize;W.textureStore;W.thickness;W.time;W.timerDelta;W.timerGlobal;W.timerLocal;W.toneMapping;W.toneMappingExposure;W.toonOutlinePass;W.transformDirection;W.transformNormal;W.transformNormalToView;W.transformedClearcoatNormalView;W.transformedNormalView;W.transformedNormalWorld;W.transmission;W.transpose;W.triNoise3D;W.triplanarTexture;W.triplanarTextures;W.trunc;W.tslFn;W.uint;const dge=W.uniform;W.uniformCubeTexture;W.uniformArray;W.uniformGroup;W.uniformTexture;W.uniforms;W.unpremultiplyAlpha;W.userData;W.uv;W.uvec2;W.uvec3;W.uvec4;W.Var;W.varying;W.varyingProperty;W.vec2;W.vec3;W.vec4;W.vectorComponents;W.velocity;W.vertexColor;W.vertexIndex;W.vibrance;W.viewZToLogarithmicDepth;W.viewZToOrthographicDepth;W.viewZToPerspectiveDepth;W.viewport;W.viewportBottomLeft;W.viewportCoordinate;W.viewportDepthTexture;W.viewportLinearDepth;W.viewportMipTexture;W.viewportResolution;W.viewportSafeUV;W.viewportSharedTexture;W.viewportSize;W.viewportTexture;W.viewportTopLeft;W.viewportUV;W.wgsl;W.wgslFn;W.workgroupArray;W.workgroupBarrier;W.workgroupId;W.workingToColorSpace;W.xor;const $I=new kh,Vx=new ce;class jq extends gQ{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new Si(e,3)),this.setAttribute("uv",new Si(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Vb(t,6,1);return this.setAttribute("instanceStart",new $u(n,3,0)),this.setAttribute("instanceEnd",new $u(n,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Vb(t,6,1);return this.setAttribute("instanceColorStart",new $u(n,3,0)),this.setAttribute("instanceColorEnd",new $u(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new YY(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new kh);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),$I.setFromBufferAttribute(t),this.boundingBox.union($I))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new cd),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Vx.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Vx)),Vx.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(Vx));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}zt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new it(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};ia.line={uniforms:lT.merge([zt.common,zt.fog,zt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			float alpha = opacity;
			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class i6 extends ya{constructor(e){super({type:"LineMaterial",uniforms:lT.clone(ia.line.uniforms),vertexShader:ia.line.vertexShader,fragmentShader:ia.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const GM=new mn,YI=new ce,QI=new ce,io=new mn,ro=new mn,Uu=new mn,zM=new ce,VM=new Cn,so=new yQ,KI=new ce,qx=new kh,Hx=new cd,Fu=new mn;let Hu,OA;function ZI(i,e,t){return Fu.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),Fu.multiplyScalar(1/Fu.w),Fu.x=OA/t.width,Fu.y=OA/t.height,Fu.applyMatrix4(i.projectionMatrixInverse),Fu.multiplyScalar(1/Fu.w),Math.abs(Math.max(Fu.x,Fu.y))}function Age(i,e){const t=i.matrixWorld,n=i.geometry,r=n.attributes.instanceStart,s=n.attributes.instanceEnd,o=Math.min(n.instanceCount,r.count);for(let a=0,l=o;a<l;a++){so.start.fromBufferAttribute(r,a),so.end.fromBufferAttribute(s,a),so.applyMatrix4(t);const u=new ce,h=new ce;Hu.distanceSqToSegment(so.start,so.end,h,u),h.distanceTo(u)<OA*.5&&e.push({point:h,pointOnLine:u,distance:Hu.origin.distanceTo(h),object:i,face:null,faceIndex:a,uv:null,uv1:null})}}function pge(i,e,t){const n=e.projectionMatrix,s=i.material.resolution,o=i.matrixWorld,a=i.geometry,l=a.attributes.instanceStart,u=a.attributes.instanceEnd,h=Math.min(a.instanceCount,l.count),d=-e.near;Hu.at(1,Uu),Uu.w=1,Uu.applyMatrix4(e.matrixWorldInverse),Uu.applyMatrix4(n),Uu.multiplyScalar(1/Uu.w),Uu.x*=s.x/2,Uu.y*=s.y/2,Uu.z=0,zM.copy(Uu),VM.multiplyMatrices(e.matrixWorldInverse,o);for(let _=0,x=h;_<x;_++){if(io.fromBufferAttribute(l,_),ro.fromBufferAttribute(u,_),io.w=1,ro.w=1,io.applyMatrix4(VM),ro.applyMatrix4(VM),io.z>d&&ro.z>d)continue;if(io.z>d){const D=io.z-ro.z,O=(io.z-d)/D;io.lerp(ro,O)}else if(ro.z>d){const D=ro.z-io.z,O=(ro.z-d)/D;ro.lerp(io,O)}io.applyMatrix4(n),ro.applyMatrix4(n),io.multiplyScalar(1/io.w),ro.multiplyScalar(1/ro.w),io.x*=s.x/2,io.y*=s.y/2,ro.x*=s.x/2,ro.y*=s.y/2,so.start.copy(io),so.start.z=0,so.end.copy(ro),so.end.z=0;const R=so.closestPointToPointParameter(zM,!0);so.at(R,KI);const E=Lm.lerp(io.z,ro.z,R),w=E>=-1&&E<=1,L=zM.distanceTo(KI)<OA*.5;if(w&&L){so.start.fromBufferAttribute(l,_),so.end.fromBufferAttribute(u,_),so.start.applyMatrix4(o),so.end.applyMatrix4(o);const D=new ce,O=new ce;Hu.distanceSqToSegment(so.start,so.end,O,D),t.push({point:O,pointOnLine:D,distance:Hu.origin.distanceTo(O),object:i,face:null,faceIndex:_,uv:null,uv1:null})}}}class mge extends Ri{constructor(e=new jq,t=new i6({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)YI.fromBufferAttribute(t,o),QI.fromBufferAttribute(n,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+YI.distanceTo(QI);const s=new Vb(r,2,1);return e.setAttribute("instanceDistanceStart",new $u(s,1,0)),e.setAttribute("instanceDistanceEnd",new $u(s,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;r===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Hu=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;OA=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),Hx.copy(a.boundingSphere).applyMatrix4(o);let u;if(n)u=OA*.5;else{const d=Math.max(r.near,Hx.distanceToPoint(Hu.origin));u=ZI(r,d,l.resolution)}if(Hx.radius+=u,Hu.intersectsSphere(Hx)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),qx.copy(a.boundingBox).applyMatrix4(o);let h;if(n)h=OA*.5;else{const d=Math.max(r.near,qx.distanceToPoint(Hu.origin));h=ZI(r,d,l.resolution)}qx.expandByScalar(h),Hu.intersectsBox(qx)!==!1&&(n?Age(this,t):pge(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(GM),this.material.uniforms.resolution.value.set(GM.z,GM.w))}}class Xq extends jq{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setColors(n),this}setFromPoints(e){const t=e.length-1,n=new Float32Array(6*t);for(let r=0;r<t;r++)n[6*r]=e[r].x,n[6*r+1]=e[r].y,n[6*r+2]=e[r].z||0,n[6*r+3]=e[r+1].x,n[6*r+4]=e[r+1].y,n[6*r+5]=e[r+1].z||0;return super.setPositions(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class gge extends mge{constructor(e=new Xq,t=new i6({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class JI extends h8{constructor(e,t={}){const n=t.font;if(n===void 0)super();else{const r=n.generateShapes(e,t.size);t.depth===void 0&&(t.depth=50),t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class _ge{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const n=[],r=yge(e,t,this.data);for(let s=0,o=r.length;s<o;s++)n.push(...r[s].toShapes());return n}}function yge(i,e,t){const n=Array.from(i),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let u=0;u<n.length;u++){const h=n[u];if(h===`
`)a=0,l-=s;else{const d=vge(h,r,a,l,t);a+=d.offsetX,o.push(d.path)}}return o}function vge(i,e,t,n,r){const s=r.glyphs[i]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+i+'" does not exists in font family '+r.familyName+".");return}const o=new vQ;let a,l,u,h,d,_,x,b;if(s.o){const R=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let E=0,w=R.length;E<w;)switch(R[E++]){case"m":a=R[E++]*e+t,l=R[E++]*e+n,o.moveTo(a,l);break;case"l":a=R[E++]*e+t,l=R[E++]*e+n,o.lineTo(a,l);break;case"q":u=R[E++]*e+t,h=R[E++]*e+n,d=R[E++]*e+t,_=R[E++]*e+n,o.quadraticCurveTo(d,_,u,h);break;case"b":u=R[E++]*e+t,h=R[E++]*e+n,d=R[E++]*e+t,_=R[E++]*e+n,x=R[E++]*e+t,b=R[E++]*e+n,o.bezierCurveTo(d,_,x,b,u,h);break}}return{offsetX:s.ha*e,path:o}}function JC(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function xge(i){if(Array.isArray(i))return i}function bge(i){if(Array.isArray(i))return JC(i)}function $q(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function Sge(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function eB(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(u){return void t(u)}a.done?e(l):Promise.resolve(l).then(n,r)}function Tge(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){eB(s,n,r,o,a,"next",l)}function a(l){eB(s,n,r,o,a,"throw",l)}o(void 0)})}}function $T(i,e,t){return e=$m(e),Lge(i,s6()?Reflect.construct(e,t||[],$m(i).constructor):e.apply(i,t))}function Ege(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YT(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Q1(i,e){return i.get($q(i,e))}function qM(i,e,t){Ege(i,e),e.set(i,t)}function HM(i,e,t){return i.set($q(i,e),t),t}function r6(i,e,t){if(s6())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return r}function wge(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Yq(n.key),n)}}function QT(i,e,t){return e&&wge(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Xs(i,e,t){return(e=Yq(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function e4(){return e4=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var n=Oge(i,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?i:t):r.value}},e4.apply(null,arguments)}function $m(i){return $m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$m(i)}function KT(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&n4(i,e)}function s6(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s6=function(){return!!i})()}function Mge(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Rge(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Cge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tB(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Xi(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tB(Object(t),!0).forEach(function(n){Xs(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):tB(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Dge(i,e){if(i==null)return{};var t,n,r=Pge(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function Pge(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.indexOf(n)!==-1)continue;t[n]=i[n]}return t}function Lge(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sge(i)}function t4(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var i,e,t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function s(x,b,R,E){var w=b&&b.prototype instanceof a?b:a,L=Object.create(w.prototype);return za(L,"_invoke",function(D,O,B){var G,k,z,F=0,q=B||[],H=!1,Q={p:0,n:0,v:i,a:K,f:K.bind(i,4),d:function(se,ee){return G=se,k=0,z=i,Q.n=ee,o}};function K(se,ee){for(k=se,z=ee,e=0;!H&&F&&!$&&e<q.length;e++){var $,re=q[e],ae=Q.p,_e=re[2];se>3?($=_e===ee)&&(z=re[(k=re[4])?5:(k=3,3)],re[4]=re[5]=i):re[0]<=ae&&(($=se<2&&ae<re[1])?(k=0,Q.v=ee,Q.n=re[1]):ae<_e&&($=se<3||re[0]>ee||ee>_e)&&(re[4]=se,re[5]=ee,Q.n=_e,k=0))}if($||se>1)return o;throw H=!0,ee}return function(se,ee,$){if(F>1)throw TypeError("Generator is already running");for(H&&ee===1&&K(ee,$),k=ee,z=$;(e=k<2?i:z)||!H;){G||(k?k<3?(k>1&&(Q.n=-1),K(k,z)):Q.n=z:Q.v=z);try{if(F=2,G){if(k||(se="next"),e=G[se]){if(!(e=e.call(G,z)))throw TypeError("iterator result is not an object");if(!e.done)return e;z=e.value,k<2&&(k=0)}else k===1&&(e=G.return)&&e.call(G),k<2&&(z=TypeError("The iterator does not provide a '"+se+"' method"),k=1);G=i}else if((e=(H=Q.n<0)?z:D.call(O,Q))!==o)break}catch(re){G=i,k=1,z=re}finally{F=1}}return{value:e,done:H}}}(x,R,E),!0),L}var o={};function a(){}function l(){}function u(){}e=Object.getPrototypeOf;var h=[][n]?e(e([][n]())):(za(e={},n,function(){return this}),e),d=u.prototype=a.prototype=Object.create(h);function _(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,u):(x.__proto__=u,za(x,r,"GeneratorFunction")),x.prototype=Object.create(d),x}return l.prototype=u,za(d,"constructor",u),za(u,"constructor",l),l.displayName="GeneratorFunction",za(u,r,"GeneratorFunction"),za(d),za(d,r,"Generator"),za(d,n,function(){return this}),za(d,"toString",function(){return"[object Generator]"}),(t4=function(){return{w:s,m:_}})()}function za(i,e,t,n){var r=Object.defineProperty;try{r({},"",{})}catch{r=0}za=function(s,o,a,l){if(o)r?r(s,o,{value:a,enumerable:!l,configurable:!l,writable:!l}):s[o]=a;else{let h=function(d,_){za(s,d,function(x){return this._invoke(d,_,x)})};var u=h;h("next",0),h("throw",1),h("return",2)}},za(i,e,t,n)}function n4(i,e){return n4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},n4(i,e)}function Mr(i,e){return xge(i)||Rge(i,e)||Qq(i,e)||Cge()}function Oge(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=$m(i))!==null;);return i}function WM(i,e,t,n){var r=e4($m(i.prototype),e,t);return typeof r=="function"?function(s){return r.apply(t,s)}:r}function rr(i){return bge(i)||Mge(i)||Qq(i)||Nge()}function Ige(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Yq(i){var e=Ige(i,"string");return typeof e=="symbol"?e:e+""}function Qq(i,e){if(i){if(typeof i=="string")return JC(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?JC(i,e):void 0}}var Kq=function(e){e instanceof Array?e.forEach(Kq):(e.map&&e.map.dispose(),e.dispose())},o6=function(e){e.geometry&&e.geometry.dispose(),e.material&&Kq(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(o6)},ur=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),o6(t)}};function jo(i,e){var t=new e;return{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[i][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[i],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var h=o[r].apply(o,l);return h===o?this:h}}}}var Sr=100;function nB(){return Sr}function Il(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(90-i)*Math.PI/180,r=(90-e)*Math.PI/180,s=Sr*(1+t),o=Math.sin(n);return{x:s*o*Math.cos(r),y:s*Math.cos(n),z:s*o*Math.sin(r)}}function Zq(i){var e=i.x,t=i.y,n=i.z,r=Math.sqrt(e*e+t*t+n*n),s=Math.acos(t/r),o=Math.atan2(n,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:r/Sr-1}}function hA(i){return i*Math.PI/180}var My=window.THREE?window.THREE:{BackSide:Zi,BufferAttribute:_r,Color:Jt,Mesh:Ri,ShaderMaterial:ya},Bge=`
uniform float hollowRadius;

varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {    
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  
  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);
  vCameraDistanceToObjCenter = length(objCenterViewPosition);
  
  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);
  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));
  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;

  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,Uge=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
uniform float hollowRadius;

varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {
  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius
  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius

  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`;function Fge(i,e,t,n){return new My.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:Bge,fragmentShader:Uge,uniforms:{coefficient:{value:i},color:{value:new My.Color(e)},power:{value:t},hollowRadius:{value:n}}})}function kge(i,e){for(var t=i.clone(),n=new Float32Array(i.attributes.position.count*3),r=0,s=n.length;r<s;r++){var o=i.attributes.normal.array[r],a=i.attributes.position.array[r];n[r]=a+o*e}return t.setAttribute("position",new My.BufferAttribute(n,3)),t}var Gge=function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.color,o=s===void 0?"gold":s,a=r.size,l=a===void 0?2:a,u=r.coefficient,h=u===void 0?.5:u,d=r.power,_=d===void 0?1:d,x=r.hollowRadius,b=x===void 0?0:x,R=r.backside,E=R===void 0?!0:R;YT(this,e),n=$T(this,e);var w=kge(t,l),L=Fge(h,o,_,b);return E&&(L.side=My.BackSide),n.geometry=w,n.material=L,n}return KT(e,i),QT(e)}(My.Mesh),ku=window.THREE?window.THREE:{Color:Jt,Group:ca,LineBasicMaterial:hg,LineSegments:d9,Mesh:Ri,MeshPhongMaterial:w9,SphereGeometry:_c,SRGBColorSpace:qs,TextureLoader:d8},Jq=Ds({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeCurvatureResolution:{default:4},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return t!==void 0?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){ur(e.globeObj),ur(e.tileEngine),ur(e.graticulesObj)}},stateInit:function(){var e=new ku.MeshPhongMaterial({color:0}),t=new ku.Mesh(void 0,e);t.rotation.y=-Math.PI/2;var n=new Tre(Sr),r=new ku.Group;r.__globeObjType="globe",r.add(t),r.add(n);var s=new ku.LineSegments(new LF(Vie(),Sr,2),new ku.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeGroup:r,globeObj:t,graticulesObj:s,defaultGlobeMaterial:e,tileEngine:n}},init:function(e,t){ur(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var n=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeCurvatureResolution")){var r;(r=e.globeObj.geometry)===null||r===void 0||r.dispose();var s=Math.max(4,Math.round(360/e.globeCurvatureResolution));e.globeObj.geometry=new ku.SphereGeometry(Sr,s,s/2),e.tileEngine.curvatureResolution=e.globeCurvatureResolution}if(t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new ku.TextureLoader().load(e.globeImageUrl,function(a){a.colorSpace=ku.SRGBColorSpace,n.map=a,n.color=null,n.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!n.color&&(n.color=new ku.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new ku.TextureLoader().load(e.bumpImageUrl,function(a){n.bumpMap=a,n.needsUpdate=!0}):(n.bumpMap=null,n.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),ur(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var o=e.atmosphereObj=new Gge(e.globeObj.geometry,{color:e.atmosphereColor,size:Sr*e.atmosphereAltitude,hollowRadius:Sr,coefficient:.1,power:3.5});o.visible=!!e.showAtmosphere,o.__globeObjType="atmosphere",e.scene.add(o)}!e.ready&&(!e.globeImageUrl||e.globeTileEngineUrl)&&(e.ready=!0,e.onReady())}}),pc=function(e){return isNaN(e)?parseInt(gn(e).toHex(),16):e},mu=function(e){return e&&isNaN(e)?qA(e).opacity:1},ud=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r,s=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var a=o.slice(1),l=Mr(a,4),u=l[0],h=l[1],d=l[2],_=l[3];r=new Jt("rgb(".concat(+u,",").concat(+h,",").concat(+d,")")),s=Math.min(+_,1)}else r=new Jt(e);n&&r.convertLinearToSRGB();var x=r.toArray();return t?[].concat(rr(x),[s]):x};function zge(i,e,t){return i.opacity=e,i.transparent=e<1,i.depthWrite=e>=1,i}var iB=window.THREE?window.THREE:{BufferAttribute:_r};function mc(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float32Array;if(e===1)return new iB.BufferAttribute(new t(i),e);for(var n=new iB.BufferAttribute(new t(i.length*e),e),r=0,s=i.length;r<s;r++)n.set(i[r],r*e);return n}function Vge(i){for(var e=i.itemSize,t=[],n=0;n<i.count;n++)t.push(i.array.slice(n*e,(n+1)*e));return t}var jM=new WeakMap,Wx=new WeakMap,jx=new WeakMap,Ea=function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.dataBindAttr,o=s===void 0?"__data":s,a=r.objBindAttr,l=a===void 0?"__threeObj":a,u=r.removeDelay,h=u===void 0?0:u;return YT(this,e),n=$T(this,e),Xs(n,"scene",void 0),qM(n,jM,void 0),qM(n,Wx,void 0),qM(n,jx,void 0),n.scene=t,HM(jM,n,o),HM(Wx,n,l),HM(jx,n,h),n.onRemoveObj(function(){}),n}return KT(e,i),QT(e,[{key:"onCreateObj",value:function(n){var r=this;return WM(e,"onCreateObj",this)([function(s){var o=n(s);return s[Q1(Wx,r)]=o,o[Q1(jM,r)]=s,r.scene.add(o),o}]),this}},{key:"onRemoveObj",value:function(n){var r=this;return WM(e,"onRemoveObj",this)([function(s,o){var a=WM(e,"getData",r)([s]);n(s,o);var l=function(){r.scene.remove(s),ur(s),delete a[Q1(Wx,r)]};Q1(jx,r)?setTimeout(l,Q1(jx,r)):l()}]),this}}])}(Jse),tu=window.THREE?window.THREE:{BufferGeometry:Vi,CylinderGeometry:fT,Matrix4:Cn,Mesh:Ri,MeshLambertMaterial:Gh,Object3D:Rr,Vector3:ce},rB=Object.assign({},D8),sB=rB.BufferGeometryUtils||rB,eH=Ds({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var n=bt(e.pointLat),r=bt(e.pointLng),s=bt(e.pointAltitude),o=bt(e.pointRadius),a=bt(e.pointColor),l=new tu.CylinderGeometry(1,1,1,e.pointResolution);l.applyMatrix4(new tu.Matrix4().makeRotationX(Math.PI/2)),l.applyMatrix4(new tu.Matrix4().makeTranslation(0,0,-.5));var u=2*Math.PI*Sr/360,h={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&ur(e.scene),e.dataMapper.scene=e.pointsMerge?new tu.Object3D:e.scene,e.dataMapper.onCreateObj(x).onUpdateObj(b).digest(e.pointsData),e.pointsMerge){var d=e.pointsData.length?(sB.mergeGeometries||sB.mergeBufferGeometries)(e.pointsData.map(function(R){var E=e.dataMapper.getObj(R),w=E.geometry.clone();E.updateMatrix(),w.applyMatrix4(E.matrix);var L=ud(a(R));return w.setAttribute("color",mc(Array(w.getAttribute("position").count).fill(L),4)),w})):new tu.BufferGeometry,_=new tu.Mesh(d,new tu.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));_.__globeObjType="points",_.__data=e.pointsData,e.dataMapper.clear(),ur(e.scene),e.scene.add(_)}function x(){var R=new tu.Mesh(l);return R.__globeObjType="point",R}function b(R,E){var w=function(z){var F=R.__currentTargetD=z,q=F.r,H=F.alt,Q=F.lat,K=F.lng;Object.assign(R.position,Il(Q,K));var se=e.pointsMerge?new tu.Vector3(0,0,0):e.scene.localToWorld(new tu.Vector3(0,0,0));R.lookAt(se),R.scale.x=R.scale.y=Math.min(30,q)*u,R.scale.z=Math.max(H*Sr,.1)},L={alt:+s(E),r:+o(E),lat:+n(E),lng:+r(E)},D=R.__currentTargetD||Object.assign({},L,{alt:-.001});if(Object.keys(L).some(function(k){return D[k]!==L[k]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?w(L):e.tweenGroup.add(new Mo(D).to(L,e.pointsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(w).start())),!e.pointsMerge){var O=a(E),B=O?mu(O):0,G=!!B;R.visible=G,G&&(h.hasOwnProperty(O)||(h[O]=new tu.MeshLambertMaterial({color:pc(O),transparent:B<1,opacity:B})),R.material=h[O])}}}}),tH=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    `.concat(Qn.common,`
    `).concat(Qn.logdepthbuf_pars_vertex,`
  
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  
      `).concat(Qn.logdepthbuf_vertex,`
    }
  `),fragmentShader:`
    `.concat(Qn.logdepthbuf_pars_fragment,`

    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
  
      `).concat(Qn.logdepthbuf_fragment,`
    }
  `)}},i4=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},qge=function(e){return e.vertexShader=`
    attribute float r;
    
    const float PI = 3.1415926535897932384626433832795;
    float toRad(in float a) {
      return a * PI / 180.0;
    }
    
    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]
      float phi = toRad(90.0 - c.x);
      float theta = toRad(90.0 - c.y);
      float r = c.z;
      return vec3( // x,y,z
        r * sin(phi) * cos(theta),
        r * cos(phi),
        r * sin(phi) * sin(theta)
      );
    }
    
    vec2 Cartesian2Polar(in vec3 p) {
      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);
      float phi = acos(p.y / r);
      float theta = atan(p.z, p.x);
      return vec2( // lat,lng
        90.0 - phi * 180.0 / PI,
        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)
      );
    }
    `.concat(e.vertexShader.replace("}",`                  
        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `),`
  `),e},a6=function(e,t){return e.onBeforeCompile=function(n){e.userData.shader=t(n)},e},Hge=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r};if(e.userData.shader)t(e.userData.shader.uniforms);else{var n=e.onBeforeCompile;e.onBeforeCompile=function(r){n(r),t(r.uniforms)}}},Wge=["stroke"],nu=window.THREE?window.THREE:{BufferGeometry:Vi,CubicBezierCurve3:m9,Curve:xu,Group:ca,Line:cT,Mesh:Ri,NormalBlending:Wo,ShaderMaterial:ya,TubeGeometry:f8,Vector3:ce},jge=zm.default||zm,nH=Ds({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new jge,sharedMaterial:new nu.ShaderMaterial(Xi(Xi({},tH()),{},{transparent:!0,blending:nu.NormalBlending}))}},init:function(e,t){ur(e),t.scene=e,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var n=new nu.Group;return n.__globeObjType="arc",n}),t.ticker.onTick.add(function(n,r){t.dataMapper.entries().map(function(s){var o=Mr(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r,l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a})})},update:function(e){var t=bt(e.arcStartLat),n=bt(e.arcStartLng),r=bt(e.arcEndLat),s=bt(e.arcEndLng),o=bt(e.arcAltitude),a=bt(e.arcAltitudeAutoScale),l=bt(e.arcStroke),u=bt(e.arcColor),h=bt(e.arcDashLength),d=bt(e.arcDashGap),_=bt(e.arcDashInitialGap),x=bt(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(w,L){var D=l(L),O=D!=null;if(!w.children.length||O!==(w.children[0].type==="Mesh")){ur(w);var B=O?new nu.Mesh:new nu.Line(new nu.BufferGeometry);B.material=e.sharedMaterial.clone(),w.add(B)}var G=w.children[0];Object.assign(G.material.uniforms,{dashSize:{value:h(L)},gapSize:{value:d(L)},dashOffset:{value:_(L)}});var k=x(L);G.__dashAnimateStep=k>0?1e3/k:0;var z=R(u(L),e.arcCurveResolution,O?e.arcCircularResolution+1:1),F=E(e.arcCurveResolution,O?e.arcCircularResolution+1:1,!0);G.geometry.setAttribute("color",z),G.geometry.setAttribute("relDistance",F);var q=function(se){var ee=w.__currentTargetD=se,$=ee.stroke,re=Dge(ee,Wge),ae=b(re);O?(G.geometry&&G.geometry.dispose(),G.geometry=new nu.TubeGeometry(ae,e.arcCurveResolution,$/2,e.arcCircularResolution),G.geometry.setAttribute("color",z),G.geometry.setAttribute("relDistance",F)):G.geometry.setFromPoints(ae.getPoints(e.arcCurveResolution))},H={stroke:D,alt:o(L),altAutoScale:+a(L),startLat:+t(L),startLng:+n(L),endLat:+r(L),endLng:+s(L)},Q=w.__currentTargetD||Object.assign({},H,{altAutoScale:-.001});Object.keys(H).some(function(K){return Q[K]!==H[K]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?q(H):e.tweenGroup.add(new Mo(Q).to(H,e.arcsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(q).start()))}).digest(e.arcsData);function b(w){var L=w.alt,D=w.altAutoScale,O=w.startLat,B=w.startLng,G=w.endLat,k=w.endLng,z=function(ye){var ve=Mr(ye,3),Pe=ve[0],Se=ve[1],Fe=ve[2],Ye=Il(Se,Pe,Fe),at=Ye.x,At=Ye.y,Gt=Ye.z;return new nu.Vector3(at,At,Gt)},F=[B,O],q=[k,G],H=L;if(H==null&&(H=ld(F,q)/2*D),H){var Q=w8(F,q),K=[.25,.75].map(function(ne){return[].concat(rr(Q(ne)),[H*1.5])}),se=Mr(K,2),ee=se[0],$=se[1],re=r6(nu.CubicBezierCurve3,rr([F,ee,$,q].map(z)));return re}else{var ae=.001;return _e.apply(void 0,rr([[].concat(F,[ae]),[].concat(q,[ae])].map(z)))}function _e(ne,ye){var ve=ne.angleTo(ye),Pe=ve===0?function(){return ne.clone()}:function(Fe){return new nu.Vector3().addVectors(ne.clone().multiplyScalar(Math.sin((1-Fe)*ve)),ye.clone().multiplyScalar(Math.sin(Fe*ve))).divideScalar(Math.sin(ve))},Se=new nu.Curve;return Se.getPoint=Pe,Se}}function R(w,L){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=L+1,B;if(w instanceof Array||w instanceof Function){var G=w instanceof Array?Rh().domain(w.map(function(K,se){return se/(w.length-1)})).range(w):w;B=function(se){return ud(G(se),!0,!0)}}else{var k=ud(w,!0,!0);B=function(){return k}}for(var z=[],F=0,q=O;F<q;F++)for(var H=B(F/(q-1)),Q=0;Q<D;Q++)z.push(H);return mc(z,4)}function E(w){for(var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=w+1,B=[],G=0,k=O;G<k;G++)for(var z=G/(k-1),F=0;F<L;F++)B.push(z);return D&&B.reverse(),mc(B,1)}}}),Df=window.THREE?window.THREE:{BufferGeometry:Vi,DoubleSide:ss,Mesh:Ri,MeshLambertMaterial:Gh,Object3D:Rr},oB=Object.assign({},D8),aB=oB.BufferGeometryUtils||oB,iH=Ds({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var t=e.sumWeight;return t*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var n=bt(e.hexBinPointLat),r=bt(e.hexBinPointLng),s=bt(e.hexBinPointWeight),o=bt(e.hexAltitude),a=bt(e.hexTopColor),l=bt(e.hexSideColor),u=bt(e.hexMargin),h=xae(e.hexBinPointsData.map(function(L){return Xi(Xi({},L),{},{h3Idx:nle(n(L),r(L),e.hexBinResolution)})}),"h3Idx"),d=Object.entries(h).map(function(L){var D=Mr(L,2),O=D[0],B=D[1];return{h3Idx:O,points:B,sumWeight:B.reduce(function(G,k){return G+ +s(k)},0)}}),_={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&ur(e.scene),e.dataMapper.scene=e.hexBinMerge?new Df.Object3D:e.scene,e.dataMapper.id(function(L){return L.h3Idx}).onCreateObj(E).onUpdateObj(w).digest(d),e.hexBinMerge){var x=d.length?(aB.mergeGeometries||aB.mergeBufferGeometries)(d.map(function(L){var D=e.dataMapper.getObj(L),O=D.geometry.toNonIndexed();D.updateMatrix(),O.applyMatrix4(D.matrix);var B=ud(a(L)),G=ud(l(L)),k=O.getAttribute("position").count,z=O.groups[0].count;return O.setAttribute("color",mc(rr(new Array(k)).map(function(F,q){return q>=z?B:G}),4)),O})):new Df.BufferGeometry,b=new Df.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:Df.DoubleSide});b.onBeforeCompile=function(L){b.userData.shader=i4(L)};var R=new Df.Mesh(x,b);R.__globeObjType="hexBinPoints",R.__data=d,e.dataMapper.clear(),ur(e.scene),e.scene.add(R)}function E(L){var D=new Df.Mesh;D.__hexCenter=ZF(L.h3Idx),D.__hexGeoJson=JF(L.h3Idx,!0).reverse();var O=D.__hexCenter[1];return D.__hexGeoJson.forEach(function(B){var G=B[0];Math.abs(O-G)>170&&(B[0]+=O>G?360:-360)}),D.__globeObjType="hexbin",D}function w(L,D){var O=function(re,ae,_e){return re-(re-ae)*_e},B=Math.max(0,Math.min(1,+u(D))),G=Mr(L.__hexCenter,2),k=G[0],z=G[1],F=B===0?L.__hexGeoJson:L.__hexGeoJson.map(function($){var re=Mr($,2),ae=re[0],_e=re[1];return[[ae,z],[_e,k]].map(function(ne){var ye=Mr(ne,2),ve=ye[0],Pe=ye[1];return O(ve,Pe,B)})}),q=e.hexTopCurvatureResolution;L.geometry&&L.geometry.dispose(),L.geometry=new B8([F],0,Sr,!1,!0,!0,q);var H={alt:+o(D)},Q=function(re){var ae=L.__currentTargetD=re,_e=ae.alt;L.scale.x=L.scale.y=L.scale.z=1+_e;var ne=Sr/(_e+1);L.geometry.setAttribute("surfaceRadius",mc(Array(L.geometry.getAttribute("position").count).fill(ne),1))},K=L.__currentTargetD||Object.assign({},H,{alt:-.001});if(Object.keys(H).some(function($){return K[$]!==H[$]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?Q(H):e.tweenGroup.add(new Mo(K).to(H,e.hexTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(Q).start())),!e.hexBinMerge){var se=l(D),ee=a(D);[se,ee].forEach(function($){if(!_.hasOwnProperty($)){var re=mu($);_[$]=a6(new Df.MeshLambertMaterial({color:pc($),transparent:re<1,opacity:re,side:Df.DoubleSide}),i4)}}),L.material=[se,ee].map(function($){return _[$]})}}}}),rH=function(e){return e*e},Ah=function(e){return e*Math.PI/180};function Xge(i,e){var t=Math.sqrt,n=Math.cos,r=function(h){return rH(Math.sin(h/2))},s=Ah(i[1]),o=Ah(e[1]),a=Ah(i[0]),l=Ah(e[0]);return 2*Math.asin(t(r(o-s)+n(s)*n(o)*r(l-a)))}var $ge=Math.sqrt(2*Math.PI);function Yge(i,e){return Math.exp(-rH(i/e)/2)/(e*$ge)}var Qge=function(e){var t=Mr(e,2),n=t[0],r=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.lngAccessor,l=a===void 0?function(E){return E[0]}:a,u=o.latAccessor,h=u===void 0?function(E){return E[1]}:u,d=o.weightAccessor,_=d===void 0?function(){return 1}:d,x=o.bandwidth,b=[n,r],R=x*Math.PI/180;return _ne(s.map(function(E){var w=_(E);if(!w)return 0;var L=Xge(b,[l(E),h(E)]);return Yge(L,R)*w}))},Kge=function(){var i=Tge(t4().m(function e(t){var n,r,s,o,a,l,u,h,d,_,x,b,R,E,w,L,D,O,B,G,k,z,F,q,H,Q,K,se,ee,$,re,ae,_e,ne,ye,ve,Pe,Se,Fe,Ye,at=arguments,At,Gt,Dt,Nn;return t4().w(function(bn){for(;;)switch(bn.n){case 0:if(r=at.length>1&&at[1]!==void 0?at[1]:[],s=at.length>2&&at[2]!==void 0?at[2]:{},o=s.lngAccessor,a=o===void 0?function($t){return $t[0]}:o,l=s.latAccessor,u=l===void 0?function($t){return $t[1]}:l,h=s.weightAccessor,d=h===void 0?function(){return 1}:h,_=s.bandwidth,(n=navigator)!==null&&n!==void 0&&n.gpu){bn.n=1;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),bn.a(2,t.map(function($t){return Qge($t,r,{lngAccessor:a,latAccessor:u,weightAccessor:d,bandwidth:_})}));case 1:return x=4,b=tge,R=nge,E=dge,w=fge,L=age,D=lge,O=ige,B=hge,G=cge,k=sge,z=rge,F=oge,q=uge,H=w(new Ob(new Float32Array(t.flat().map(Ah)),2),"vec2",t.length),Q=w(new Ob(new Float32Array(r.map(function($t){return[Ah(a($t)),Ah(u($t)),d($t)]}).flat()),3),"vec3",r.length),K=new Ob(t.length,1),se=w(K,"float",t.length),ee=L(Math.PI),$=B(ee.mul(2)),re=function(he){return he.mul(he)},ae=function(he){return re(G(he.div(2)))},_e=function(he,vt){var ft=L(he[1]),pt=L(vt[1]),et=L(he[0]),Ft=L(vt[0]);return L(2).mul(z(B(ae(pt.sub(ft)).add(k(ft).mul(k(pt)).mul(ae(Ft.sub(et)))))))},ne=function(he,vt){return F(q(re(he.div(vt)).div(2))).div(vt.mul($))},ye=E(Ah(_)),ve=E(Ah(_*x)),Pe=E(r.length),Se=b(function(){var $t=H.element(D),he=se.element(D);he.assign(0),O(Pe,function(vt){var ft=vt.i,pt=Q.element(ft),et=pt.z;R(et,function(){var Ft=_e(pt.xy,$t.xy);R(Ft&&Ft.lessThan(ve),function(){he.addAssign(ne(Ft,ye).mul(et))})})})}),Fe=Se().compute(t.length),Ye=new Wq,bn.n=2,Ye.computeAsync(Fe);case 2:return At=Array,Gt=Float32Array,bn.n=3,Ye.getArrayBufferAsync(K);case 3:return Dt=bn.v,Nn=new Gt(Dt),bn.a(2,At.from.call(At,Nn))}},e)}));return function(t){return i.apply(this,arguments)}}(),Xx=window.THREE?window.THREE:{Mesh:Ri,MeshLambertMaterial:Gh,SphereGeometry:_c},Zge=3.5,Jge=.1,lB=100,e1e=function(e){var t=qA(rle(e));return t.opacity=Math.cbrt(e),t.formatRgb()},sH=Ds({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return e1e}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var s=new Xx.Mesh(new Xx.SphereGeometry(Sr),a6(new Xx.MeshLambertMaterial({vertexColors:!0,transparent:!0}),qge));return s.__globeObjType="heatmap",s})},update:function(e){var t=bt(e.heatmapPoints),n=bt(e.heatmapPointLat),r=bt(e.heatmapPointLng),s=bt(e.heatmapPointWeight),o=bt(e.heatmapBandwidth),a=bt(e.heatmapColorFn),l=bt(e.heatmapColorSaturation),u=bt(e.heatmapBaseAltitude),h=bt(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(d,_){var x=o(_),b=a(_),R=l(_),E=u(_),w=h(_),L=t(_).map(function(k){var z=n(k),F=r(k),q=Il(z,F),H=q.x,Q=q.y,K=q.z;return{x:H,y:Q,z:K,lat:z,lng:F,weight:s(k)}}),D=Math.max(Jge,x/Zge),O=Math.ceil(360/(D||-1));d.geometry.parameters.widthSegments!==O&&(d.geometry.dispose(),d.geometry=new Xx.SphereGeometry(Sr,O,O/2));var B=Vge(d.geometry.getAttribute("position")),G=B.map(function(k){var z=Mr(k,3),F=z[0],q=z[1],H=z[2],Q=Zq({x:F,y:q,z:H}),K=Q.lng,se=Q.lat;return[K,se]});Kge(G,L,{latAccessor:function(z){return z.lat},lngAccessor:function(z){return z.lng},weightAccessor:function(z){return z.weight},bandwidth:x}).then(function(k){var z=rr(new Array(lB)).map(function(Q,K){return ud(b(K/(lB-1)))}),F=function(K){var se=d.__currentTargetD=K,ee=se.kdeVals,$=se.topAlt,re=se.saturation,ae=pne(ee.map(Math.abs))||1e-15,_e=J9([0,ae/re],z);d.geometry.setAttribute("color",mc(ee.map(function(ye){return _e(Math.abs(ye))}),4));var ne=Rh([0,ae],[Sr*(1+E),Sr*(1+($||E))]);d.geometry.setAttribute("r",mc(ee.map(ne)))},q={kdeVals:k,topAlt:w,saturation:R},H=d.__currentTargetD||Object.assign({},q,{kdeVals:k.map(function(){return 0}),topAlt:w&&E,saturation:.5});H.kdeVals.length!==k.length&&(H.kdeVals=k.slice()),Object.keys(q).some(function(Q){return H[Q]!==q[Q]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?F(q):e.tweenGroup.add(new Mo(H).to(q,e.heatmapsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(F).start()))})}).digest(e.heatmapsData)}}),Pf=window.THREE?window.THREE:{DoubleSide:ss,Group:ca,LineBasicMaterial:hg,LineSegments:d9,Mesh:Ri,MeshBasicMaterial:$a},oH=Ds({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjPolygon"}).id(function(s){return s.id}).onCreateObj(function(){var s=new Pf.Group;return s.__defaultSideMaterial=a6(new Pf.MeshBasicMaterial({side:Pf.DoubleSide,depthWrite:!0}),i4),s.__defaultCapMaterial=new Pf.MeshBasicMaterial({side:Pf.DoubleSide,depthWrite:!0}),s.add(new Pf.Mesh(void 0,[s.__defaultSideMaterial,s.__defaultCapMaterial])),s.add(new Pf.LineSegments(void 0,new Pf.LineBasicMaterial)),s.__globeObjType="polygon",s})},update:function(e){var t=bt(e.polygonGeoJsonGeometry),n=bt(e.polygonAltitude),r=bt(e.polygonCapCurvatureResolution),s=bt(e.polygonCapColor),o=bt(e.polygonCapMaterial),a=bt(e.polygonSideColor),l=bt(e.polygonSideMaterial),u=bt(e.polygonStrokeColor),h=[];e.polygonsData.forEach(function(d){var _={data:d,capColor:s(d),capMaterial:o(d),sideColor:a(d),sideMaterial:l(d),strokeColor:u(d),altitude:+n(d),capCurvatureResolution:+r(d)},x=t(d),b=d.__id||"".concat(Math.round(Math.random()*1e9));d.__id=b,x.type==="Polygon"?h.push(Xi({id:"".concat(b,"_0"),coords:x.coordinates},_)):x.type==="MultiPolygon"?h.push.apply(h,rr(x.coordinates.map(function(R,E){return Xi({id:"".concat(b,"_").concat(E),coords:R},_)}))):console.warn("Unsupported GeoJson geometry type: ".concat(x.type,". Skipping geometry..."))}),e.dataMapper.onUpdateObj(function(d,_){var x=_.coords,b=_.capColor,R=_.capMaterial,E=_.sideColor,w=_.sideMaterial,L=_.strokeColor,D=_.altitude,O=_.capCurvatureResolution,B=Mr(d.children,2),G=B[0],k=B[1],z=!!L;k.visible=z;var F=!!(b||R),q=!!(E||w);t1e(G.geometry.parameters||{},{polygonGeoJson:x,curvatureResolution:O,closedTop:F,includeSides:q})||(G.geometry&&G.geometry.dispose(),G.geometry=new B8(x,0,Sr,!1,F,q,O)),z&&(!k.geometry.parameters||k.geometry.parameters.geoJson.coordinates!==x||k.geometry.parameters.resolution!==O)&&(k.geometry&&k.geometry.dispose(),k.geometry=new LF({type:"Polygon",coordinates:x},Sr,O));var H=q?0:-1,Q=F?q?1:0:-1;if(H>=0&&(G.material[H]=w||d.__defaultSideMaterial),Q>=0&&(G.material[Q]=R||d.__defaultCapMaterial),[[!w&&E,H],[!R&&b,Q]].forEach(function(ae){var _e=Mr(ae,2),ne=_e[0],ye=_e[1];if(!(!ne||ye<0)){var ve=G.material[ye],Pe=mu(ne);ve.color.set(pc(ne)),ve.transparent=Pe<1,ve.opacity=Pe}}),z){var K=k.material,se=mu(L);K.color.set(pc(L)),K.transparent=se<1,K.opacity=se}var ee={alt:D},$=function(_e){var ne=d.__currentTargetD=_e,ye=ne.alt;G.scale.x=G.scale.y=G.scale.z=1+ye,z&&(k.scale.x=k.scale.y=k.scale.z=1+ye+1e-4),Hge(d.__defaultSideMaterial,function(ve){return ve.surfaceRadius.value=Sr/(ye+1)})},re=d.__currentTargetD||Object.assign({},ee,{alt:-.001});Object.keys(ee).some(function(ae){return re[ae]!==ee[ae]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||re.alt===ee.alt?$(ee):e.tweenGroup.add(new Mo(re).to(ee,e.polygonsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate($).start()))}).digest(h)}});function t1e(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(n,r){return n===r}};return Object.entries(e).every(function(n){var r=Mr(n,2),s=r[0],o=r[1];return i.hasOwnProperty(s)&&t(s)(i[s],o)})}var vp=window.THREE?window.THREE:{BufferGeometry:Vi,DoubleSide:ss,Mesh:Ri,MeshLambertMaterial:Gh,Vector3:ce},uB=Object.assign({},D8),cB=uB.BufferGeometryUtils||uB,aH=Ds({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var s=new vp.Mesh(void 0,new vp.MeshLambertMaterial({side:vp.DoubleSide}));return s.__globeObjType="hexPolygon",s})},update:function(e){var t=bt(e.hexPolygonGeoJsonGeometry),n=bt(e.hexPolygonColor),r=bt(e.hexPolygonAltitude),s=bt(e.hexPolygonResolution),o=bt(e.hexPolygonMargin),a=bt(e.hexPolygonUseDots),l=bt(e.hexPolygonCurvatureResolution),u=bt(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(h,d){var _=t(d),x=s(d),b=r(d),R=Math.max(0,Math.min(1,+o(d))),E=a(d),w=l(d),L=u(d),D=n(d),O=mu(D);h.material.color.set(pc(D)),h.material.transparent=O<1,h.material.opacity=O;var B={alt:b,margin:R,curvatureResolution:w},G={geoJson:_,h3Res:x},k=h.__currentTargetD||Object.assign({},B,{alt:-.001}),z=h.__currentMemD||G;if(Object.keys(B).some(function(Q){return k[Q]!==B[Q]})||Object.keys(G).some(function(Q){return z[Q]!==G[Q]})){h.__currentMemD=G;var F=[];_.type==="Polygon"?CO(_.coordinates,x,!0).forEach(function(Q){return F.push(Q)}):_.type==="MultiPolygon"?_.coordinates.forEach(function(Q){return CO(Q,x,!0).forEach(function(K){return F.push(K)})}):console.warn("Unsupported GeoJson geometry type: ".concat(_.type,". Skipping geometry..."));var q=F.map(function(Q){var K=ZF(Q),se=JF(Q,!0).reverse(),ee=K[1];return se.forEach(function($){var re=$[0];Math.abs(ee-re)>170&&($[0]+=ee>re?360:-360)}),{h3Idx:Q,hexCenter:K,hexGeoJson:se}}),H=function(K){var se=h.__currentTargetD=K,ee=se.alt,$=se.margin,re=se.curvatureResolution;h.geometry&&h.geometry.dispose(),h.geometry=q.length?(cB.mergeGeometries||cB.mergeBufferGeometries)(q.map(function(ae){var _e=Mr(ae.hexCenter,2),ne=_e[0],ye=_e[1];if(E){var ve=Il(ne,ye,ee),Pe=Il(ae.hexGeoJson[0][1],ae.hexGeoJson[0][0],ee),Se=.85*(1-$)*new vp.Vector3(ve.x,ve.y,ve.z).distanceTo(new vp.Vector3(Pe.x,Pe.y,Pe.z)),Fe=new hT(Se,L);return Fe.rotateX(hA(-ne)),Fe.rotateY(hA(ye)),Fe.translate(ve.x,ve.y,ve.z),Fe}else{var Ye=function(Gt,Dt,Nn){return Gt-(Gt-Dt)*Nn},at=$===0?ae.hexGeoJson:ae.hexGeoJson.map(function(At){var Gt=Mr(At,2),Dt=Gt[0],Nn=Gt[1];return[[Dt,ye],[Nn,ne]].map(function(bn){var $t=Mr(bn,2),he=$t[0],vt=$t[1];return Ye(he,vt,$)})});return new B8([at],Sr,Sr*(1+ee),!1,!0,!1,re)}})):new vp.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?H(B):e.tweenGroup.add(new Mo(k).to(B,e.hexPolygonsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(H).start())}}).digest(e.hexPolygonsData)}}),n1e=window.THREE?window.THREE:{Vector3:ce};function i1e(i,e){var t=function(o,a){var l=o[o.length-1];return[].concat(rr(o),rr(Array(a-o.length).fill(l)))},n=Math.max(i.length,e.length),r=One.apply(void 0,rr([i,e].map(function(s){return s.map(function(o){var a=o.x,l=o.y,u=o.z;return[a,l,u]})}).map(function(s){return t(s,n)})));return function(s){return s===0?i:s===1?e:r(s).map(function(o){var a=Mr(o,3),l=a[0],u=a[1],h=a[2];return new n1e.Vector3(l,u,h)})}}var Zd=window.THREE?window.THREE:{BufferGeometry:Vi,Color:Jt,Group:ca,Line:cT,NormalBlending:Wo,ShaderMaterial:ya,Vector3:ce},r1e=zm.default||zm,lH=Ds({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new r1e,sharedMaterial:new Zd.ShaderMaterial(Xi(Xi({},tH()),{},{transparent:!0,blending:Zd.NormalBlending}))}},init:function(e,t){ur(e),t.scene=e,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var n=new Zd.Group;return n.__globeObjType="path",n}),t.ticker.onTick.add(function(n,r){t.dataMapper.entries().map(function(s){var o=Mr(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r;if(o.type==="Line"){var l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a}else if(o.type==="Line2"){for(var u=o.material.dashOffset-a,h=o.material.dashSize+o.material.gapSize;u<=-h;)u+=h;o.material.dashOffset=u}})})},update:function(e){var t=bt(e.pathPoints),n=bt(e.pathPointLat),r=bt(e.pathPointLng),s=bt(e.pathPointAlt),o=bt(e.pathStroke),a=bt(e.pathColor),l=bt(e.pathDashLength),u=bt(e.pathDashGap),h=bt(e.pathDashInitialGap),d=bt(e.pathDashAnimateTime);e.dataMapper.onUpdateObj(function(E,w){var L=o(w),D=L!=null;if(!E.children.length||D===(E.children[0].type==="Line")){ur(E);var O=D?new gge(new Xq,new i6):new Zd.Line(new Zd.BufferGeometry,e.sharedMaterial.clone());E.add(O)}var B=E.children[0],G=x(t(w),n,r,s,e.pathResolution),k=d(w);if(B.__dashAnimateStep=k>0?1e3/k:0,D){B.material.resolution=e.rendererSize;{var q=l(w),H=u(w),Q=h(w);B.material.dashed=H>0,B.material.dashed?B.material.defines.USE_DASH="":delete B.material.defines.USE_DASH,B.material.dashed&&(B.material.dashScale=1/_(G),B.material.dashSize=q,B.material.gapSize=H,B.material.dashOffset=-Q)}{var K=a(w);if(K instanceof Array){var se=b(a(w),G.length-1,1,!1);B.geometry.setColors(se.array),B.material.vertexColors=!0}else{var ee=K,$=mu(ee);B.material.color=new Zd.Color(pc(ee)),B.material.transparent=$<1,B.material.opacity=$,B.material.vertexColors=!1}}B.material.needsUpdate=!0}else{Object.assign(B.material.uniforms,{dashSize:{value:l(w)},gapSize:{value:u(w)},dashOffset:{value:h(w)}});var z=b(a(w),G.length),F=R(G.length,1,!0);B.geometry.setAttribute("color",z),B.geometry.setAttribute("relDistance",F)}var re=i1e(E.__currentTargetD&&E.__currentTargetD.points||[G[0]],G),ae=function(ve){var Pe=E.__currentTargetD=ve,Se=Pe.stroke,Fe=Pe.interpolK,Ye=E.__currentTargetD.points=re(Fe);if(D){var at;B.geometry.setPositions((at=[]).concat.apply(at,rr(Ye.map(function(At){var Gt=At.x,Dt=At.y,Nn=At.z;return[Gt,Dt,Nn]})))),B.material.linewidth=Se,B.material.dashed&&B.computeLineDistances()}else B.geometry.setFromPoints(Ye),B.geometry.computeBoundingSphere()},_e={stroke:L,interpolK:1},ne=Object.assign({},E.__currentTargetD||_e,{interpolK:0});Object.keys(_e).some(function(ye){return ne[ye]!==_e[ye]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?ae(_e):e.tweenGroup.add(new Mo(ne).to(_e,e.pathTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(ae).start()))}).digest(e.pathsData);function _(E){var w=0,L;return E.forEach(function(D){L&&(w+=L.distanceTo(D)),L=D}),w}function x(E,w,L,D,O){var B=function(F,q,H){for(var Q=[],K=1;K<=H;K++)Q.push(F+(q-F)*K/(H+1));return Q},G=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,H=[],Q=null;return F.forEach(function(K){if(Q){for(;Math.abs(Q[1]-K[1])>180;)Q[1]+=360*(Q[1]<K[1]?1:-1);var se=Math.sqrt(Math.pow(K[0]-Q[0],2)+Math.pow(K[1]-Q[1],2));if(se>q)for(var ee=Math.floor(se/q),$=B(Q[0],K[0],ee),re=B(Q[1],K[1],ee),ae=B(Q[2],K[2],ee),_e=0,ne=$.length;_e<ne;_e++)H.push([$[_e],re[_e],ae[_e]])}H.push(Q=K)}),H},k=function(F){var q=Mr(F,3),H=q[0],Q=q[1],K=q[2],se=Il(H,Q,K),ee=se.x,$=se.y,re=se.z;return new Zd.Vector3(ee,$,re)};return G(E.map(function(z){return[w(z),L(z),D(z)]}),O).map(k)}function b(E,w){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,O=w+1,B;if(E instanceof Array||E instanceof Function){var G=E instanceof Array?Rh().domain(E.map(function(K,se){return se/(E.length-1)})).range(E):E;B=function(se){return ud(G(se),D,!0)}}else{var k=ud(E,D,!0);B=function(){return k}}for(var z=[],F=0,q=O;F<q;F++)for(var H=B(F/(q-1)),Q=0;Q<L;Q++)z.push(H);return mc(z,D?4:3)}function R(E){for(var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=E+1,O=[],B=0,G=D;B<G;B++)for(var k=B/(G-1),z=0;z<w;z++)O.push(k);return L&&O.reverse(),mc(O,1)}}}),$x=window.THREE?window.THREE:{Euler:ao,Mesh:Ri,MeshLambertMaterial:Gh,SphereGeometry:_c},uH=Ds({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new $x.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var s=new $x.Mesh;return s.__globeObjType="tile",s})},update:function(e){var t=bt(e.tileLat),n=bt(e.tileLng),r=bt(e.tileAltitude),s=bt(e.tileWidth),o=bt(e.tileHeight),a=bt(e.tileUseGlobeProjection),l=bt(e.tileMaterial),u=bt(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(h,d){h.material=l(d);var _=a(d),x=u(d),b=function(L){var D=h.__currentTargetD=L,O=D.lat,B=D.lng,G=D.alt,k=D.width,z=D.height,F=xp(B),q=xp(-O);h.geometry&&h.geometry.dispose(),h.geometry=new $x.SphereGeometry(Sr*(1+G),Math.ceil(k/(x||-1)),Math.ceil(z/(x||-1)),xp(90-k/2)+(_?F:0),xp(k),xp(90-z/2)+(_?q:0),xp(z)),_||h.setRotationFromEuler(new $x.Euler(q,F,0,"YXZ"))},R={lat:+t(d),lng:+n(d),alt:+r(d),width:+s(d),height:+o(d)},E=h.__currentTargetD||Object.assign({},R,{width:0,height:0});Object.keys(R).some(function(w){return E[w]!==R[w]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?b(R):e.tweenGroup.add(new Mo(E).to(R,e.tilesTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(b).start()))}).digest(e.tilesData)}}),xp=function(e){return e*Math.PI/180},K1=window.THREE?window.THREE:{BufferGeometry:Vi,Color:Jt,Points:gY,PointsMaterial:l8},cH=Ds({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){ur(e),t.scene=e,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var n=new K1.Points(new K1.BufferGeometry,new K1.PointsMaterial);return n.__globeObjType="particles",n}).onUpdateObj(function(n,r){var s=bt(t.particlesList),o=bt(t.particleLat),a=bt(t.particleLng),l=bt(t.particleAltitude);n.geometry.setAttribute("position",mc(s(r).map(function(u){return Object.values(Il(o(u),a(u),l(u)))}),3))})},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(a){return t.hasOwnProperty(a)})&&e.dataMapper.digest(e.particlesData);var n=bt(e.particlesColor),r=bt(e.particlesSize),s=bt(e.particlesSizeAttenuation),o=bt(e.particlesTexture);e.dataMapper.entries().forEach(function(a){var l=Mr(a,2),u=l[0],h=l[1];if(h.material.size=r(u),h.material.sizeAttenuation=s(u),e.particlesTexture)h.material.color=new K1.Color(16777215),h.material.transparent=!1,h.material.alphaTest=.5,h.material.map=o(u);else{var d=n(u),_=mu(d);h.material.color=new K1.Color(pc(d)),h.material.transparent=_<1,h.material.opacity=_,h.material.alphaTest=0}})}}),s1e=window.THREE?window.THREE:{BufferGeometry:Vi},o1e=function(i){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;YT(this,e),t=$T(this,e),t.type="CircleLineGeometry",t.parameters={radius:n,segmentCount:r};for(var s=[],o=0;o<=r;o++){var a=(o/r-.25)*Math.PI*2;s.push({x:Math.cos(a)*n,y:Math.sin(a)*n,z:0})}return t.setFromPoints(s),t}return KT(e,i),QT(e)}(s1e.BufferGeometry),bp=window.THREE?window.THREE:{Color:Jt,Group:ca,Line:cT,LineBasicMaterial:hg,Vector3:ce},a1e=zm.default||zm,hH=Ds({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var s=new bp.Group;return s.__globeObjType="ring",s}),t.ticker=new a1e,t.ticker.onTick.add(function(s){if(t.ringsData.length){var o=bt(t.ringColor),a=bt(t.ringAltitude),l=bt(t.ringMaxRadius),u=bt(t.ringPropagationSpeed),h=bt(t.ringRepeatPeriod);t.dataMapper.entries().filter(function(d){var _=Mr(d,2),x=_[1];return x}).forEach(function(d){var _=Mr(d,2),x=_[0],b=_[1];if((b.__nextRingTime||0)<=s){var R=h(x)/1e3;b.__nextRingTime=s+(R<=0?1/0:R);var E=new bp.Line(new o1e(1,t.ringResolution),new bp.LineBasicMaterial),w=o(x),L=w instanceof Array||w instanceof Function,D;L?w instanceof Array?(D=Rh().domain(w.map(function(H,Q){return Q/(w.length-1)})).range(w),E.material.transparent=w.some(function(H){return mu(H)<1})):(D=w,E.material.transparent=!0):(E.material.color=new bp.Color(pc(w)),zge(E.material,mu(w)));var O=Sr*(1+a(x)),B=l(x),G=B*Math.PI/180,k=u(x),z=k<=0,F=function(Q){var K=Q.t,se=(z?1-K:K)*G;if(E.scale.x=E.scale.y=O*Math.sin(se),E.position.z=O*(1-Math.cos(se)),L){var ee=D(K);E.material.color=new bp.Color(pc(ee)),E.material.transparent&&(E.material.opacity=mu(ee))}};if(k===0)F({t:0}),b.add(E);else{var q=Math.abs(B/k)*1e3;t.tweenGroup.add(new Mo({t:0}).to({t:1},q).onUpdate(F).onStart(function(){return b.add(E)}).onComplete(function(){b.remove(E),o6(E)}).start())}}})}})},update:function(e){var t=bt(e.ringLat),n=bt(e.ringLng),r=bt(e.ringAltitude),s=e.scene.localToWorld(new bp.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(o,a){var l=t(a),u=n(a),h=r(a);Object.assign(o.position,Il(l,u,h)),o.lookAt(s)}).digest(e.ringsData)}}),l1e={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},u1e="normal",c1e=1189,h1e=-100,f1e="normal",d1e={yMin:-334,xMin:-111,yMax:1189,xMax:1672},A1e=1e3,p1e={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},m1e=-334,g1e="Helvetiker",_1e=1522,y1e=50,v1e={glyphs:l1e,cssFontWeight:u1e,ascender:c1e,underlinePosition:h1e,cssFontStyle:f1e,boundingBox:d1e,resolution:A1e,original_font_information:p1e,descender:m1e,familyName:g1e,lineHeight:_1e,underlineThickness:y1e},iu=Xi(Xi({},window.THREE?window.THREE:{BoxGeometry:hd,CircleGeometry:hT,DoubleSide:ss,Group:ca,Mesh:Ri,MeshLambertMaterial:Gh,TextGeometry:JI,Vector3:ce}),{},{Font:_ge,TextGeometry:JI}),fH=Ds({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:.002},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:v1e,onChange:function(e,t){t.font=new iu.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r;var s=new iu.CircleGeometry(1,32);t.dataMapper=new Ea(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var o=new iu.MeshLambertMaterial;o.side=ss;var a=new iu.Group;a.add(new iu.Mesh(s,o));var l=new iu.Mesh(void 0,o);a.add(l);var u=new iu.Mesh;return u.visible=!1,l.add(u),a.__globeObjType="label",a})},update:function(e){var t=bt(e.labelLat),n=bt(e.labelLng),r=bt(e.labelAltitude),s=bt(e.labelText),o=bt(e.labelSize),a=bt(e.labelRotation),l=bt(e.labelColor),u=bt(e.labelIncludeDot),h=bt(e.labelDotRadius),d=bt(e.labelDotOrientation),_=new Set(["right","top","bottom"]),x=2*Math.PI*Sr/360;e.dataMapper.onUpdateObj(function(b,R){var E=Mr(b.children,2),w=E[0],L=E[1],D=Mr(L.children,1),O=D[0],B=l(R),G=mu(B);L.material.color.set(pc(B)),L.material.transparent=G<1,L.material.opacity=G;var k=u(R),z=d(R);!k||!_.has(z)&&(z="bottom");var F=k?+h(R)*x:1e-12;w.scale.x=w.scale.y=F;var q=+o(R)*x;if(L.geometry&&L.geometry.dispose(),L.geometry=new iu.TextGeometry(s(R),{font:e.font,size:q,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),O.geometry&&O.geometry.dispose(),L.geometry.computeBoundingBox(),O.geometry=r6(iu.BoxGeometry,rr(new iu.Vector3().subVectors(L.geometry.boundingBox.max,L.geometry.boundingBox.min).clampScalar(0,1/0).toArray())),z!=="right"&&L.geometry.center(),k){var H=F+q/2;z==="right"&&(L.position.x=H),L.position.y={right:-q/2,top:H+q/2,bottom:-H-q/2}[z]}var Q=function($){var re=b.__currentTargetD=$,ae=re.lat,_e=re.lng,ne=re.alt,ye=re.rot,ve=re.scale;Object.assign(b.position,Il(ae,_e,ne)),b.lookAt(e.scene.localToWorld(new iu.Vector3(0,0,0))),b.rotateY(Math.PI),b.rotateZ(-ye*Math.PI/180),b.scale.x=b.scale.y=b.scale.z=ve},K={lat:+t(R),lng:+n(R),alt:+r(R),rot:+a(R),scale:1},se=b.__currentTargetD||Object.assign({},K,{scale:1e-12});Object.keys(K).some(function(ee){return se[ee]!==K[ee]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?Q(K):e.tweenGroup.add(new Mo(se).to(K,e.labelsTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(Q).start()))}).digest(e.labelsData)}}),x1e=Xi(Xi({},window.THREE?window.THREE:{}),{},{CSS2DObject:rte}),dH=Ds({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){if(e.dataMapper){var n=t?[t]:e.dataMapper.entries().map(function(r){var s=Mr(r,2),o=s[1];return o}).filter(function(r){return r});n.forEach(function(r){var s=!e.isBehindGlobe||!e.isBehindGlobe(r.position);e.htmlElementVisibilityModifier?(r.visible=!0,e.htmlElementVisibilityModifier(r.element,s)):r.visible=s})}}},init:function(e,t,n){var r=n.tweenGroup;ur(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(s){var o=bt(t.htmlElement)(s),a=new x1e.CSS2DObject(o);return a.__globeObjType="html",a})},update:function(e,t){var n=this,r=bt(e.htmlLat),s=bt(e.htmlLng),o=bt(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(a,l){var u=function(_){var x=a.__currentTargetD=_,b=x.alt,R=x.lat,E=x.lng;Object.assign(a.position,Il(R,E,b)),n.updateObjVisibility(a)},h={lat:+r(l),lng:+s(l),alt:+o(l)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!a.__currentTargetD?u(h):e.tweenGroup.add(new Mo(a.__currentTargetD).to(h,e.htmlTransitionDuration).easing(ms.Quadratic.InOut).onUpdate(u).start())}).digest(e.htmlElementsData)}}),Yx=window.THREE?window.THREE:{Group:ca,Mesh:Ri,MeshLambertMaterial:Gh,SphereGeometry:_c},AH=Ds({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new Yx.Mesh(new Yx.SphereGeometry(1,16,8),new Yx.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){ur(e),t.scene=e,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(n){var r=bt(t.objectThreeObject)(n);t.objectThreeObject===r&&(r=r.clone());var s=new Yx.Group;return s.add(r),s.__globeObjType="object",s})},update:function(e,t){var n=bt(e.objectLat),r=bt(e.objectLng),s=bt(e.objectAltitude),o=bt(e.objectFacesSurface),a=bt(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(l,u){var h=+n(u),d=+r(u),_=+s(u);Object.assign(l.position,Il(h,d,_)),o(u)?l.setRotationFromEuler(new ao(hA(-h),hA(d),0,"YXZ")):l.rotation.set(0,0,0);var x=l.children[0],b=a(u);b&&x.setRotationFromEuler(new ao(hA(b.x||0),hA(b.y||0),hA(b.z||0)))}).digest(e.objectsData)}}),pH=Ds({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){ur(e),t.scene=e,t.dataMapper=new Ea(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(n){var r=bt(t.customThreeObject)(n,Sr);return r&&(t.customThreeObject===r&&(r=r.clone()),r.__globeObjType="custom"),r})},update:function(e,t){e.customThreeObjectUpdate||ur(e.scene);var n=bt(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(r,s){return n(r,s,Sr)}).digest(e.customLayerData)}}),Qx=window.THREE?window.THREE:{Camera:jy,Group:ca,Vector2:it,Vector3:ce},b1e=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],mH=jo("globeLayer",Jq),S1e=Object.assign.apply(Object,rr(["globeImageUrl","bumpImageUrl","globeCurvatureResolution","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(i){return Xs({},i,mH.linkProp(i))}))),T1e=Object.assign.apply(Object,rr(["globeMaterial"].map(function(i){return Xs({},i,mH.linkMethod(i))}))),E1e=jo("pointsLayer",eH),w1e=Object.assign.apply(Object,rr(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(i){return Xs({},i,E1e.linkProp(i))}))),M1e=jo("arcsLayer",nH),R1e=Object.assign.apply(Object,rr(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(i){return Xs({},i,M1e.linkProp(i))}))),C1e=jo("hexBinLayer",iH),N1e=Object.assign.apply(Object,rr(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(i){return Xs({},i,C1e.linkProp(i))}))),D1e=jo("heatmapsLayer",sH),P1e=Object.assign.apply(Object,rr(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(i){return Xs({},i,D1e.linkProp(i))}))),L1e=jo("hexedPolygonsLayer",aH),O1e=Object.assign.apply(Object,rr(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(i){return Xs({},i,L1e.linkProp(i))}))),I1e=jo("polygonsLayer",oH),B1e=Object.assign.apply(Object,rr(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(i){return Xs({},i,I1e.linkProp(i))}))),U1e=jo("pathsLayer",lH),F1e=Object.assign.apply(Object,rr(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(i){return Xs({},i,U1e.linkProp(i))}))),k1e=jo("tilesLayer",uH),G1e=Object.assign.apply(Object,rr(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(i){return Xs({},i,k1e.linkProp(i))}))),z1e=jo("particlesLayer",cH),V1e=Object.assign.apply(Object,rr(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(i){return Xs({},i,z1e.linkProp(i))}))),q1e=jo("ringsLayer",hH),H1e=Object.assign.apply(Object,rr(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(i){return Xs({},i,q1e.linkProp(i))}))),W1e=jo("labelsLayer",fH),j1e=Object.assign.apply(Object,rr(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(i){return Xs({},i,W1e.linkProp(i))}))),X1e=jo("htmlElementsLayer",dH),$1e=Object.assign.apply(Object,rr(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(i){return Xs({},i,X1e.linkProp(i))}))),Y1e=jo("objectsLayer",AH),Q1e=Object.assign.apply(Object,rr(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(i){return Xs({},i,Y1e.linkProp(i))}))),K1e=jo("customLayer",pH),Z1e=Object.assign.apply(Object,rr(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(i){return Xs({},i,K1e.linkProp(i))}))),J1e=Ds({props:Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi(Xi({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new Qx.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},S1e),w1e),R1e),N1e),P1e),B1e),O1e),F1e),G1e),V1e),H1e),j1e),$1e),Q1e),Z1e),methods:Xi({getGlobeRadius:nB,getCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Il.apply(void 0,n)},toGeoCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Zq.apply(void 0,n)},setPointOfView:function(e,t){var n=t instanceof Qx.Camera?t.position:t,r=nB(),s=void 0;if(e.scene&&n){var o,a,l,u;s=function(d){o===void 0&&(o=n.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),a===void 0&&(a=o.length()),l===void 0&&(l=Math.sqrt(Math.pow(a,2)-Math.pow(r,2))),u===void 0&&(u=Math.acos(l/a));var _=o.distanceTo(d);if(_<l)return!1;var x=d.length(),b=Math.acos((Math.pow(a,2)+Math.pow(_,2)-Math.pow(x,2))/(2*a*_));return b<u}}e.layersThatNeedUpdatePov.forEach(function(h){return h.updatePov(t)}),e.layersThatNeedBehindGlobeChecker.forEach(function(h){return h.isBehindGlobe(s)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(t){var n;return(n=t.pauseAnimation)===null||n===void 0?void 0:n.call(t)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(t){var n;return(n=t.resumeAnimation)===null||n===void 0?void 0:n.call(t)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(t){return t._destructor()})}},T1e),stateInit:function(){var e=new pT,t={tweenGroup:e},n={globeLayer:Jq(t),pointsLayer:eH(t),arcsLayer:nH(t),hexBinLayer:iH(t),heatmapsLayer:sH(t),polygonsLayer:oH(t),hexedPolygonsLayer:aH(t),pathsLayer:lH(t),tilesLayer:uH(t),particlesLayer:cH(t),ringsLayer:hH(t),labelsLayer:fH(t),htmlElementsLayer:dH(t),objectsLayer:AH(t),customLayer:pH(t)};return Xi(Xi({tweenGroup:e},n),{},{layersThatNeedUpdatePov:Object.values(n).filter(function(r){return r.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(n).filter(function(r){return r.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(n).filter(function(r){return r.hasOwnProperty("_destructor")}),pausableLayers:Object.values(n).filter(function(r){return r.hasOwnProperty("pauseAnimation")})})},init:function(e,t,n){var r=n.animateIn,s=r===void 0?!0:r,o=n.waitForGlobeReady,a=o===void 0?!0:o;ur(e),t.scene=e,t.scene.visible=!1,b1e.forEach(function(u){var h=new Qx.Group;t.scene.add(h),t[u](h)});var l=function(){if(s){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new Mo({k:1e-6}).to({k:1},600).easing(ms.Quadratic.Out).onUpdate(function(d){var _=d.k;return t.scene.scale.set(_,_,_)}).start());var h=new Qx.Vector3(0,1,0);t.tweenGroup.add(new Mo({rot:Math.PI*2}).to({rot:0},1200).easing(ms.Quintic.Out).onUpdate(function(d){var _=d.rot;return t.scene.setRotationFromAxisAngle(h,_)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};a?t.globeLayer.onReady(l):l(),this._animationCycle()},update:function(e){}});function e_e(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=function(r){function s(){var o;YT(this,s);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return o=$T(this,s,[].concat(l)),o.__kapsuleInstance=r6(i,[].concat(rr(t?[o]:[]),l)),o}return KT(s,r),QT(s)}(e);return Object.keys(i()).forEach(function(r){return n.prototype[r]=function(){var s,o=(s=this.__kapsuleInstance)[r].apply(s,arguments);return o===this.__kapsuleInstance?this:o}}),n}var t_e=window.THREE?window.THREE:{Group:ca},gH=e_e(J1e,t_e.Group,!0);const XM={type:"change"},l6={type:"start"},u6={type:"end"},hB=1e-6,Gi={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},Kx=new it,Lf=new it,n_e=new ce,Zx=new ce,$M=new ce,Sp=new _u,fB=new ce,Jx=new ce,YM=new ce,eb=new ce;class i_e extends g8{constructor(e,t=null){super(e,t),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Cl.ROTATE,MIDDLE:Cl.DOLLY,RIGHT:Cl.PAN},this.target=new ce,this.state=Gi.NONE,this.keyState=Gi.NONE,this._lastPosition=new ce,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new ce,this._movePrev=new it,this._moveCurr=new it,this._lastAxis=new ce,this._zoomStart=new it,this._zoomEnd=new it,this._panStart=new it,this._panEnd=new it,this._pointers=[],this._pointerPositions={},this._onPointerMove=s_e.bind(this),this._onPointerDown=r_e.bind(this),this._onPointerUp=o_e.bind(this),this._onPointerCancel=a_e.bind(this),this._onContextMenu=A_e.bind(this),this._onMouseWheel=d_e.bind(this),this._onKeyDown=u_e.bind(this),this._onKeyUp=l_e.bind(this),this._onTouchStart=p_e.bind(this),this._onTouchMove=m_e.bind(this),this._onTouchEnd=g_e.bind(this),this._onMouseDown=c_e.bind(this),this._onMouseMove=h_e.bind(this),this._onMouseUp=f_e.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(t),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>hB&&(this.dispatchEvent(XM),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>hB||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(XM),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=Gi.NONE,this.keyState=Gi.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(XM),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Lf.copy(this._panEnd).sub(this._panStart),Lf.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Lf.x*=e,Lf.y*=t}Lf.multiplyScalar(this._eye.length()*this.panSpeed),Zx.copy(this._eye).cross(this.object.up).setLength(Lf.x),Zx.add(n_e.copy(this.object.up).setLength(Lf.y)),this.object.position.add(Zx),this.target.add(Zx),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Lf.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){eb.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=eb.length();e?(this._eye.copy(this.object.position).sub(this.target),fB.copy(this._eye).normalize(),Jx.copy(this.object.up).normalize(),YM.crossVectors(Jx,fB).normalize(),Jx.setLength(this._moveCurr.y-this._movePrev.y),YM.setLength(this._moveCurr.x-this._movePrev.x),eb.copy(Jx.add(YM)),$M.crossVectors(eb,this._eye).normalize(),e*=this.rotateSpeed,Sp.setFromAxisAngle($M,e),this._eye.applyQuaternion(Sp),this.object.up.applyQuaternion(Sp),this._lastAxis.copy($M),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),Sp.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(Sp),this.object.up.applyQuaternion(Sp)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===Gi.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Lm.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Lm.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return Kx.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),Kx}_getMouseOnCircle(e,t){return Kx.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),Kx}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new it,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function r_e(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i))}function s_e(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function o_e(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchEnd(i):this._onMouseUp(),this._removePointer(i),this._pointers.length===0&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function a_e(i){this._removePointer(i)}function l_e(){this.enabled!==!1&&(this.keyState=Gi.NONE,window.addEventListener("keydown",this._onKeyDown))}function u_e(i){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===Gi.NONE&&(i.code===this.keys[Gi.ROTATE]&&!this.noRotate?this.keyState=Gi.ROTATE:i.code===this.keys[Gi.ZOOM]&&!this.noZoom?this.keyState=Gi.ZOOM:i.code===this.keys[Gi.PAN]&&!this.noPan&&(this.keyState=Gi.PAN)))}function c_e(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Cl.DOLLY:this.state=Gi.ZOOM;break;case Cl.ROTATE:this.state=Gi.ROTATE;break;case Cl.PAN:this.state=Gi.PAN;break;default:this.state=Gi.NONE}const t=this.keyState!==Gi.NONE?this.keyState:this.state;t===Gi.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr)):t===Gi.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._zoomEnd.copy(this._zoomStart)):t===Gi.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(l6)}function h_e(i){const e=this.keyState!==Gi.NONE?this.keyState:this.state;e===Gi.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY))):e===Gi.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY)):e===Gi.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY))}function f_e(){this.state=Gi.NONE,this.dispatchEvent(u6)}function d_e(i){if(this.enabled!==!1&&this.noZoom!==!0){switch(i.preventDefault(),i.deltaMode){case 2:this._zoomStart.y-=i.deltaY*.025;break;case 1:this._zoomStart.y-=i.deltaY*.01;break;default:this._zoomStart.y-=i.deltaY*25e-5;break}this.dispatchEvent(l6),this.dispatchEvent(u6)}}function A_e(i){this.enabled!==!1&&i.preventDefault()}function p_e(i){switch(this._trackPointer(i),this._pointers.length){case 1:this.state=Gi.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=Gi.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,r)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(l6)}function m_e(i){switch(this._trackPointer(i),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY));break;default:const e=this._getSecondPointerPosition(i),t=i.pageX-e.x,n=i.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+n*n);const r=(i.pageX+e.x)/2,s=(i.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,s));break}}function g_e(i){switch(this._pointers.length){case 0:this.state=Gi.NONE;break;case 1:this.state=Gi.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=Gi.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==i.pointerId){const t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(u6)}const dB={type:"change"},c6={type:"start"},_H={type:"end"},tb=new Wy,AB=new Gu,__e=Math.cos(70*Lm.DEG2RAD),Ts=new ce,ta=2*Math.PI,lr={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},QM=1e-6;class y_e extends g8{constructor(e,t=null){super(e,t),this.state=lr.NONE,this.target=new ce,this.cursor=new ce,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Cl.ROTATE,MIDDLE:Cl.DOLLY,RIGHT:Cl.PAN},this.touches={ONE:Up.ROTATE,TWO:Up.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ce,this._lastQuaternion=new _u,this._lastTargetPosition=new ce,this._quat=new _u().setFromUnitVectors(e.up,new ce(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new CL,this._sphericalDelta=new CL,this._scale=1,this._panOffset=new ce,this._rotateStart=new it,this._rotateEnd=new it,this._rotateDelta=new it,this._panStart=new it,this._panEnd=new it,this._panDelta=new it,this._dollyStart=new it,this._dollyEnd=new it,this._dollyDelta=new it,this._dollyDirection=new ce,this._mouse=new it,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=x_e.bind(this),this._onPointerDown=v_e.bind(this),this._onPointerUp=b_e.bind(this),this._onContextMenu=C_e.bind(this),this._onMouseWheel=E_e.bind(this),this._onKeyDown=w_e.bind(this),this._onTouchStart=M_e.bind(this),this._onTouchMove=R_e.bind(this),this._onMouseDown=S_e.bind(this),this._onMouseMove=T_e.bind(this),this._interceptControlDown=N_e.bind(this),this._interceptControlUp=D_e.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(dB),this.update(),this.state=lr.NONE}update(e=null){const t=this.object.position;Ts.copy(t).sub(this.target),Ts.applyQuaternion(this._quat),this._spherical.setFromVector3(Ts),this.autoRotate&&this.state===lr.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=ta:n>Math.PI&&(n-=ta),r<-Math.PI?r+=ta:r>Math.PI&&(r-=ta),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(Ts.setFromSpherical(this._spherical),Ts.applyQuaternion(this._quatInverse),t.copy(this.target).add(Ts),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=Ts.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new ce(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const u=new ce(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),o=Ts.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(tb.origin.copy(this.object.position),tb.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(tb.direction))<__e?this.object.lookAt(this.target):(AB.setFromNormalAndCoplanarPoint(this.object.up,this.target),tb.intersectPlane(AB,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>QM||8*(1-this._lastQuaternion.dot(this.object.quaternion))>QM||this._lastTargetPosition.distanceToSquared(this.target)>QM?(this.dispatchEvent(dB),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?ta/60*this.autoRotateSpeed*e:ta/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Ts.setFromMatrixColumn(t,0),Ts.multiplyScalar(-e),this._panOffset.add(Ts)}_panUp(e,t){this.screenSpacePanning===!0?Ts.setFromMatrixColumn(t,1):(Ts.setFromMatrixColumn(t,0),Ts.crossVectors(this.object.up,Ts)),Ts.multiplyScalar(e),this._panOffset.add(Ts)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;Ts.copy(r).sub(this.target);let s=Ts.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,o=n.width,a=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(ta*this._rotateDelta.x/t.clientHeight),this._rotateUp(ta*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(ta*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-ta*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(ta*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-ta*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(ta*this._rotateDelta.x/t.clientHeight),this._rotateUp(ta*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new it,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function v_e(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function x_e(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function b_e(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(_H),this.state=lr.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function S_e(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Cl.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=lr.DOLLY;break;case Cl.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=lr.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=lr.ROTATE}break;case Cl.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=lr.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=lr.PAN}break;default:this.state=lr.NONE}this.state!==lr.NONE&&this.dispatchEvent(c6)}function T_e(i){switch(this.state){case lr.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case lr.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case lr.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function E_e(i){this.enabled===!1||this.enableZoom===!1||this.state!==lr.NONE||(i.preventDefault(),this.dispatchEvent(c6),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(_H))}function w_e(i){this.enabled!==!1&&this._handleKeyDown(i)}function M_e(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case Up.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=lr.TOUCH_ROTATE;break;case Up.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=lr.TOUCH_PAN;break;default:this.state=lr.NONE}break;case 2:switch(this.touches.TWO){case Up.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=lr.TOUCH_DOLLY_PAN;break;case Up.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=lr.TOUCH_DOLLY_ROTATE;break;default:this.state=lr.NONE}break;default:this.state=lr.NONE}this.state!==lr.NONE&&this.dispatchEvent(c6)}function R_e(i){switch(this._trackPointer(i),this.state){case lr.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case lr.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case lr.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case lr.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=lr.NONE}}function C_e(i){this.enabled!==!1&&i.preventDefault()}function N_e(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function D_e(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const P_e={type:"change"},pB=1e-6,mB=new _u;class L_e extends g8{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new ce(0,0,0),this._rotationVector=new ce(0,0,0),this._lastQuaternion=new _u,this._lastPosition=new ce,this._status=0,this._onKeyDown=O_e.bind(this),this._onKeyUp=I_e.bind(this),this._onPointerMove=U_e.bind(this),this._onPointerDown=B_e.bind(this),this._onPointerUp=F_e.bind(this),this._onPointerCancel=k_e.bind(this),this._onContextMenu=G_e.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const t=this.object,n=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),mB.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(mB),(this._lastPosition.distanceToSquared(t.position)>pB||8*(1-this._lastQuaternion.dot(t.quaternion))>pB)&&(this.dispatchEvent(P_e),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function O_e(i){if(!(i.altKey||this.enabled===!1)){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function I_e(i){if(this.enabled!==!1){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function B_e(i){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(i.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function U_e(i){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),t=e.size[0]/2,n=e.size[1]/2;this._moveState.yawLeft=-(i.pageX-e.offset[0]-t)/t,this._moveState.pitchDown=(i.pageY-e.offset[1]-n)/n,this._updateRotationVector()}}function F_e(i){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(i.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function k_e(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function G_e(i){this.enabled!==!1&&i.preventDefault()}const z_e={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class ZT{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const V_e=new Qy(-1,1,1,-1,0,1);class q_e extends Vi{constructor(){super(),this.setAttribute("position",new Si([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Si([0,2,0,0,2,0],2))}}const H_e=new q_e;class W_e{constructor(e){this._mesh=new Ri(H_e,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,V_e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class j_e extends ZT{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof ya?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=lT.clone(e.uniforms),this.material=new ya({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new W_e(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class gB extends ZT{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class X_e extends ZT{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class $_e{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const n=e.getSize(new it);this._width=n.width,this._height=n.height,t=new ad(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:As}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new j_e(z_e),this.copyPass.material.blending=ga,this.clock=new C9}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}gB!==void 0&&(o instanceof gB?n=!0:o instanceof X_e&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new it);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Y_e extends ZT{constructor(e,t,n=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Jt}render(e,t,n){const r=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=r}}function Sa(){return Sa=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Sa.apply(null,arguments)}function Q_e(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ry(i,e){return Ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ry(i,e)}function K_e(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,Ry(i,e)}function r4(i){return r4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r4(i)}function Z_e(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function yH(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yH=function(){return!!i})()}function J_e(i,e,t){if(yH())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&Ry(r,t.prototype),r}function s4(i){var e=typeof Map=="function"?new Map:void 0;return s4=function(n){if(n===null||!Z_e(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return J_e(n,arguments,r4(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ry(r,n)},s4(i)}var Yu=function(i){K_e(e,i);function e(t){var n;return n=i.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,Q_e(n)}return e}(s4(Error));function KM(i){return Math.round(i*255)}function eye(i,e,t){return KM(i)+","+KM(e)+","+KM(t)}function FS(i,e,t,n){if(n===void 0&&(n=eye),e===0)return n(t,t,t);var r=(i%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,o=s*(1-Math.abs(r%2-1)),a=0,l=0,u=0;r>=0&&r<1?(a=s,l=o):r>=1&&r<2?(a=o,l=s):r>=2&&r<3?(l=s,u=o):r>=3&&r<4?(l=o,u=s):r>=4&&r<5?(a=o,u=s):r>=5&&r<6&&(a=s,u=o);var h=t-s/2,d=a+h,_=l+h,x=u+h;return n(d,_,x)}var _B={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function tye(i){if(typeof i!="string")return i;var e=i.toLowerCase();return _B[e]?"#"+_B[e]:i}var nye=/^#[a-fA-F0-9]{6}$/,iye=/^#[a-fA-F0-9]{8}$/,rye=/^#[a-fA-F0-9]{3}$/,sye=/^#[a-fA-F0-9]{4}$/,ZM=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,oye=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,aye=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,lye=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Ym(i){if(typeof i!="string")throw new Yu(3);var e=tye(i);if(e.match(nye))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(iye)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(rye))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(sye)){var n=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:n}}var r=ZM.exec(e);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=oye.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=aye.exec(e);if(o){var a=parseInt(""+o[1],10),l=parseInt(""+o[2],10)/100,u=parseInt(""+o[3],10)/100,h="rgb("+FS(a,l,u)+")",d=ZM.exec(h);if(!d)throw new Yu(4,e,h);return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10)}}var _=lye.exec(e.substring(0,50));if(_){var x=parseInt(""+_[1],10),b=parseInt(""+_[2],10)/100,R=parseInt(""+_[3],10)/100,E="rgb("+FS(x,b,R)+")",w=ZM.exec(E);if(!w)throw new Yu(4,e,E);return{red:parseInt(""+w[1],10),green:parseInt(""+w[2],10),blue:parseInt(""+w[3],10),alpha:parseFloat(""+_[4])>1?parseFloat(""+_[4])/100:parseFloat(""+_[4])}}throw new Yu(5)}function uye(i){var e=i.red/255,t=i.green/255,n=i.blue/255,r=Math.max(e,t,n),s=Math.min(e,t,n),o=(r+s)/2;if(r===s)return i.alpha!==void 0?{hue:0,saturation:0,lightness:o,alpha:i.alpha}:{hue:0,saturation:0,lightness:o};var a,l=r-s,u=o>.5?l/(2-r-s):l/(r+s);switch(r){case e:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-e)/l+2;break;default:a=(e-t)/l+4;break}return a*=60,i.alpha!==void 0?{hue:a,saturation:u,lightness:o,alpha:i.alpha}:{hue:a,saturation:u,lightness:o}}function md(i){return uye(Ym(i))}var cye=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},o4=cye;function oA(i){var e=i.toString(16);return e.length===1?"0"+e:e}function JM(i){return oA(Math.round(i*255))}function hye(i,e,t){return o4("#"+JM(i)+JM(e)+JM(t))}function vH(i,e,t){return FS(i,e,t,hye)}function fye(i,e,t){if(typeof i=="object"&&e===void 0&&t===void 0)return vH(i.hue,i.saturation,i.lightness);throw new Yu(1)}function dye(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?vH(i.hue,i.saturation,i.lightness):"rgba("+FS(i.hue,i.saturation,i.lightness)+","+i.alpha+")";throw new Yu(2)}function xH(i,e,t){if(typeof i=="number"&&typeof e=="number"&&typeof t=="number")return o4("#"+oA(i)+oA(e)+oA(t));if(typeof i=="object"&&e===void 0&&t===void 0)return o4("#"+oA(i.red)+oA(i.green)+oA(i.blue));throw new Yu(6)}function JT(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?xH(i.red,i.green,i.blue):"rgba("+i.red+","+i.green+","+i.blue+","+i.alpha+")";throw new Yu(7)}var Aye=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},pye=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},mye=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},gye=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function gd(i){if(typeof i!="object")throw new Yu(8);if(pye(i))return JT(i);if(Aye(i))return xH(i);if(gye(i))return dye(i);if(mye(i))return fye(i);throw new Yu(8)}function bH(i,e,t){return function(){var r=t.concat(Array.prototype.slice.call(arguments));return r.length>=e?i.apply(this,r):bH(i,e,r)}}function tl(i){return bH(i,i.length,[])}function _ye(i,e){if(e==="transparent")return e;var t=md(e);return gd(Sa({},t,{hue:t.hue+parseFloat(i)}))}tl(_ye);function gg(i,e,t){return Math.max(i,Math.min(e,t))}function yye(i,e){if(e==="transparent")return e;var t=md(e);return gd(Sa({},t,{lightness:gg(0,1,t.lightness-parseFloat(i))}))}tl(yye);function vye(i,e){if(e==="transparent")return e;var t=md(e);return gd(Sa({},t,{saturation:gg(0,1,t.saturation-parseFloat(i))}))}tl(vye);function xye(i,e){if(e==="transparent")return e;var t=md(e);return gd(Sa({},t,{lightness:gg(0,1,t.lightness+parseFloat(i))}))}tl(xye);function bye(i,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(i===0)return t;var n=Ym(e),r=Sa({},n,{alpha:typeof n.alpha=="number"?n.alpha:1}),s=Ym(t),o=Sa({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),a=r.alpha-o.alpha,l=parseFloat(i)*2-1,u=l*a===-1?l:l+a,h=1+l*a,d=(u/h+1)/2,_=1-d,x={red:Math.floor(r.red*d+o.red*_),green:Math.floor(r.green*d+o.green*_),blue:Math.floor(r.blue*d+o.blue*_),alpha:r.alpha*parseFloat(i)+o.alpha*(1-parseFloat(i))};return JT(x)}var Sye=tl(bye),SH=Sye;function Tye(i,e){if(e==="transparent")return e;var t=Ym(e),n=typeof t.alpha=="number"?t.alpha:1,r=Sa({},t,{alpha:gg(0,1,(n*100+parseFloat(i)*100)/100)});return JT(r)}var Eye=tl(Tye),wye=Eye;function Mye(i,e){if(e==="transparent")return e;var t=md(e);return gd(Sa({},t,{saturation:gg(0,1,t.saturation+parseFloat(i))}))}tl(Mye);function Rye(i,e){return e==="transparent"?e:gd(Sa({},md(e),{hue:parseFloat(i)}))}tl(Rye);function Cye(i,e){return e==="transparent"?e:gd(Sa({},md(e),{lightness:parseFloat(i)}))}tl(Cye);function Nye(i,e){return e==="transparent"?e:gd(Sa({},md(e),{saturation:parseFloat(i)}))}tl(Nye);function Dye(i,e){return e==="transparent"?e:SH(parseFloat(i),"rgb(0, 0, 0)",e)}tl(Dye);function Pye(i,e){return e==="transparent"?e:SH(parseFloat(i),"rgb(255, 255, 255)",e)}tl(Pye);function Lye(i,e){if(e==="transparent")return e;var t=Ym(e),n=typeof t.alpha=="number"?t.alpha:1,r=Sa({},t,{alpha:gg(0,1,+(n*100-parseFloat(i)*100).toFixed(2)/100)});return JT(r)}tl(Lye);var a4="http://www.w3.org/1999/xhtml";const yB={svg:"http://www.w3.org/2000/svg",xhtml:a4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function TH(i){var e=i+="",t=e.indexOf(":");return t>=0&&(e=i.slice(0,t))!=="xmlns"&&(i=i.slice(t+1)),yB.hasOwnProperty(e)?{space:yB[e],local:i}:i}function Oye(i){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===a4&&e.documentElement.namespaceURI===a4?e.createElement(i):e.createElementNS(t,i)}}function Iye(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function EH(i){var e=TH(i);return(e.local?Iye:Oye)(e)}function Bye(){}function wH(i){return i==null?Bye:function(){return this.querySelector(i)}}function Uye(i){typeof i!="function"&&(i=wH(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],o=s.length,a=n[r]=new Array(o),l,u,h=0;h<o;++h)(l=s[h])&&(u=i.call(l,l.__data__,h,s))&&("__data__"in l&&(u.__data__=l.__data__),a[h]=u);return new Bl(n,this._parents)}function Fye(i){return i==null?[]:Array.isArray(i)?i:Array.from(i)}function kye(){return[]}function Gye(i){return i==null?kye:function(){return this.querySelectorAll(i)}}function zye(i){return function(){return Fye(i.apply(this,arguments))}}function Vye(i){typeof i=="function"?i=zye(i):i=Gye(i);for(var e=this._groups,t=e.length,n=[],r=[],s=0;s<t;++s)for(var o=e[s],a=o.length,l,u=0;u<a;++u)(l=o[u])&&(n.push(i.call(l,l.__data__,u,o)),r.push(l));return new Bl(n,r)}function qye(i){return function(){return this.matches(i)}}function MH(i){return function(e){return e.matches(i)}}var Hye=Array.prototype.find;function Wye(i){return function(){return Hye.call(this.children,i)}}function jye(){return this.firstElementChild}function Xye(i){return this.select(i==null?jye:Wye(typeof i=="function"?i:MH(i)))}var $ye=Array.prototype.filter;function Yye(){return Array.from(this.children)}function Qye(i){return function(){return $ye.call(this.children,i)}}function Kye(i){return this.selectAll(i==null?Yye:Qye(typeof i=="function"?i:MH(i)))}function Zye(i){typeof i!="function"&&(i=qye(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],o=s.length,a=n[r]=[],l,u=0;u<o;++u)(l=s[u])&&i.call(l,l.__data__,u,s)&&a.push(l);return new Bl(n,this._parents)}function RH(i){return new Array(i.length)}function Jye(){return new Bl(this._enter||this._groups.map(RH),this._parents)}function kS(i,e){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=e}kS.prototype={constructor:kS,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,e){return this._parent.insertBefore(i,e)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function e2e(i){return function(){return i}}function t2e(i,e,t,n,r,s){for(var o=0,a,l=e.length,u=s.length;o<u;++o)(a=e[o])?(a.__data__=s[o],n[o]=a):t[o]=new kS(i,s[o]);for(;o<l;++o)(a=e[o])&&(r[o]=a)}function n2e(i,e,t,n,r,s,o){var a,l,u=new Map,h=e.length,d=s.length,_=new Array(h),x;for(a=0;a<h;++a)(l=e[a])&&(_[a]=x=o.call(l,l.__data__,a,e)+"",u.has(x)?r[a]=l:u.set(x,l));for(a=0;a<d;++a)x=o.call(i,s[a],a,s)+"",(l=u.get(x))?(n[a]=l,l.__data__=s[a],u.delete(x)):t[a]=new kS(i,s[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(_[a])===l&&(r[a]=l)}function i2e(i){return i.__data__}function r2e(i,e){if(!arguments.length)return Array.from(this,i2e);var t=e?n2e:t2e,n=this._parents,r=this._groups;typeof i!="function"&&(i=e2e(i));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var h=n[u],d=r[u],_=d.length,x=s2e(i.call(h,h&&h.__data__,u,n)),b=x.length,R=a[u]=new Array(b),E=o[u]=new Array(b),w=l[u]=new Array(_);t(h,d,R,E,w,x,e);for(var L=0,D=0,O,B;L<b;++L)if(O=R[L]){for(L>=D&&(D=L+1);!(B=E[D])&&++D<b;);O._next=B||null}}return o=new Bl(o,n),o._enter=a,o._exit=l,o}function s2e(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function o2e(){return new Bl(this._exit||this._groups.map(RH),this._parents)}function a2e(i,e,t){var n=this.enter(),r=this,s=this.exit();return typeof i=="function"?(n=i(n),n&&(n=n.selection())):n=n.append(i+""),e!=null&&(r=e(r),r&&(r=r.selection())),t==null?s.remove():t(s),n&&r?n.merge(r).order():r}function l2e(i){for(var e=i.selection?i.selection():i,t=this._groups,n=e._groups,r=t.length,s=n.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var u=t[l],h=n[l],d=u.length,_=a[l]=new Array(d),x,b=0;b<d;++b)(x=u[b]||h[b])&&(_[b]=x);for(;l<r;++l)a[l]=t[l];return new Bl(a,this._parents)}function u2e(){for(var i=this._groups,e=-1,t=i.length;++e<t;)for(var n=i[e],r=n.length-1,s=n[r],o;--r>=0;)(o=n[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function c2e(i){i||(i=h2e);function e(d,_){return d&&_?i(d.__data__,_.__data__):!d-!_}for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s){for(var o=t[s],a=o.length,l=r[s]=new Array(a),u,h=0;h<a;++h)(u=o[h])&&(l[h]=u);l.sort(e)}return new Bl(r,this._parents).order()}function h2e(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}function f2e(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function d2e(){return Array.from(this)}function A2e(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null}function p2e(){let i=0;for(const e of this)++i;return i}function m2e(){return!this.node()}function g2e(i){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,o=r.length,a;s<o;++s)(a=r[s])&&i.call(a,a.__data__,s,r);return this}function _2e(i){return function(){this.removeAttribute(i)}}function y2e(i){return function(){this.removeAttributeNS(i.space,i.local)}}function v2e(i,e){return function(){this.setAttribute(i,e)}}function x2e(i,e){return function(){this.setAttributeNS(i.space,i.local,e)}}function b2e(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(i):this.setAttribute(i,t)}}function S2e(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function T2e(i,e){var t=TH(i);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?y2e:_2e:typeof e=="function"?t.local?S2e:b2e:t.local?x2e:v2e)(t,e))}function CH(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function E2e(i){return function(){this.style.removeProperty(i)}}function w2e(i,e,t){return function(){this.style.setProperty(i,e,t)}}function M2e(i,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(i):this.style.setProperty(i,n,t)}}function R2e(i,e,t){return arguments.length>1?this.each((e==null?E2e:typeof e=="function"?M2e:w2e)(i,e,t??"")):C2e(this.node(),i)}function C2e(i,e){return i.style.getPropertyValue(e)||CH(i).getComputedStyle(i,null).getPropertyValue(e)}function N2e(i){return function(){delete this[i]}}function D2e(i,e){return function(){this[i]=e}}function P2e(i,e){return function(){var t=e.apply(this,arguments);t==null?delete this[i]:this[i]=t}}function L2e(i,e){return arguments.length>1?this.each((e==null?N2e:typeof e=="function"?P2e:D2e)(i,e)):this.node()[i]}function NH(i){return i.trim().split(/^|\s+/)}function h6(i){return i.classList||new DH(i)}function DH(i){this._node=i,this._names=NH(i.getAttribute("class")||"")}DH.prototype={add:function(i){var e=this._names.indexOf(i);e<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var e=this._names.indexOf(i);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function PH(i,e){for(var t=h6(i),n=-1,r=e.length;++n<r;)t.add(e[n])}function LH(i,e){for(var t=h6(i),n=-1,r=e.length;++n<r;)t.remove(e[n])}function O2e(i){return function(){PH(this,i)}}function I2e(i){return function(){LH(this,i)}}function B2e(i,e){return function(){(e.apply(this,arguments)?PH:LH)(this,i)}}function U2e(i,e){var t=NH(i+"");if(arguments.length<2){for(var n=h6(this.node()),r=-1,s=t.length;++r<s;)if(!n.contains(t[r]))return!1;return!0}return this.each((typeof e=="function"?B2e:e?O2e:I2e)(t,e))}function F2e(){this.textContent=""}function k2e(i){return function(){this.textContent=i}}function G2e(i){return function(){var e=i.apply(this,arguments);this.textContent=e??""}}function z2e(i){return arguments.length?this.each(i==null?F2e:(typeof i=="function"?G2e:k2e)(i)):this.node().textContent}function V2e(){this.innerHTML=""}function q2e(i){return function(){this.innerHTML=i}}function H2e(i){return function(){var e=i.apply(this,arguments);this.innerHTML=e??""}}function W2e(i){return arguments.length?this.each(i==null?V2e:(typeof i=="function"?H2e:q2e)(i)):this.node().innerHTML}function j2e(){this.nextSibling&&this.parentNode.appendChild(this)}function X2e(){return this.each(j2e)}function $2e(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Y2e(){return this.each($2e)}function Q2e(i){var e=typeof i=="function"?i:EH(i);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function K2e(){return null}function Z2e(i,e){var t=typeof i=="function"?i:EH(i),n=e==null?K2e:typeof e=="function"?e:wH(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function J2e(){var i=this.parentNode;i&&i.removeChild(this)}function eve(){return this.each(J2e)}function tve(){var i=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function nve(){var i=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function ive(i){return this.select(i?nve:tve)}function rve(i){return arguments.length?this.property("__data__",i):this.node().__data__}function sve(i){return function(e){i.call(this,e,this.__data__)}}function ove(i){return i.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function ave(i){return function(){var e=this.__on;if(e){for(var t=0,n=-1,r=e.length,s;t<r;++t)s=e[t],(!i.type||s.type===i.type)&&s.name===i.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function lve(i,e,t){return function(){var n=this.__on,r,s=sve(e);if(n){for(var o=0,a=n.length;o<a;++o)if((r=n[o]).type===i.type&&r.name===i.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=t),r.value=e;return}}this.addEventListener(i.type,s,t),r={type:i.type,name:i.name,value:e,listener:s,options:t},n?n.push(r):this.__on=[r]}}function uve(i,e,t){var n=ove(i+""),r,s=n.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,h;l<u;++l)for(r=0,h=a[l];r<s;++r)if((o=n[r]).type===h.type&&o.name===h.name)return h.value}return}for(a=e?lve:ave,r=0;r<s;++r)this.each(a(n[r],e,t));return this}function OH(i,e,t){var n=CH(i),r=n.CustomEvent;typeof r=="function"?r=new r(e,t):(r=n.document.createEvent("Event"),t?(r.initEvent(e,t.bubbles,t.cancelable),r.detail=t.detail):r.initEvent(e,!1,!1)),i.dispatchEvent(r)}function cve(i,e){return function(){return OH(this,i,e)}}function hve(i,e){return function(){return OH(this,i,e.apply(this,arguments))}}function fve(i,e){return this.each((typeof e=="function"?hve:cve)(i,e))}function*dve(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length,o;r<s;++r)(o=n[r])&&(yield o)}var Ave=[null];function Bl(i,e){this._groups=i,this._parents=e}function pve(){return this}Bl.prototype={constructor:Bl,select:Uye,selectAll:Vye,selectChild:Xye,selectChildren:Kye,filter:Zye,data:r2e,enter:Jye,exit:o2e,join:a2e,merge:l2e,selection:pve,order:u2e,sort:c2e,call:f2e,nodes:d2e,node:A2e,size:p2e,empty:m2e,each:g2e,attr:T2e,style:R2e,property:L2e,classed:U2e,text:z2e,html:W2e,raise:X2e,lower:Y2e,append:Q2e,insert:Z2e,remove:eve,clone:ive,datum:rve,on:uve,dispatch:fve,[Symbol.iterator]:dve};function mve(i){return typeof i=="string"?new Bl([[document.querySelector(i)]],[document.documentElement]):new Bl([[i]],Ave)}function gve(i){let e;for(;e=i.sourceEvent;)i=e;return i}function _ve(i,e){if(i=gve(i),e===void 0&&(e=i.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=i.clientX,n.y=i.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop]}}return[i.pageX,i.pageY]}var c2,Or,IH,BH,fA,vB,UH,FH,kH,f6,l4,u4,Cy={},GH=[],yve=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,e3=Array.isArray;function Qu(i,e){for(var t in e)i[t]=e[t];return i}function d6(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function vve(i,e,t){var n,r,s,o={};for(s in e)s=="key"?n=e[s]:s=="ref"?r=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?c2.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(s in i.defaultProps)o[s]===void 0&&(o[s]=i.defaultProps[s]);return B_(i,o,n,r,null)}function B_(i,e,t,n,r){var s={type:i,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++IH,__i:-1,__u:0};return r==null&&Or.vnode!=null&&Or.vnode(s),s}function t3(i){return i.children}function Ub(i,e){this.props=i,this.context=e}function Qm(i,e){if(e==null)return i.__?Qm(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?Qm(i):null}function zH(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return zH(i)}}function xB(i){(!i.__d&&(i.__d=!0)&&fA.push(i)&&!GS.__r++||vB!=Or.debounceRendering)&&((vB=Or.debounceRendering)||UH)(GS)}function GS(){for(var i,e,t,n,r,s,o,a=1;fA.length;)fA.length>a&&fA.sort(FH),i=fA.shift(),a=fA.length,i.__d&&(t=void 0,r=(n=(e=i).__v).__e,s=[],o=[],e.__P&&((t=Qu({},n)).__v=n.__v+1,Or.vnode&&Or.vnode(t),A6(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,s,r??Qm(n),!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,HH(s,t,o),t.__e!=r&&zH(t)));GS.__r=0}function VH(i,e,t,n,r,s,o,a,l,u,h){var d,_,x,b,R,E,w=n&&n.__k||GH,L=e.length;for(l=xve(t,e,w,l,L),d=0;d<L;d++)(x=t.__k[d])!=null&&(_=x.__i==-1?Cy:w[x.__i]||Cy,x.__i=d,E=A6(i,x,_,r,s,o,a,l,u,h),b=x.__e,x.ref&&_.ref!=x.ref&&(_.ref&&p6(_.ref,null,x),h.push(x.ref,x.__c||b,x)),R==null&&b!=null&&(R=b),4&x.__u||_.__k===x.__k?l=qH(x,l,i):typeof x.type=="function"&&E!==void 0?l=E:b&&(l=b.nextSibling),x.__u&=-7);return t.__e=R,l}function xve(i,e,t,n,r){var s,o,a,l,u,h=t.length,d=h,_=0;for(i.__k=new Array(r),s=0;s<r;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=s+_,(o=i.__k[s]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?B_(null,o,null,null,null):e3(o)?B_(t3,{children:o},null,null,null):o.constructor==null&&o.__b>0?B_(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=i,o.__b=i.__b+1,a=null,(u=o.__i=bve(o,t,l,d))!=-1&&(d--,(a=t[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(r>h?_--:r<h&&_++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?_--:u==l+1?_++:(u>l?_--:_++,o.__u|=4))):i.__k[s]=null;if(d)for(s=0;s<h;s++)(a=t[s])!=null&&(2&a.__u)==0&&(a.__e==n&&(n=Qm(a)),jH(a,a));return n}function qH(i,e,t){var n,r;if(typeof i.type=="function"){for(n=i.__k,r=0;n&&r<n.length;r++)n[r]&&(n[r].__=i,e=qH(n[r],e,t));return e}i.__e!=e&&(e&&i.type&&!t.contains(e)&&(e=Qm(i)),t.insertBefore(i.__e,e||null),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function bve(i,e,t,n){var r,s,o=i.key,a=i.type,l=e[t];if(l===null&&i.key==null||l&&o==l.key&&a==l.type&&(2&l.__u)==0)return t;if(n>(l!=null&&(2&l.__u)==0?1:0))for(r=t-1,s=t+1;r>=0||s<e.length;){if(r>=0){if((l=e[r])&&(2&l.__u)==0&&o==l.key&&a==l.type)return r;r--}if(s<e.length){if((l=e[s])&&(2&l.__u)==0&&o==l.key&&a==l.type)return s;s++}}return-1}function bB(i,e,t){e[0]=="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||yve.test(e)?t:t+"px"}function nb(i,e,t,n,r){var s,o;e:if(e=="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(e in n)t&&e in t||bB(i.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||bB(i.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(kH,"$1")),o=e.toLowerCase(),e=o in i||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),i.l||(i.l={}),i.l[e+s]=t,t?n?t.u=n.u:(t.u=f6,i.addEventListener(e,s?u4:l4,s)):i.removeEventListener(e,s?u4:l4,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&t==1?"":t))}}function SB(i){return function(e){if(this.l){var t=this.l[e.type+i];if(e.t==null)e.t=f6++;else if(e.t<t.u)return;return t(Or.event?Or.event(e):e)}}}function A6(i,e,t,n,r,s,o,a,l,u){var h,d,_,x,b,R,E,w,L,D,O,B,G,k,z,F,q,H=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),s=[a=e.__e=t.__e]),(h=Or.__b)&&h(e);e:if(typeof H=="function")try{if(w=e.props,L="prototype"in H&&H.prototype.render,D=(h=H.contextType)&&n[h.__c],O=h?D?D.props.value:h.__:n,t.__c?E=(d=e.__c=t.__c).__=d.__E:(L?e.__c=d=new H(w,O):(e.__c=d=new Ub(w,O),d.constructor=H,d.render=Tve),D&&D.sub(d),d.props=w,d.state||(d.state={}),d.context=O,d.__n=n,_=d.__d=!0,d.__h=[],d._sb=[]),L&&d.__s==null&&(d.__s=d.state),L&&H.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Qu({},d.__s)),Qu(d.__s,H.getDerivedStateFromProps(w,d.__s))),x=d.props,b=d.state,d.__v=e,_)L&&H.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),L&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(L&&H.getDerivedStateFromProps==null&&w!==x&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(w,O),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(w,d.__s,O)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(d.props=w,d.state=d.__s,d.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Q){Q&&(Q.__=e)}),B=0;B<d._sb.length;B++)d.__h.push(d._sb[B]);d._sb=[],d.__h.length&&o.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(w,d.__s,O),L&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(x,b,R)})}if(d.context=O,d.props=w,d.__P=i,d.__e=!1,G=Or.__r,k=0,L){for(d.state=d.__s,d.__d=!1,G&&G(e),h=d.render(d.props,d.state,d.context),z=0;z<d._sb.length;z++)d.__h.push(d._sb[z]);d._sb=[]}else do d.__d=!1,G&&G(e),h=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++k<25);d.state=d.__s,d.getChildContext!=null&&(n=Qu(Qu({},n),d.getChildContext())),L&&!_&&d.getSnapshotBeforeUpdate!=null&&(R=d.getSnapshotBeforeUpdate(x,b)),F=h,h!=null&&h.type===t3&&h.key==null&&(F=WH(h.props.children)),a=VH(i,e3(F)?F:[F],e,t,n,r,s,o,a,l,u),d.base=e.__e,e.__u&=-161,d.__h.length&&o.push(d),E&&(d.__E=d.__=null)}catch(Q){if(e.__v=null,l||s!=null)if(Q.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else for(q=s.length;q--;)d6(s[q]);else e.__e=t.__e,e.__k=t.__k;Or.__e(Q,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=Sve(t.__e,e,t,n,r,s,o,l,u);return(h=Or.diffed)&&h(e),128&e.__u?void 0:a}function HH(i,e,t){for(var n=0;n<t.length;n++)p6(t[n],t[++n],t[++n]);Or.__c&&Or.__c(e,i),i.some(function(r){try{i=r.__h,r.__h=[],i.some(function(s){s.call(r)})}catch(s){Or.__e(s,r.__v)}})}function WH(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:e3(i)?i.map(WH):Qu({},i)}function Sve(i,e,t,n,r,s,o,a,l){var u,h,d,_,x,b,R,E=t.props,w=e.props,L=e.type;if(L=="svg"?r="http://www.w3.org/2000/svg":L=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(u=0;u<s.length;u++)if((x=s[u])&&"setAttribute"in x==!!L&&(L?x.localName==L:x.nodeType==3)){i=x,s[u]=null;break}}if(i==null){if(L==null)return document.createTextNode(w);i=document.createElementNS(r,L,w.is&&w),a&&(Or.__m&&Or.__m(e,s),a=!1),s=null}if(L==null)E===w||a&&i.data==w||(i.data=w);else{if(s=s&&c2.call(i.childNodes),E=t.props||Cy,!a&&s!=null)for(E={},u=0;u<i.attributes.length;u++)E[(x=i.attributes[u]).name]=x.value;for(u in E)if(x=E[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=x;else if(!(u in w)){if(u=="value"&&"defaultValue"in w||u=="checked"&&"defaultChecked"in w)continue;nb(i,u,null,x,r)}}for(u in w)x=w[u],u=="children"?_=x:u=="dangerouslySetInnerHTML"?h=x:u=="value"?b=x:u=="checked"?R=x:a&&typeof x!="function"||E[u]===x||nb(i,u,x,E[u],r);if(h)a||d&&(h.__html==d.__html||h.__html==i.innerHTML)||(i.innerHTML=h.__html),e.__k=[];else if(d&&(i.innerHTML=""),VH(e.type=="template"?i.content:i,e3(_)?_:[_],e,t,n,L=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,o,s?s[0]:t.__k&&Qm(t,0),a,l),s!=null)for(u=s.length;u--;)d6(s[u]);a||(u="value",L=="progress"&&b==null?i.removeAttribute("value"):b!=null&&(b!==i[u]||L=="progress"&&!b||L=="option"&&b!=E[u])&&nb(i,u,b,E[u],r),u="checked",R!=null&&R!=i[u]&&nb(i,u,R,E[u],r))}return i}function p6(i,e,t){try{if(typeof i=="function"){var n=typeof i.__u=="function";n&&i.__u(),n&&e==null||(i.__u=i(e))}else i.current=e}catch(r){Or.__e(r,t)}}function jH(i,e,t){var n,r;if(Or.unmount&&Or.unmount(i),(n=i.ref)&&(n.current&&n.current!=i.__e||p6(n,null,e)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(s){Or.__e(s,e)}n.base=n.__P=null}if(n=i.__k)for(r=0;r<n.length;r++)n[r]&&jH(n[r],e,t||typeof i.type!="function");t||d6(i.__e),i.__c=i.__=i.__e=void 0}function Tve(i,e,t){return this.constructor(i,t)}function Eve(i,e,t){var n,r,s,o;e==document&&(e=document.documentElement),Or.__&&Or.__(i,e),r=(n=!1)?null:e.__k,s=[],o=[],A6(e,i=e.__k=vve(t3,null,[i]),r||Cy,Cy,e.namespaceURI,r?null:e.firstChild?c2.call(e.childNodes):null,s,r?r.__e:e.firstChild,n,o),HH(s,i,o)}function XH(i,e,t){var n,r,s,o,a=Qu({},i.props);for(s in i.type&&i.type.defaultProps&&(o=i.type.defaultProps),e)s=="key"?n=e[s]:s=="ref"?r=e[s]:a[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(a.children=arguments.length>3?c2.call(arguments,2):t),B_(i.type,a,n||i.key,r||i.ref,null)}c2=GH.slice,Or={__e:function(i,e,t,n){for(var r,s,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(i)),o=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(i,n||{}),o=r.__d),o)return r.__E=r}catch(a){i=a}throw i}},IH=0,BH=function(i){return i!=null&&i.constructor==null},Ub.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Qu({},this.state),typeof i=="function"&&(i=i(Qu({},t),this.props)),i&&Qu(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),xB(this))},Ub.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),xB(this))},Ub.prototype.render=t3,fA=[],UH=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,FH=function(i,e){return i.__v.__b-e.__v.__b},GS.__r=0,kH=/(PointerCapture)$|Capture$/i,f6=0,l4=SB(!1),u4=SB(!0);function TB(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function wve(i){if(Array.isArray(i))return i}function Mve(i,e,t){return(e=Lve(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Rve(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Cve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EB(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Nve(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?EB(Object(t),!0).forEach(function(n){Mve(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):EB(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Dve(i,e){return wve(i)||Rve(i,e)||Ove(i,e)||Cve()}function Pve(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Lve(i){var e=Pve(i,"string");return typeof e=="symbol"?e:e+""}function zS(i){"@babel/helpers - typeof";return zS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zS(i)}function Ove(i,e){if(i){if(typeof i=="string")return TB(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?TB(i,e):void 0}}var c4=function(e){if(zS(e)!=="object")return e;var t=XH(e);if(t.props){var n;t.props=Nve({},t.props),t!=null&&(n=t.props)!==null&&n!==void 0&&n.children&&(t.props.children=Array.isArray(t.props.children)?t.props.children.map(c4):c4(t.props.children))}return t},Ive=function(e){return BH(XH(e))},Bve=function(e,t){delete t.__k,Eve(c4(e),t)};function Uve(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var Fve=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;Uve(Fve);var kve=Ds({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.style,s=r===void 0?{}:r,o=!!e&&zS(e)==="object"&&!!e.node&&typeof e.node=="function",a=mve(o?e.node():e);a.style("position")==="static"&&a.style("position","relative"),t.tooltipEl=a.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(u){var h=Dve(u,2),d=h[0],_=h[1];return t.tooltipEl.style(d,_)}),t.tooltipEl.style("left","-10000px").style("display","none");var l="tooltip-".concat(Math.round(Math.random()*1e12));t.mouseInside=!1,a.on("mousemove.".concat(l),function(u){t.mouseInside=!0;var h=_ve(u),d=a.node(),_=d.offsetWidth,x=d.offsetHeight,b=[t.offsetX===null||t.offsetX===void 0?"-".concat(h[0]/_*100,"%"):typeof t.offsetX=="number"?"calc(-50% + ".concat(t.offsetX,"px)"):t.offsetX,t.offsetY===null||t.offsetY===void 0?x>130&&x-h[1]<100?"calc(-100% - 6px)":"21px":typeof t.offsetY=="number"?t.offsetY<0?"calc(-100% - ".concat(Math.abs(t.offsetY),"px)"):"".concat(t.offsetY,"px"):t.offsetY];t.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(b.join(","),")")),t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseover.".concat(l),function(){t.mouseInside=!0,t.content&&t.tooltipEl.style("display","inline")}),a.on("mouseout.".concat(l),function(){t.mouseInside=!1,t.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):Ive(e.content)?(e.tooltipEl.text(""),Bve(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function Gve(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var zve=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;Gve(zve);function h4(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function Vve(i){if(Array.isArray(i))return i}function qve(i){if(Array.isArray(i))return h4(i)}function Hve(i,e,t){return(e=Kve(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Wve(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function jve(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(h){u=!0,r=h}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Xve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yve(i,e){return Vve(i)||jve(i,e)||$H(i,e)||Xve()}function Jd(i){return qve(i)||Wve(i)||$H(i)||$ve()}function Qve(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Kve(i){var e=Qve(i,"string");return typeof e=="symbol"?e:e+""}function $H(i,e){if(i){if(typeof i=="string")return h4(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h4(i,e):void 0}}var Pr=window.THREE?window.THREE:{WebGLRenderer:ite,Scene:uT,PerspectiveCamera:Ws,Raycaster:_Q,SRGBColorSpace:qs,TextureLoader:d8,Vector2:it,Vector3:ce,Box3:kh,Color:Jt,Mesh:Ri,SphereGeometry:_c,MeshBasicMaterial:$a,BackSide:Zi,Clock:C9},YH=Ds({props:{width:{default:window.innerWidth,onChange:function(e,t,n){isNaN(e)&&(t.width=n)}},height:{default:window.innerHeight,onChange:function(e,t,n){isNaN(e)&&(t.height=n)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.tooltip&&t.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(o){return o.render(e.scene,e.camera)});var t=+new Date;if(e.enablePointerInteraction&&t-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=t;var n=null;if(e.hoverDuringDrag||!e.isPointerDragging){var r=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&r.sort(function(o,a){return e.hoverOrderComparator(o.object,a.object)});var s=r.find(function(o){return e.hoverFilter(o.object)})||null;n=s?s.object:null,e.intersection=s||null}n!==e.hoverObj&&(e.onHover(n,e.hoverObj,e.intersection),e.tooltip.content(n&&bt(e.tooltipContent)(n,e.intersection)||null),e.hoverObj=n)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos,n=t.x,r=t.y;return{x:n,y:r}},cameraPosition:function(e,t,n,r){var s=e.camera;if(t&&e.initialised){var o=t,a=n||{x:0,y:0,z:0};if(!r)h(o),d(a);else{var l=Object.assign({},s.position),u=_();e.tweenGroup.add(new Mo(l).to(o,r).easing(ms.Quadratic.Out).onUpdate(h).start()),e.tweenGroup.add(new Mo(u).to(a,r/3).easing(ms.Quadratic.Out).onUpdate(d).start())}return this}return Object.assign({},s.position,{lookAt:_()});function h(x){var b=x.x,R=x.y,E=x.z;b!==void 0&&(s.position.x=b),R!==void 0&&(s.position.y=R),E!==void 0&&(s.position.z=E)}function d(x){var b=new Pr.Vector3(x.x,x.y,x.z);e.controls.enabled&&e.controls.target?e.controls.target=b:s.lookAt(b)}function _(){return Object.assign(new Pr.Vector3(0,0,-1e3).applyQuaternion(s.quaternion).add(s.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,r=arguments.length,s=new Array(r>3?r-3:0),o=3;o<r;o++)s[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,s),t,n)},fitToBbox:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,s=e.camera;if(t){var o=new Pr.Vector3(0,0,0),a=Math.max.apply(Math,Jd(Object.entries(t).map(function(x){var b=Yve(x,2),R=b[0],E=b[1];return Math.max.apply(Math,Jd(E.map(function(w){return Math.abs(o[R]-w)})))})))*2,l=(1-r*2/e.height)*s.fov,u=a/Math.atan(l*Math.PI/180),h=u/s.aspect,d=Math.max(u,h);if(d>0){var _=o.clone().sub(s.position).normalize().multiplyScalar(-d);this.cameraPosition(_,o,n)}}return this},getBbox:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},n=new Pr.Box3(new Pr.Vector3(0,0,0),new Pr.Vector3(0,0,0)),r=e.objects.filter(t);return r.length?(r.forEach(function(s){return n.expandByObject(s)}),Object.assign.apply(Object,Jd(["x","y","z"].map(function(s){return Hve({},s,[n.min[s],n.max[s]])})))):null},getScreenCoords:function(e,t,n,r){var s=new Pr.Vector3(t,n,r);return s.project(this.camera()),{x:(s.x+1)*e.width/2,y:-(s.y-1)*e.height/2}},getSceneCoords:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=new Pr.Vector2(t/e.width*2-1,-(n/e.height)*2+1),o=new Pr.Raycaster;return o.setFromCamera(s,e.camera),Object.assign({},o.ray.at(r,new Pr.Vector3))},intersectingObjects:function(e,t,n){var r=new Pr.Vector2(t/e.width*2-1,-(n/e.height)*2+1),s=new Pr.Raycaster;return s.params.Line.threshold=e.lineHoverPrecision,s.params.Points.threshold=e.pointsHoverPrecision,s.setFromCamera(r,e.camera),s.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new Pr.Scene,camera:new Pr.PerspectiveCamera,clock:new Pr.Clock,tweenGroup:new pT,lastRaycasterCheck:0}},init:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.controlType,s=r===void 0?"trackball":r,o=n.useWebGPU,a=o===void 0?!1:o,l=n.rendererConfig,u=l===void 0?{}:l,h=n.extraRenderers,d=h===void 0?[]:h,_=n.waitForLoadComplete,x=_===void 0?!0:_;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[s]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.tooltip=new kve(t.container),t.pointerPos=new Pr.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(b){return t.container.addEventListener(b,function(R){if(b==="pointerdown"&&(t.isPointerPressed=!0),!t.isPointerDragging&&R.type==="pointermove"&&(R.pressure>0||t.isPointerPressed)&&(R.pointerType==="mouse"||R.movementX===void 0||[R.movementX,R.movementY].some(function(L){return Math.abs(L)>1}))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var E=w(t.container);t.pointerPos.x=R.pageX-E.left,t.pointerPos.y=R.pageY-E.top}function w(L){var D=L.getBoundingClientRect(),O=window.pageXOffset||document.documentElement.scrollLeft,B=window.pageYOffset||document.documentElement.scrollTop;return{top:D.top+B,left:D.left+O}}},{passive:!0})}),t.container.addEventListener("pointerup",function(b){t.isPointerPressed&&(t.isPointerPressed=!1,!(t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag))&&requestAnimationFrame(function(){b.button===0&&t.onClick(t.hoverObj||null,b,t.intersection),b.button===2&&t.onRightClick&&t.onRightClick(t.hoverObj||null,b,t.intersection)}))},{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",function(b){t.onRightClick&&b.preventDefault()}),t.renderer=new(a?Wq:Pr.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=d,t.extraRenderers.forEach(function(b){b.domElement.style.position="absolute",b.domElement.style.top="0px",b.domElement.style.pointerEvents="none",t.container.appendChild(b.domElement)}),t.postProcessingComposer=new $_e(t.renderer),t.postProcessingComposer.addPass(new Y_e(t.scene,t.camera)),t.controls=new{trackball:i_e,orbit:y_e,fly:L_e}[s](t.camera,t.renderer.domElement),s==="fly"&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),(s==="trackball"||s==="orbit")&&(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",function(){t.controlsEngaged=!0}),t.controls.addEventListener("change",function(){t.controlsEngaged&&(t.controlsDragging=!0)}),t.controls.addEventListener("end",function(){t.controlsEngaged=!1,t.controlsDragging=!1})),[t.renderer,t.postProcessingComposer].concat(Jd(t.extraRenderers)).forEach(function(b){return b.setSize(t.width,t.height)}),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new Pr.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!x,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))){var n,r=e.width,s=e.height;e.container.style.width="".concat(r,"px"),e.container.style.height="".concat(s,"px"),[e.renderer,e.postProcessingComposer].concat(Jd(e.extraRenderers)).forEach(function(x){return x.setSize(r,s)}),e.camera.aspect=r/s;var o=e.viewOffset.slice(0,2);o.some(function(x){return x})&&(n=e.camera).setViewOffset.apply(n,[r,s].concat(Jd(o),[r,s])),e.camera.updateProjectionMatrix()}if(t.hasOwnProperty("viewOffset")){var a,l=e.width,u=e.height,h=e.viewOffset.slice(0,2);h.some(function(x){return x})?(a=e.camera).setViewOffset.apply(a,[l,u].concat(Jd(h),[l,u])):e.camera.clearViewOffset()}if(t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new Pr.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var d=Ym(e.backgroundColor).alpha;d===void 0&&(d=1),e.renderer.setClearColor(new Pr.Color(wye(1,e.backgroundColor)),d)}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new Pr.TextureLoader().load(e.backgroundImageUrl,function(x){x.colorSpace=Pr.SRGBColorSpace,e.skysphere.material=new Pr.MeshBasicMaterial({map:x,side:Pr.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&_()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&_())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach(function(x){return e.scene.remove(x)}),e.lights.forEach(function(x){return e.scene.add(x)})),t.hasOwnProperty("objects")&&((t.objects||[]).forEach(function(x){return e.scene.remove(x)}),e.objects.forEach(function(x){return e.scene.add(x)}));function _(){e.loadComplete=e.scene.visible=!0}}});function Zve(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var Jve=`.scene-container .clickable {
  cursor: pointer;
}`;Zve(Jve);function f4(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function exe(i){if(Array.isArray(i))return f4(i)}function h2(i,e,t){return(e=oxe(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function txe(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function nxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wB(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function dA(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wB(Object(t),!0).forEach(function(n){h2(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):wB(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function ixe(i,e){if(i==null)return{};var t,n,r=rxe(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function rxe(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.indexOf(n)!==-1)continue;t[n]=i[n]}return t}function n3(i){return exe(i)||txe(i)||axe(i)||nxe()}function sxe(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function oxe(i){var e=sxe(i,"string");return typeof e=="symbol"?e:e+""}function axe(i,e){if(i){if(typeof i=="string")return f4(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f4(i,e):void 0}}function QH(i,e){var t=new e;return t._destructor&&t._destructor(),{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[i][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[i],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var h=o[r].apply(o,l);return h===o?this:h}}}}var lxe=["rendererConfig","waitForGlobeReady"],Z1=dA(dA({},window.THREE?window.THREE:{AmbientLight:m8,DirectionalLight:M9,Vector2:it,REVISION:og}),{},{CSS2DRenderer:ste}),KH=QH("globe",gH),uxe=Object.assign.apply(Object,n3(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","globeCurvatureResolution","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(i){return h2({},i,KH.linkProp(i))}))),cxe=Object.assign.apply(Object,n3(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map(function(i){return h2({},i,KH.linkMethod(i))}))),ZH=QH("renderObjs",YH),hxe=Object.assign.apply(Object,n3(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(i){return h2({},i,ZH.linkProp(i))}))),fxe=Object.assign.apply(Object,n3(["lights","postProcessingComposer"].map(function(i){return h2({},i,ZH.linkMethod(i))}))),dxe=Ds({props:dA(dA({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},particleLabel:{default:"name",triggerUpdate:!1},onParticleClick:{triggerUpdate:!1},onParticleRightClick:{triggerUpdate:!1},onParticleHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){t.renderObjs.lineHoverPrecision(e),t.renderObjs.pointsHoverPrecision(e)}},globeOffset:{default:[0,0],triggerUpdate:!1,onChange:function(e,t){return Array.isArray(e)&&e.length===2&&t.renderObjs.viewOffset(e.map(function(n){return-n}))}}},uxe),hxe),methods:dA(dA({pauseAnimation:function(e){var t;return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),(t=e.globe)===null||t===void 0||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return e.animationFrameRequestId===null&&this._animationCycle(),(t=e.globe)===null||t===void 0||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=o();if(t.lat===void 0&&t.lng===void 0&&t.altitude===void 0)return r;var s=Object.assign({},r,t);if(["lat","lng","altitude"].forEach(function(l){return s[l]=+s[l]}),!n)a(s);else{for(;r.lng-s.lng>180;)r.lng-=360;for(;r.lng-s.lng<-180;)r.lng+=360;e.tweenGroup.add(new Mo(r).to(s,n).easing(ms.Cubic.InOut).onUpdate(a).start())}return this;function o(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function a(l){var u=l.lat,h=l.lng,d=l.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(u,h,d)),e.globe.setPointOfView(e.renderObjs.camera())}},getScreenCoords:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];var o=(t=e.globe).getCoords.apply(t,r);return e.renderObjs.getScreenCoords(o.x,o.y,o.z)},toGlobeCoords:function(e,t,n){var r=e.renderObjs.intersectingObjects(t,n).find(function(l){return(l.object.__globeObjType||l.object.parent.__globeObjType)==="globe"});if(!r)return null;var s=e.globe.toGeoCoords(r.point),o=s.lat,a=s.lng;return{lat:o,lng:a}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.particlesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},cxe),fxe),stateInit:function(e){var t=e.rendererConfig,n=e.waitForGlobeReady,r=n===void 0?!0:n,s=ixe(e,lxe),o=new gH(dA({waitForGlobeReady:r},s));return{globe:o,renderObjs:YH({controlType:"orbit",rendererConfig:t,waitForLoadComplete:r,extraRenderers:[new Z1.CSS2DRenderer]}).skyRadius(o.getGlobeRadius()*500).showNavInfo(!1).objects([o]).lights([new Z1.AmbientLight(13421772,Math.PI),new Z1.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new pT}},init:function(e,t){var n=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var r=document.createElement("div");t.container.appendChild(r),t.renderObjs(r),t.globe.rendererSize(t.renderObjs.renderer().getSize(new Z1.Vector2)),this.pointOfView({altitude:2.5});var s=t.globe.getGlobeRadius(),o=t.renderObjs.controls();t.renderObjs.camera().near=.05,o.minDistance=s+Math.max(.001,t.renderObjs.camera().near*1.1),o.maxDistance=s*100,o.enablePan=!1,o.enableDamping=!0,o.dampingFactor=.1,o.rotateSpeed=.3,o.zoomSpeed=.3,o.zoomToCursor=!0,o.addEventListener("change",function(){o.target.setScalar(0);var u=n.pointOfView();o.rotateSpeed=u.altitude*.3,o.zoomSpeed=Math.sqrt(u.altitude)*.5,t.globe.setPointOfView(t.renderObjs.camera()),t.onZoom&&t.onZoom(u)});var a=function(h){for(var d=h;d&&!d.hasOwnProperty("__globeObjType");)d=d.parent;return d},l={point:function(h){return h},arc:function(h){return h},polygon:function(h){return h.data},path:function(h){return h},heatmap:function(h){return h},hexbin:function(h){return h},hexPolygon:function(h){return h},tile:function(h){return h},particles:function(h,d){return!d||!d.hasOwnProperty("index")||h.length<=d.index?h:h[d.index]},label:function(h){return h},object:function(h){return h},custom:function(h){return h}};Z1.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverFilter(function(u){var h=a(u);if(!h)return!1;var d=h.__globeObjType;if(d!=="globe"&&!l.hasOwnProperty(d))return!1;var _=l.hasOwnProperty(d)&&h.__data?l[d](h.__data):null;return["points","hexBinPoints"].some(function(x){return x===d})&&Array.isArray(_)?!1:t.pointerEventsFilter(h,_)}).tooltipContent(function(u,h){var d={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,particles:t.particleLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},_=a(u),x=_&&_.__globeObjType;return _&&x&&d.hasOwnProperty(x)&&l.hasOwnProperty(x)&&bt(d[x])(l[x](_.__data,h))||""}).onHover(function(u,h,d){var _={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,particles:t.onParticleHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},x={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},b=a(u);if(b&&!_.hasOwnProperty(b.__globeObjType)&&(b=null),b!==t.hoverObj){var R=t.hoverObj?t.hoverObj.__globeObjType:null,E=t.hoverData,w=b?b.__globeObjType:null,L=b?l[w](b.__data,d):null;R&&R!==w&&_[R]&&_[R](null,E||null),w&&_[w]&&_[w](L,R===w?E:null),t.renderObjs.renderer().domElement.classList[w&&x[w]?"add":"remove"]("clickable"),t.hoverObj=b,t.hoverData=L}}).onClick(function(u,h,d){if(u){var _={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},x=a(u),b=x.__globeObjType;if(x&&_.hasOwnProperty(b)&&_[b]){var R=[h],E=d!=null&&d.isVector3?d:d?.point;if(b==="globe"){var w=n.toGeoCoords(E),L=w.lat,D=w.lng;R.unshift({lat:L,lng:D})}else R.push(n.toGeoCoords(E));l.hasOwnProperty(b)&&R.unshift(l[b](x.__data,d)),_[b].apply(_,R)}}}).onRightClick(function(u,h,d){if(u){var _={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,particles:t.onParticleRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},x=a(u),b=x.__globeObjType;if(x&&_.hasOwnProperty(b)&&_[b]){var R=[h],E=d!=null&&d.isVector3?d:d?.point;if(b==="globe"){var w=n.toGeoCoords(E),L=w.lat,D=w.lng;R.unshift({lat:L,lng:D})}else R.push(n.toGeoCoords(E));l.hasOwnProperty(b)&&R.unshift(l[b](x.__data,d)),_[b].apply(_,R)}}}),this._animationCycle()}}),eR={exports:{}},tR,MB;function Axe(){if(MB)return tR;MB=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return tR=i,tR}var nR,RB;function pxe(){if(RB)return nR;RB=1;var i=Axe();function e(){}function t(){}return t.resetWarningCache=e,nR=function(){function n(o,a,l,u,h,d){if(d!==i){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}n.isRequired=n;function r(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:r,element:n,elementType:n,instanceOf:r,node:n,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},nR}var CB;function mxe(){return CB||(CB=1,eR.exports=pxe()()),eR.exports}var gxe=mxe();const X=nT(gxe);var _xe={width:X.number,height:X.number,globeOffset:X.arrayOf(X.number),backgroundColor:X.string,backgroundImageUrl:X.string,globeImageUrl:X.string,bumpImageUrl:X.string,globeTileEngineUrl:X.func,showGlobe:X.bool,showGraticules:X.bool,showAtmosphere:X.bool,atmosphereColor:X.string,atmosphereAltitude:X.number,globeMaterial:X.object,onGlobeReady:X.func,onGlobeClick:X.func,onGlobeRightClick:X.func,pointsData:X.arrayOf(X.object),pointLat:X.oneOfType([X.number,X.string,X.func]),pointLng:X.oneOfType([X.number,X.string,X.func]),pointColor:X.oneOfType([X.string,X.func]),pointAltitude:X.oneOfType([X.number,X.string,X.func]),pointRadius:X.oneOfType([X.number,X.string,X.func]),pointResolution:X.number,pointsMerge:X.bool,pointsTransitionDuration:X.number,pointLabel:X.oneOfType([X.string,X.func]),onPointClick:X.func,onPointRightClick:X.func,onPointHover:X.func,arcsData:X.arrayOf(X.object),arcStartLat:X.oneOfType([X.number,X.string,X.func]),arcStartLng:X.oneOfType([X.number,X.string,X.func]),arcEndLat:X.oneOfType([X.number,X.string,X.func]),arcEndLng:X.oneOfType([X.number,X.string,X.func]),arcColor:X.oneOfType([X.string,X.arrayOf(X.string),X.func]),arcAltitude:X.oneOfType([X.number,X.string,X.func]),arcAltitudeAutoScale:X.oneOfType([X.number,X.string,X.func]),arcStroke:X.oneOfType([X.number,X.string,X.func]),arcCurveResolution:X.number,arcCircularResolution:X.number,arcDashLength:X.oneOfType([X.number,X.string,X.func]),arcDashGap:X.oneOfType([X.number,X.string,X.func]),arcDashInitialGap:X.oneOfType([X.number,X.string,X.func]),arcDashAnimateTime:X.oneOfType([X.number,X.string,X.func]),arcsTransitionDuration:X.number,arcLabel:X.oneOfType([X.string,X.func]),onArcClick:X.func,onArcRightClick:X.func,onArcHover:X.func,polygonsData:X.arrayOf(X.object),polygonGeoJsonGeometry:X.oneOfType([X.string,X.func]),polygonCapColor:X.oneOfType([X.string,X.func]),polygonCapMaterial:X.oneOfType([X.object,X.string,X.func]),polygonSideColor:X.oneOfType([X.string,X.func]),polygonSideMaterial:X.oneOfType([X.object,X.string,X.func]),polygonStrokeColor:X.oneOfType([X.string,X.func]),polygonAltitude:X.oneOfType([X.number,X.string,X.func]),polygonCapCurvatureResolution:X.oneOfType([X.number,X.string,X.func]),polygonsTransitionDuration:X.number,polygonLabel:X.oneOfType([X.string,X.func]),onPolygonClick:X.func,onPolygonRightClick:X.func,onPolygonHover:X.func,pathsData:X.array,pathPoints:X.oneOfType([X.array,X.string,X.func]),pathPointLat:X.oneOfType([X.number,X.string,X.func]),pathPointLng:X.oneOfType([X.number,X.string,X.func]),pathPointAlt:X.oneOfType([X.number,X.string,X.func]),pathResolution:X.number,pathColor:X.oneOfType([X.string,X.arrayOf(X.string),X.func]),pathStroke:X.oneOfType([X.number,X.string,X.func]),pathDashLength:X.oneOfType([X.number,X.string,X.func]),pathDashGap:X.oneOfType([X.number,X.string,X.func]),pathDashInitialGap:X.oneOfType([X.number,X.string,X.func]),pathDashAnimateTime:X.oneOfType([X.number,X.string,X.func]),pathTransitionDuration:X.number,pathLabel:X.oneOfType([X.string,X.func]),onPathClick:X.func,onPathRightClick:X.func,onPathHover:X.func,heatmapsData:X.array,heatmapPoints:X.oneOfType([X.array,X.string,X.func]),heatmapPointLat:X.oneOfType([X.number,X.string,X.func]),heatmapPointLng:X.oneOfType([X.number,X.string,X.func]),heatmapPointWeight:X.oneOfType([X.number,X.string,X.func]),heatmapBandwidth:X.oneOfType([X.number,X.string,X.func]),heatmapColorFn:X.oneOfType([X.string,X.func]),heatmapColorSaturation:X.oneOfType([X.number,X.string,X.func]),heatmapBaseAltitude:X.oneOfType([X.number,X.string,X.func]),heatmapTopAltitude:X.oneOfType([X.number,X.string,X.func]),heatmapsTransitionDuration:X.number,onHeatmapClick:X.func,onHeatmapRightClick:X.func,onHeatmapHover:X.func,hexBinPointsData:X.arrayOf(X.object),hexBinPointLat:X.oneOfType([X.number,X.string,X.func]),hexBinPointLng:X.oneOfType([X.number,X.string,X.func]),hexBinPointWeight:X.oneOfType([X.number,X.string,X.func]),hexBinResolution:X.number,hexMargin:X.oneOfType([X.number,X.func]),hexTopColor:X.func,hexSideColor:X.func,hexAltitude:X.oneOfType([X.number,X.func]),hexTopCurvatureResolution:X.number,hexBinMerge:X.bool,hexTransitionDuration:X.number,hexLabel:X.oneOfType([X.string,X.func]),onHexClick:X.func,onHexRightClick:X.func,onHexHover:X.func,hexPolygonsData:X.arrayOf(X.object),hexPolygonGeoJsonGeometry:X.oneOfType([X.string,X.func]),hexPolygonColor:X.oneOfType([X.string,X.func]),hexPolygonAltitude:X.oneOfType([X.number,X.string,X.func]),hexPolygonResolution:X.oneOfType([X.number,X.string,X.func]),hexPolygonMargin:X.oneOfType([X.number,X.string,X.func]),hexPolygonUseDots:X.oneOfType([X.bool,X.string,X.func]),hexPolygonCurvatureResolution:X.oneOfType([X.number,X.string,X.func]),hexPolygonDotResolution:X.oneOfType([X.number,X.string,X.func]),hexPolygonsTransitionDuration:X.number,hexPolygonLabel:X.oneOfType([X.string,X.func]),onHexPolygonClick:X.func,onHexPolygonRightClick:X.func,onHexPolygonHover:X.func,tilesData:X.arrayOf(X.object),tileLat:X.oneOfType([X.number,X.string,X.func]),tileLng:X.oneOfType([X.number,X.string,X.func]),tileAltitude:X.oneOfType([X.number,X.string,X.func]),tileWidth:X.oneOfType([X.number,X.string,X.func]),tileHeight:X.oneOfType([X.number,X.string,X.func]),tileUseGlobeProjection:X.oneOfType([X.bool,X.string,X.func]),tileMaterial:X.oneOfType([X.object,X.string,X.func]),tileCurvatureResolution:X.oneOfType([X.number,X.string,X.func]),tilesTransitionDuration:X.number,tileLabel:X.oneOfType([X.string,X.func]),onTileClick:X.func,onTileRightClick:X.func,onTileHover:X.func,particlesData:X.arrayOf(X.object),particlesList:X.oneOfType([X.string,X.func]),particleLat:X.oneOfType([X.number,X.string,X.func]),particleLng:X.oneOfType([X.number,X.string,X.func]),particleAltitude:X.oneOfType([X.number,X.string,X.func]),particlesSize:X.oneOfType([X.number,X.string,X.func]),particlesSizeAttenuation:X.oneOfType([X.bool,X.string,X.func]),particlesColor:X.oneOfType([X.string,X.func]),particlesTexture:X.oneOfType([X.string,X.func]),particleLabel:X.oneOfType([X.string,X.func]),onParticleClick:X.func,onParticleRightClick:X.func,onParticleHover:X.func,ringsData:X.arrayOf(X.object),ringLat:X.oneOfType([X.number,X.string,X.func]),ringLng:X.oneOfType([X.number,X.string,X.func]),ringAltitude:X.oneOfType([X.number,X.string,X.func]),ringColor:X.oneOfType([X.string,X.arrayOf(X.string),X.func]),ringResolution:X.number,ringMaxRadius:X.oneOfType([X.number,X.string,X.func]),ringPropagationSpeed:X.oneOfType([X.number,X.string,X.func]),ringRepeatPeriod:X.oneOfType([X.number,X.string,X.func]),labelsData:X.arrayOf(X.object),labelLat:X.oneOfType([X.number,X.string,X.func]),labelLng:X.oneOfType([X.number,X.string,X.func]),labelAltitude:X.oneOfType([X.number,X.string,X.func]),labelRotation:X.oneOfType([X.number,X.string,X.func]),labelText:X.oneOfType([X.string,X.func]),labelSize:X.oneOfType([X.number,X.string,X.func]),labelTypeFace:X.object,labelColor:X.oneOfType([X.string,X.func]),labelResolution:X.number,labelIncludeDot:X.oneOfType([X.bool,X.string,X.func]),labelDotRadius:X.oneOfType([X.number,X.string,X.func]),labelDotOrientation:X.oneOfType([X.string,X.func]),labelsTransitionDuration:X.number,labelLabel:X.oneOfType([X.string,X.func]),onLabelClick:X.func,onLabelRightClick:X.func,onLabelHover:X.func,htmlElementsData:X.arrayOf(X.object),htmlLat:X.oneOfType([X.number,X.string,X.func]),htmlLng:X.oneOfType([X.number,X.string,X.func]),htmlAltitude:X.oneOfType([X.number,X.string,X.func]),htmlElement:X.oneOfType([X.string,X.func]),htmlElementVisibilityModifier:X.func,htmlTransitionDuration:X.number,objectsData:X.arrayOf(X.object),objectLat:X.oneOfType([X.number,X.string,X.func]),objectLng:X.oneOfType([X.number,X.string,X.func]),objectAltitude:X.oneOfType([X.number,X.string,X.func]),objectRotation:X.oneOfType([X.shape({x:X.number,y:X.number,z:X.number}),X.string,X.func]),objectFacesSurface:X.oneOfType([X.bool,X.string,X.func]),objectThreeObject:X.oneOfType([X.object,X.string,X.func]),objectLabel:X.oneOfType([X.string,X.func]),onObjectClick:X.func,onObjectRightClick:X.func,onObjectHover:X.func,customLayerData:X.arrayOf(X.object),customThreeObject:X.oneOfType([X.object,X.string,X.func]),customThreeObjectUpdate:X.oneOfType([X.string,X.func]),customLayerLabel:X.oneOfType([X.string,X.func]),onCustomLayerClick:X.func,onCustomLayerRightClick:X.func,onCustomLayerHover:X.func,enablePointerInteraction:X.bool,pointerEventsFilter:X.func,lineHoverPrecision:X.number,onZoom:X.func},m6=ZX(dxe,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});m6.displayName="Globe";m6.propTypes=_xe;const yxe=[{name:"Adelaide",trackName:"Hungaroring",gpName:"Hungarian GP",lng:138.599503,lat:-34.92123,model:"models/albert_park.stl",image:""},{name:"Melbourne",trackName:"Hungaroring",gpName:"Hungarian GP",lng:144.97,lat:-37.8503,model:"models/sectors/melbourne.stl",image:"svg/australia.svg"},{name:"Shanghai",trackName:"Hungaroring",gpName:"Hungarian GP",lng:121.1311,lat:31.202,model:"models/shanghai-international-circuit-shanghai-china-5xs.stl",image:"svg/china.svg"},{name:"Suzuka",trackName:"Hungaroring",gpName:"Hungarian GP",lng:136.5417,lat:34.8425,model:"models/suzuka-circuit-suzuka-japan-5xsup.stl",image:"svg/japan.svg"},{name:"Bahrain",trackName:"Hungaroring",gpName:"Hungarian GP",lng:50.3038,lat:26.157,model:"models/bahrain-international-circuit-sakhir-bahrain-5xsu.stl",image:"svg/hungary.svg"},{name:"Jeddah",trackName:"Hungaroring",gpName:"Hungarian GP",lng:39.0616,lat:21.3755,model:"",image:"svg/saudi_arabia.svg"},{name:"Miami",trackName:"Hungaroring",gpName:"Hungarian GP",lng:-80.238889,lat:25.958056,model:"",image:"svg/miami.svg"},{name:"Imola",trackName:"Hungaroring",gpName:"Hungarian GP",lng:11.4248,lat:44.2028,model:"",image:"svg/imola.svg"},{name:"Monaco",trackName:"Hungaroring",gpName:"Hungarian GP",lng:7.4217,lat:43.7342,model:"",image:"svg/monaco.svg"},{name:"Barcelona",trackName:"Hungaroring",gpName:"Hungarian GP",lng:-2.2579,lat:41.5697,model:"models/circuit-de-barcelona-catalunya-montmelo-spain-5xs.stl",image:"svg/spain.svg"},{name:"Canada",trackName:"Hungaroring",gpName:"Hungarian GP",lng:-73.5226,lat:45.5014,model:"models/circuit-gilles-villeneuve-montreal-canada-5xsup.stl",image:"svg/canada.svg"},{name:"Red Bull Ring",trackName:"Hungaroring",gpName:"Hungarian GP",lng:14.7651,lat:47.2197,model:"models/red-bull-ring-spielberg-bei-knittelfeld-austria-5.stl",image:"svg/austria.svg"},{name:"Silverstone",trackName:"Hungaroring",gpName:"Hungarian GP",lng:-1.02303,lat:52.0681,model:"models/silverstone-circuit-silverstone-united-kingdom-5x.stl",image:"svg/silverstone.svg"},{name:"Spa",trackName:"Hungaroring",gpName:"Hungarian GP",lng:5.971003,lat:50.4457,model:"models/hungaroring-mogyorod-hungary-5xsup.stl",image:"svg/hungary.svg"},{name:"Zandvoort",trackName:"Circuit Zandvoort",gpName:"Dutch GP",lng:4.534503,lat:52.3842,model:"models/circuit-zandvoort-zandvoort-netherlands-5xsup.stl",image:"svg/netherlands.svg"},{name:"Monza",trackName:"Autodromo Nazionale Monza",gpName:"Italian GP",lng:9.281503,lat:45.6174,model:"models/autodromo-nazionale-monza-monza-italy-5xsup.stl",image:"svg/monza.svg"},{name:"Baku",trackName:"Baku City Circuit",gpName:"Azerbaijan GP",lng:49.85323,lat:40.3729,model:"models/baku-city-circuit-baku-azerbaijan-5xsup.stl",image:"svg/azerbaijan.svg"},{name:"Singapore",trackName:"Marina Bay Street Circuit",gpName:"Singaporian GP",lng:103.86663,lat:1.2878,model:"",image:"svg/singapore.svg"},{name:"Americas",trackName:"Circuit of the Americas",gpName:"US GP",lng:-97.6405,lat:30.1327,model:"",image:"svg/usa.svg"},{name:"Mexico",trackName:"Autdromo Hermanos Rodrguez",gpName:"Mexican GP",lng:-99.0926,lat:19.4055,model:"",image:"svg/mexico.svg"},{name:"Brazil",trackName:"Autdromo Jos Carlos Pace",gpName:"Brazilian GP",lng:-46.7008,lat:-23.7038,model:"models/autodromo-jose-carlos-pace-so-paulo-brazil-5xsup.stl",image:"svg/brazil.svg"},{name:"Las Vegas",trackName:"Las Vegas Street Circuit",gpName:"Las Vegas GP",lng:-115.0944,lat:36.0636,model:"",image:"svg/las_vegas.svg"},{name:"Qatar",trackName:"Losail Circuit",gpName:"Qatar GP",lng:51.45053,lat:25.4885,model:"",image:"svg/qatar.svg"},{name:"Abu Dhabi",trackName:"Yas Marina Circuit",gpName:"Abu Dhabi GP",lng:54.60573,lat:24.4697,model:"models/yas-marina-circuit-abu-dhabi-united-arab-emirates.stl",image:"svg/qatar.svg"}],VS={tracks:yxe},vxe="_OpacityShow_xgvej_1",xxe="_OpacityHide_xgvej_5",NB={OpacityShow:vxe,OpacityHide:xxe};class bxe extends Yy{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new aQ(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){function t(u){const h=new DataView(u),d=32/8*3+32/8*3*3+16/8,_=h.getUint32(80,!0);if(80+32/8+_*d===h.byteLength)return!0;const b=[115,111,108,105,100];for(let R=0;R<5;R++)if(n(b,h,R))return!1;return!0}function n(u,h,d){for(let _=0,x=u.length;_<x;_++)if(u[_]!==h.getUint8(d+_))return!1;return!0}function r(u){const h=new DataView(u),d=h.getUint32(80,!0);let _,x,b,R=!1,E,w,L,D,O;for(let H=0;H<70;H++)h.getUint32(H,!1)==1129270351&&h.getUint8(H+4)==82&&h.getUint8(H+5)==61&&(R=!0,E=new Float32Array(d*3*3),w=h.getUint8(H+6)/255,L=h.getUint8(H+7)/255,D=h.getUint8(H+8)/255,O=h.getUint8(H+9)/255);const B=84,G=50,k=new Vi,z=new Float32Array(d*3*3),F=new Float32Array(d*3*3),q=new Jt;for(let H=0;H<d;H++){const Q=B+H*G,K=h.getFloat32(Q,!0),se=h.getFloat32(Q+4,!0),ee=h.getFloat32(Q+8,!0);if(R){const $=h.getUint16(Q+48,!0);($&32768)===0?(_=($&31)/31,x=($>>5&31)/31,b=($>>10&31)/31):(_=w,x=L,b=D)}for(let $=1;$<=3;$++){const re=Q+$*12,ae=H*3*3+($-1)*3;z[ae]=h.getFloat32(re,!0),z[ae+1]=h.getFloat32(re+4,!0),z[ae+2]=h.getFloat32(re+8,!0),F[ae]=K,F[ae+1]=se,F[ae+2]=ee,R&&(q.setRGB(_,x,b,qs),E[ae]=q.r,E[ae+1]=q.g,E[ae+2]=q.b)}}return k.setAttribute("position",new _r(z,3)),k.setAttribute("normal",new _r(F,3)),R&&(k.setAttribute("color",new _r(E,3)),k.hasColors=!0,k.alpha=O),k}function s(u){const h=new Vi,d=/solid([\s\S]*?)endsolid/g,_=/facet([\s\S]*?)endfacet/g,x=/solid\s(.+)/;let b=0;const R=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,E=new RegExp("vertex"+R+R+R,"g"),w=new RegExp("normal"+R+R+R,"g"),L=[],D=[],O=[],B=new ce;let G,k=0,z=0,F=0;for(;(G=d.exec(u))!==null;){z=F;const q=G[0],H=(G=x.exec(q))!==null?G[1]:"";for(O.push(H);(G=_.exec(q))!==null;){let se=0,ee=0;const $=G[0];for(;(G=w.exec($))!==null;)B.x=parseFloat(G[1]),B.y=parseFloat(G[2]),B.z=parseFloat(G[3]),ee++;for(;(G=E.exec($))!==null;)L.push(parseFloat(G[1]),parseFloat(G[2]),parseFloat(G[3])),D.push(B.x,B.y,B.z),se++,F++;ee!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+b),se!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+b),b++}const Q=z,K=F-z;h.userData.groupNames=O,h.addGroup(Q,K,k),k++}return h.setAttribute("position",new Si(L,3)),h.setAttribute("normal",new Si(D,3)),h}function o(u){return typeof u!="string"?new TextDecoder().decode(u):u}function a(u){if(typeof u=="string"){const h=new Uint8Array(u.length);for(let d=0;d<u.length;d++)h[d]=u.charCodeAt(d)&255;return h.buffer||h}else return u}const l=a(e);return t(l)?r(l):s(o(e))}}var iR={exports:{}},DB;function Sxe(){return DB||(DB=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,d,_){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new r(h,d||l,_),b=t?t+u:u;return l._events[b]?l._events[b].fn?l._events[b]=[l._events[b],x]:l._events[b].push(x):(l._events[b]=x,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},a.prototype.listeners=function(u){var h=t?t+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var _=0,x=d.length,b=new Array(x);_<x;_++)b[_]=d[_].fn;return b},a.prototype.listenerCount=function(u){var h=t?t+u:u,d=this._events[h];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,h,d,_,x,b){var R=t?t+u:u;if(!this._events[R])return!1;var E=this._events[R],w=arguments.length,L,D;if(E.fn){switch(E.once&&this.removeListener(u,E.fn,void 0,!0),w){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,d),!0;case 4:return E.fn.call(E.context,h,d,_),!0;case 5:return E.fn.call(E.context,h,d,_,x),!0;case 6:return E.fn.call(E.context,h,d,_,x,b),!0}for(D=1,L=new Array(w-1);D<w;D++)L[D-1]=arguments[D];E.fn.apply(E.context,L)}else{var O=E.length,B;for(D=0;D<O;D++)switch(E[D].once&&this.removeListener(u,E[D].fn,void 0,!0),w){case 1:E[D].fn.call(E[D].context);break;case 2:E[D].fn.call(E[D].context,h);break;case 3:E[D].fn.call(E[D].context,h,d);break;case 4:E[D].fn.call(E[D].context,h,d,_);break;default:if(!L)for(B=1,L=new Array(w-1);B<w;B++)L[B-1]=arguments[B];E[D].fn.apply(E[D].context,L)}}return!0},a.prototype.on=function(u,h,d){return s(this,u,h,d,!1)},a.prototype.once=function(u,h,d){return s(this,u,h,d,!0)},a.prototype.removeListener=function(u,h,d,_){var x=t?t+u:u;if(!this._events[x])return this;if(!h)return o(this,x),this;var b=this._events[x];if(b.fn)b.fn===h&&(!_||b.once)&&(!d||b.context===d)&&o(this,x);else{for(var R=0,E=[],w=b.length;R<w;R++)(b[R].fn!==h||_&&!b[R].once||d&&b[R].context!==d)&&E.push(b[R]);E.length?this._events[x]=E.length===1?E[0]:E:o(this,x)}return this},a.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a}(iR)),iR.exports}var Txe=Sxe();const Exe=nT(Txe),d4=new Exe;function Km(i,e){const t=()=>{d4.off(i,e)};return On.useEffect(()=>(d4.on(i,e),t),[]),t}const i3=()=>(i,e)=>{d4.emit(i,e)},rR=2e3,ib=.01;function wxe({}){const[i,e]=On.useState(1),t=On.useRef(0),[n,r]=On.useState(""),[s,o]=On.useState(!0),[a,l]=On.useState(void 0),u=i3(),h=VS.tracks.map((D,O)=>({name:D.name,text:D.name,lat:D.lat,lng:D.lng,size:i,color:"red",model:D.model,index:O})),d=On.useRef(void 0),_=(D,O,B)=>{d.current?.pointOfView({lng:D,lat:O,altitude:B},rR)},x=()=>{_(138.599503,-34.92123,1),d.current?.lights().push(new m8)},b=D=>{o(D.altitude>=ib),D.altitude<=ib&&u("MapMoveTo",{coord:[D.lat,D.lng]})},R=D=>{if(D=D||"models/albert_park.stl",n==D)return;r(D),console.log(`loading ${D}`),new bxe().load(D||"models/albert_park.stl",function(B){const G=new Ri(B),k=125e-6;G.scale.set(k,k,k);const z=new $a;z.color=new Jt(2105376),G.material=z,l(G)},function(B){console.log(B.loaded/B.total*100+"% loaded")},function(B){console.error("An error happened",B)})},E=()=>{R("models/albert_park.stl")},w=(D,O,B)=>{L({trackIndex:D.index})},L=D=>{t.current=D.trackIndex;const O=VS.tracks.at(D.trackIndex);R(O.model);const B=[O.lng,O.lat];_(B[0],B[1],1),setTimeout(()=>{u("MapMoveTo",{coord:[O.lat,O.lng]})},rR),setTimeout(()=>{_(O.lng,O.lat,ib-.001)},rR)};return On.useEffect(E,[]),Km("onTrackSelect",D=>{L(D)}),Km("toggle3DGlobe",D=>{o(D.visible),_(D.lng,D.lat,ib+.01)}),rs.jsx("div",{className:s?NB.OpacityShow:NB.OpacityHide,children:rs.jsx(m6,{ref:d,onGlobeReady:x,onZoom:b,globeImageUrl:"//cdn.jsdelivr.net/npm/three-globe/example/img/earth-water.png",globeTileEngineUrl:(D,O,B)=>`https://mt0.google.com/vt/lyrs=p&hl=en&x=${D}&y=${O}&z=${B}`,labelsData:h,onLabelClick:w,labelColor:()=>"red",labelDotRadius:D=>D.size,labelsTransitionDuration:0,labelIncludeDot:!1,objectsData:[h.at(t.current)],objectAltitude:1e-5,objectThreeObject:a})})}const Mxe="_Container_1jddr_10",Rxe="_Sidebar_1jddr_20",Cxe="_SidebarLabel_1jddr_31",sR={Container:Mxe,Sidebar:Rxe,SidebarLabel:Cxe},Nxe=({children:i})=>{const[e,t]=On.useState(!0),n=i3();return rs.jsxs("div",{className:sR.Container,children:[e&&rs.jsx("div",{className:sR.Sidebar,children:VS.tracks.map((r,s)=>rs.jsx("h3",{className:sR.SidebarLabel,onClick:()=>{console.log(`selected: ${r.name}`),n("onTrackSelect",{trackIndex:s})},children:r.name},r.name))}),i]})},Dxe="_MapContainer_1g7l1_1",Pxe={MapContainer:Dxe},sa={ADD:"add",REMOVE:"remove"},Zm={PROPERTYCHANGE:"propertychange"},ai={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class r3{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Lxe(i,e,t){let n,r;t=t||Sh;let s=0,o=i.length,a=!1;for(;s<o;)n=s+(o-s>>1),r=+t(i[n],e),r<0?s=n+1:(o=n,a=!r);return a?s:~s}function Sh(i,e){return i>e?1:i<e?-1:0}function Oxe(i,e){return i<e?1:i>e?-1:0}function g6(i,e,t){if(i[0]<=e)return 0;const n=i.length;if(e<=i[n-1])return n-1;if(typeof t=="function"){for(let r=1;r<n;++r){const s=i[r];if(s===e)return r;if(s<e)return t(e,i[r-1],s)>0?r-1:r}return n-1}if(t>0){for(let r=1;r<n;++r)if(i[r]<e)return r-1;return n-1}if(t<0){for(let r=1;r<n;++r)if(i[r]<=e)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==e)return r;if(i[r]<e)return i[r-1]-e<e-i[r]?r-1:r}return n-1}function Ixe(i,e,t){for(;e<t;){const n=i[e];i[e]=i[t],i[t]=n,++e,--t}}function _6(i,e){const t=Array.isArray(e)?e:[e],n=t.length;for(let r=0;r<n;r++)i[i.length]=t[r]}function _d(i,e){const t=i.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(i[n]!==e[n])return!1;return!0}function Bxe(i,e,t){const n=e||Sh;return i.every(function(r,s){if(s===0)return!0;const o=n(i[s-1],r);return!(o>0||o===0)})}function Ny(){return!0}function s3(){return!1}function Dy(){}function JH(i){let e,t,n;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==n||!_d(r,t))&&(n=this,t=r,e=i.apply(this,arguments)),e}}function Uxe(i){function e(){let t;try{t=i()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function f2(i){for(const e in i)delete i[e]}function Jm(i){let e;for(e in i)return!1;return!e}class Vh{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class o3 extends r3{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const n=this.listeners_||(this.listeners_={}),r=n[e]||(n[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",n=t?e:e.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=t?new Vh(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let l;for(let u=0,h=r.length;u<h;++u)if("handleEvent"in r[u]?l=r[u].handleEvent(s):l=r[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[n]===0){let u=a[n];for(delete a[n];u--;)this.removeEventListener(n,Dy);delete o[n]}return l}disposeInternal(){this.listeners_&&f2(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const n=this.listeners_[e];if(!n)return;const r=n.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(n[r]=Dy,++this.pendingRemovals_[e]):(n.splice(r,1),n.length===0&&delete this.listeners_[e]))}}function Bi(i,e,t,n,r){if(r){const o=t;t=function(a){return i.removeEventListener(e,t),o.call(n??this,a)}}else n&&n!==i&&(t=t.bind(n));const s={target:i,type:e,listener:t};return i.addEventListener(e,t),s}function qS(i,e,t,n){return Bi(i,e,t,n,!0)}function Ir(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),f2(i))}class d2 extends o3{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ai.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const n=e.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=Bi(this,e[s],t);return r}return Bi(this,e,t)}onceInternal(e,t){let n;if(Array.isArray(e)){const r=e.length;n=new Array(r);for(let s=0;s<r;++s)n[s]=qS(this,e[s],t)}else n=qS(this,e,t);return t.ol_key=n,n}unInternal(e,t){const n=t.ol_key;if(n)Fxe(n);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}d2.prototype.on;d2.prototype.once;d2.prototype.un;function Fxe(i){if(Array.isArray(i))for(let e=0,t=i.length;e<t;++e)Ir(i[e]);else Ir(i)}function Ii(){throw new Error("Unimplemented abstract method.")}let kxe=0;function Ui(i){return i.ol_uid||(i.ol_uid=String(++kxe))}class PB extends Vh{constructor(e,t,n){super(e),this.key=t,this.oldValue=n}}class bc extends d2{constructor(e){super(),this.on,this.once,this.un,Ui(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let n;n=`change:${e}`,this.hasListener(n)&&this.dispatchEvent(new PB(n,e,t)),n=Zm.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new PB(n,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,n){const r=this.values_||(this.values_={});if(n)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const n in e)this.set(n,e[n],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const n=this.values_[e];delete this.values_[e],Jm(this.values_)&&(this.values_=null),t||this.notify(e,n)}}}const LB={LENGTH:"length"};class rb extends Vh{constructor(e,t,n){super(e),this.element=t,this.index=n}}class Ku extends bc{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,n=e.length;t<n;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let n=0,r=t.length;n<r;++n)e(t[n],n,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(LB.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new rb(sa.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let n=0,r=t.length;n<r;++n)if(t[n]===e)return this.removeAt(n)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new rb(sa.REMOVE,t,e)),t}setAt(e,t){const n=this.getLength();if(e>=n){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new rb(sa.REMOVE,r,e)),this.dispatchEvent(new rb(sa.ADD,t,e))}updateLength_(){this.set(LB.LENGTH,this.array_.length)}assertUnique_(e,t){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===e&&n!==t)throw new Error("Duplicate item added to a unique collection")}}class Lp extends Vh{constructor(e,t,n){super(e),this.map=t,this.frameState=n!==void 0?n:null}}class kf extends Lp{constructor(e,t,n,r,s,o){super(e,t,s),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const $r={SINGLECLICK:"singleclick",CLICK:ai.CLICK,DBLCLICK:ai.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},$A=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Gxe=$A.includes("safari")&&!$A.includes("chrom");Gxe&&($A.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test($A));const zxe=$A.includes("webkit")&&!$A.includes("edge"),eW=$A.includes("macintosh"),Vxe=typeof devicePixelRatio<"u"?devicePixelRatio:1,y6=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,tW=typeof Image<"u"&&Image.prototype.decode,nW=function(){let i=!1;try{const e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return i}(),A4={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class qxe extends o3{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Bi(n,A4.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Bi(n,A4.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ai.TOUCHMOVE,this.boundHandleTouchMove_,nW?{passive:!1}:!1)}emulateClick_(e){let t=new kf($r.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new kf($r.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new kf($r.SINGLECLICK,this.map_,e);this.dispatchEvent(n)},250)}updateActivePointers_(e){const t=e,n=t.pointerId;if(t.type==$r.POINTERUP||t.type==$r.POINTERCANCEL){delete this.trackedTouches_[n];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==$r.POINTERDOWN||t.type==$r.POINTERMOVE)&&(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new kf($r.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ir),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new kf($r.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Bi(n,$r.POINTERMOVE,this.handlePointerMove_,this),Bi(n,$r.POINTERUP,this.handlePointerUp_,this),Bi(this.element_,$r.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(Bi(this.element_.getRootNode(),$r.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new kf($r.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new kf($r.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ir(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ai.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ir(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ir),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Gf={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},vo={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},En={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Ki(i,e){if(!i)throw new Error(e)}const HS=1/0;class Hxe{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,f2(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(e){Ki(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=HS?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,n=this.priorities_,r=t.length,s=t[e],o=n[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<r&&n[u]<n[l]?u:l;t[e]=t[h],n[e]=n[h],e=h}t[e]=s,n[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const n=this.elements_,r=this.priorities_,s=n[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)n[t]=n[a],r[t]=r[a],t=a;else break}n[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,n=this.priorities_;let r=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==HS?delete this.queuedElements_[this.keyFunction_(o)]:(n[r]=l,t[r++]=o);t.length=r,n.length=r,this.heapify_()}}class Wxe extends Hxe{constructor(e,t){super(n=>e.apply(null,n),n=>n[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ai.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,n=t.getState();if(n===En.LOADED||n===En.ERROR||n===En.EMPTY){n!==En.ERROR&&t.removeEventListener(ai.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let n=0;for(;this.tilesLoading_<e&&n<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===En.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++n,r.load())}}}function jxe(i,e,t,n,r){if(!i||!(t in i.wantedTiles)||!i.wantedTiles[t][e.getKey()])return HS;const s=i.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const xo={ANIMATING:0,INTERACTING:1},ru={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function qr(i,e,t){return Math.min(Math.max(i,e),t)}function Xxe(i,e,t,n,r,s){const o=r-t,a=s-n;if(o!==0||a!==0){const l=((i-t)*o+(e-n)*a)/(o*o+a*a);l>1?(t=r,n=s):l>0&&(t+=o*l,n+=a*l)}return am(i,e,t,n)}function am(i,e,t,n){const r=t-i,s=n-e;return r*r+s*s}function $xe(i){const e=i.length;for(let n=0;n<e;n++){let r=n,s=Math.abs(i[n][n]);for(let a=n+1;a<e;a++){const l=Math.abs(i[a][n]);l>s&&(s=l,r=a)}if(s===0)return null;const o=i[r];i[r]=i[n],i[n]=o;for(let a=n+1;a<e;a++){const l=-i[a][n]/i[n][n];for(let u=n;u<e+1;u++)n==u?i[a][u]=0:i[a][u]+=l*i[n][u]}}const t=new Array(e);for(let n=e-1;n>=0;n--){t[n]=i[n][e]/i[n][n];for(let r=n-1;r>=0;r--)i[r][e]-=i[r][n]*t[n]}return t}function OB(i){return i*180/Math.PI}function id(i){return i*Math.PI/180}function IA(i,e){const t=i%e;return t*e<0?t+e:t}function Sl(i,e,t){return i+t*(e-i)}function a3(i,e){const t=Math.pow(10,e);return Math.round(i*t)/t}function sb(i,e){return Math.floor(a3(i,e))}function ob(i,e){return Math.ceil(a3(i,e))}function p4(i,e,t){if(i>=e&&i<t)return i;const n=t-e;return((i-e)%n+n)%n+e}function IB(i,e,t){return function(n,r,s,o,a){if(!n)return;if(!r&&!e)return n;const l=e?0:s[0]*r,u=e?0:s[1]*r,h=a?a[0]:0,d=a?a[1]:0;let _=i[0]+l/2+h,x=i[2]-l/2+h,b=i[1]+u/2+d,R=i[3]-u/2+d;_>x&&(_=(x+_)/2,x=_),b>R&&(b=(R+b)/2,R=b);let E=qr(n[0],_,x),w=qr(n[1],b,R);if(o&&t&&r){const L=30*r;E+=-L*Math.log(1+Math.max(0,_-n[0])/L)+L*Math.log(1+Math.max(0,n[0]-x)/L),w+=-L*Math.log(1+Math.max(0,b-n[1])/L)+L*Math.log(1+Math.max(0,n[1]-R)/L)}return[E,w]}}function Yxe(i){return i}const Gs={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function BB(i){const e=Ul();for(let t=0,n=i.length;t<n;++t)U_(e,i[t]);return e}function v6(i,e,t){return t?(t[0]=i[0]-e,t[1]=i[1]-e,t[2]=i[2]+e,t[3]=i[3]+e,t):[i[0]-e,i[1]-e,i[2]+e,i[3]+e]}function iW(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i.slice()}function rW(i,e,t){let n,r;return e<i[0]?n=i[0]-e:i[2]<e?n=e-i[2]:n=0,t<i[1]?r=i[1]-t:i[3]<t?r=t-i[3]:r=0,n*n+r*r}function eg(i,e){return sW(i,e[0],e[1])}function p_(i,e){return i[0]<=e[0]&&e[2]<=i[2]&&i[1]<=e[1]&&e[3]<=i[3]}function sW(i,e,t){return i[0]<=e&&e<=i[2]&&i[1]<=t&&t<=i[3]}function m4(i,e){const t=i[0],n=i[1],r=i[2],s=i[3],o=e[0],a=e[1];let l=Gs.UNKNOWN;return o<t?l=l|Gs.LEFT:o>r&&(l=l|Gs.RIGHT),a<n?l=l|Gs.BELOW:a>s&&(l=l|Gs.ABOVE),l===Gs.UNKNOWN&&(l=Gs.INTERSECTING),l}function Ul(){return[1/0,1/0,-1/0,-1/0]}function Bh(i,e,t,n,r){return r?(r[0]=i,r[1]=e,r[2]=t,r[3]=n,r):[i,e,t,n]}function l3(i){return Bh(1/0,1/0,-1/0,-1/0,i)}function oW(i,e){const t=i[0],n=i[1];return Bh(t,n,t,n,e)}function x6(i,e,t,n,r){const s=l3(r);return aW(s,i,e,t,n)}function Py(i,e){return i[0]==e[0]&&i[2]==e[2]&&i[1]==e[1]&&i[3]==e[3]}function Qxe(i,e){return e[0]<i[0]&&(i[0]=e[0]),e[2]>i[2]&&(i[2]=e[2]),e[1]<i[1]&&(i[1]=e[1]),e[3]>i[3]&&(i[3]=e[3]),i}function U_(i,e){e[0]<i[0]&&(i[0]=e[0]),e[0]>i[2]&&(i[2]=e[0]),e[1]<i[1]&&(i[1]=e[1]),e[1]>i[3]&&(i[3]=e[1])}function aW(i,e,t,n,r){for(;t<n;t+=r)Kxe(i,e[t],e[t+1]);return i}function Kxe(i,e,t){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}function b6(i,e){let t;return t=e(u3(i)),t||(t=e(c3(i)),t)||(t=e(h3(i)),t)||(t=e(r0(i)),t)?t:!1}function g4(i){let e=0;return f3(i)||(e=ir(i)*Ho(i)),e}function u3(i){return[i[0],i[1]]}function c3(i){return[i[2],i[1]]}function YA(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function Zxe(i,e){let t;if(e==="bottom-left")t=u3(i);else if(e==="bottom-right")t=c3(i);else if(e==="top-left")t=r0(i);else if(e==="top-right")t=h3(i);else throw new Error("Invalid corner");return t}function _4(i,e,t,n,r){const[s,o,a,l,u,h,d,_]=lW(i,e,t,n);return Bh(Math.min(s,a,u,d),Math.min(o,l,h,_),Math.max(s,a,u,d),Math.max(o,l,h,_),r)}function lW(i,e,t,n){const r=e*n[0]/2,s=e*n[1]/2,o=Math.cos(t),a=Math.sin(t),l=r*o,u=r*a,h=s*o,d=s*a,_=i[0],x=i[1];return[_-l+d,x-u-h,_-l-d,x-u+h,_+l-d,x+u+h,_+l+d,x+u-h,_-l+d,x-u-h]}function Ho(i){return i[3]-i[1]}function BA(i,e,t){const n=t||Ul();return Vo(i,e)?(i[0]>e[0]?n[0]=i[0]:n[0]=e[0],i[1]>e[1]?n[1]=i[1]:n[1]=e[1],i[2]<e[2]?n[2]=i[2]:n[2]=e[2],i[3]<e[3]?n[3]=i[3]:n[3]=e[3]):l3(n),n}function r0(i){return[i[0],i[3]]}function h3(i){return[i[2],i[3]]}function ir(i){return i[2]-i[0]}function Vo(i,e){return i[0]<=e[2]&&i[2]>=e[0]&&i[1]<=e[3]&&i[3]>=e[1]}function f3(i){return i[2]<i[0]||i[3]<i[1]}function Jxe(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i}function ebe(i,e,t){let n=!1;const r=m4(i,e),s=m4(i,t);if(r===Gs.INTERSECTING||s===Gs.INTERSECTING)n=!0;else{const o=i[0],a=i[1],l=i[2],u=i[3],h=e[0],d=e[1],_=t[0],x=t[1],b=(x-d)/(_-h);let R,E;s&Gs.ABOVE&&!(r&Gs.ABOVE)&&(R=_-(x-u)/b,n=R>=o&&R<=l),!n&&s&Gs.RIGHT&&!(r&Gs.RIGHT)&&(E=x-(_-l)*b,n=E>=a&&E<=u),!n&&s&Gs.BELOW&&!(r&Gs.BELOW)&&(R=_-(x-a)/b,n=R>=o&&R<=l),!n&&s&Gs.LEFT&&!(r&Gs.LEFT)&&(E=x-(_-o)*b,n=E>=a&&E<=u)}return n}function uW(i,e){const t=e.getExtent(),n=YA(i);if(e.canWrapX()&&(n[0]<t[0]||n[0]>=t[2])){const r=ir(t),o=Math.floor((n[0]-t[0])/r)*r;i[0]-=o,i[2]-=o}return i}function cW(i,e,t){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];uW(i,e);const r=ir(n);if(ir(i)>r&&!t)return[[n[0],i[1],n[2],i[3]]];if(i[0]<n[0])return[[i[0]+r,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-r,i[3]]]}return[i]}function tbe(i,e){return i[0]+=+e[0],i[1]+=+e[1],i}function WS(i,e){let t=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=e[n]){t=!1;break}return t}function S6(i,e){const t=Math.cos(e),n=Math.sin(e),r=i[0]*t-i[1]*n,s=i[1]*t+i[0]*n;return i[0]=r,i[1]=s,i}function nbe(i,e){return i[0]*=e,i[1]*=e,i}function hW(i,e){if(e.canWrapX()){const t=ir(e.getExtent()),n=ibe(i,e,t);n&&(i[0]-=n*t)}return i}function ibe(i,e,t){const n=e.getExtent();let r=0;return e.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(t=t||ir(n),r=Math.floor((i[0]-n[0])/t)),r}function fW(i){return Math.pow(i,3)}function _g(i){return 1-fW(1-i)}function rbe(i){return 3*i*i-2*i*i*i}function sbe(i){return i}const obe=63710088e-1;function UB(i,e,t){t=t||obe;const n=id(i[1]),r=id(e[1]),s=(r-n)/2,o=id(e[0]-i[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function dW(...i){console.warn(...i)}const T6={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class E6{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||T6[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const A2=6378137,$p=Math.PI*A2,abe=[-$p,-$p,$p,$p],lbe=[-180,-85,180,85],ab=A2*Math.log(Math.tan(Math.PI/2));class Tp extends E6{constructor(e){super({code:e,units:"m",extent:abe,global:!0,worldExtent:lbe,getPointResolution:function(t,n){return t/Math.cosh(n[1]/A2)}})}}const FB=[new Tp("EPSG:3857"),new Tp("EPSG:102100"),new Tp("EPSG:102113"),new Tp("EPSG:900913"),new Tp("http://www.opengis.net/def/crs/EPSG/0/3857"),new Tp("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ube(i,e,t,n){const r=i.length;t=t>1?t:2,n=n??t,e===void 0&&(t>2?e=i.slice():e=new Array(r));for(let s=0;s<r;s+=n){e[s]=$p*i[s]/180;let o=A2*Math.log(Math.tan(Math.PI*(+i[s+1]+90)/360));o>ab?o=ab:o<-ab&&(o=-ab),e[s+1]=o}return e}function cbe(i,e,t,n){const r=i.length;t=t>1?t:2,n=n??t,e===void 0&&(t>2?e=i.slice():e=new Array(r));for(let s=0;s<r;s+=n)e[s]=180*i[s]/$p,e[s+1]=360*Math.atan(Math.exp(i[s+1]/A2))/Math.PI-90;return e}const hbe=6378137,kB=[-180,-90,180,90],fbe=Math.PI*hbe/180;class eA extends E6{constructor(e,t){super({code:e,units:"degrees",extent:kB,axisOrientation:t,global:!0,metersPerUnit:fbe,worldExtent:kB})}}const GB=[new eA("CRS:84"),new eA("EPSG:4326","neu"),new eA("urn:ogc:def:crs:OGC:1.3:CRS84"),new eA("urn:ogc:def:crs:OGC:2:84"),new eA("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new eA("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new eA("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let y4={};function dbe(i){return y4[i]||y4[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Abe(i,e){y4[i]=e}let lm={};function Ly(i,e,t){const n=i.getCode(),r=e.getCode();n in lm||(lm[n]={}),lm[n][r]=t}function oR(i,e){return i in lm&&e in lm[i]?lm[i][e]:null}const jS=.9996,Dl=.00669438,d3=Dl*Dl,A3=d3*Dl,xA=Dl/(1-Dl),zB=Math.sqrt(1-Dl),tg=(1-zB)/(1+zB),AW=tg*tg,w6=AW*tg,M6=w6*tg,pW=M6*tg,mW=1-Dl/4-3*d3/64-5*A3/256,pbe=3*Dl/8+3*d3/32+45*A3/1024,mbe=15*d3/256+45*A3/1024,gbe=35*A3/3072,_be=3/2*tg-27/32*w6+269/512*pW,ybe=21/16*AW-55/32*M6,vbe=151/96*w6-417/128*pW,xbe=1097/512*M6,XS=6378137;function bbe(i,e,t){const n=i-5e5,o=(t.north?e:e-1e7)/jS/(XS*mW),a=o+_be*Math.sin(2*o)+ybe*Math.sin(4*o)+vbe*Math.sin(6*o)+xbe*Math.sin(8*o),l=Math.sin(a),u=l*l,h=Math.cos(a),d=l/h,_=d*d,x=_*_,b=1-Dl*u,R=Math.sqrt(1-Dl*u),E=XS/R,w=(1-Dl)/b,L=xA*h**2,D=L*L,O=n/(E*jS),B=O*O,G=B*O,k=G*O,z=k*O,F=z*O,q=a-d/w*(B/2-k/24*(5+3*_+10*L-4*D-9*xA))+F/720*(61+90*_+298*L+45*x-252*xA-3*D);let H=(O-G/6*(1+2*_+L)+z/120*(5-2*L+28*_-3*D+8*xA+24*x))/h;return H=p4(H+id(gW(t.number)),-Math.PI,Math.PI),[OB(H),OB(q)]}const VB=-80,qB=84,Sbe=-180,Tbe=180;function Ebe(i,e,t){i=p4(i,Sbe,Tbe),e<VB?e=VB:e>qB&&(e=qB);const n=id(e),r=Math.sin(n),s=Math.cos(n),o=r/s,a=o*o,l=a*a,u=id(i),h=gW(t.number),d=id(h),_=XS/Math.sqrt(1-Dl*r**2),x=xA*s**2,b=s*p4(u-d,-Math.PI,Math.PI),R=b*b,E=R*b,w=E*b,L=w*b,D=L*b,O=XS*(mW*n-pbe*Math.sin(2*n)+mbe*Math.sin(4*n)-gbe*Math.sin(6*n)),B=jS*_*(b+E/6*(1-a+x)+L/120*(5-18*a+l+72*x-58*xA))+5e5;let G=jS*(O+_*o*(R/2+w/24*(5-a+9*x+4*x**2)+D/720*(61-58*a+l+600*x-330*xA)));return t.north||(G+=1e7),[B,G]}function gW(i){return(i-1)*6-180+3}const wbe=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function _W(i){let e=0;for(const r of wbe){const s=i.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,n=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(n=!0,t=e-32600),t?{number:t,north:n}:null}function HB(i,e){return function(t,n,r,s){const o=t.length;r=r>1?r:2,s=s??r,n||(r>2?n=t.slice():n=new Array(o));for(let a=0;a<o;a+=s){const l=t[a],u=t[a+1],h=i(l,u,e);n[a]=h[0],n[a+1]=h[1]}return n}}function Mbe(i){return _W(i)?new E6({code:i,units:"m"}):null}function Rbe(i){const e=_W(i.getCode());return e?{forward:HB(Ebe,e),inverse:HB(bbe,e)}:null}const Cbe=[Rbe],Nbe=[Mbe];let v4=!0;function yW(i){v4=!1}function R6(i,e){if(e!==void 0){for(let t=0,n=i.length;t<n;++t)e[t]=i[t];e=e}else e=i.slice();return e}function x4(i){Abe(i.getCode(),i),Ly(i,i,R6)}function Dbe(i){i.forEach(x4)}function Ta(i){if(typeof i!="string")return i;const e=dbe(i);if(e)return e;for(const t of Nbe){const n=t(i);if(n)return n}return null}function WB(i,e,t,n){i=Ta(i);let r;const s=i.getPointResolutionFunc();if(s)r=s(e,t);else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")r=e;else{const a=D6(i,Ta("EPSG:4326"));if(!a&&o!=="degrees")r=e*i.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=a(u,u,2);const h=UB(u.slice(0,2),u.slice(2,4)),d=UB(u.slice(4,6),u.slice(6,8));r=(h+d)/2}const l=i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function jB(i){Dbe(i),i.forEach(function(e){i.forEach(function(t){e!==t&&Ly(e,t,R6)})})}function Pbe(i,e,t,n){i.forEach(function(r){e.forEach(function(s){Ly(r,s,t),Ly(s,r,n)})})}function C6(i,e){return i?typeof i=="string"?Ta(i):i:Ta(e)}function Lbe(i){return function(e,t,n,r){const s=e.length;n=n!==void 0?n:2,r=r??n,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=i(e.slice(o,o+n)),l=a.length;for(let u=0,h=r;u<h;++u)t[o+u]=u>=l?e[o+u]:a[u]}return t}}function N6(i,e){return yW(),p2(i,"EPSG:4326",e)}function Obe(i,e){const t=p2(i,e,"EPSG:4326"),n=t[0];return(n<-180||n>180)&&(t[0]=IA(n+180,360)-180),t}function aR(i,e){if(i===e)return!0;const t=i.getUnits()===e.getUnits();return(i.getCode()===e.getCode()||D6(i,e)===R6)&&t}function D6(i,e){const t=i.getCode(),n=e.getCode();let r=oR(t,n);if(r)return r;let s=null,o=null;for(const l of Cbe)s||(s=l(i)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=lR(s.inverse,o.forward);else{const l=oR(t,a);l&&(r=lR(l,o.forward))}else{const l=oR(a,n);l&&(r=lR(s.inverse,l))}return r&&(x4(i),x4(e),Ly(i,e,r)),r}function lR(i,e){return function(t,n,r,s){return n=i(t,n,r,s),e(n,n,r,s)}}function $S(i,e){const t=Ta(i),n=Ta(e);return D6(t,n)}function p2(i,e,t){const n=$S(e,t);if(!n){const r=Ta(e).getCode(),s=Ta(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return n(i,void 0,i.length)}function b4(i,e){return i}function oh(i,e){return v4&&!WS(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(v4=!1,dW("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function vW(i,e){return i}function Yf(i,e){return i}function Ibe(){jB(FB),jB(GB),Pbe(GB,FB,ube,cbe)}Ibe();new Array(6);function gu(){return[1,0,0,1,0,0]}function Bbe(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i}function Vs(i,e){const t=e[0],n=e[1];return e[0]=i[0]*t+i[2]*n+i[4],e[1]=i[1]*t+i[3]*n+i[5],e}function Uh(i,e,t,n,r,s,o,a){const l=Math.sin(s),u=Math.cos(s);return i[0]=n*u,i[1]=r*l,i[2]=-n*l,i[3]=r*u,i[4]=o*n*u-a*n*l+e,i[5]=o*r*l+a*r*u+t,i}function xW(i,e){const t=Ube(e);Ki(t!==0,"Transformation matrix cannot be inverted");const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return i[0]=o/t,i[1]=-r/t,i[2]=-s/t,i[3]=n/t,i[4]=(s*l-o*a)/t,i[5]=-(n*l-r*a)/t,i}function Ube(i){return i[0]*i[3]-i[1]*i[2]}const Fbe=[1e5,1e5,1e5,1e5,2,2];function kbe(i){return"matrix("+i.join(", ")+")"}function XB(i){return i.substring(7,i.length-1).split(",").map(parseFloat)}function Gbe(i,e){const t=XB(i),n=XB(e);for(let r=0;r<6;++r)if(Math.round((t[r]-n[r])*Fbe[r])!==0)return!1;return!0}function rd(i,e,t,n,r,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<t;l+=n){const u=i[l],h=i[l+1];s[a++]=r[0]*u+r[2]*h+r[4],s[a++]=r[1]*u+r[3]*h+r[5];for(let d=2;d<o;d++)s[a++]=i[l+d]}return s&&s.length!=a&&(s.length=a),s}function P6(i,e,t,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),u=s[0],h=s[1];let d=0;for(let _=e;_<t;_+=n){const x=i[_]-u,b=i[_+1]-h;o[d++]=u+x*a-b*l,o[d++]=h+x*l+b*a;for(let R=_+2;R<_+n;++R)o[d++]=i[R]}return o&&o.length!=d&&(o.length=d),o}function zbe(i,e,t,n,r,s,o,a){a=a||[];const l=o[0],u=o[1];let h=0;for(let d=e;d<t;d+=n){const _=i[d]-l,x=i[d+1]-u;a[h++]=l+r*_,a[h++]=u+s*x;for(let b=d+2;b<d+n;++b)a[h++]=i[b]}return a&&a.length!=h&&(a.length=h),a}function Vbe(i,e,t,n,r,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=n){o[a++]=i[l]+r,o[a++]=i[l+1]+s;for(let u=l+2;u<l+n;++u)o[a++]=i[u]}return o&&o.length!=a&&(o.length=a),o}const $B=gu(),qbe=[NaN,NaN];class Hbe extends bc{constructor(){super(),this.extent_=Ul(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=JH((e,t,n)=>{if(!n)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Ii()}closestPointXY(e,t,n,r){return Ii()}containsXY(e,t){return this.closestPointXY(e,t,qbe,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Ii()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&l3(t),this.extentRevision_=this.getRevision()}return Jxe(this.extent_,e)}rotate(e,t){Ii()}scale(e,t,n){Ii()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Ii()}getType(){return Ii()}applyTransform(e){Ii()}intersectsExtent(e){return Ii()}translate(e,t){Ii()}transform(e,t){const n=Ta(e),r=n.getUnits()=="tile-pixels"?function(s,o,a){const l=n.getExtent(),u=n.getWorldExtent(),h=Ho(u)/Ho(l);Uh($B,u[0],u[3],h,-h,0,0,0);const d=rd(s,0,s.length,a,$B,o),_=$S(n,t);return _?_(d,d,a):d}:$S(n,t);return this.applyTransform(r),this}}class p3 extends Hbe{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return x6(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Ii()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=YB(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Ii()}setLayout(e,t,n){let r;if(e)r=YB(e);else{for(let s=0;s<n;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Wbe(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const n=this.getFlatCoordinates();if(n){const r=this.getStride();P6(n,0,n.length,r,e,t,n),this.changed()}}scale(e,t,n){t===void 0&&(t=e),n||(n=YA(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();zbe(r,0,r.length,s,e,t,n,r),this.changed()}}translate(e,t){const n=this.getFlatCoordinates();if(n){const r=this.getStride();Vbe(n,0,n.length,r,e,t,n),this.changed()}}}function Wbe(i){let e;return i==2?e="XY":i==3?e="XYZ":i==4&&(e="XYZM"),e}function YB(i){let e;return i=="XY"?e=2:i=="XYZ"||i=="XYM"?e=3:i=="XYZM"&&(e=4),e}function jbe(i,e,t){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return rd(n,0,n.length,r,e,t)}function bW(i,e,t,n){let r=0;const s=i[t-n],o=i[t-n+1];let a=0,l=0;for(;e<t;e+=n){const u=i[e]-s,h=i[e+1]-o;r+=l*u-a*h,a=u,l=h}return r/2}function Xbe(i,e,t,n){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=bW(i,e,a,n),e=a}return r}function QB(i,e,t,n,r,s,o){const a=i[e],l=i[e+1],u=i[t]-a,h=i[t+1]-l;let d;if(u===0&&h===0)d=e;else{const _=((r-a)*u+(s-l)*h)/(u*u+h*h);if(_>1)d=t;else if(_>0){for(let x=0;x<n;++x)o[x]=Sl(i[e+x],i[t+x],_);o.length=n;return}else d=e}for(let _=0;_<n;++_)o[_]=i[d+_];o.length=n}function SW(i,e,t,n,r){let s=i[e],o=i[e+1];for(e+=n;e<t;e+=n){const a=i[e],l=i[e+1],u=am(s,o,a,l);u>r&&(r=u),s=a,o=l}return r}function $be(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=SW(i,e,a,n,r),e=a}return r}function TW(i,e,t,n,r,s,o,a,l,u,h){if(e==t)return u;let d,_;if(r===0){if(_=am(o,a,i[e],i[e+1]),_<u){for(d=0;d<n;++d)l[d]=i[e+d];return l.length=n,_}return u}h=h||[NaN,NaN];let x=e+n;for(;x<t;)if(QB(i,x-n,x,n,o,a,h),_=am(o,a,h[0],h[1]),_<u){for(u=_,d=0;d<n;++d)l[d]=h[d];l.length=n,x+=n}else x+=n*Math.max((Math.sqrt(_)-Math.sqrt(u))/r|0,1);if(QB(i,t-n,e,n,o,a,h),_=am(o,a,h[0],h[1]),_<u){for(u=_,d=0;d<n;++d)l[d]=h[d];l.length=n}return u}function Ybe(i,e,t,n,r,s,o,a,l,u,h){h=h||[NaN,NaN];for(let d=0,_=t.length;d<_;++d){const x=t[d];u=TW(i,e,x,n,r,s,o,a,l,u,h),e=x}return u}function EW(i,e,t,n){for(let r=0,s=t.length;r<s;++r)i[e++]=t[r];return e}function wW(i,e,t,n){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<n;++a)i[e++]=o[a]}return e}function Qbe(i,e,t,n,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=wW(i,e,t[o],n);r[s++]=l,e=l}return r.length=s,r}function Yp(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=n)r[s++]=i.slice(o,o+n);return r.length=s,r}function YS(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=Yp(i,e,l,n,r[s]),e=l}return r.length=s,r}function KB(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=l.length===1&&l[0]===e?[]:YS(i,e,l,n,r[s]),e=l[l.length-1]}return r.length=s,r}function L6(i,e,t,n,r,s,o){const a=(t-e)/n;if(a<3){for(;e<t;e+=n)s[o++]=i[e],s[o++]=i[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const u=[e,t-n];let h=0;for(;u.length>0;){const d=u.pop(),_=u.pop();let x=0;const b=i[_],R=i[_+1],E=i[d],w=i[d+1];for(let L=_+n;L<d;L+=n){const D=i[L],O=i[L+1],B=Xxe(D,O,b,R,E,w);B>x&&(h=L,x=B)}x>r&&(l[(h-e)/n]=1,_+n<h&&u.push(_,h),h+n<d&&u.push(h,d))}for(let d=0;d<a;++d)l[d]&&(s[o++]=i[e+d*n],s[o++]=i[e+d*n+1]);return o}function Kbe(i,e,t,n,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const h=t[l];o=L6(i,e,h,n,r,s,o),a.push(o),e=h}return o}function aA(i,e){return e*Math.round(i/e)}function Zbe(i,e,t,n,r,s,o){if(e==t)return o;let a=aA(i[e],r),l=aA(i[e+1],r);e+=n,s[o++]=a,s[o++]=l;let u,h;do if(u=aA(i[e],r),h=aA(i[e+1],r),e+=n,e==t)return s[o++]=u,s[o++]=h,o;while(u==a&&h==l);for(;e<t;){const d=aA(i[e],r),_=aA(i[e+1],r);if(e+=n,d==u&&_==h)continue;const x=u-a,b=h-l,R=d-a,E=_-l;if(x*E==b*R&&(x<0&&R<x||x==R||x>0&&R>x)&&(b<0&&E<b||b==E||b>0&&E>b)){u=d,h=_;continue}s[o++]=u,s[o++]=h,a=u,l=h,u=d,h=_}return s[o++]=u,s[o++]=h,o}function MW(i,e,t,n,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const h=t[l];o=Zbe(i,e,h,n,r,s,o),a.push(o),e=h}return o}class Oy extends p3{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Oy(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,n,r){return r<rW(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(SW(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),TW(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,n,r))}getArea(){return bW(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Yp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=L6(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Oy(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wW(this.flatCoordinates,0,e,this.stride),this.changed()}}class m3 extends p3{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new m3(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,r){const s=this.flatCoordinates,o=am(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)n[l]=s[l];return n.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return oW(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return sW(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=EW(this.flatCoordinates,0,e,this.stride),this.changed()}}function Jbe(i,e,t,n,r){return!b6(r,function(o){return!bA(i,e,t,n,o[0],o[1])})}function bA(i,e,t,n,r,s){let o=0,a=i[t-n],l=i[t-n+1];for(;e<t;e+=n){const u=i[e],h=i[e+1];l<=s?h>s&&(u-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(u-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=u,l=h}return o!==0}function RW(i,e,t,n,r,s){if(t.length===0||!bA(i,e,t[0],n,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(bA(i,t[o-1],t[o],n,r,s))return!1;return!0}function O6(i,e,t,n,r,s,o){let a,l,u,h,d,_,x;const b=r[s+1],R=[];for(let L=0,D=t.length;L<D;++L){const O=t[L];for(h=i[O-n],_=i[O-n+1],a=e;a<O;a+=n)d=i[a],x=i[a+1],(b<=_&&x<=b||_<=b&&b<=x)&&(u=(b-_)/(x-_)*(d-h)+h,R.push(u)),h=d,_=x}let E=NaN,w=-1/0;for(R.sort(Sh),h=R[0],a=1,l=R.length;a<l;++a){d=R[a];const L=Math.abs(d-h);L>w&&(u=(h+d)/2,RW(i,e,t,n,u,b)&&(E=u,w=L)),h=d}return isNaN(E)&&(E=r[s]),o?(o.push(E,b,w),o):[E,b,w]}function eSe(i,e,t,n,r){let s=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];s=O6(i,e,l,n,r,2*o,s),e=l[l.length-1]}return s}function tSe(i,e,t,n,r){let s;for(e+=n;e<t;e+=n)if(s=r(i.slice(e-n,e),i.slice(e,e+n)),s)return s;return!1}function CW(i,e,t,n,r,s){return s=s??aW(Ul(),i,e,t,n),Vo(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:tSe(i,e,t,n,function(o,a){return ebe(r,o,a)}):!1}function NW(i,e,t,n,r){return!!(CW(i,e,t,n,r)||bA(i,e,t,n,r[0],r[1])||bA(i,e,t,n,r[0],r[3])||bA(i,e,t,n,r[2],r[1])||bA(i,e,t,n,r[2],r[3]))}function nSe(i,e,t,n,r){if(!NW(i,e,t[0],n,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(Jbe(i,t[s-1],t[s],n,r)&&!CW(i,t[s-1],t[s],n,r))return!1;return!0}function iSe(i,e,t,n){for(;e<t-n;){for(let r=0;r<n;++r){const s=i[e+r];i[e+r]=i[t-n+r],i[t-n+r]=s}e+=n,t-=n}}function I6(i,e,t,n){let r=0,s=i[t-n],o=i[t-n+1];for(;e<t;e+=n){const a=i[e],l=i[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function rSe(i,e,t,n,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=I6(i,e,a,n);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function ZB(i,e,t,n,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=I6(i,e,a,n);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&iSe(i,e,a,n),e=a}return e}function sSe(i,e){const t=[];let n=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],u=I6(i,n,l,2);if(s===void 0&&(s=u),u===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,n=l}return t}class Iy extends p3{constructor(e,t,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&n?(this.setFlatCoordinates(t,e),this.ends_=n):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?_6(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Iy(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,r){return r<rW(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($be(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ybe(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,n,r))}containsXY(e,t){return RW(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Xbe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),ZB(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,YS(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=YA(this.getExtent());this.flatInteriorPoint_=O6(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new m3(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Oy(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],u=new Oy(t.slice(s,l),e);r.push(u),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;rSe(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=ZB(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=MW(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,n),new Iy(t,"XY",n)}getType(){return"Polygon"}intersectsExtent(e){return nSe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Qbe(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function JB(i){if(f3(i))throw new Error("Cannot create polygon from empty extent");const e=i[0],t=i[1],n=i[2],r=i[3],s=[e,t,e,r,n,r,n,t,e,t];return new Iy(s,"XY",[s.length])}function B6(i,e,t,n){const r=ir(e)/t[0],s=Ho(e)/t[1];return n?Math.min(i,Math.max(r,s)):Math.min(i,Math.min(r,s))}function U6(i,e,t){let n=Math.min(i,e);const r=50;return n*=Math.log(1+r*Math.max(0,i/e-1))/r+1,t&&(n=Math.max(n,t),n/=Math.log(1+r*Math.max(0,t/i-1))/r+1),qr(n,t/2,e*2)}function oSe(i,e,t,n){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=i[0],u=i[i.length-1],h=t?B6(l,t,o,n):l;if(a)return e?U6(r,h,u):qr(r,u,h);const d=Math.min(h,r),_=Math.floor(g6(i,d,s));return i[_]>h&&_<i.length-1?i[_+1]:i[_]}}}function aSe(i,e,t,n,r,s){return n=n!==void 0?n:!0,t=t!==void 0?t:0,function(o,a,l,u){if(o!==void 0){const h=r?B6(e,r,l,s):e;if(u)return n?U6(o,h,t):qr(o,t,h);const d=1e-9,_=Math.ceil(Math.log(e/h)/Math.log(i)-d),x=-a*(.5-d)+.5,b=Math.min(h,o),R=Math.floor(Math.log(e/b)/Math.log(i)+x),E=Math.max(_,R),w=e/Math.pow(i,E);return qr(w,t,h)}}}function eU(i,e,t,n,r){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const u=n?B6(i,n,a,r):i;return!t||!l?qr(s,e,u):U6(s,u,e)}}}function F6(i){if(i!==void 0)return 0}function tU(i){if(i!==void 0)return i}function lSe(i){const e=2*Math.PI/i;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function uSe(i){const e=id(5);return function(t,n){return n||t===void 0?t:Math.abs(t)<=e?0:t}}const cSe=42,k6=256,uR=0;class Wu extends bc{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=C6(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&yW(),e.center&&(e.center=oh(e.center,this.projection_)),e.extent&&(e.extent=Yf(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in ru)delete t[a];this.setProperties(t,!0);const n=fSe(e);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=n.minZoom;const r=hSe(e),s=n.constraint,o=dSe(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const n=this.getCenterInternal();if(n){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let n=0;n<t.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=oh(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=oh(r.anchor,this.getProjection())),t[n]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,n;t>1&&typeof arguments[t-1]=="function"&&(n=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===t){n&&lb(n,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const u=[];for(;r<t;++r){const h=arguments[r],d={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||rbe,callback:n};if(h.center&&(d.sourceCenter=o,d.targetCenter=h.center.slice(),o=d.targetCenter),h.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(h.zoom),a=d.targetResolution):h.resolution&&(d.sourceResolution=a,d.targetResolution=h.resolution,a=d.targetResolution),h.rotation!==void 0){d.sourceRotation=l;const _=IA(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+_,l=d.targetRotation}ASe(d)?d.complete=!0:s+=d.duration,u.push(d)}this.animations_.push(u),this.setHint(xo.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[xo.ANIMATING]>0}getInteracting(){return this.hints_[xo.INTERACTING]>0}cancelAnimations(){this.setHint(xo.ANIMATING,-this.hints_[xo.ANIMATING]);let e;for(let t=0,n=this.animations_.length;t<n;++t){const r=this.animations_[t];if(r[0].callback&&lb(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const d=l.easing(h);if(l.sourceCenter){const _=l.sourceCenter[0],x=l.sourceCenter[1],b=l.targetCenter[0],R=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=_+d*(b-_),w=x+d*(R-x);this.targetCenter_=[E,w]}if(l.sourceResolution&&l.targetResolution){const _=d===1?l.targetResolution:l.sourceResolution+d*(l.targetResolution-l.sourceResolution);if(l.anchor){const x=this.getViewportSize_(this.getRotation()),b=this.constraints_.resolution(_,0,x,!0);this.targetCenter_=this.calculateCenterZoom(b,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=_,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const _=d===1?IA(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+d*(l.targetRotation-l.sourceRotation);if(l.anchor){const x=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(x,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[n]=null,this.setHint(xo.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&lb(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let n;const r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-t[0],r[1]-t[1]],S6(n,e-this.getRotation()),tbe(n,t)),n}calculateCenterZoom(e,t){let n;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;n=[o,a]}return n}getViewportSize_(e){const t=this.viewportSize_;if(e){const n=t[0],r=t[1];return[Math.abs(n*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(n*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&b4(e,this.getProjection())}getCenterInternal(){return this.get(ru.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return vW(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Ki(t,"The view center is not defined");const n=this.getResolution();Ki(n!==void 0,"The view resolution is not defined");const r=this.getRotation();return Ki(r!==void 0,"The view rotation is not defined"),_4(t,n,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ru.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Yf(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const n=ir(e)/t[0],r=Ho(e)/t[1];return Math.max(n,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(t/n)/Math.log(e);return function(s){return t/Math.pow(e,s*r)}}getRotation(){return this.get(ru.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(n/r)/t;return function(o){return Math.log(n/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const n=this.padding_;return n&&(t=[t[0]-n[1]-n[3],t[1]-n[0]-n[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=cR(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,n)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,n,r;if(this.resolutions_){const s=g6(this.resolutions_,e,1);t=s,n=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=n/this.resolutions_[s+1]}else n=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(n/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=qr(Math.floor(e),0,this.resolutions_.length-2),n=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(n,qr(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let n;if(Ki(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Ki(!f3(e),"Cannot fit empty extent provided as `geometry`");const r=Yf(e,this.getProjection());n=JB(r)}else if(e.getType()==="Circle"){const r=Yf(e.getExtent(),this.getProjection());n=JB(r),n.rotate(this.getRotation(),YA(r))}else n=e;this.fitInternal(n,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),n=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,u=-1/0,h=-1/0;for(let d=0,_=s.length;d<_;d+=o){const x=s[d]*n-s[d+1]*r,b=s[d]*r+s[d+1]*n;a=Math.min(a,x),l=Math.min(l,b),u=Math.max(u,x),h=Math.max(h,b)}return[a,l,u,h]}fitInternal(e,t){t=t||{};let n=t.size;n||(n=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),d=Math.cos(u),_=YA(a);_[0]+=(r[1]-r[3])/2*l,_[1]+=(r[0]-r[2])/2*l;const x=_[0]*d-_[1]*h,b=_[1]*d+_[0]*h,R=this.getConstrainedCenter([x,b],l),E=t.callback?t.callback:Dy;t.duration!==void 0?this.animateInternal({resolution:l,center:R,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=R,this.applyTargetState_(!1,!0),lb(E,!0))}centerOn(e,t,n){this.centerOnInternal(oh(e,this.getProjection()),t,n)}centerOnInternal(e,t,n){this.setCenterInternal(cR(e,t,n,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,n,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-n),l=cR(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,n);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=b4(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&oh(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,n);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=oh(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,n);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&oh(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const n=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,n),a=this.constraints_.center(this.targetCenter_,o,s,n,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(ru.ROTATION)!==r&&this.set(ru.ROTATION,r),this.get(ru.RESOLUTION)!==o&&(this.set(ru.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(ru.CENTER)||!WS(this.get(ru.CENTER),a))&&this.set(ru.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,n){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}n=n||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!WS(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:_g,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(xo.INTERACTING,1)}endInteraction(e,t,n){n=n&&oh(n,this.getProjection()),this.endInteractionInternal(e,t,n)}endInteractionInternal(e,t,n){this.getInteracting()&&(this.setHint(xo.INTERACTING,-1),this.resolveConstraints(e,t,n))}getConstrainedCenter(e,t){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),n)}getConstrainedZoom(e,t){const n=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(n,t))}getConstrainedResolution(e,t){t=t||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,n)}}function lb(i,e){setTimeout(function(){i(e)},0)}function hSe(i){if(i.extent!==void 0){const t=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return IB(i.extent,i.constrainOnlyCenter,t)}const e=C6(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,IB(t,!1,!1)}return Yxe}function fSe(i){let e,t,n,o=i.minZoom!==void 0?i.minZoom:uR,a=i.maxZoom!==void 0?i.maxZoom:28;const l=i.zoomFactor!==void 0?i.zoomFactor:2,u=i.multiWorld!==void 0?i.multiWorld:!1,h=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,d=i.showFullExtent!==void 0?i.showFullExtent:!1,_=C6(i.projection,"EPSG:3857"),x=_.getExtent();let b=i.constrainOnlyCenter,R=i.extent;if(!u&&!R&&_.isGlobal()&&(b=!1,R=x),i.resolutions!==void 0){const E=i.resolutions;t=E[o],n=E[a]!==void 0?E[a]:E[E.length-1],i.constrainResolution?e=oSe(E,h,!b&&R,d):e=eU(t,n,h,!b&&R,d)}else{const w=(x?Math.max(ir(x),Ho(x)):360*T6.degrees/_.getMetersPerUnit())/k6/Math.pow(2,uR),L=w/Math.pow(2,28-uR);t=i.maxResolution,t!==void 0?o=0:t=w/Math.pow(l,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=t/Math.pow(l,a):n=w/Math.pow(l,a):n=L),a=o+Math.floor(Math.log(t/n)/Math.log(l)),n=t/Math.pow(l,a-o),i.constrainResolution?e=aSe(l,t,n,h,!b&&R,d):e=eU(t,n,h,!b&&R,d)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:o,zoomFactor:l}}function dSe(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const t=i.constrainRotation;return t===void 0||t===!0?uSe():t===!1?tU:typeof t=="number"?lSe(t):tU}return F6}function ASe(i){return!(i.sourceCenter&&i.targetCenter&&!WS(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function cR(i,e,t,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=i[0]*s-i[1]*o,l=i[1]*s+i[0]*o;a+=(e[0]/2-t[0])*n,l+=(t[1]-e[1]/2)*n,o=-o;const u=a*s-l*o,h=l*s+a*o;return[u,h]}const ub="ol-hidden",g3="ol-unselectable",G6="ol-control",nU="ol-collapsed",pSe=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),iU=["style","variant","weight","size","lineHeight","family"],S4={normal:400,bold:700},T4=function(i){const e=i.match(pSe);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let n=0,r=iU.length;n<r;++n){const s=e[n+1];s!==void 0&&(t[iU[n]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in S4&&(t.weight=S4[t.weight]),t.families=t.family.split(/,\s?/).map(n=>n.trim().replace(/^['"]|['"]$/g,"")),t};function Rs(i,e,t,n){let r;return t&&t.length?r=t.shift():y6?r=new OffscreenCanvas(i||300,e||300):r=document.createElement("canvas"),i&&(r.width=i),e&&(r.height=e),r.getContext("2d",n)}let hR;function QS(){return hR||(hR=Rs(1,1)),hR}function _3(i){const e=i.canvas;e.width=1,e.height=1,i.clearRect(0,0,1,1)}function rU(i,e){const t=e.parentNode;t&&t.replaceChild(i,e)}function mSe(i){for(;i.lastChild;)i.lastChild.remove()}function gSe(i,e){const t=i.childNodes;for(let n=0;;++n){const r=t[n],s=e[n];if(!r&&!s)break;if(r!==s){if(!r){i.appendChild(s);continue}if(!s){i.removeChild(r),--n;continue}i.insertBefore(s,r)}}}class z6 extends bc{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,n=this.listenerKeys.length;t<n;++t)Ir(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Dy&&this.listenerKeys.push(Bi(e,Gf.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class _Se extends z6{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",n=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(ai.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+g3+" "+G6+(this.collapsed_&&this.collapsible_?" "+nU:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),n=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>n.add(r)):n.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(n)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>Uxe(()=>r))),n=t.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!_d(t,this.renderedAttributions_)){mSe(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(nU),this.collapsed_?rU(this.collapseLabel_,this.label_):rU(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class ySe extends z6{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",n=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(ai.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+g3+" "+G6,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ub)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const n=t.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:_g}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const n=t.viewState.rotation;if(n!=this.rotation_){const r="rotate("+n+"rad)";if(this.autoHide_){const s=this.element.classList.contains(ub);!s&&n===0?this.element.classList.add(ub):s&&n!==0&&this.element.classList.remove(ub)}this.label_.style.transform=r}this.rotation_=n}}class vSe extends z6{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",n=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(ai.CLICK,this.handleClick_.bind(this,n),!1);const d=document.createElement("button");d.className=s,d.setAttribute("type","button"),d.title=u,d.appendChild(typeof a=="string"?document.createTextNode(a):a),d.addEventListener(ai.CLICK,this.handleClick_.bind(this,-n),!1);const _=t+" "+g3+" "+G6,x=this.element;x.className=_,x.appendChild(h),x.appendChild(d),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const n=this.getMap().getView();if(!n)return;const r=n.getZoom();if(r!==void 0){const s=n.getConstrainedZoom(r+e);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:_g})):n.setZoom(s)}}}function xSe(i){i=i||{};const e=new Ku;return(i.zoom!==void 0?i.zoom:!0)&&e.push(new vSe(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&e.push(new ySe(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&e.push(new _Se(i.attributionOptions)),e}class bSe{constructor(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let n=t-3;for(;n>0&&this.points_[n+2]>e;)n-=3;const r=this.points_[t+2]-this.points_[n+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[n],o=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const sU={ACTIVE:"active"};class m2 extends bc{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(sU.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(sU.ACTIVE,e)}setMap(e){this.map_=e}}function SSe(i,e,t){const n=i.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];i.animateInternal({duration:t!==void 0?t:250,easing:sbe,center:i.getConstrainedCenter(r)})}}function V6(i,e,t,n){const r=i.getZoom();if(r===void 0)return;const s=i.getConstrainedZoom(r+e),o=i.getResolutionForZoom(s);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:t,duration:n!==void 0?n:250,easing:_g})}class TSe extends m2{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==$r.DBLCLICK){const n=e.originalEvent,r=e.map,s=e.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=r.getView();V6(a,o,s,this.duration_),n.preventDefault(),t=!0}return!t}}function E4(i){const e=arguments;return function(t){let n=!0;for(let r=0,s=e.length;r<s&&(n=n&&e[r](t),!!n);++r);return n}}const ESe=function(i){const e=i.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},wSe=function(i){const e=i.map.getTargetElement(),t=e.getRootNode(),n=i.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(n):e.contains(n)},DW=function(i){const e=i.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?wSe(i):!0},MSe=Ny,PW=function(i){const e=i.originalEvent;return"pointerId"in e&&e.button==0&&!(zxe&&eW&&e.ctrlKey)},LW=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},RSe=function(i){const e=i.originalEvent;return eW?e.metaKey:e.ctrlKey},CSe=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},OW=function(i){const e=i.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},fR=function(i){const e=i.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},NSe=function(i){const e=i.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class g2 extends m2{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==$r.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==$r.POINTERUP){const n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==$r.POINTERDOWN){const n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==$r.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function q6(i){const e=i.length;let t=0,n=0;for(let r=0;r<e;r++)t+=i[r].clientX,n+=i[r].clientY;return{clientX:t/e,clientY:n/e}}class DSe extends g2{constructor(e){super({stopDown:s3}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:E4(LW,NSe);this.condition_=e.onFocusOnly?E4(DW,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const n=this.targetPointers,r=t.getEventPixel(q6(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();nbe(s,a.getResolution()),S6(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,n=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:_g})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const n=e.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class PSe extends g2{constructor(e){e=e||{},super({stopDown:s3}),this.condition_=e.condition?e.condition:ESe,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!fR(e))return;const t=e.map,n=t.getView();if(n.getConstraints().rotation===F6)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return fR(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return fR(e)&&PW(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class LSe extends r3{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+n,r.top=Math.min(e[1],t[1])+n,r.width=Math.abs(t[0]-e[0])+n,r.height=Math.abs(t[1]-e[1])+n}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Iy([r])}getGeometry(){return this.geometry_}}const Ep={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class J1 extends Vh{constructor(e,t,n){super(e),this.coordinate=t,this.mapBrowserEvent=n}}class OSe extends g2{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new LSe(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??PW,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,n){const r=n[0]-t[0],s=n[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new J1(Ep.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new J1(t?Ep.BOXEND:Ep.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new J1(Ep.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new J1(Ep.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new J1(Ep.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class ISe extends OSe{constructor(e){e=e||{};const t=e.condition?e.condition:CSe;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const n=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(r),o=n.getResolutionForExtentInternal(s),a=n.getResolution()/o;r=r.clone(),r.scale(a*a)}n.fitInternal(r,{duration:this.duration_,easing:_g})}}const tA={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class BSe extends m2{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return LW(t)&&OW(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ai.KEYDOWN){const n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r==tA.DOWN||r==tA.LEFT||r==tA.RIGHT||r==tA.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,u=0;r==tA.DOWN?u=-a:r==tA.LEFT?l=-a:r==tA.RIGHT?l=a:u=a;const h=[l,u];S6(h,o.getRotation()),SSe(o,h,this.duration_),n.preventDefault(),t=!0}}return!t}}class USe extends m2{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!RSe(t)&&OW(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ai.KEYDOWN||e.type==ai.KEYPRESS){const n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();V6(a,o,void 0,this.duration_),n.preventDefault(),t=!0}}return!t}}const FSe=40,kSe=300;class GSe extends m2{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:MSe;this.condition_=e.onFocusOnly?E4(DW,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ai.WHEEL)return!0;const n=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=FSe;break;case WheelEvent.DOM_DELTA_PAGE:s*=kSe;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?n.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let n=-qr(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),V6(t,n,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class zSe extends g2{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=s3),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==F6&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(q6(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class VSe extends g2{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=s3),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(q6(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const n=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function qSe(i){i=i||{};const e=new Ku,t=new bSe(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&e.push(new PSe),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&e.push(new TSe({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&e.push(new DSe({onFocusOnly:i.onFocusOnly,kinetic:t})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&e.push(new zSe),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&e.push(new VSe({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(e.push(new BSe),e.push(new USe({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&e.push(new GSe({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&e.push(new ISe({duration:i.zoomDuration})),e}const nr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class IW extends bc{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[nr.OPACITY]=e.opacity!==void 0?e.opacity:1,Ki(typeof t[nr.OPACITY]=="number","Layer opacity must be a number"),t[nr.VISIBLE]=e.visible!==void 0?e.visible:!0,t[nr.Z_INDEX]=e.zIndex,t[nr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[nr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[nr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[nr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},n=this.getZIndex();return t.opacity=qr(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=n===void 0&&!t.managed?1/0:n,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Ii()}getLayerStatesArray(e){return Ii()}getExtent(){return this.get(nr.EXTENT)}getMaxResolution(){return this.get(nr.MAX_RESOLUTION)}getMinResolution(){return this.get(nr.MIN_RESOLUTION)}getMinZoom(){return this.get(nr.MIN_ZOOM)}getMaxZoom(){return this.get(nr.MAX_ZOOM)}getOpacity(){return this.get(nr.OPACITY)}getSourceState(){return Ii()}getVisible(){return this.get(nr.VISIBLE)}getZIndex(){return this.get(nr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(nr.EXTENT,e)}setMaxResolution(e){this.set(nr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(nr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(nr.MAX_ZOOM,e)}setMinZoom(e){this.set(nr.MIN_ZOOM,e)}setOpacity(e){Ki(typeof e=="number","Layer opacity must be a number"),this.set(nr.OPACITY,e)}setVisible(e){this.set(nr.VISIBLE,e)}setZIndex(e){this.set(nr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class qf extends Vh{constructor(e,t){super(e),this.layer=t}}const dR={LAYERS:"layers"};class yg extends IW{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let n=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(dR.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Ku(n.slice(),{unique:!0}):Ki(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new Ku(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ir),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Bi(e,sa.ADD,this.handleLayersAdd_,this),Bi(e,sa.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ir);f2(this.listenerKeys_);const t=e.getArray();for(let n=0,r=t.length;n<r;n++){const s=t[n];this.registerLayerListeners_(s),this.dispatchEvent(new qf("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[Bi(e,Zm.PROPERTYCHANGE,this.handleLayerChange_,this),Bi(e,ai.CHANGE,this.handleLayerChange_,this)];e instanceof yg&&t.push(Bi(e,"addlayer",this.handleLayerGroupAdd_,this),Bi(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Ui(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new qf("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new qf("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new qf("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,n=Ui(t);this.listenerKeys_[n].forEach(Ir),delete this.listenerKeys_[n],this.dispatchEvent(new qf("removelayer",t)),this.changed()}getLayers(){return this.get(dR.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const n=t.getArray();for(let r=0,s=n.length;r<s;++r)this.dispatchEvent(new qf("removelayer",n[r]))}this.set(dR.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],n=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=n,a=t.length;o<a;o++){const l=t[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=BA(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}const Ml={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class y3 extends IW{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(nr.SOURCE,this.handleSourcePropertyChange_);const n=e.source?e.source:null;this.setSource(n)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(nr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ir(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Bi(e,ai.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const n=this.getMapInternal();!e&&n&&(e=n.getView()),e instanceof Wu?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&n&&(t.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return H6(r,t.viewState)&&(!s||Vo(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const n=e instanceof Wu?e.getViewStateAndExtent():e;let r=t(n);return Array.isArray(r)||(r=[r]),r}render(e,t){const n=this.getRenderer();return n.prepareFrame(e)?(this.rendered=!0,n.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(nr.MAP,e)}getMapInternal(){return this.get(nr.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ir(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ir(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Bi(e,Ml.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Bi(this,ai.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,n=this.getLayerState(!1);Ki(!t.some(r=>r.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(n)}setSource(e){this.set(nr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function H6(i,e){if(!i.visible)return!1;const t=e.resolution;if(t<i.minResolution||t>=i.maxResolution)return!1;const n=e.zoom;return n>i.minZoom&&n<=i.maxZoom}function BW(i,e,t=0,n=i.length-1,r=HSe){for(;n>t;){if(n-t>600){const l=n-t+1,u=e-t+1,h=Math.log(l),d=.5*Math.exp(2*h/3),_=.5*Math.sqrt(h*d*(l-d)/l)*(u-l/2<0?-1:1),x=Math.max(t,Math.floor(e-u*d/l+_)),b=Math.min(n,Math.floor(e+(l-u)*d/l+_));BW(i,e,x,b,r)}const s=i[e];let o=t,a=n;for(e_(i,t,e),r(i[n],s)>0&&e_(i,t,n);o<a;){for(e_(i,o,a),o++,a--;r(i[o],s)<0;)o++;for(;r(i[a],s)>0;)a--}r(i[t],s)===0?e_(i,t,a):(a++,e_(i,a,n)),a<=e&&(t=a+1),e<=a&&(n=a-1)}}function e_(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}function HSe(i,e){return i<e?-1:i>e?1:0}let UW=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!hb(e,t))return n;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?r(a):a;hb(e,l)&&(t.leaf?n.push(a):pR(e,l)?this._all(a,n):s.push(a))}t=s.pop()}return n}collides(e){let t=this.data;if(!hb(e,t))return!1;const n=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(hb(e,o)){if(t.leaf||pR(e,o))return!0;n.push(s)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Op([]),this}remove(e,t){if(!e)return this;let n=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,u;for(;n||s.length;){if(n||(n=s.pop(),l=s[s.length-1],a=o.pop(),u=!0),n.leaf){const h=WSe(e,n.children,t);if(h!==-1)return n.children.splice(h,1),s.push(n),this._condense(s),this}!u&&!n.leaf&&pR(n,r)?(s.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const s=n-t+1;let o=this._maxEntries,a;if(s<=o)return a=Op(e.slice(t,n+1)),wp(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Op([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),u=l*Math.ceil(Math.sqrt(o));oU(e,t,n,u,this.compareMinX);for(let h=t;h<=n;h+=u){const d=Math.min(h+u-1,n);oU(e,h,d,l,this.compareMinY);for(let _=h;_<=d;_+=l){const x=Math.min(_+l-1,d);a.children.push(this._build(e,_,x,r-1))}}return wp(a,this.toBBox),a}_chooseSubtree(e,t,n,r){for(;r.push(t),!(t.leaf||r.length-1===n);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=AR(u),d=$Se(e,u)-h;d<o?(o=d,s=h<s?h:s,a=u):d===o&&h<s&&(s=h,a=u)}t=a||t.children[0]}return t}_insert(e,t,n){const r=n?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),g_(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const n=e[t],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);const o=this._chooseSplitIndex(n,s,r),a=Op(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,wp(n,this.toBBox),wp(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this.data=Op([e,t]),this.data.height=e.height+1,this.data.leaf=!1,wp(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,s=1/0,o=1/0;for(let a=t;a<=n-t;a++){const l=m_(e,0,a,this.toBBox),u=m_(e,a,n,this.toBBox),h=YSe(l,u),d=AR(l)+AR(u);h<s?(s=h,r=a,o=d<o?d:o):h===s&&d<o&&(o=d,r=a)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:jSe,s=e.leaf?this.compareMinY:XSe,o=this._allDistMargin(e,t,n,r),a=this._allDistMargin(e,t,n,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const s=this.toBBox,o=m_(e,0,t,s),a=m_(e,n-t,n,s);let l=cb(o)+cb(a);for(let u=t;u<n-t;u++){const h=e.children[u];g_(o,e.leaf?s(h):h),l+=cb(o)}for(let u=n-t-1;u>=t;u--){const h=e.children[u];g_(a,e.leaf?s(h):h),l+=cb(a)}return l}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)g_(t[r],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():wp(e[t],this.toBBox)}};function WSe(i,e,t){if(!t)return e.indexOf(i);for(let n=0;n<e.length;n++)if(t(i,e[n]))return n;return-1}function wp(i,e){m_(i,0,i.children.length,e,i)}function m_(i,e,t,n,r){r||(r=Op(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=i.children[s];g_(r,i.leaf?n(o):o)}return r}function g_(i,e){return i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY),i}function jSe(i,e){return i.minX-e.minX}function XSe(i,e){return i.minY-e.minY}function AR(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function cb(i){return i.maxX-i.minX+(i.maxY-i.minY)}function $Se(i,e){return(Math.max(e.maxX,i.maxX)-Math.min(e.minX,i.minX))*(Math.max(e.maxY,i.maxY)-Math.min(e.minY,i.minY))}function YSe(i,e){const t=Math.max(i.minX,e.minX),n=Math.max(i.minY,e.minY),r=Math.min(i.maxX,e.maxX),s=Math.min(i.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-n)}function pR(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function hb(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function Op(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function oU(i,e,t,n,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=n)continue;const o=e+Math.ceil((t-e)/n/2)*n;BW(i,o,e,t,r),s.push(e,o,o,t)}}const W6=[NaN,NaN,NaN,0];let mR;function QSe(){return mR||(mR=Rs(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),mR}const KSe=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ZSe=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,JSe=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,eTe=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function fb(i,e){return i.endsWith("%")?Number(i.substring(0,i.length-1))/e:Number(i)}function F_(i){throw new Error('failed to parse "'+i+'" as color')}function FW(i){if(i.toLowerCase().startsWith("rgb")){const s=i.match(ZSe)||i.match(KSe)||i.match(JSe);if(s){const o=s[4],a=100/255;return[qr(fb(s[1],a)+.5|0,0,255),qr(fb(s[2],a)+.5|0,0,255),qr(fb(s[3],a)+.5|0,0,255),o!==void 0?qr(fb(o,100),0,1):1]}F_(i)}if(i.startsWith("#")){if(eTe.test(i)){const s=i.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}F_(i)}const e=QSe();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=i,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=i,e.fillStyle===t&&F_(i));const n=e.fillStyle;if(n.startsWith("#")||n.startsWith("rgba"))return FW(n);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=a3(r[3]/255,3),r}function tTe(i){return typeof i=="string"?i:X6(i)}const nTe=1024,t_={};let gR=0;function iTe(i){if(i.length===4)return i;const e=i.slice();return e[3]=1,e}function _R(i){return i>.0031308?Math.pow(i,1/2.4)*269.025-14.025:i*3294.6}function yR(i){return i>.2068965?Math.pow(i,3):(i-4/29)*(108/841)}function vR(i){return i>10.314724?Math.pow((i+14.025)/269.025,2.4):i/3294.6}function xR(i){return i>.0088564?Math.pow(i,1/3):i/(108/841)+4/29}function aU(i){const e=vR(i[0]),t=vR(i[1]),n=vR(i[2]),r=xR(e*.222488403+t*.716873169+n*.06060791),s=500*(xR(e*.452247074+t*.399439023+n*.148375274)-r),o=200*(r-xR(e*.016863605+t*.117638439+n*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,i[3]]}function rTe(i){const e=(i[0]+16)/116,t=i[1],n=i[2]*Math.PI/180,r=yR(e),s=yR(e+t/500*Math.cos(n)),o=yR(e-t/200*Math.sin(n)),a=_R(s*3.021973625-r*1.617392459-o*.404875592),l=_R(s*-.943766287+r*1.916279586+o*.027607165),u=_R(s*.069407491-r*.22898585+o*1.159737864);return[qr(a+.5|0,0,255),qr(l+.5|0,0,255),qr(u+.5|0,0,255),i[3]]}function j6(i){if(i==="none")return W6;if(t_.hasOwnProperty(i))return t_[i];if(gR>=nTe){let t=0;for(const n in t_)(t++&3)===0&&(delete t_[n],--gR)}const e=FW(i);e.length!==4&&F_(i);for(const t of e)isNaN(t)&&F_(i);return t_[i]=e,++gR,e}function ng(i){return Array.isArray(i)?i:j6(i)}function X6(i){let e=i[0];e!=(e|0)&&(e=e+.5|0);let t=i[1];t!=(t|0)&&(t=t+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const r=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+e+","+t+","+n+","+r+")"}function lU(i){return i[0]>0&&i[1]>0}function sTe(i,e,t){return t===void 0&&(t=[0,0]),t[0]=i[0]*e+.5|0,t[1]=i[1]*e+.5|0,t}function pa(i,e){return Array.isArray(i)?i:(e===void 0?e=[i,i]:(e[0]=i,e[1]=i),e)}let s0=0;const ko=1<<s0++,Ei=1<<s0++,oa=1<<s0++,cu=1<<s0++,QA=1<<s0++,__=1<<s0++,db=Math.pow(2,s0)-1,$6={[ko]:"boolean",[Ei]:"number",[oa]:"string",[cu]:"color",[QA]:"number[]",[__]:"size"},oTe=Object.keys($6).map(Number).sort(Sh);function aTe(i){return i in $6}function y_(i){const e=[];for(const t of oTe)v_(i,t)&&e.push($6[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function v_(i,e){return(i&e)===e}function Of(i,e){return i===e}class Es{constructor(e,t){if(!aTe(e))throw new Error(`literal expressions must have a specific type, got ${y_(e)}`);this.type=e,this.value=t}}class lTe{constructor(e,t,...n){this.type=e,this.operator=t,this.args=n}}function kW(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function oo(i,e,t){switch(typeof i){case"boolean":{if(Of(e,oa))return new Es(oa,i?"true":"false");if(!v_(e,ko))throw new Error(`got a boolean, but expected ${y_(e)}`);return new Es(ko,i)}case"number":{if(Of(e,__))return new Es(__,pa(i));if(Of(e,ko))return new Es(ko,!!i);if(Of(e,oa))return new Es(oa,i.toString());if(!v_(e,Ei))throw new Error(`got a number, but expected ${y_(e)}`);return new Es(Ei,i)}case"string":{if(Of(e,cu))return new Es(cu,j6(i));if(Of(e,ko))return new Es(ko,!!i);if(!v_(e,oa))throw new Error(`got a string, but expected ${y_(e)}`);return new Es(oa,i)}}if(!Array.isArray(i))throw new Error("expression must be an array or a primitive value");if(i.length===0)throw new Error("empty expression");if(typeof i[0]=="string")return yTe(i,e,t);for(const n of i)if(typeof n!="number")throw new Error("expected an array of numbers");if(Of(e,__)){if(i.length!==2)throw new Error(`expected an array of two values for a size, got ${i.length}`);return new Es(__,i)}if(Of(e,cu)){if(i.length===3)return new Es(cu,[...i,1]);if(i.length===4)return new Es(cu,i);throw new Error(`expected an array of 3 or 4 values for a color, got ${i.length}`)}if(!v_(e,QA))throw new Error(`got an array of numbers, but expected ${y_(e)}`);return new Es(QA,i)}const lt={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},uTe={[lt.Get]:Vn(oi(1,1/0),uU),[lt.Var]:Vn(oi(1,1),cTe),[lt.Has]:Vn(oi(1,1/0),uU),[lt.Id]:Vn(hTe,Mp),[lt.Concat]:Vn(oi(2,1/0),Fi(oa)),[lt.GeometryType]:Vn(fTe,Mp),[lt.LineMetric]:Vn(Mp),[lt.Resolution]:Vn(bR,Mp),[lt.Zoom]:Vn(bR,Mp),[lt.Time]:Vn(bR,Mp),[lt.Any]:Vn(oi(2,1/0),Fi(ko)),[lt.All]:Vn(oi(2,1/0),Fi(ko)),[lt.Not]:Vn(oi(1,1),Fi(ko)),[lt.Equal]:Vn(oi(2,2),Fi(db)),[lt.NotEqual]:Vn(oi(2,2),Fi(db)),[lt.GreaterThan]:Vn(oi(2,2),Fi(Ei)),[lt.GreaterThanOrEqualTo]:Vn(oi(2,2),Fi(Ei)),[lt.LessThan]:Vn(oi(2,2),Fi(Ei)),[lt.LessThanOrEqualTo]:Vn(oi(2,2),Fi(Ei)),[lt.Multiply]:Vn(oi(2,1/0),cU),[lt.Coalesce]:Vn(oi(2,1/0),cU),[lt.Divide]:Vn(oi(2,2),Fi(Ei)),[lt.Add]:Vn(oi(2,1/0),Fi(Ei)),[lt.Subtract]:Vn(oi(2,2),Fi(Ei)),[lt.Clamp]:Vn(oi(3,3),Fi(Ei)),[lt.Mod]:Vn(oi(2,2),Fi(Ei)),[lt.Pow]:Vn(oi(2,2),Fi(Ei)),[lt.Abs]:Vn(oi(1,1),Fi(Ei)),[lt.Floor]:Vn(oi(1,1),Fi(Ei)),[lt.Ceil]:Vn(oi(1,1),Fi(Ei)),[lt.Round]:Vn(oi(1,1),Fi(Ei)),[lt.Sin]:Vn(oi(1,1),Fi(Ei)),[lt.Cos]:Vn(oi(1,1),Fi(Ei)),[lt.Atan]:Vn(oi(1,2),Fi(Ei)),[lt.Sqrt]:Vn(oi(1,1),Fi(Ei)),[lt.Match]:Vn(oi(4,1/0),hU,ATe),[lt.Between]:Vn(oi(3,3),Fi(Ei)),[lt.Interpolate]:Vn(oi(6,1/0),hU,pTe),[lt.Case]:Vn(oi(3,1/0),dTe,mTe),[lt.In]:Vn(oi(2,2),gTe),[lt.Number]:Vn(oi(1,1/0),Fi(db)),[lt.String]:Vn(oi(1,1/0),Fi(db)),[lt.Array]:Vn(oi(1,1/0),Fi(Ei)),[lt.Color]:Vn(oi(1,4),Fi(Ei)),[lt.Band]:Vn(oi(1,3),Fi(Ei)),[lt.Palette]:Vn(oi(2,2),_Te),[lt.ToString]:Vn(oi(1,1),Fi(ko|Ei|oa|cu))};function uU(i,e,t){const n=i.length-1,r=new Array(n);for(let s=0;s<n;++s){const o=i[s+1];switch(typeof o){case"number":{r[s]=new Es(Ei,o);break}case"string":{r[s]=new Es(oa,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function cTe(i,e,t){const n=i[1];if(typeof n!="string")throw new Error("expected a string argument for var operation");return t.variables.add(n),[new Es(oa,n)]}function hTe(i,e,t){t.featureId=!0}function fTe(i,e,t){t.geometryType=!0}function bR(i,e,t){t.mapState=!0}function Mp(i,e,t){const n=i[0];if(i.length!==1)throw new Error(`expected no arguments for ${n} operation`);return[]}function oi(i,e){return function(t,n,r){const s=t[0],o=t.length-1;if(i===e){if(o!==i){const a=i===1?"":"s";throw new Error(`expected ${i} argument${a} for ${s}, got ${o}`)}}else if(o<i||o>e){const a=e===1/0?`${i} or more`:`${i} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function cU(i,e,t){const n=i.length-1,r=new Array(n);for(let s=0;s<n;++s){const o=oo(i[s+1],e,t);r[s]=o}return r}function Fi(i){return function(e,t,n){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=oo(e[o+1],i,n);s[o]=a}return s}}function dTe(i,e,t){const n=i[0],r=i.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${n}, got ${r} instead`)}function hU(i,e,t){const n=i[0],r=i.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${n}, got ${r} instead`)}function ATe(i,e,t){const n=i.length-1,r=oa|Ei|ko,s=oo(i[1],r,t),o=oo(i[i.length-1],e,t),a=new Array(n-2);for(let l=0;l<n-2;l+=2){try{const u=oo(i[l+2],s.type,t);a[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=oo(i[l+3],o.type,t);a[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...a,o]}function pTe(i,e,t){const n=i[1];let r;switch(n[0]){case"linear":r=1;break;case"exponential":const l=n[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const s=new Es(Ei,r);let o;try{o=oo(i[2],Ei,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(i.length-3);for(let l=0;l<a.length;l+=2){try{const u=oo(i[l+3],Ei,t);a[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=oo(i[l+4],e,t);a[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,o,...a]}function mTe(i,e,t){const n=oo(i[i.length-1],e,t),r=new Array(i.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=oo(i[s+1],ko,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=oo(i[s+2],n.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=n,r}function gTe(i,e,t){let n=i[2];if(!Array.isArray(n))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof n[0]=="string"){if(n[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],r=oa}else r=Ei;const s=new Array(n.length);for(let a=0;a<s.length;a++)try{const l=oo(n[a],r,t);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[oo(i[1],r,t),...s]}function _Te(i,e,t){let n;try{n=oo(i[1],Ei,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=i[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=oo(r[o],cu,t)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Es))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[n,...s]}function Vn(...i){return function(e,t,n){const r=e[0];let s;for(let o=0;o<i.length;o++){const a=i[o](e,t,n);if(o==i.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new lTe(t,r,...s)}}function yTe(i,e,t){const n=i[0],r=uTe[n];if(!r)throw new Error(`unknown operator: ${n}`);return r(i,e,t)}function GW(i){if(!i)return"";const e=i.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return GW(i.getGeometries()[0]);default:return""}}function zW(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function qh(i,e,t){const n=oo(i,e,t);return vu(n)}function vu(i,e){if(i instanceof Es){if(i.type===cu&&typeof i.value=="string"){const n=j6(i.value);return function(){return n}}return function(){return i.value}}const t=i.operator;switch(t){case lt.Number:case lt.String:case lt.Coalesce:return vTe(i);case lt.Get:case lt.Var:case lt.Has:return xTe(i);case lt.Id:return n=>n.featureId;case lt.GeometryType:return n=>n.geometryType;case lt.Concat:{const n=i.args.map(r=>vu(r));return r=>"".concat(...n.map(s=>s(r).toString()))}case lt.Resolution:return n=>n.resolution;case lt.Any:case lt.All:case lt.Between:case lt.In:case lt.Not:return STe(i);case lt.Equal:case lt.NotEqual:case lt.LessThan:case lt.LessThanOrEqualTo:case lt.GreaterThan:case lt.GreaterThanOrEqualTo:return bTe(i);case lt.Multiply:case lt.Divide:case lt.Add:case lt.Subtract:case lt.Clamp:case lt.Mod:case lt.Pow:case lt.Abs:case lt.Floor:case lt.Ceil:case lt.Round:case lt.Sin:case lt.Cos:case lt.Atan:case lt.Sqrt:return TTe(i);case lt.Case:return ETe(i);case lt.Match:return wTe(i);case lt.Interpolate:return MTe(i);case lt.ToString:return RTe(i);default:throw new Error(`Unsupported operator ${t}`)}}function vTe(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=vu(i.args[s]);switch(t){case lt.Coalesce:return s=>{for(let o=0;o<n;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case lt.Number:case lt.String:return s=>{for(let o=0;o<n;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function xTe(i,e){const n=i.args[0].value;switch(i.operator){case lt.Get:return r=>{const s=i.args;let o=r.properties[n];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case lt.Var:return r=>r.variables[n];case lt.Has:return r=>{const s=i.args;if(!(n in r.properties))return!1;let o=r.properties[n];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function bTe(i,e){const t=i.operator,n=vu(i.args[0]),r=vu(i.args[1]);switch(t){case lt.Equal:return s=>n(s)===r(s);case lt.NotEqual:return s=>n(s)!==r(s);case lt.LessThan:return s=>n(s)<r(s);case lt.LessThanOrEqualTo:return s=>n(s)<=r(s);case lt.GreaterThan:return s=>n(s)>r(s);case lt.GreaterThanOrEqualTo:return s=>n(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function STe(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=vu(i.args[s]);switch(t){case lt.Any:return s=>{for(let o=0;o<n;++o)if(r[o](s))return!0;return!1};case lt.All:return s=>{for(let o=0;o<n;++o)if(!r[o](s))return!1;return!0};case lt.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case lt.In:return s=>{const o=r[0](s);for(let a=1;a<n;++a)if(o===r[a](s))return!0;return!1};case lt.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function TTe(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=vu(i.args[s]);switch(t){case lt.Multiply:return s=>{let o=1;for(let a=0;a<n;++a)o*=r[a](s);return o};case lt.Divide:return s=>r[0](s)/r[1](s);case lt.Add:return s=>{let o=0;for(let a=0;a<n;++a)o+=r[a](s);return o};case lt.Subtract:return s=>r[0](s)-r[1](s);case lt.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case lt.Mod:return s=>r[0](s)%r[1](s);case lt.Pow:return s=>Math.pow(r[0](s),r[1](s));case lt.Abs:return s=>Math.abs(r[0](s));case lt.Floor:return s=>Math.floor(r[0](s));case lt.Ceil:return s=>Math.ceil(r[0](s));case lt.Round:return s=>Math.round(r[0](s));case lt.Sin:return s=>Math.sin(r[0](s));case lt.Cos:return s=>Math.cos(r[0](s));case lt.Atan:return n===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case lt.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function ETe(i,e){const t=i.args.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=vu(i.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(n[s](r))return n[s+1](r);return n[t-1](r)}}function wTe(i,e){const t=i.args.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=vu(i.args[r]);return r=>{const s=n[0](r);for(let o=1;o<t-1;o+=2)if(s===n[o](r))return n[o+1](r);return n[t-1](r)}}function MTe(i,e){const t=i.args.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=vu(i.args[r]);return r=>{const s=n[0](r),o=n[1](r);let a,l;for(let u=2;u<t;u+=2){const h=n[u](r);let d=n[u+1](r);const _=Array.isArray(d);if(_&&(d=iTe(d)),h>=o)return u===2?d:_?CTe(s,o,a,l,h,d):x_(s,o,a,l,h,d);a=h,l=d}return l}}function RTe(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=vu(i.args[s]);switch(t){case lt.ToString:return s=>{const o=r[0](s);return i.args[0].type===cu?X6(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function x_(i,e,t,n,r,s){const o=r-t;if(o===0)return n;const a=e-t,l=i===1?a/o:(Math.pow(i,a)-1)/(Math.pow(i,o)-1);return n+l*(s-n)}function CTe(i,e,t,n,r,s){if(r-t===0)return n;const a=aU(n),l=aU(s);let u=l[2]-a[2];u>180?u-=360:u<-180&&(u+=360);const h=[x_(i,e,t,a[0],r,l[0]),x_(i,e,t,a[1],r,l[1]),a[2]+x_(i,e,t,0,r,u),x_(i,e,t,n[3],r,s[3])];return rTe(h)}const li={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function NTe(i,e,t){const n=i;let r=!0,s=!1,o=!1;const a=[qS(n,ai.LOAD,function(){o=!0,s||e()})];return n.src&&tW?(s=!0,n.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():t())})):a.push(qS(n,ai.ERROR,t)),function(){r=!1,a.forEach(Ir)}}function DTe(i,e){return new Promise((t,n)=>{function r(){o(),t(i)}function s(){o(),n(new Error("Image load error"))}function o(){i.removeEventListener("load",r),i.removeEventListener("error",s)}i.addEventListener("load",r),i.addEventListener("error",s)})}function PTe(i,e){return e&&(i.src=e),i.src&&tW?new Promise((t,n)=>i.decode().then(()=>t(i)).catch(r=>i.complete&&i.width?t(i):n(r))):DTe(i)}class LTe{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,n){const r=SR(e,t,n);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,n){const r=SR(e,t,n);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,n,r,s){const o=SR(e,t,n),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===li.IDLE&&r.load(),r.getImageState()===li.LOADING?r.ready().then(()=>{this.patternCache_[o]=QS().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=QS().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function SR(i,e,t){const n=t?ng(t):"null";return e+":"+i+":"+n}const Rl=new LTe;let n_=null;class VW extends o3{constructor(e,t,n,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=n,this.canvas_={},this.color_=s,this.imageState_=r===void 0?li.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===li.LOADED){n_||(n_=Rs(1,1,void 0,{willReadFrequently:!0})),n_.drawImage(this.image_,0,0);try{n_.getImageData(0,0,1,1),this.tainted_=!1}catch{n_=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ai.CHANGE)}handleImageError_(){this.imageState_=li.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=li.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],n=Rs(e,t);n.fillRect(0,0,e,t),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===li.IDLE){this.image_||this.initializeImage_(),this.imageState_=li.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&PTe(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==li.LOADED)return;const t=this.image_,n=Rs(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=n.canvas;n.scale(e,e),n.drawImage(t,0,0),n.globalCompositeOperation="multiply",n.fillStyle=tTe(this.color_),n.fillRect(0,0,r.width/e,r.height/e),n.globalCompositeOperation="destination-in",n.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===li.LOADED||this.imageState_===li.ERROR)e();else{const t=()=>{(this.imageState_===li.LOADED||this.imageState_===li.ERROR)&&(this.removeEventListener(ai.CHANGE,t),e())};this.addEventListener(ai.CHANGE,t)}})),this.ready_}}function Y6(i,e,t,n,r,s){let o=e===void 0?void 0:Rl.get(e,t,r);return o||(o=new VW(i,i&&"src"in i?i.src||void 0:e,t,n,r),Rl.set(e,t,r,o,s)),s&&o&&!Rl.getPattern(e,t,r)&&Rl.set(e,t,r,o,s),o}function Zu(i){return i?Array.isArray(i)?X6(i):typeof i=="object"&&"src"in i?OTe(i):i:null}function OTe(i){if(!i.offset||!i.size)return Rl.getPattern(i.src,"anonymous",i.color);const e=i.src+":"+i.offset,t=Rl.getPattern(e,void 0,i.color);if(t)return t;const n=Rl.get(i.src,"anonymous",null);if(n.getImageState()!==li.LOADED)return null;const r=Rs(i.size[0],i.size[1]);return r.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),Y6(r.canvas,e,void 0,li.LOADED,i.color,!0),Rl.getPattern(e,void 0,i.color)}const qW="10px sans-serif",aa="#000",ig="round",Th=[],Eh=0,rg="round",By=10,Uy="#000",Fy="center",KS="middle",SA=[0,0,0,0],ky=1,Ip=new bc;let i_=null,fU;const w4={},ITe=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function BTe(i,e,t){return`${i} ${e} 16px "${t}"`}const UTe=function(){let e,t;async function n(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=T4(s),l=a.families[0].toLowerCase(),u=a.weight;return o.some(h=>{const d=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),_=S4[h.weight]||h.weight;return d===l&&h.style===a.style&&_==u})}async function r(){await t.ready;let s=!0;const o=Ip.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const u=a[l];let h=o[u];h<100&&(await n(u)?(f2(w4),Ip.set(u,100)):(h+=10,Ip.set(u,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=y6?self.fonts:document.fonts);const o=T4(s);if(!o)return;const a=o.families;let l=!1;for(const u of a){if(ITe.has(u))continue;const h=BTe(o.style,o.weight,u);Ip.get(h)===void 0&&(Ip.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(r,100))}}(),FTe=function(){let i;return function(e){let t=w4[e];if(t==null){if(y6){const n=T4(e),r=HW(e,"g");t=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=e,document.body.appendChild(i),t=i.offsetHeight,document.body.removeChild(i);w4[e]=t}return t}}();function HW(i,e){return i_||(i_=Rs(1,1)),i!=fU&&(i_.font=i,fU=i_.font),i_.measureText(e)}function WW(i,e){return HW(i,e).width}function dU(i,e,t){if(e in t)return t[e];const n=e.split(`
`).reduce((r,s)=>Math.max(r,WW(i,s)),0);return t[e]=n,n}function kTe(i,e){const t=[],n=[],r=[];let s=0,o=0,a=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const d=e[u];if(d===`
`||u===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const _=e[u+1]||i.font,x=WW(_,d);t.push(x),o+=x;const b=FTe(_);n.push(b),l=Math.max(l,b)}return{width:s,height:a,widths:t,heights:n,lineWidths:r}}function GTe(i,e,t,n,r,s,o,a,l,u,h){i.save(),t!==1&&(i.globalAlpha===void 0?i.globalAlpha=d=>d.globalAlpha*=t:i.globalAlpha*=t),e&&i.transform.apply(i,e),n.contextInstructions?(i.translate(l,u),i.scale(h[0],h[1]),zTe(n,i)):h[0]<0||h[1]<0?(i.translate(l,u),i.scale(h[0],h[1]),i.drawImage(n,r,s,o,a,0,0,o,a)):i.drawImage(n,r,s,o,a,l,u,o*h[0],a*h[1]),i.restore()}function zTe(i,e){const t=i.contextInstructions;for(let n=0,r=t.length;n<r;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}class v3{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=pa(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new v3({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Ii()}getImage(e){return Ii()}getHitDetectionImage(){return Ii()}getPixelRatio(e){return 1}getImageState(){return Ii()}getImageSize(){return Ii()}getOrigin(){return Ii()}getSize(){return Ii()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=pa(e)}listenImageChange(e){Ii()}load(){Ii()}unlistenImageChange(e){Ii()}ready(){return Promise.resolve()}}class x3 extends v3{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?li.LOADING:li.LOADED,this.imageState_===li.LOADING&&this.ready().then(()=>this.imageState_=li.LOADED),this.render()}clone(){const e=this.getScale(),t=new x3({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),n=this.getScaleArray();return[e[0]/2-t[0]/n[0],e[1]/2+t[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),n=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Rl.get(n,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=Rs(o,o);this.draw_(s,a,e),r=a.canvas,Rl.set(n,null,null,new VW(r,void 0,null,li.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,n){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const G=r;r=s,s=G}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),u=Math.sqrt(s*s-l*l),h=r-u,d=Math.sqrt(l*l+h*h),_=d/l;if(e==="miter"&&_<=n)return _*t;const x=t/2/_,b=t/2*(h/d),E=Math.sqrt((r+x)*(r+x)+b*b)-r;if(this.radius2_===void 0||e==="bevel")return E*2;const w=r*Math.sin(a),L=Math.sqrt(r*r-w*w),D=s-L,B=Math.sqrt(w*w+D*D)/w;if(B<=n){const G=B*t/2-s-r;return 2*Math.max(E,G)}return E*2}createRenderOptions(){let e=ig,t=rg,n=0,r=null,s=0,o,a=0;this.stroke_&&(o=Zu(this.stroke_.getColor()??Uy),a=this.stroke_.getWidth()??ky,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??rg,e=this.stroke_.getLineCap()??ig,n=this.stroke_.getMiterLimit()??By);const l=this.calculateLineJoinSize_(t,a,n),u=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*u+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,n){if(t.scale(n,n),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=aa),t.fillStyle=Zu(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let n=this.fill_.getColor(),r=0;typeof n=="string"&&(n=ng(n)),n===null?r=1:Array.isArray(n)&&(r=n.length===4?n[3]:1),r===0&&(t=Rs(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const n=this.radius;if(t===1/0)e.arc(0,0,n,0,2*Math.PI);else{const r=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,u=a%2===0?n:r;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=aa,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class b3 extends x3{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new b3({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class sd{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new sd({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Y6(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===li.IDLE&&t.load(),t.getImageState()===li.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Ui(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:ng(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function AU(i,e,t,n){return t!==void 0&&n!==void 0?[t/i,n/e]:t!==void 0?t/i:n!==void 0?n/e:1}class _2 extends v3{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,n=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:n,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;Ki(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||Ui(o)),Ki(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Ki(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=li.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?li.LOADED:li.IDLE:l=li.LOADING:l=li.LOADED),this.color_=e.color!==void 0?ng(e.color):null,this.iconImage_=Y6(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,h;if(e.size)[u,h]=e.size;else{const d=this.getImage(1);if(d.width&&d.height)u=d.width,h=d.height;else if(d instanceof HTMLImageElement){this.initialOptions_=e;const _=()=>{if(this.unlistenImageChange(_),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(AU(x[0],x[1],e.width,e.height))};this.listenImageChange(_);return}}u!==void 0&&this.setScale(AU(u,h,e.width,e.height))}}clone(){let e,t,n;return this.initialOptions_?(t=this.initialOptions_.width,n=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new _2({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),n=this.getScaleArray();return[e[0]-t[0]/n[0],e[1]+t[1]/n[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),n=this.iconImage_.getSize();if(!t||!n)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=n[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=n[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==li.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==li.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ai.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ai.CHANGE,e)}ready(){return this.iconImage_.ready()}}class UA{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new UA({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class wh{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=pU,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new wh({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=pU,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function VTe(i){let e;if(typeof i=="function")e=i;else{let t;Array.isArray(i)?t=i:(Ki(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[i]),e=function(){return t}}return e}let TR=null;function jW(i,e){if(!TR){const t=new sd({color:"rgba(255,255,255,0.4)"}),n=new UA({color:"#3399CC",width:1.25});TR=[new wh({image:new b3({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return TR}function pU(i){return i.getGeometry()}const qTe="#333";class S3{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=pa(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new sd({color:qTe}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new S3({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=pa(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function HTe(i){return!0}function WTe(i){const e=kW(),t=jTe(i,e),n=zW();return function(r,s){if(n.properties=r.getPropertiesInternal(),n.resolution=s,e.featureId){const o=r.getId();o!==void 0?n.featureId=o:n.featureId=null}return e.geometryType&&(n.geometryType=GW(r.getGeometry())),t(n)}}function mU(i){const e=kW(),t=i.length,n=new Array(t);for(let o=0;o<t;++o)n[o]=M4(i[o],e);const r=zW(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const u=o.getId();u!==void 0?r.featureId=u:r.featureId=null}let l=0;for(let u=0;u<t;++u){const h=n[u](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function jTe(i,e){const t=i.length,n=new Array(t);for(let r=0;r<t;++r){const s=i[r],o="filter"in s?qh(s.filter,ko,e):HTe;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let u=0;u<l;++u)a[u]=M4(s.style[u],e)}else a=[M4(s.style,e)];n[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const l=n[a].filter;if(l(r)&&!(i[a].else&&o)){o=!0;for(const u of n[a].styles){const h=u(r);h&&s.push(h)}}}return s}}function M4(i,e){const t=Gy(i,"",e),n=zy(i,"",e),r=XTe(i,e),s=$Te(i,e),o=la(i,"z-index",e);if(!t&&!n&&!r&&!s&&!Jm(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const a=new wh;return function(l){let u=!0;if(t){const h=t(l);h&&(u=!1),a.setFill(h)}if(n){const h=n(l);h&&(u=!1),a.setStroke(h)}if(r){const h=r(l);h&&(u=!1),a.setText(h)}if(s){const h=s(l);h&&(u=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),u?null:a}}function Gy(i,e,t){let n;if(e+"fill-pattern-src"in i)n=ZTe(i,e+"fill-",t);else{if(i[e+"fill-color"]==="none")return s=>null;n=Q6(i,e+"fill-color",t)}if(!n)return null;const r=new sd;return function(s){const o=n(s);return o===W6?null:(r.setColor(o),r)}}function zy(i,e,t){const n=la(i,e+"stroke-width",t),r=Q6(i,e+"stroke-color",t);if(!n&&!r)return null;const s=hh(i,e+"stroke-line-cap",t),o=hh(i,e+"stroke-line-join",t),a=XW(i,e+"stroke-line-dash",t),l=la(i,e+"stroke-line-dash-offset",t),u=la(i,e+"stroke-miter-limit",t),h=new UA;return function(d){if(r){const _=r(d);if(_===W6)return null;h.setColor(_)}if(n&&h.setWidth(n(d)),s){const _=s(d);if(_!=="butt"&&_!=="round"&&_!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(_)}if(o){const _=o(d);if(_!=="bevel"&&_!=="round"&&_!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(_)}return a&&h.setLineDash(a(d)),l&&h.setLineDashOffset(l(d)),u&&h.setMiterLimit(u(d)),h}}function XTe(i,e){const t="text-",n=hh(i,t+"value",e);if(!n)return null;const r=Gy(i,t,e),s=Gy(i,t+"background-",e),o=zy(i,t,e),a=zy(i,t+"background-",e),l=hh(i,t+"font",e),u=la(i,t+"max-angle",e),h=la(i,t+"offset-x",e),d=la(i,t+"offset-y",e),_=um(i,t+"overflow",e),x=hh(i,t+"placement",e),b=la(i,t+"repeat",e),R=T3(i,t+"scale",e),E=um(i,t+"rotate-with-view",e),w=la(i,t+"rotation",e),L=hh(i,t+"align",e),D=hh(i,t+"justify",e),O=hh(i,t+"baseline",e),B=um(i,t+"keep-upright",e),G=XW(i,t+"padding",e),k=E3(i,t+"declutter-mode"),z=new S3({declutterMode:k});return function(F){if(z.setText(n(F)),r&&z.setFill(r(F)),s&&z.setBackgroundFill(s(F)),o&&z.setStroke(o(F)),a&&z.setBackgroundStroke(a(F)),l&&z.setFont(l(F)),u&&z.setMaxAngle(u(F)),h&&z.setOffsetX(h(F)),d&&z.setOffsetY(d(F)),_&&z.setOverflow(_(F)),x){const q=x(F);if(q!=="point"&&q!=="line")throw new Error("Expected point or line for text-placement");z.setPlacement(q)}if(b&&z.setRepeat(b(F)),R&&z.setScale(R(F)),E&&z.setRotateWithView(E(F)),w&&z.setRotation(w(F)),L){const q=L(F);if(q!=="left"&&q!=="center"&&q!=="right"&&q!=="end"&&q!=="start")throw new Error("Expected left, right, center, start, or end for text-align");z.setTextAlign(q)}if(D){const q=D(F);if(q!=="left"&&q!=="right"&&q!=="center")throw new Error("Expected left, right, or center for text-justify");z.setJustify(q)}if(O){const q=O(F);if(q!=="bottom"&&q!=="top"&&q!=="middle"&&q!=="alphabetic"&&q!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");z.setTextBaseline(q)}return G&&z.setPadding(G(F)),B&&z.setKeepUpright(B(F)),z}}function $Te(i,e){return"icon-src"in i?YTe(i,e):"shape-points"in i?QTe(i,e):"circle-radius"in i?KTe(i,e):null}function YTe(i,e){const t="icon-",n=t+"src",r=$W(i[n],n),s=ZS(i,t+"anchor",e),o=T3(i,t+"scale",e),a=la(i,t+"opacity",e),l=ZS(i,t+"displacement",e),u=la(i,t+"rotation",e),h=um(i,t+"rotate-with-view",e),d=_U(i,t+"anchor-origin"),_=yU(i,t+"anchor-x-units"),x=yU(i,t+"anchor-y-units"),b=n3e(i,t+"color"),R=e3e(i,t+"cross-origin"),E=t3e(i,t+"offset"),w=_U(i,t+"offset-origin"),L=JS(i,t+"width"),D=JS(i,t+"height"),O=JTe(i,t+"size"),B=E3(i,t+"declutter-mode"),G=new _2({src:r,anchorOrigin:d,anchorXUnits:_,anchorYUnits:x,color:b,crossOrigin:R,offset:E,offsetOrigin:w,height:D,width:L,size:O,declutterMode:B});return function(k){return a&&G.setOpacity(a(k)),l&&G.setDisplacement(l(k)),u&&G.setRotation(u(k)),h&&G.setRotateWithView(h(k)),o&&G.setScale(o(k)),s&&G.setAnchor(s(k)),G}}function QTe(i,e){const t="shape-",n=t+"points",r=t+"radius",s=R4(i[n],n),o=R4(i[r],r),a=Gy(i,t,e),l=zy(i,t,e),u=T3(i,t+"scale",e),h=ZS(i,t+"displacement",e),d=la(i,t+"rotation",e),_=um(i,t+"rotate-with-view",e),x=JS(i,t+"radius2"),b=JS(i,t+"angle"),R=E3(i,t+"declutter-mode"),E=new x3({points:s,radius:o,radius2:x,angle:b,declutterMode:R});return function(w){return a&&E.setFill(a(w)),l&&E.setStroke(l(w)),h&&E.setDisplacement(h(w)),d&&E.setRotation(d(w)),_&&E.setRotateWithView(_(w)),u&&E.setScale(u(w)),E}}function KTe(i,e){const t="circle-",n=Gy(i,t,e),r=zy(i,t,e),s=la(i,t+"radius",e),o=T3(i,t+"scale",e),a=ZS(i,t+"displacement",e),l=la(i,t+"rotation",e),u=um(i,t+"rotate-with-view",e),h=E3(i,t+"declutter-mode"),d=new b3({radius:5,declutterMode:h});return function(_){return s&&d.setRadius(s(_)),n&&d.setFill(n(_)),r&&d.setStroke(r(_)),a&&d.setDisplacement(a(_)),l&&d.setRotation(l(_)),u&&d.setRotateWithView(u(_)),o&&d.setScale(o(_)),d}}function la(i,e,t){if(!(e in i))return;const n=qh(i[e],Ei,t);return function(r){return R4(n(r),e)}}function hh(i,e,t){if(!(e in i))return null;const n=qh(i[e],oa,t);return function(r){return $W(n(r),e)}}function ZTe(i,e,t){const n=hh(i,e+"pattern-src",t),r=gU(i,e+"pattern-offset",t),s=gU(i,e+"pattern-size",t),o=Q6(i,e+"color",t);return function(a){return{src:n(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function um(i,e,t){if(!(e in i))return null;const n=qh(i[e],ko,t);return function(r){const s=n(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Q6(i,e,t){if(!(e in i))return null;const n=qh(i[e],cu,t);return function(r){return YW(n(r),e)}}function XW(i,e,t){if(!(e in i))return null;const n=qh(i[e],QA,t);return function(r){return y2(n(r),e)}}function ZS(i,e,t){if(!(e in i))return null;const n=qh(i[e],QA,t);return function(r){const s=y2(n(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function gU(i,e,t){if(!(e in i))return null;const n=qh(i[e],QA,t);return function(r){return QW(n(r),e)}}function T3(i,e,t){if(!(e in i))return null;const n=qh(i[e],QA|Ei,t);return function(r){return i3e(n(r),e)}}function JS(i,e){const t=i[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function JTe(i,e){const t=i[e];if(t!==void 0){if(typeof t=="number")return pa(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function e3e(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function _U(i,e){const t=i[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function yU(i,e){const t=i[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function t3e(i,e){const t=i[e];if(t!==void 0)return y2(t,e)}function E3(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function n3e(i,e){const t=i[e];if(t!==void 0)return YW(t,e)}function y2(i,e){if(!Array.isArray(i))throw new Error(`Expected an array for ${e}`);const t=i.length;for(let n=0;n<t;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${e}`);return i}function $W(i,e){if(typeof i!="string")throw new Error(`Expected a string for ${e}`);return i}function R4(i,e){if(typeof i!="number")throw new Error(`Expected a number for ${e}`);return i}function YW(i,e){if(typeof i=="string")return i;const t=y2(i,e),n=t.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function QW(i,e){const t=y2(i,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function i3e(i,e){return typeof i=="number"?i:QW(i,e)}const vU={RENDER_ORDER:"renderOrder"};class KW extends y3{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(vU.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const n=this.getDeclutter();n in e.declutter||(e.declutter[n]=new UW(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(vU.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?jW:e;const t=r3e(e);this.styleFunction_=e===null?void 0:VTe(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function r3e(i){if(i===void 0)return jW;if(!i)return null;if(typeof i=="function"||i instanceof wh)return i;if(!Array.isArray(i))return mU([i]);if(i.length===0)return[];const e=i.length,t=i[0];if(t instanceof wh){const r=new Array(e);for(let s=0;s<e;++s){const o=i[s];if(!(o instanceof wh))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=i[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return WTe(r)}return mU(i)}class ZW extends Vh{constructor(e,t,n,r){super(e),this.inversePixelTransform=t,this.frameState=n,this.context=r}}class s3e extends r3{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Ii()}calculateMatrices2D(e){const t=e.viewState,n=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Uh(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),xW(r,n)}forEachFeatureAtCoordinate(e,t,n,r,s,o,a,l){let u;const h=t.viewState;function d(O,B,G,k){return s.call(o,B,O?G:null,k)}const _=h.projection,x=hW(e.slice(),_),b=[[0,0]];if(_.canWrapX()&&r){const O=_.getExtent(),B=ir(O);b.push([-B,0],[B,0])}const R=t.layerStatesArray,E=R.length,w=[],L=[];for(let O=0;O<b.length;O++)for(let B=E-1;B>=0;--B){const G=R[B],k=G.layer;if(k.hasRenderer()&&H6(G,h)&&a.call(l,k)){const z=k.getRenderer(),F=k.getSource();if(z&&F){const q=F.getWrapX()?x:e,H=d.bind(null,G.managed);L[0]=q[0]+b[O][0],L[1]=q[1]+b[O][1],u=z.forEachFeatureAtCoordinate(L,t,n,H,w)}if(u)return u}}if(w.length===0)return;const D=1/w.length;return w.forEach((O,B)=>O.distanceSq+=B*D),w.sort((O,B)=>O.distanceSq-B.distanceSq),w.some(O=>u=O.callback(O.feature,O.layer,O.geometry)),u}hasFeatureAtCoordinate(e,t,n,r,s,o){return this.forEachFeatureAtCoordinate(e,t,n,r,Ny,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){Ii()}scheduleExpireIconCache(e){Rl.canExpireCache()&&e.postRenderFunctions.push(o3e)}}function o3e(i,e){Rl.expire()}class a3e extends s3e{constructor(e){super(e),this.fontChangeListenerKey_=Bi(Ip,Zm.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=g3+" ol-layers";const n=e.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const n=this.getMap();if(n.hasListener(e)){const r=new ZW(e,void 0,t);n.dispatchEvent(r)}}disposeInternal(){Ir(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ml.PRECOMPOSE,e);const t=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);t.some(a=>a.layer instanceof KW&&a.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=t.length;a<l;++a){const u=t[a];e.layerIndex=a;const h=u.layer,d=h.getSourceState();if(!H6(u,r)||d!="ready"&&d!="undefined"){h.unrender();continue}const _=h.render(e,o);_&&(_!==o&&(this.children_.push(_),o=_),s.push(u))}this.declutter(e,s),gSe(this.element_,this.children_),this.dispatchRenderEvent(Ml.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let n=t.length-1;n>=0;--n){const r=t[n],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(n=>n.layer.renderDeferred(e))}}}function JW(i){if(i instanceof y3){i.setMapInternal(null);return}i instanceof yg&&i.getLayers().forEach(JW)}function ej(i,e){if(i instanceof y3){i.setMapInternal(e);return}if(i instanceof yg){const t=i.getLayers().getArray();for(let n=0,r=t.length;n<r;++n)ej(t[n],e)}}let l3e=class extends bc{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=u3e(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Vxe,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=gu(),this.pixelToCoordinateTransform_=gu(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||xSe(),this.interactions=t.interactions||qSe({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Wxe(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(vo.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(vo.VIEW,this.handleViewChanged_),this.addChangeListener(vo.SIZE,this.handleSizeChanged_),this.addChangeListener(vo.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const n=this;e.view&&!(e.view instanceof Wu)&&e.view.then(function(r){n.setView(new Wu(r))}),this.controls.addEventListener(sa.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(sa.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(sa.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(sa.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(sa.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(sa.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){ej(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:Ny,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const n=[];return this.forEachFeatureAtPixel(e,function(r){n.push(r)},t),n}getAllLayers(){const e=[];function t(n){n.forEach(function(r){r instanceof yg?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Ny,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const n=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=n.width/r[0],o=n.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-n.left)/s,(a.clientY-n.top)/o]}getTarget(){return this.get(vo.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return b4(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Vs(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(vo.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ku){t.setLayers(e);return}const n=t.getLayers();n.clear(),n.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,n=e.length;t<n;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=oh(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Vs(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(vo.SIZE)}getView(){return this.get(vo.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,n,r){return jxe(this.frameState_,e,t,n,r)}handleBrowserEvent(e,t){t=t||e.type;const n=new kf(t,this,e);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,n=t.type;if(n===A4.POINTERDOWN||n===ai.WHEEL||n===ai.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[xo.ANIMATING]||o[xo.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ml.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ml.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Lp(Gf.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Lp(Gf.LOADSTART,this,e))));const n=this.postRenderFunctions_;if(e)for(let r=0,s=n.length;r<s;++r)n[r](this,e);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)Ir(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ai.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ai.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new a3e(this)),this.mapBrowserEventHandler_=new qxe(this,this.moveTolerance_);for(const s in $r)this.mapBrowserEventHandler_.addEventListener($r[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ai.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ai.WHEEL,this.boundHandleBrowserEvent_,nW?{passive:!1}:!1);let n;if(this.keyboardEventTarget_)n=this.keyboardEventTarget_;else{const s=t.getRootNode();n=s instanceof ShadowRoot?s.host:t}this.targetChangeHandlerKeys_=[Bi(n,ai.KEYDOWN,this.handleBrowserEvent,this),Bi(n,ai.KEYPRESS,this.handleBrowserEvent,this)];const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ir(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ir(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Bi(e,Zm.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Bi(e,ai.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ir),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new qf("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Bi(e,Zm.PROPERTYCHANGE,this.render,this),Bi(e,ai.CHANGE,this.render,this),Bi(e,"addlayer",this.handleLayerAdd_,this),Bi(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,n=e.length;t<n;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){JW(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),n=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&lU(t)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:_4(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:Ui(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=_4(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!f3(this.previousExtent_)&&!Py(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Lp(Gf.MOVESTART,this,r)),this.previousExtent_=l3(this.previousExtent_)),this.previousExtent_&&!s.viewHints[xo.ANIMATING]&&!s.viewHints[xo.INTERACTING]&&!Py(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Lp(Gf.MOVEEND,this,s)),iW(s.extent,this.previousExtent_))),this.dispatchEvent(new Lp(Gf.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Gf.LOADSTART)||this.hasListener(Gf.LOADEND)||this.hasListener(Ml.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new qf("removelayer",t)),this.set(vo.LAYERGROUP,e)}setSize(e){this.set(vo.SIZE,e)}setTarget(e){this.set(vo.TARGET,e)}setView(e){if(!e||e instanceof Wu){this.set(vo.VIEW,e);return}this.set(vo.VIEW,new Wu);const t=this;e.then(function(n){t.setView(new Wu(n))})}updateSize(){const e=this.getTargetElement();let t;if(e){const r=getComputedStyle(e),s=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[Math.max(0,s),Math.max(0,o)],!lU(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&dW("No map visible because the map container's width or height are 0."))}const n=this.getSize();t&&(!n||!_d(t,n))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function u3e(i){let e=null;i.keyboardEventTarget!==void 0&&(e=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const t={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new yg({layers:i.layers});t[vo.LAYERGROUP]=n,t[vo.TARGET]=i.target,t[vo.VIEW]=i.view instanceof Wu?i.view:new Wu;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new Ku(i.controls.slice()):(Ki(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=i.controls));let s;i.interactions!==void 0&&(Array.isArray(i.interactions)?s=new Ku(i.interactions.slice()):(Ki(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new Ku(i.overlays.slice()):(Ki(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=i.overlays):o=new Ku,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}class K6 extends o3{constructor(e,t,n){super(),n=n||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ai.CHANGE)}release(){this.setState(En.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==En.EMPTY){if(this.state!==En.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Ii()}getAlpha(e,t){if(!this.transition_)return 1;let n=this.transitionStarts_[e];if(!n)n=t,this.transitionStarts_[e]=n;else if(n===-1)return 1;const r=t-n+1e3/60;return r>=this.transition_?1:fW(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function C4(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}const c3e=new Error("disposed"),h3e=[256,256];class xU extends K6{constructor(e){const t=En.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=C4(this.data_);return e?[e.width,e.height]:h3e}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==En.IDLE&&this.state!==En.ERROR)return;this.state=En.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=En.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=En.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(c3e),this.controller_=null),super.disposeInternal()}}class tj extends K6{constructor(e,t,n,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=En.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=En.ERROR,this.unlistenImage_(),this.image_=f3e(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=En.LOADED:this.state=En.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==En.ERROR&&(this.state=En.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==En.IDLE&&(this.state=En.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=NTe(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function f3e(){const i=Rs(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class Z6{constructor(e,t,n,r){this.minX=e,this.maxX=t,this.minY=n,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Rp(i,e,t,n,r){return r!==void 0?(r.minX=i,r.maxX=e,r.minY=t,r.maxY=n,r):new Z6(i,e,t,n)}let ER;const cm=[];function bU(i,e,t,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(e,t),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(e,n)+1,Math.max(t,r)),i.restore()}function wR(i,e){return Math.abs(i[e*4]-210)>2||Math.abs(i[e*4+3]-.75*255)>2}function d3e(){if(ER===void 0){const i=Rs(6,6,cm);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",bU(i,4,5,4,0),bU(i,4,5,0,5);const e=i.getImageData(0,0,3,3).data;ER=wR(e,0)||wR(e,4)||wR(e,8),_3(i),cm.push(i.canvas)}return ER}function SU(i,e,t,n){const r=p2(t,e,i);let s=WB(e,n,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=i.getMetersPerUnit();a!==void 0&&(s/=a);const l=i.getExtent();if(!l||eg(l,r)){const u=WB(i,s,r)/s;isFinite(u)&&u>0&&(s/=u)}return s}function A3e(i,e,t,n){const r=YA(t);let s=SU(i,e,r,n);return(!isFinite(s)||s<=0)&&b6(t,function(o){return s=SU(i,e,o,n),isFinite(s)&&s>0}),s}function p3e(i,e,t,n,r,s,o,a,l,u,h,d,_,x){const b=Rs(Math.round(t*i),Math.round(t*e),cm);if(d||(b.imageSmoothingEnabled=!1),l.length===0)return b.canvas;b.scale(t,t);function R(B){return Math.round(B*t)/t}b.globalCompositeOperation="lighter";const E=Ul();l.forEach(function(B,G,k){Qxe(E,B.extent)});let w;const L=t/n,D=(d?1:1+Math.pow(2,-24))/L;w=Rs(Math.round(ir(E)*L),Math.round(Ho(E)*L),cm),d||(w.imageSmoothingEnabled=!1),l.forEach(function(B,G,k){if(B.image.width>0&&B.image.height>0){if(B.clipExtent){w.save();const Q=(B.clipExtent[0]-E[0])*L,K=-(B.clipExtent[3]-E[3])*L,se=ir(B.clipExtent)*L,ee=Ho(B.clipExtent)*L;w.rect(d?Q:Math.round(Q),d?K:Math.round(K),d?se:Math.round(Q+se)-Math.round(Q),d?ee:Math.round(K+ee)-Math.round(K)),w.clip()}const z=(B.extent[0]-E[0])*L,F=-(B.extent[3]-E[3])*L,q=ir(B.extent)*L,H=Ho(B.extent)*L;w.drawImage(B.image,u,u,B.image.width-2*u,B.image.height-2*u,d?z:Math.round(z),d?F:Math.round(F),d?q:Math.round(z+q)-Math.round(z),d?H:Math.round(F+H)-Math.round(F)),B.clipExtent&&w.restore()}});const O=r0(o);return a.getTriangles().forEach(function(B,G,k){const z=B.source,F=B.target;let q=z[0][0],H=z[0][1],Q=z[1][0],K=z[1][1],se=z[2][0],ee=z[2][1];const $=R((F[0][0]-O[0])/s),re=R(-(F[0][1]-O[1])/s),ae=R((F[1][0]-O[0])/s),_e=R(-(F[1][1]-O[1])/s),ne=R((F[2][0]-O[0])/s),ye=R(-(F[2][1]-O[1])/s),ve=q,Pe=H;q=0,H=0,Q-=ve,K-=Pe,se-=ve,ee-=Pe;const Se=[[Q,K,0,0,ae-$],[se,ee,0,0,ne-$],[0,0,Q,K,_e-re],[0,0,se,ee,ye-re]],Fe=$xe(Se);if(!Fe)return;if(b.save(),b.beginPath(),d3e()||!d){b.moveTo(ae,_e);const at=4,At=$-ae,Gt=re-_e;for(let Dt=0;Dt<at;Dt++)b.lineTo(ae+R((Dt+1)*At/at),_e+R(Dt*Gt/(at-1))),Dt!=at-1&&b.lineTo(ae+R((Dt+1)*At/at),_e+R((Dt+1)*Gt/(at-1)));b.lineTo(ne,ye)}else b.moveTo(ae,_e),b.lineTo($,re),b.lineTo(ne,ye);b.clip(),b.transform(Fe[0],Fe[2],Fe[1],Fe[3],$,re),b.translate(E[0]-ve,E[3]-Pe);let Ye;if(w)Ye=w.canvas,b.scale(D,-D);else{const at=l[0],At=at.extent;Ye=at.image,b.scale(ir(At)/Ye.width,-Ho(At)/Ye.height)}b.drawImage(Ye,0,0),b.restore()}),w&&(_3(w),cm.push(w.canvas)),h&&(b.save(),b.globalCompositeOperation="source-over",b.strokeStyle="black",b.lineWidth=1,a.getTriangles().forEach(function(B,G,k){const z=B.target,F=(z[0][0]-O[0])/s,q=-(z[0][1]-O[1])/s,H=(z[1][0]-O[0])/s,Q=-(z[1][1]-O[1])/s,K=(z[2][0]-O[0])/s,se=-(z[2][1]-O[1])/s;b.beginPath(),b.moveTo(H,Q),b.lineTo(F,q),b.lineTo(K,se),b.closePath(),b.stroke()}),b.restore()),b.canvas}const m3e=10,TU=.25;class g3e{constructor(e,t,n,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let l={};const u=a?Lbe(D=>Vs(a,p2(D,this.targetProj_,this.sourceProj_))):$S(this.targetProj_,this.sourceProj_);this.transformInv_=function(D){const O=D[0]+"/"+D[1];return l[O]||(l[O]=u(D)),l[O]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ir(r)>=ir(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ir(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ir(this.targetProj_.getExtent()):null;const h=r0(n),d=h3(n),_=c3(n),x=u3(n),b=this.transformInv_(h),R=this.transformInv_(d),E=this.transformInv_(_),w=this.transformInv_(x),L=m3e+(o?Math.max(0,Math.ceil(Math.log2(g4(n)/(o*o*256*256)))):0);if(this.addQuad_(h,d,_,x,b,R,E,w,L),this.wrapsXInSource_){let D=1/0;this.triangles_.forEach(function(O,B,G){D=Math.min(D,O.source[0][0],O.source[1][0],O.source[2][0])}),this.triangles_.forEach(O=>{if(Math.max(O.source[0][0],O.source[1][0],O.source[2][0])-D>this.sourceWorldWidth_/2){const B=[[O.source[0][0],O.source[0][1]],[O.source[1][0],O.source[1][1]],[O.source[2][0],O.source[2][1]]];B[0][0]-D>this.sourceWorldWidth_/2&&(B[0][0]-=this.sourceWorldWidth_),B[1][0]-D>this.sourceWorldWidth_/2&&(B[1][0]-=this.sourceWorldWidth_),B[2][0]-D>this.sourceWorldWidth_/2&&(B[2][0]-=this.sourceWorldWidth_);const G=Math.min(B[0][0],B[1][0],B[2][0]);Math.max(B[0][0],B[1][0],B[2][0])-G<this.sourceWorldWidth_/2&&(O.source=B)}})}l={}}addTriangle_(e,t,n,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,n]})}addQuad_(e,t,n,r,s,o,a,l,u){const h=BB([s,o,a,l]),d=this.sourceWorldWidth_?ir(h)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&d>.5&&d<1;let b=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=BB([e,t,n,r]);b=ir(E)/this.targetWorldWidth_>TU||b}!x&&this.sourceProj_.isGlobal()&&d&&(b=d>TU||b)}if(!b&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Vo(h,this.maxSourceExtent_))return;let R=0;if(!b&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)b=!0;else if(R=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),R!=1&&R!=2&&R!=4&&R!=8)return}if(u>0){if(!b){const E=[(e[0]+n[0])/2,(e[1]+n[1])/2],w=this.transformInv_(E);let L;x?L=(IA(s[0],_)+IA(a[0],_))/2-IA(w[0],_):L=(s[0]+a[0])/2-w[0];const D=(s[1]+a[1])/2-w[1];b=L*L+D*D>this.errorThresholdSquared_}if(b){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){const E=[(t[0]+n[0])/2,(t[1]+n[1])/2],w=this.transformInv_(E),L=[(r[0]+e[0])/2,(r[1]+e[1])/2],D=this.transformInv_(L);this.addQuad_(e,t,E,L,s,o,w,D,u-1),this.addQuad_(L,E,n,r,D,w,a,l,u-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],w=this.transformInv_(E),L=[(n[0]+r[0])/2,(n[1]+r[1])/2],D=this.transformInv_(L);this.addQuad_(e,E,L,r,s,w,D,l,u-1),this.addQuad_(E,t,n,L,w,o,a,D,u-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(R&11)==0&&this.addTriangle_(e,n,r,s,a,l),(R&14)==0&&this.addTriangle_(e,n,t,s,a,o),R&&((R&13)==0&&this.addTriangle_(t,r,e,o,l,s),(R&7)==0&&this.addTriangle_(t,r,n,o,l,a))}calculateSourceExtent(){const e=Ul();return this.triangles_.forEach(function(t,n,r){const s=t.source;U_(e,s[0]),U_(e,s[1]),U_(e,s[2])}),e}getTriangles(){return this.triangles_}}const _3e=.5;class nj extends K6{constructor(e,t,n,r,s,o,a,l,u,h,d,_){super(s,En.IDLE,_),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),b=this.targetTileGrid_.getExtent();let R=this.sourceTileGrid_.getExtent();const E=b?BA(x,b):x;if(g4(E)===0){this.state=En.EMPTY;return}const w=e.getExtent();w&&(R?R=BA(R,w):R=w);const L=r.getResolution(this.wrappedTileCoord_[0]),D=A3e(e,n,E,L);if(!isFinite(D)||D<=0){this.state=En.EMPTY;return}const O=h!==void 0?h:_3e;if(this.triangulation_=new g3e(e,n,E,R,D*O,L),this.triangulation_.getTriangles().length===0){this.state=En.EMPTY;return}this.sourceZ_=t.getZForResolution(D);let B=this.triangulation_.calculateSourceExtent();if(R&&(e.canWrapX()?(B[1]=qr(B[1],R[1],R[3]),B[3]=qr(B[3],R[1],R[3])):B=BA(B,R)),!g4(B))this.state=En.EMPTY;else{let G=0,k=0;e.canWrapX()&&(G=ir(w),k=Math.floor((B[0]-w[0])/G)),cW(B.slice(),e,!0).forEach(F=>{const q=t.getTileRangeForExtentAndZ(F,this.sourceZ_);for(let H=q.minX;H<=q.maxX;H++)for(let Q=q.minY;Q<=q.maxY;Q++){const K=u(this.sourceZ_,H,Q,a);if(K){const se=k*G;this.sourceTiles_.push({tile:K,offset:se})}}++k}),this.sourceTiles_.length===0&&(this.state=En.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const n=t.tile;if(n&&n.getState()==En.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:n.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=En.ERROR;else{const t=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(t),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=p3e(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=En.LOADED}this.changed()}load(){if(this.state==En.IDLE){this.state=En.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const n=t.getState();if(n==En.IDLE||n==En.LOADING){e++;const r=Bi(t,ai.CHANGE,s=>{const o=t.getState();(o==En.LOADED||o==En.ERROR||o==En.EMPTY)&&(Ir(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},n,r){t.getState()==En.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ir),this.sourcesListenerKeys_=null}release(){this.canvas_&&(_3(this.canvas_.getContext("2d")),cm.push(this.canvas_),this.canvas_=null),super.release()}}class y3e{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof r3&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const n=this.entries_[e];return Ki(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(e){const t=this.entries_[e];return Ki(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e}getValues(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Ki(!(e in this.entries_),"Tried to set a value for a key that is used already");const n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_}setSize(e){this.highWaterMark=e}}function eT(i,e,t,n){return n!==void 0?(n[0]=i,n[1]=e,n[2]=t,n):[i,e,t]}function v3e(i,e,t){return i+"/"+e+"/"+t}function x3e(i){return b3e(i[0],i[1],i[2])}function b3e(i,e,t){return(e<<i)+t}function S3e(i,e){const t=i[0],n=i[1],r=i[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(n,r):!0}class ij{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(QS(),{get:(e,t)=>{if(typeof QS()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,n)=>(this.push_(t,n),!0)})}push_(...e){const t=this.instructions_,n=this.zIndex+this.offset_;t[n]||(t[n]=[]),t[n].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let n=0,r=t.length;n<r;++n){const s=t[n];if(typeof s=="function"){s(e);continue}const o=t[++n];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const T3e=5;class E3e extends d2{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=T3e}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Ii()}getData(e){return null}prepareFrame(e){return Ii()}renderFrame(e,t){return Ii()}forEachFeatureAtCoordinate(e,t,n,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===li.LOADED||t.getState()===li.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=li.LOADED&&t!=li.ERROR&&e.addEventListener(ai.CHANGE,this.boundHandleImageChange_),t==li.IDLE&&(e.load(),t=e.getState()),t==li.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const EU=[];let Bp=null;function w3e(){Bp=Rs(1,1,void 0,{willReadFrequently:!0})}class rj extends E3e{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=gu(),this.pixelTransform=gu(),this.inversePixelTransform=gu(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,n){Bp||w3e(),Bp.clearRect(0,0,1,1);let r;try{Bp.drawImage(e,t,n,1,1,0,0,1,1),r=Bp.getImageData(0,0,1,1).data}catch{return Bp=null,null}return r}getBackground(e){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(e.viewState.resolution)),n||void 0}useContainer(e,t,n){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!n||e&&e.style.backgroundColor&&_d(ng(e.style.backgroundColor),ng(n)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&Gbe(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Rs();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(e,t,n){const r=r0(n),s=h3(n),o=c3(n),a=u3(n);Vs(t.coordinateToPixelTransform,r),Vs(t.coordinateToPixelTransform,s),Vs(t.coordinateToPixelTransform,o),Vs(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Vs(l,r),Vs(l,s),Vs(l,o),Vs(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const n=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ir(n)/r*o),l=Math.round(Ho(n)/r*o);Uh(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),xW(this.inversePixelTransform,this.pixelTransform);const u=kbe(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(e,t,n){const r=this.getLayer();if(r.hasListener(e)){const s=new ZW(e,this.inversePixelTransform,n,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ml.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ml.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new ij),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ml.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ml.POSTRENDER,this.context,e))}getRenderTransform(e,t,n,r,s,o,a){const l=s/2,u=o/2,h=r/t,d=-h,_=-e[0]+a,x=-e[1];return Uh(this.tempTransform,l,u,h,d,-n,_,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function MR(i,e,t,n,r){return`${Ui(i)},${e},${v3e(t,n,r)}`}function RR(i,e,t){if(!(t in i))return i[t]=new Set([e]),!0;const n=i[t],r=n.has(e);return r||n.add(e),!r}function M3e(i,e,t){const n=i[t];return n?n.delete(e):!1}function wU(i,e){const t=i.layerStatesArray[i.layerIndex];t.extent&&(e=BA(e,Yf(t.extent,i.viewState.projection)));const n=t.layer.getRenderSource();if(!n.getWrapX()){const r=n.getTileGridForProjection(i.viewState.projection).getExtent();r&&(e=BA(e,r))}return e}class R3e extends rj{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Ul(),this.tempTileRange_=new Z6(0,0,0,0),this.tempTileCoord_=eT(0,0,0);const n=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new y3e(n),this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,n,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=MR(a,a.getKey(),e,t,n);let u;if(s.containsKey(l))u=s.get(l);else{if(u=a.getTile(e,t,n,r.pixelRatio,r.viewState.projection),!u)return null;s.set(l,u)}return u}getTile(e,t,n,r){const s=this.getOrCreateTile(e,t,n,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const n=this.getLayer(),r=Vs(t.pixelToCoordinateTransform,e.slice()),s=n.getExtent();if(s&&!eg(s,r))return null;const o=t.viewState,a=n.getRenderSource(),l=a.getTileGridForProjection(o.projection),u=a.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const d=l.getTileCoordForCoordAndZ(r,h),_=this.getTile(h,d[1],d[2],t);if(!_||_.getState()!==En.LOADED)continue;const x=l.getOrigin(h),b=pa(l.getTileSize(h)),R=l.getResolution(h);let E;if(_ instanceof tj||_ instanceof nj)E=_.getImage();else if(_ instanceof xU){if(E=C4(_.getData()),!E)continue}else continue;const w=Math.floor(u*((r[0]-x[0])/R-d[1]*b[0])),L=Math.floor(u*((x[1]-r[1])/R-d[2]*b[1])),D=Math.round(u*a.getGutterForProjection(o.projection));return this.getImageData(E,w+D,L+D)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const n=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==n&&(this.renderedSourceRevision_=n,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=n,!0}enqueueTiles(e,t,n,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=Ui(l);h in e.wantedTiles||(e.wantedTiles[h]={});const d=e.wantedTiles[h],_=a.getMapInternal(),x=Math.max(n-s,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),b=o.rotation,R=b?lW(o.center,o.resolution,b,e.size):void 0;for(let E=n;E>=x;--E){const w=u.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),L=u.getResolution(E);for(let D=w.minX;D<=w.maxX;++D)for(let O=w.minY;O<=w.maxY;++O){if(b&&!u.tileCoordIntersectsViewport([E,D,O],R))continue;const B=this.getTile(E,D,O,e);if(!B||!RR(r,B,E))continue;const k=B.getKey();if(d[k]=!0,B.getState()===En.IDLE&&!e.tileQueue.isKeyQueued(k)){const z=eT(E,D,O,this.tempTileCoord_);e.tileQueue.enqueue([B,h,u.getTileCoordCenter(z),L])}}}}findStaleTile_(e,t){const n=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const u=MR(this.getLayer().getSource(),a[l],r,s,o);if(n.containsKey(u)){const h=n.peek(u);if(h.getState()===En.LOADED)return h.endTransition(Ui(this)),RR(t,h,r),!0}}return!1}findAltTiles_(e,t,n,r){const s=e.getTileRangeForTileCoordAndZ(t,n,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let d=s.minY;d<=s.maxY;++d){const _=MR(l,u,n,h,d);let x=!1;if(a.containsKey(_)){const b=a.peek(_);b.getState()===En.LOADED&&(RR(r,b,n),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const n=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=e.pixelRatio,u=this.getLayer(),h=u.getSource(),d=h.getTileGridForProjection(s),_=d.getZForResolution(o,h.zDirection),x=d.getResolution(_),b=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==b&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=b):this.renderedSourceKey_=b;let R=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const w=this.context.canvas.width,L=this.context.canvas.height,D=n.extent&&Yf(n.extent);D&&(R=BA(R,Yf(n.extent)));const O=x*w/2/E,B=x*L/2/E,G=[a[0]-O,a[1]-B,a[0]+O,a[1]+B],k={};this.renderedTiles.length=0;const z=u.getPreload();if(e.nextExtent){const ae=d.getZForResolution(r.nextResolution,h.zDirection),_e=wU(e,e.nextExtent);this.enqueueTiles(e,_e,ae,k,z)}const F=wU(e,R);if(this.enqueueTiles(e,F,_,k,0),z>0&&setTimeout(()=>{this.enqueueTiles(e,F,_-1,k,z-1)},0),!(_ in k))return this.container;const q=Ui(this),H=e.time;for(const ae of k[_]){const _e=ae.getState();if(_e===En.EMPTY)continue;const ne=ae.tileCoord;if(_e===En.LOADED&&ae.getAlpha(q,H)===1){ae.endTransition(q);continue}if(_e!==En.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,k)){M3e(k,ae,_),e.animate=!0;continue}if(this.findAltTiles_(d,ne,_+1,k))continue;const Pe=d.getMinZoom();for(let Se=_-1;Se>=Pe&&!this.findAltTiles_(d,ne,Se,k);--Se);}const Q=x/o*l/E,K=this.getRenderContext(e);Uh(this.tempTransform,w/2,L/2,Q,Q,0,-w/2,-L/2),n.extent&&this.clipUnrotated(K,e,D),h.getInterpolate()||(K.imageSmoothingEnabled=!1),this.preRender(K,e);const se=Object.keys(k).map(Number);se.sort(Sh);let ee;const $=[],re=[];for(let ae=se.length-1;ae>=0;--ae){const _e=se[ae],ne=h.getTilePixelSize(_e,l,s),ve=d.getResolution(_e)/x,Pe=ne[0]*ve*Q,Se=ne[1]*ve*Q,Fe=d.getTileCoordForCoordAndZ(r0(G),_e),Ye=d.getTileCoordExtent(Fe),at=Vs(this.tempTransform,[E*(Ye[0]-G[0])/x,E*(G[3]-Ye[3])/x]),At=E*h.getGutterForProjection(s);for(const Gt of k[_e]){if(Gt.getState()!==En.LOADED)continue;const Dt=Gt.tileCoord,Nn=Fe[1]-Dt[1],bn=Math.round(at[0]-(Nn-1)*Pe),$t=Fe[2]-Dt[2],he=Math.round(at[1]-($t-1)*Se),vt=Math.round(at[0]-Nn*Pe),ft=Math.round(at[1]-$t*Se),pt=bn-vt,et=he-ft,Ft=se.length===1;let Tt=!1;ee=[vt,ft,vt+pt,ft,vt+pt,ft+et,vt,ft+et];for(let Lt=0,_n=$.length;Lt<_n;++Lt)if(!Ft&&_e<re[Lt]){const pe=$[Lt];Vo([vt,ft,vt+pt,ft+et],[pe[0],pe[3],pe[4],pe[7]])&&(Tt||(K.save(),Tt=!0),K.beginPath(),K.moveTo(ee[0],ee[1]),K.lineTo(ee[2],ee[3]),K.lineTo(ee[4],ee[5]),K.lineTo(ee[6],ee[7]),K.moveTo(pe[6],pe[7]),K.lineTo(pe[4],pe[5]),K.lineTo(pe[2],pe[3]),K.lineTo(pe[0],pe[1]),K.clip())}$.push(ee),re.push(_e),this.drawTile(Gt,e,vt,ft,pt,et,At,Ft),Tt&&K.restore(),this.renderedTiles.unshift(Gt),this.updateUsedTiles(e.usedTiles,h,Gt)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Py(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=l,this.postRender(this.context,e),n.extent&&K.restore(),K.imageSmoothingEnabled=!0,this.renderComplete){const ae=(_e,ne)=>{const ye=Ui(h),ve=ne.wantedTiles[ye],Pe=ve?Object.keys(ve).length:0;this.updateCacheSize(Pe),this.tileCache_.expireCache()};e.postRenderFunctions.push(ae)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,n,r,s,o,a,l){let u;if(e instanceof xU){if(u=C4(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const h=this.getRenderContext(t),d=Ui(this),_=t.layerStatesArray[t.layerIndex],x=_.opacity*(l?e.getAlpha(d,t.time):1),b=x!==h.globalAlpha;b&&(h.save(),h.globalAlpha=x),h.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,s,o),b&&h.restore(),x!==_.opacity?t.animate=!0:l&&e.endTransition(d)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,n){const r=Ui(t);r in e||(e[r]={}),e[r][n.getKey()]=!0}}const Ab={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class C3e extends y3{constructor(e){e=e||{};const t=Object.assign({},e),n=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ab.PRELOAD)}setPreload(e){this.set(Ab.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Ab.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Ab.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class N3e extends C3e{constructor(e){super(e)}createRenderer(){return new R3e(this,{cacheSize:this.getCacheSize()})}}const Cp=[0,0,0],If=5;class sj{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Ki(Bxe(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Ki(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=e.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=r0(n)),Ki(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Ki(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:k6,Ki(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new Z6(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){const a=this.getTileRangeForExtentAndZ(n,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):n&&this.calculateTileRanges_(n)}forEachTileCoord(e,t,n){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)n([t,s,a])}forEachTileCoordParentTileRange(e,t,n,r){let s,o,a,l=null,u=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);u>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Rp(o,o,a,a,n)):s=this.getTileRangeForExtentAndZ(l,u,n),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Rp(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Rp(s,o,s,o,n);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-r),u=Math.floor(s*l),h=Math.floor(o*l);if(t<r)return Rp(u,u,h,h,n);const d=Math.floor(l*(s+1))-1,_=Math.floor(l*(o+1))-1;return Rp(u,d,h,_,n)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,n)}getTileRangeForExtentAndZ(e,t,n){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Cp);const r=Cp[1],s=Cp[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Cp);const o=Cp[1],a=Cp[2];return Rp(r,o,s,a,n)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),n=this.getResolution(e[0]),r=pa(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*n,t[1]-(e[2]+.5)*r[1]*n]}getTileCoordExtent(e,t){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=pa(this.getTileSize(e[0]),this.tmpSize_),o=n[0]+e[1]*s[0]*r,a=n[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,u=a+s[1]*r;return Bh(o,a,l,u,t)}getTileCoordForCoordAndResolution(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)}getTileCoordForXYAndResolution_(e,t,n,r,s){const o=this.getZForResolution(n),a=n/this.getResolution(o),l=this.getOrigin(o),u=pa(this.getTileSize(o),this.tmpSize_);let h=a*(e-l[0])/n/u[0],d=a*(l[1]-t)/n/u[1];return r?(h=ob(h,If)-1,d=ob(d,If)-1):(h=sb(h,If),d=sb(d,If)),eT(o,h,d,s)}getTileCoordForXYAndZ_(e,t,n,r,s){const o=this.getOrigin(n),a=this.getResolution(n),l=pa(this.getTileSize(n),this.tmpSize_);let u=(e-o[0])/a/l[0],h=(o[1]-t)/a/l[1];return r?(u=ob(u,If)-1,h=ob(h,If)-1):(u=sb(u,If),h=sb(h,If)),eT(n,u,h,s)}getTileCoordForCoordAndZ(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const n=g6(this.resolutions_,e,t||0);return qr(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return NW(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,n=new Array(t);for(let r=this.minZoom;r<t;++r)n[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=n}}function oj(i){let e=i.getDefaultTileGrid();return e||(e=O3e(i),i.setDefaultTileGrid(e)),e}function D3e(i,e,t){const n=e[0],r=i.getTileCoordCenter(e),s=J6(t);if(!eg(s,r)){const o=ir(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,i.getTileCoordForCoordAndZ(r,n)}return e}function P3e(i,e,t,n){n=n!==void 0?n:"top-left";const r=aj(i,e,t);return new sj({extent:i,origin:Zxe(i,n),resolutions:r,tileSize:t})}function L3e(i){const e=i||{},t=e.extent||Ta("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:aj(t,e.maxZoom,e.tileSize,e.maxResolution)};return new sj(n)}function aj(i,e,t,n){e=e!==void 0?e:cSe,t=pa(t!==void 0?t:k6);const r=Ho(i),s=ir(i);n=n>0?n:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=n/Math.pow(2,l);return a}function O3e(i,e,t,n){const r=J6(i);return P3e(r,e,t,n)}function J6(i){i=Ta(i);let e=i.getExtent();if(!e){const t=180*T6.degrees/i.getMetersPerUnit();e=Bh(-t,-t,t,t)}return e}const I3e=/\{z\}/g,B3e=/\{x\}/g,U3e=/\{y\}/g,F3e=/\{-y\}/g;function k3e(i,e,t,n,r){return i.replace(I3e,e.toString()).replace(B3e,t.toString()).replace(U3e,n.toString()).replace(F3e,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-n).toString()})}function G3e(i){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(i);if(t){const n=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(i.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(i),t){const n=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=n;r++)e.push(i.replace(t[0],r.toString()));return e}return e.push(i),e}function z3e(i,e){return function(t,n,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return k3e(i,o,t[1],t[2],s)}}function V3e(i,e){const t=i.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=z3e(i[r],e);return q3e(n)}function q3e(i){return i.length===1?i[0]:function(e,t,n){if(!e)return;const r=x3e(e),s=IA(r,i.length);return i[s](e,t,n)}}class lj extends bc{constructor(e){super(),this.projection=Ta(e.projection),this.attributions_=MU(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(n,r){t.viewResolver=n,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=MU(e),this.changed()}setState(e){this.state_=e,this.changed()}}function MU(i){return i?typeof i=="function"?i:(Array.isArray(i)||(i=[i]),e=>i):null}class H3e extends lj{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&pa(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||Ui(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,n,r,s){return Ii()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:oj(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,n){const r=this.getTileGridForProjection(n),s=this.getTilePixelRatio(t),o=pa(r.getTileSize(e),this.tmpSize);return s==1?o:sTe(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const n=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(n):this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(e=D3e(r,e,n)),S3e(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class W3e extends Vh{constructor(e,t){super(e),this.tile=t}}const CR={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class eN extends H3e{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===eN.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,n=Ui(t),r=t.getState();let s;r==En.LOADING?(this.tileLoadingKeys_[n]=!0,s=CR.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==En.ERROR?CR.TILELOADERROR:r==En.LOADED?CR.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new W3e(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=G3e(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(V3e(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,n){}}class j3e extends eN{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:X3e,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:tj,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!aR(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||aR(t,e)))return this.tileGrid;const n=Ui(e);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=oj(e)),this.tileGridForProjection[n]}createTile_(e,t,n,r,s,o){const a=[e,t,n],l=this.getTileCoordForTileUrlFunction(a,s),u=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,u!==void 0?En.IDLE:En.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(ai.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,n,r,s){const o=this.getProjection();if(!o||!s||aR(o,s))return this.getTileInternal(e,t,n,r,o||s);const a=[e,t,n],l=this.getKey(),u=this.getTileGridForProjection(o),h=this.getTileGridForProjection(s),d=this.getTileCoordForTileUrlFunction(a,s),_=new nj(o,u,s,h,a,d,this.getTilePixelRatio(r),this.getGutter(),(x,b,R,E)=>this.getTileInternal(x,b,R,E,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return _.key=l,_}getTileInternal(e,t,n,r,s){const o=this.getKey();return this.createTile_(e,t,n,r,s,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const n=Ta(e);if(n){const r=Ui(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function X3e(i,e){i.getImage().src=e}class $3e extends j3e{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",n=e.tileGrid!==void 0?e.tileGrid:L3e({extent:J6(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const sg="EPSG:3857",RU=i=>!i||Object.keys(i).length===0,uj=i=>N6(i,sg),Y3e=i=>Obe(i,sg),Q3e=i=>uj([i.at(1),i.at(0)]),CU=12,K3e=new N3e({source:new $3e({url:"https://mt0.google.com/vt/lyrs=p&hl=en&x={x}&y={y}&z={z}",transition:0})}),Z3e=({layers:i,onInit:e,onClick:t,onMove:n,duringMove:r,mapCenter:s})=>{const[o,a]=On.useState(),l=On.useRef(0),u=On.useRef(null),h=On.useRef(void 0),d=On.useRef(void 0);d.current=o;const _=On.useRef([]);return _.current=[K3e,...i],Km("MapMoveTo",x=>{if(RU(x)||!x.coord||x.coord.length<=0){console.error(`[MAP]<event> map move triggered to invalid position. ${x}`);return}console.log(`[MAP]<event> map move to ${x.coord}`),d.current?.getView().animate({center:Q3e(x.coord),zoom:CU})}),Km("MapFitTo",x=>{if(RU(x)){console.error(`[MAP]<event> map move triggered to invalid position. ${x}`);return}console.log(`[MAP]<event> map move to ${x}`);const b=d.current;b.getView().fit(x,{size:b.getSize(),minResolution:2,duration:800,padding:[48,48,48,48]})}),On.useEffect(()=>{if(l.current>0)return;l.current=1;const x=new Wu({projection:sg,center:p2(s,"EPSG:4326",sg),zoom:CU});h.current=x;const b=new l3e({target:u.current,layers:_.current,view:x,controls:[]});b.on("singleclick",R=>{t&&t(R,d.current)}),b.on("moveend",R=>{n&&n(R,d.current)}),b.on("postrender",R=>{r&&r(R,d.current)}),b.on("change",R=>{r&&r(R,d.current)}),a(b),d.current=b,e&&e(b)},[]),On.useEffect(()=>{console.debug("[MAP] updating layers"),o&&o.setLayers(_.current)},[i]),On.useEffect(()=>{console.debug("[MAP] updating center"),o&&o.getView().animate({center:uj(s),duration:1e3})},[s]),rs.jsx("div",{ref:u,className:Pxe.MapContainer})};class cj{drawCustom(e,t,n,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,n){}drawFeature(e,t,n){}drawGeometryCollection(e,t,n){}drawLineString(e,t,n){}drawMultiLineString(e,t,n){}drawMultiPoint(e,t,n){}drawMultiPolygon(e,t,n){}drawPoint(e,t,n){}drawPolygon(e,t,n){}drawText(e,t,n){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Sn={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},pb=[Sn.FILL],Qf=[Sn.STROKE],TA=[Sn.BEGIN_PATH],NU=[Sn.CLOSE_PATH];class v2 extends cj{constructor(e,t,n,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(n){return n*t})}appendFlatPointCoordinates(e,t){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)r[0]=e[a],r[1]=e[a+1],eg(n,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,n,r,s,o){const a=this.coordinates;let l=a.length;const u=this.getBufferedMaxExtent();o&&(t+=r);let h=e[t],d=e[t+1];const _=this.tmpCoordinate_;let x=!0,b,R,E;for(b=t+r;b<n;b+=r)_[0]=e[b],_[1]=e[b+1],E=m4(u,_),E!==R?(x&&(a[l++]=h,a[l++]=d,x=!1),a[l++]=_[0],a[l++]=_[1]):E===Gs.INTERSECTING?(a[l++]=_[0],a[l++]=_[1],x=!1):x=!0,h=_[0],d=_[1],R=E;return(s&&x||b===t+r)&&(a[l++]=h,a[l++]=d),l}drawCustomCoordinates_(e,t,n,r,s){for(let o=0,a=n.length;o<a;++o){const l=n[o],u=this.appendFlatLineCoordinates(e,t,l,r,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,n,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let u,h,d,_,x;switch(o){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),_=[];const b=e.getEndss();x=0;for(let R=0,E=b.length;R<E;++R){const w=[];x=this.drawCustomCoordinates_(u,x,b[R],a,w),_.push(w)}this.instructions.push([Sn.CUSTOM,l,_,e,n,KB,s]),this.hitDetectionInstructions.push([Sn.CUSTOM,l,_,e,r||n,KB,s]);break;case"Polygon":case"MultiLineString":d=[],u=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(u,0,e.getEnds(),a,d),this.instructions.push([Sn.CUSTOM,l,d,e,n,YS,s]),this.hitDetectionInstructions.push([Sn.CUSTOM,l,d,e,r||n,YS,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(u,0,u.length,a,!1,!1),this.instructions.push([Sn.CUSTOM,l,h,e,n,Yp,s]),this.hitDetectionInstructions.push([Sn.CUSTOM,l,h,e,r||n,Yp,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(u,a),h>l&&(this.instructions.push([Sn.CUSTOM,l,h,e,n,Yp,s]),this.hitDetectionInstructions.push([Sn.CUSTOM,l,h,e,r||n,Yp,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),h=this.coordinates.length,this.instructions.push([Sn.CUSTOM,l,h,e,n,void 0,s]),this.hitDetectionInstructions.push([Sn.CUSTOM,l,h,e,r||n,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,n){this.beginGeometryInstruction1_=[Sn.BEGIN_GEOMETRY,t,0,e,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Sn.BEGIN_GEOMETRY,t,0,e,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const n=e.length;let r,s,o=-1;for(t=0;t<n;++t)r=e[t],s=r[0],s==Sn.END_GEOMETRY?o=t:s==Sn.BEGIN_GEOMETRY&&(r[2]=t,Ixe(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const n=e.getColor();t.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,t.fillStyle=Zu(n||aa)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const n=e.getColor();t.strokeStyle=Zu(n||Uy);const r=e.getLineCap();t.lineCap=r!==void 0?r:ig;const s=e.getLineDash();t.lineDash=s?s.slice():Th;const o=e.getLineDashOffset();t.lineDashOffset=o||Eh;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:rg;const l=e.getWidth();t.lineWidth=l!==void 0?l:ky;const u=e.getMiterLimit();t.miterLimit=u!==void 0?u:By,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const n=this.state;this.fillStyleToState(e,n),this.strokeStyleToState(t,n)}createFill(e){const t=e.fillStyle,n=[Sn.SET_FILL_STYLE,t];return typeof t!="string"&&n.push(e.fillPatternScale),n}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Sn.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const n=e.fillStyle;(typeof n!="string"||e.currentFillStyle!=n)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=n)}updateStrokeStyle(e,t){const n=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=n||e.currentLineCap!=r||s!=e.currentLineDash&&!_d(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(t.call(this,e),e.currentStrokeStyle=n,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Sn.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=iW(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;v6(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class J3e extends v2{constructor(e,t,n,r){super(e,t,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,n){if(!this.image_||this.maxExtent&&!eg(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,n);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([Sn.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Sn.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,n){if(!this.image_)return;this.beginGeometry(e,t,n);const r=e.getFlatCoordinates(),s=[];for(let l=0,u=r.length;l<u;l+=e.getStride())(!this.maxExtent||eg(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Sn.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Sn.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const n=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class eEe extends v2{constructor(e,t,n,r){super(e,t,n,r)}drawFlatCoordinates_(e,t,n,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,n,r,!1,!1),a=[Sn.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}drawLineString(e,t,n){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,n),this.hitDetectionInstructions.push([Sn.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Th,Eh],TA);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Qf),this.endGeometry(t)}drawMultiLineString(e,t,n){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,n),this.hitDetectionInstructions.push([Sn.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Th,Eh],TA);const a=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let h=0;for(let d=0,_=a.length;d<_;++d)h=this.drawFlatCoordinates_(l,h,a[d],u);this.hitDetectionInstructions.push(Qf),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Qf),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Qf),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(TA)}}class DU extends v2{constructor(e,t,n,r){super(e,t,n,r)}drawFlatCoordinatess_(e,t,n,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=n.length;this.instructions.push(TA),this.hitDetectionInstructions.push(TA);for(let u=0;u<l;++u){const h=n[u],d=this.coordinates.length,_=this.appendFlatLineCoordinates(e,t,h,r,!0,!a),x=[Sn.MOVE_TO_LINE_TO,d,_];this.instructions.push(x),this.hitDetectionInstructions.push(x),a&&(this.instructions.push(NU),this.hitDetectionInstructions.push(NU)),t=h}return o&&(this.instructions.push(pb),this.hitDetectionInstructions.push(pb)),a&&(this.instructions.push(Qf),this.hitDetectionInstructions.push(Qf)),t}drawCircle(e,t,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_FILL_STYLE,aa]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Th,Eh]);const a=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[Sn.CIRCLE,u];this.instructions.push(TA,h),this.hitDetectionInstructions.push(TA,h),r.fillStyle!==void 0&&(this.instructions.push(pb),this.hitDetectionInstructions.push(pb)),r.strokeStyle!==void 0&&(this.instructions.push(Qf),this.hitDetectionInstructions.push(Qf)),this.endGeometry(t)}drawPolygon(e,t,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_FILL_STYLE,aa]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Th,Eh]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,a,u),this.endGeometry(t)}drawMultiPolygon(e,t,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_FILL_STYLE,aa]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Sn.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Th,Eh]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let h=0;for(let d=0,_=a.length;d<_;++d)h=this.drawFlatCoordinatess_(l,h,a[d],u);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let n=0,r=t.length;n<r;++n)t[n]=aA(t[n],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function tEe(i,e,t,n,r){const s=[];let o=t,a=0,l=e.slice(t,2);for(;a<i&&o+r<n;){const[u,h]=l.slice(-2),d=e[o+r],_=e[o+r+1],x=Math.sqrt((d-u)*(d-u)+(_-h)*(_-h));if(a+=x,a>=i){const b=(i-a+x)/x,R=Sl(u,d,b),E=Sl(h,_,b);l.push(R,E),s.push(l),l=[R,E],a==i&&(o+=r),a=0}else if(a<i)l.push(e[o+r],e[o+r+1]),o+=r;else{const b=x-a,R=Sl(u,d,b/x),E=Sl(h,_,b/x);l.push(R,E),s.push(l),l=[R,E],a=0,o+=r}}return a>0&&s.push(l),s}function nEe(i,e,t,n,r){let s=t,o=t,a=0,l=0,u=t,h,d,_,x,b,R,E,w,L,D;for(d=t;d<n;d+=r){const O=e[d],B=e[d+1];b!==void 0&&(L=O-b,D=B-R,x=Math.sqrt(L*L+D*D),E!==void 0&&(l+=_,h=Math.acos((E*L+w*D)/(_*x)),h>i&&(l>a&&(a=l,s=u,o=d),l=0,u=d-r)),_=x,E=L,w=D),b=O,R=B}return l+=x,l>a?[u,d]:[s,o]}const tT={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class iEe extends v2{constructor(e,t,n,r){super(e,t,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[aa]={fillStyle:aa},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,n){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const u=e.getType();let h=null,d=e.getStride();if(o.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!Vo(this.maxExtent,e.getExtent()))return;let _;if(h=e.getFlatCoordinates(),u=="LineString")_=[h.length];else if(u=="MultiLineString")_=e.getEnds();else if(u=="Polygon")_=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const E=e.getEndss();_=[];for(let w=0,L=E.length;w<L;++w)_.push(E[w][0])}this.beginGeometry(e,t,n);const x=o.repeat,b=x?void 0:o.textAlign;let R=0;for(let E=0,w=_.length;E<w;++E){let L;x?L=tEe(x*this.resolution,h,R,_[E],d):L=[h.slice(R,_[E])];for(let D=0,O=L.length;D<O;++D){const B=L[D];let G=0,k=B.length;if(b==null){const F=nEe(o.maxAngle,B,0,B.length,2);G=F[0],k=F[1]}for(let F=G;F<k;F+=d)a.push(B[F],B[F+1]);const z=a.length;R=_[E],this.drawChars_(l,z),l=z}}this.endGeometry(t)}else{let _=o.overflow?null:[];switch(u){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),d=2;break;case"Polygon":h=e.getFlatInteriorPoint(),o.overflow||_.push(h[2]/this.resolution),d=3;break;case"MultiPolygon":const O=e.getFlatInteriorPoints();h=[];for(let B=0,G=O.length;B<G;B+=3)o.overflow||_.push(O[B+2]/this.resolution),h.push(O[B],O[B+1]);if(h.length===0)return;d=2;break}const x=this.appendFlatPointCoordinates(h,d);if(x===l)return;if(_&&(x-l)/2!==h.length/d){let O=l/2;_=_.filter((B,G)=>{const k=a[(O+G)*2]===h[G*d]&&a[(O+G)*2+1]===h[G*d+1];return k||--O,k})}this.saveTextStates_();const b=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,R=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,n);let E=o.padding;if(E!=SA&&(o.scale[0]<0||o.scale[1]<0)){let O=o.padding[0],B=o.padding[1],G=o.padding[2],k=o.padding[3];o.scale[0]<0&&(B=-B,k=-k),o.scale[1]<0&&(O=-O,G=-G),E=[O,B,G,k]}const w=this.pixelRatio;this.instructions.push([Sn.DRAW_IMAGE,l,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==SA?SA:E.map(function(O){return O*w}),b,R,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const L=1/w,D=b?b.slice(0):null;D&&(D[1]=aa),this.hitDetectionInstructions.push([Sn.DRAW_IMAGE,l,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[L,L],NaN,this.declutterMode_,this.declutterImageWithText_,E,D,R,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?aa:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,n=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Fy,justify:t.justify,textBaseline:t.textBaseline||KS,scale:t.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(e,t){const n=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=tT[r.textBaseline],h=this.textOffsetY_*l,d=this.text_,_=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Sn.DRAW_CHARS,e,t,u,r.overflow,a,r.maxAngle,l,h,s,_*l,d,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Sn.DRAW_CHARS,e,t,u,r.overflow,a&&aa,r.maxAngle,l,h,s,_*l,d,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let n,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Zu(o.getColor()||aa)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const R=a.getLineDash(),E=a.getLineDashOffset(),w=a.getWidth(),L=a.getMiterLimit();s.lineCap=a.getLineCap()||ig,s.lineDash=R?R.slice():Th,s.lineDashOffset=E===void 0?Eh:E,s.lineJoin=a.getLineJoin()||rg,s.lineWidth=w===void 0?ky:w,s.miterLimit=L===void 0?By:L,s.strokeStyle=Zu(a.getColor()||Uy)}n=this.textState_;const l=e.getFont()||qW;UTe(l);const u=e.getScaleArray();n.overflow=e.getOverflow(),n.font=l,n.maxAngle=e.getMaxAngle(),n.placement=e.getPlacement(),n.textAlign=e.getTextAlign(),n.repeat=e.getRepeat(),n.justify=e.getJustify(),n.textBaseline=e.getTextBaseline()||KS,n.backgroundFill=e.getBackgroundFill(),n.backgroundStroke=e.getBackgroundStroke(),n.padding=e.getPadding()||SA,n.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),d=e.getOffsetY(),_=e.getRotateWithView(),x=e.getKeepUpright(),b=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=_===void 0?!1:_,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=b===void 0?0:b,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Ui(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+Ui(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const rEe={Circle:DU,Default:v2,Image:J3e,LineString:eEe,Polygon:DU,Text:iEe};class sEe{constructor(e,t,n,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const n=this.buildersByZIndex_[t];for(const r in n){const s=n[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const n=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);let s=r[t];if(s===void 0){const o=rEe[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function oEe(i,e,t,n){let r=i[e],s=i[e+1],o=0;for(let a=e+n;a<t;a+=n){const l=i[a],u=i[a+1];o+=Math.sqrt((l-r)*(l-r)+(u-s)*(u-s)),r=l,s=u}return o}function aEe(i,e,t,n,r,s,o,a,l,u,h,d,_=!0){let x=i[e],b=i[e+1],R=0,E=0,w=0,L=0;function D(){R=x,E=b,e+=n,x=i[e],b=i[e+1],L+=w,w=Math.sqrt((x-R)*(x-R)+(b-E)*(b-E))}do D();while(e<t-n&&L+w<s);let O=w===0?0:(s-L)/w;const B=Sl(R,x,O),G=Sl(E,b,O),k=e-n,z=L,F=s+a*l(u,r,h);for(;e<t-n&&L+w<F;)D();O=w===0?0:(F-L)/w;const q=Sl(R,x,O),H=Sl(E,b,O);let Q=!1;if(_)if(d){const re=[B,G,q,H];P6(re,0,4,2,d,re,re),Q=re[0]>re[2]}else Q=B>q;const K=Math.PI,se=[],ee=k+n===e;e=k,w=0,L=z,x=i[e],b=i[e+1];let $;if(ee){D(),$=Math.atan2(b-E,x-R),Q&&($+=$>0?-K:K);const re=(q+B)/2,ae=(H+G)/2;return se[0]=[re,ae,(F-s)/2,$,r],se}r=r.replace(/\n/g," ");for(let re=0,ae=r.length;re<ae;){D();let _e=Math.atan2(b-E,x-R);if(Q&&(_e+=_e>0?-K:K),$!==void 0){let Fe=_e-$;if(Fe+=Fe>K?-2*K:Fe<-K?2*K:0,Math.abs(Fe)>o)return null}$=_e;const ne=re;let ye=0;for(;re<ae;++re){const Fe=Q?ae-re-1:re,Ye=a*l(u,r[Fe],h);if(e+n<t&&L+w<s+ye+Ye/2)break;ye+=Ye}if(re===ne)continue;const ve=Q?r.substring(ae-ne,ae-re):r.substring(ne,re);O=w===0?0:(s+ye/2-L)/w;const Pe=Sl(R,x,O),Se=Sl(E,b,O);se.push([Pe,Se,ye/2,_e,ve]),s+=ye}return se}const Np=Ul(),Bf=[],rh=[],sh=[],Uf=[];function PU(i){return i[3].declutterBox}const LU=new RegExp("[-----]");function NR(i,e){return e==="start"?e=LU.test(i)?"right":"left":e==="end"&&(e=LU.test(i)?"left":"right"),tT[e]}function lEe(i,e,t){return t>0&&i.push(`
`,""),i.push(e,""),i}function uEe(i,e,t){return t%2===0&&(i+=e),i}class cEe{constructor(e,t,n,r,s){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=gu(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new ij:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,n,r){const s=e+t+n+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],d=l.justify?tT[l.justify]:NR(Array.isArray(e)?e[0]:e,l.textAlign||Fy),_=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(lEe,[]),{width:b,height:R,widths:E,heights:w,lineWidths:L}=kTe(l,x),D=b+_,O=[],B=(D+2)*h[0],G=(R+_)*h[1],k={width:B<0?Math.floor(B):Math.ceil(B),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:O};(h[0]!=1||h[1]!=1)&&O.push("scale",h),r&&(O.push("strokeStyle",o.strokeStyle),O.push("lineWidth",_),O.push("lineCap",o.lineCap),O.push("lineJoin",o.lineJoin),O.push("miterLimit",o.miterLimit),O.push("setLineDash",[o.lineDash]),O.push("lineDashOffset",o.lineDashOffset)),n&&O.push("fillStyle",a.fillStyle),O.push("textBaseline","middle"),O.push("textAlign","center");const z=.5-d;let F=d*D+z*_;const q=[],H=[];let Q=0,K=0,se=0,ee=0,$;for(let re=0,ae=x.length;re<ae;re+=2){const _e=x[re];if(_e===`
`){K+=Q,Q=0,F=d*D+z*_,++ee;continue}const ne=x[re+1]||l.font;ne!==$&&(r&&q.push("font",ne),n&&H.push("font",ne),$=ne),Q=Math.max(Q,w[se]);const ye=[_e,F+z*E[se]+d*(E[se]-L[ee]),.5*(_+Q)+K];F+=E[se],r&&q.push("strokeText",ye),n&&H.push("fillText",ye),++se}return Array.prototype.push.apply(O,q),Array.prototype.push.apply(O,H),this.labels_[s]=k,k}replayTextBackground_(e,t,n,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,n,r,s,o,a,l,u,h,d,_,x,b,R,E){a*=_[0],l*=_[1];let w=n-a,L=r-l;const D=s+u>e?e-u:s,O=o+h>t?t-h:o,B=b[3]+D*_[0]+b[1],G=b[0]+O*_[1]+b[2],k=w-b[3],z=L-b[0];(R||d!==0)&&(Bf[0]=k,Uf[0]=k,Bf[1]=z,rh[1]=z,rh[0]=k+B,sh[0]=rh[0],sh[1]=z+G,Uf[1]=sh[1]);let F;return d!==0?(F=Uh(gu(),n,r,1,1,d,-n,-r),Vs(F,Bf),Vs(F,rh),Vs(F,sh),Vs(F,Uf),Bh(Math.min(Bf[0],rh[0],sh[0],Uf[0]),Math.min(Bf[1],rh[1],sh[1],Uf[1]),Math.max(Bf[0],rh[0],sh[0],Uf[0]),Math.max(Bf[1],rh[1],sh[1],Uf[1]),Np)):Bh(Math.min(k,k+B),Math.min(z,z+G),Math.max(k,k+B),Math.max(z,z+G),Np),x&&(w=Math.round(w),L=Math.round(L)),{drawImageX:w,drawImageY:L,drawImageW:D,drawImageH:O,originX:u,originY:h,declutterBox:{minX:Np[0],minY:Np[1],maxX:Np[2],maxY:Np[3],value:E},canvasTransform:F,scale:_}}replayImageOrLabel_(e,t,n,r,s,o,a){const l=!!(o||a),u=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return u.minX-h<=t[0]&&u.maxX+h>=0&&u.minY-h<=t[1]&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,Bf,rh,sh,Uf,o,a),GTe(e,r.canvasTransform,s,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const n=Vs(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(n[0]%r,n[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,n,r){const s=this.textStates[t],o=this.createLabel(e,t,r,n),a=this.strokeStates[n],l=this.pixelRatio,u=NR(Array.isArray(e)?e[0]:e,s.textAlign||Fy),h=tT[s.textBaseline||KS],d=a&&a.lineWidth?a.lineWidth:0,_=o.width/l-2*s.scale[0],x=u*_+2*(.5-u)*d,b=h*o.height/l+2*(.5-h)*d;return{label:o,anchorX:x,anchorY:b}}execute_(e,t,n,r,s,o,a,l){const u=this.zIndexContext_;let h;this.pixelCoordinates_&&_d(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=rd(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),Bbe(this.renderedTransform_,n));let d=0;const _=r.length;let x=0,b,R,E,w,L,D,O,B,G,k,z,F,q,H=0,Q=0;const K=this.coordinateCache_,se=this.viewRotation_,ee=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,$={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},re=this.instructions!=r||this.overlaps?0:200;let ae,_e,ne,ye;for(;d<_;){const ve=r[d];switch(ve[0]){case Sn.BEGIN_GEOMETRY:ae=ve[1],ye=ve[3],ae.getGeometry()?a!==void 0&&!Vo(a,ye.getExtent())?d=ve[2]+1:++d:d=ve[2],u&&(u.zIndex=ve[4]);break;case Sn.BEGIN_PATH:H>re&&(this.fill_(e),H=0),Q>re&&(e.stroke(),Q=0),!H&&!Q&&(e.beginPath(),L=NaN,D=NaN),++d;break;case Sn.CIRCLE:x=ve[1];const Se=h[x],Fe=h[x+1],Ye=h[x+2],at=h[x+3],At=Ye-Se,Gt=at-Fe,Dt=Math.sqrt(At*At+Gt*Gt);e.moveTo(Se+Dt,Fe),e.arc(Se,Fe,Dt,0,2*Math.PI,!0),++d;break;case Sn.CLOSE_PATH:e.closePath(),++d;break;case Sn.CUSTOM:x=ve[1],b=ve[2];const Nn=ve[3],bn=ve[4],$t=ve[5];$.geometry=Nn,$.feature=ae,d in K||(K[d]=[]);const he=K[d];$t?$t(h,x,b,2,he):(he[0]=h[x],he[1]=h[x+1],he.length=2),u&&(u.zIndex=ve[6]),bn(he,$),++d;break;case Sn.DRAW_IMAGE:x=ve[1],b=ve[2],G=ve[3],R=ve[4],E=ve[5];let vt=ve[6];const ft=ve[7],pt=ve[8],et=ve[9],Ft=ve[10];let Tt=ve[11];const Lt=ve[12];let _n=ve[13];w=ve[14]||"declutter";const pe=ve[15];if(!G&&ve.length>=20){k=ve[19],z=ve[20],F=ve[21],q=ve[22];const kt=this.drawLabelWithPointPlacement_(k,z,F,q);G=kt.label,ve[3]=G;const hn=ve[23];R=(kt.anchorX-hn)*this.pixelRatio,ve[4]=R;const $n=ve[24];E=(kt.anchorY-$n)*this.pixelRatio,ve[5]=E,vt=G.height,ve[6]=vt,_n=G.width,ve[13]=_n}let ie;ve.length>25&&(ie=ve[25]);let Ge,Qe,nt;ve.length>17?(Ge=ve[16],Qe=ve[17],nt=ve[18]):(Ge=SA,Qe=null,nt=null),Ft&&ee?Tt+=se:!Ft&&!ee&&(Tt-=se);let Ke=0;for(;x<b;x+=2){if(ie&&ie[Ke++]<_n/this.pixelRatio)continue;const kt=this.calculateImageOrLabelDimensions_(G.width,G.height,h[x],h[x+1],_n,vt,R,E,pt,et,Tt,Lt,s,Ge,!!Qe||!!nt,ae),hn=[e,t,G,kt,ft,Qe,nt];if(l){let $n,Bn,Hi;if(pe){const We=b-x;if(!pe[We]){pe[We]={args:hn,declutterMode:w};continue}const St=pe[We];$n=St.args,Bn=St.declutterMode,delete pe[We],Hi=PU($n)}let Ti,ke;if($n&&(Bn!=="declutter"||!l.collides(Hi))&&(Ti=!0),(w!=="declutter"||!l.collides(kt.declutterBox))&&(ke=!0),Bn==="declutter"&&w==="declutter"){const We=Ti&&ke;Ti=We,ke=We}Ti&&(Bn!=="none"&&l.insert(Hi),this.replayImageOrLabel_.apply(this,$n)),ke&&(w!=="none"&&l.insert(kt.declutterBox),this.replayImageOrLabel_.apply(this,hn))}else this.replayImageOrLabel_.apply(this,hn)}++d;break;case Sn.DRAW_CHARS:const qt=ve[1],Bt=ve[2],Zt=ve[3],nn=ve[4];q=ve[5];const _t=ve[6],jt=ve[7],un=ve[8];F=ve[9];const sn=ve[10];k=ve[11],Array.isArray(k)&&(k=k.reduce(uEe,"")),z=ve[12];const It=[ve[13],ve[13]];w=ve[14]||"declutter";const Dn=ve[15],fe=this.textStates[z],Ut=fe.font,xt=[fe.scale[0]*jt,fe.scale[1]*jt];let Ht;Ut in this.widths_?Ht=this.widths_[Ut]:(Ht={},this.widths_[Ut]=Ht);const Ct=oEe(h,qt,Bt,2),ut=Math.abs(xt[0])*dU(Ut,k,Ht);if(nn||ut<=Ct){const kt=this.textStates[z].textAlign,hn=(Ct-ut)*NR(k,kt),$n=aEe(h,qt,Bt,2,k,hn,_t,Math.abs(xt[0]),dU,Ut,Ht,ee?0:this.viewRotation_,Dn);e:if($n){const Bn=[];let Hi,Ti,ke,We,St;if(F)for(Hi=0,Ti=$n.length;Hi<Ti;++Hi){St=$n[Hi],ke=St[4],We=this.createLabel(ke,z,"",F),R=St[2]+(xt[0]<0?-sn:sn),E=Zt*We.height+(.5-Zt)*2*sn*xt[1]/xt[0]-un;const rt=this.calculateImageOrLabelDimensions_(We.width,We.height,St[0],St[1],We.width,We.height,R,E,0,0,St[3],It,!1,SA,!1,ae);if(l&&w==="declutter"&&l.collides(rt.declutterBox))break e;Bn.push([e,t,We,rt,1,null,null])}if(q)for(Hi=0,Ti=$n.length;Hi<Ti;++Hi){St=$n[Hi],ke=St[4],We=this.createLabel(ke,z,q,""),R=St[2],E=Zt*We.height-un;const rt=this.calculateImageOrLabelDimensions_(We.width,We.height,St[0],St[1],We.width,We.height,R,E,0,0,St[3],It,!1,SA,!1,ae);if(l&&w==="declutter"&&l.collides(rt.declutterBox))break e;Bn.push([e,t,We,rt,1,null,null])}l&&w!=="none"&&l.load(Bn.map(PU));for(let rt=0,p=Bn.length;rt<p;++rt)this.replayImageOrLabel_.apply(this,Bn[rt])}}++d;break;case Sn.END_GEOMETRY:if(o!==void 0){ae=ve[1];const kt=o(ae,ye,w);if(kt)return kt}++d;break;case Sn.FILL:re?H++:this.fill_(e),++d;break;case Sn.MOVE_TO_LINE_TO:for(x=ve[1],b=ve[2],_e=h[x],ne=h[x+1],e.moveTo(_e,ne),L=_e+.5|0,D=ne+.5|0,x+=2;x<b;x+=2)_e=h[x],ne=h[x+1],O=_e+.5|0,B=ne+.5|0,(x==b-2||O!==L||B!==D)&&(e.lineTo(_e,ne),L=O,D=B);++d;break;case Sn.SET_FILL_STYLE:this.alignAndScaleFill_=ve[2],H&&(this.fill_(e),H=0,Q&&(e.stroke(),Q=0)),e.fillStyle=ve[1],++d;break;case Sn.SET_STROKE_STYLE:Q&&(e.stroke(),Q=0),this.setStrokeStyle_(e,ve),++d;break;case Sn.STROKE:re?Q++:e.stroke(),++d;break;default:++d;break}}H&&this.fill_(e),Q&&e.stroke()}execute(e,t,n,r,s,o){this.viewRotation_=r,this.execute_(e,t,n,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,n,r,s){return this.viewRotation_=n,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const AA=["Polygon","Circle","LineString","Image","Text","Default"],hj=["Image","Text"],hEe=AA.filter(i=>!hj.includes(i));class fEe{constructor(e,t,n,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=gu(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()}createExecutors_(e,t){for(const n in e){let r=this.executorsByZIndex_[n];r===void 0&&(r={},this.executorsByZIndex_[n]=r);const s=e[n];for(const o in s){const a=s[o];r[o]=new cEe(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const n=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in n)return!0}return!1}forEachFeatureAtCoordinate(e,t,n,r,s,o){r=Math.round(r);const a=r*2+1,l=Uh(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-n,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=Rs(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):u||h.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=Ul(),U_(d,e),v6(d,t*(this.renderBuffer_+r),d));const _=dEe(r);let x;function b(B,G,k){const z=h.getImageData(0,0,a,a).data;for(let F=0,q=_.length;F<q;F++)if(z[_[F]]>0){if(!o||k==="none"||x!=="Image"&&x!=="Text"||o.includes(B)){const H=(_[F]-3)/4,Q=r-H%a,K=r-(H/a|0),se=s(B,G,Q*Q+K*K);if(se)return se}h.clearRect(0,0,a,a);break}}const R=Object.keys(this.executorsByZIndex_).map(Number);R.sort(Sh);let E,w,L,D,O;for(E=R.length-1;E>=0;--E){const B=R[E].toString();for(L=this.executorsByZIndex_[B],w=AA.length-1;w>=0;--w)if(x=AA[w],D=L[x],D!==void 0&&(O=D.executeHitDetection(h,l,n,b,d),O))return O}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const n=t[0],r=t[1],s=t[2],o=t[3],a=[n,r,n,o,s,o,s,r];return rd(a,0,8,2,e,a),a}isEmpty(){return Jm(this.executorsByZIndex_)}execute(e,t,n,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?Oxe:Sh),o=o||AA;const u=AA.length;for(let h=0,d=l.length;h<d;++h){const _=l[h].toString(),x=this.executorsByZIndex_[_];for(let b=0,R=o.length;b<R;++b){const E=o[b],w=x[E];if(w!==void 0){const L=a===null?void 0:w.getZIndexContext(),D=L?L.getContext():e,O=this.maxExtent_&&E!=="Image"&&E!=="Text";if(O&&(D.save(),this.clip(D,n)),!L||E==="Text"||E==="Image"?w.execute(D,t,n,r,s,a):L.pushFunction(B=>w.execute(B,t,n,r,s,a)),O&&D.restore(),L){L.offset();const B=l[h]*u+AA.indexOf(E);this.deferredZIndexContexts_[B]||(this.deferredZIndexContexts_[B]=[]),this.deferredZIndexContexts_[B].push(L)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Sh);for(let n=0,r=t.length;n<r;++n)e[t[n]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[n]].length=0}}const DR={};function dEe(i){if(DR[i]!==void 0)return DR[i];const e=i*2+1,t=i*i,n=new Array(t+1);for(let s=0;s<=i;++s)for(let o=0;o<=i;++o){const a=s*s+o*o;if(a>t)break;let l=n[a];l||(l=[],n[a]=l),l.push(((i+s)*e+(i+o))*4+3),s>0&&l.push(((i-s)*e+(i+o))*4+3),o>0&&(l.push(((i+s)*e+(i-o))*4+3),s>0&&l.push(((i-s)*e+(i-o))*4+3))}const r=[];for(let s=0,o=n.length;s<o;++s)n[s]&&r.push(...n[s]);return DR[i]=r,r}class AEe extends cj{constructor(e,t,n,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=n,this.transform_=r,this.transformRotation_=r?a3(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=gu()}drawImages_(e,t,n,r){if(!this.image_)return;const s=rd(e,t,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,d=s.length;h<d;h+=2){const _=s[h]-this.imageAnchorX_,x=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const b=_+this.imageAnchorX_,R=x+this.imageAnchorY_;Uh(a,b,R,1,1,u,-b,-R),o.save(),o.transform.apply(o,a),o.translate(b,R),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,n,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=rd(e,t,n,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<n;t+=r){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,u-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u))}}moveToLineTo_(e,t,n,r,s){const o=this.context_,a=rd(e,t,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let u=2;u<l;u+=2)o.lineTo(a[u],a[u+1]);return s&&o.closePath(),n}drawRings_(e,t,n,r){for(let s=0,o=n.length;s<o;++s)t=this.moveToLineTo_(e,t,n[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Vo(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=jbe(e,this.transform_,this.pixelCoordinates_),n=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const n=t.getGeometryFunction()(e);n&&(this.setStyle(t),this.drawGeometry(n))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let n=0,r=t.length;n<r;++n)this.drawGeometry(t[n])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Vo(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(n,0,n.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Vo(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();n.beginPath();for(let l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Vo(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Vo(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const u=s[a];r=this.drawRings_(n,r,u,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,n=this.contextFillState_;n?n.fillStyle!=e.fillStyle&&(n.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=e.lineCap&&(n.lineCap=e.lineCap,t.lineCap=e.lineCap),_d(n.lineDash,e.lineDash)||t.setLineDash(n.lineDash=e.lineDash),n.lineDashOffset!=e.lineDashOffset&&(n.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),n.lineJoin!=e.lineJoin&&(n.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),n.lineWidth!=e.lineWidth&&(n.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),n.miterLimit!=e.miterLimit&&(n.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),n.strokeStyle!=e.strokeStyle&&(n.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,n=this.contextTextState_,r=e.textAlign?e.textAlign:Fy;n?(n.font!=e.font&&(n.font=e.font,t.font=e.font),n.textAlign!=r&&(n.textAlign=r,t.textAlign=r),n.textBaseline!=e.textBaseline&&(n.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const n=e.getColor();this.fillState_={fillStyle:Zu(n||aa)}}if(!t)this.strokeState_=null;else{const n=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Th;this.strokeState_={lineCap:r!==void 0?r:ig,lineDash:this.pixelRatio_===1?h:h.map(d=>d*this.pixelRatio_),lineDashOffset:(o||Eh)*this.pixelRatio_,lineJoin:a!==void 0?a:rg,lineWidth:(l!==void 0?l:ky)*this.pixelRatio_,miterLimit:u!==void 0?u:By,strokeStyle:Zu(n||Uy)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const n=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=t[1]*n,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=t[0]*n}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Zu(x||aa)}}const n=e.getStroke();if(!n)this.textStrokeState_=null;else{const x=n.getColor(),b=n.getLineCap(),R=n.getLineDash(),E=n.getLineDashOffset(),w=n.getLineJoin(),L=n.getWidth(),D=n.getMiterLimit();this.textStrokeState_={lineCap:b!==void 0?b:ig,lineDash:R||Th,lineDashOffset:E||Eh,lineJoin:w!==void 0?w:rg,lineWidth:L!==void 0?L:ky,miterLimit:D!==void 0?D:By,strokeStyle:Zu(x||Uy)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),d=e.getTextAlign(),_=e.getTextBaseline();this.textState_={font:r!==void 0?r:qW,textAlign:d!==void 0?d:Fy,textBaseline:_!==void 0?_:KS},this.text_=h!==void 0?Array.isArray(h)?h.reduce((x,b,R)=>x+=R%2?" ":b,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const ju=.5;function pEe(i,e,t,n,r,s,o,a,l){const u=r,h=i[0]*ju,d=i[1]*ju,_=Rs(h,d);_.imageSmoothingEnabled=!1;const x=_.canvas,b=new AEe(_,ju,r,null,o,a,null),R=t.length,E=Math.floor((256*256*256-1)/R),w={};for(let D=1;D<=R;++D){const O=t[D-1],B=O.getStyleFunction()||n;if(!B)continue;let G=B(O,s);if(!G)continue;Array.isArray(G)||(G=[G]);const z=(D*E).toString(16).padStart(7,"#00000");for(let F=0,q=G.length;F<q;++F){const H=G[F],Q=H.getGeometryFunction()(O);if(!Q||!Vo(u,Q.getExtent()))continue;const K=H.clone(),se=K.getFill();se&&se.setColor(z);const ee=K.getStroke();ee&&(ee.setColor(z),ee.setLineDash(null)),K.setText(void 0);const $=H.getImage();if($){const ne=$.getImageSize();if(!ne)continue;const ye=Rs(ne[0],ne[1],void 0,{alpha:!1}),ve=ye.canvas;ye.fillStyle=z,ye.fillRect(0,0,ve.width,ve.height),K.setImage(new _2({img:ve,anchor:$.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:$.getOrigin(),opacity:1,size:$.getSize(),scale:$.getScale(),rotation:$.getRotation(),rotateWithView:$.getRotateWithView()}))}const re=K.getZIndex()||0;let ae=w[re];ae||(ae={},w[re]=ae,ae.Polygon=[],ae.Circle=[],ae.LineString=[],ae.Point=[]);const _e=Q.getType();if(_e==="GeometryCollection"){const ne=Q.getGeometriesArrayRecursive();for(let ye=0,ve=ne.length;ye<ve;++ye){const Pe=ne[ye];ae[Pe.getType().replace("Multi","")].push(Pe,K)}}else ae[_e.replace("Multi","")].push(Q,K)}}const L=Object.keys(w).map(Number).sort(Sh);for(let D=0,O=L.length;D<O;++D){const B=w[L[D]];for(const G in B){const k=B[G];for(let z=0,F=k.length;z<F;z+=2){b.setStyle(k[z+1]);for(let q=0,H=e.length;q<H;++q)b.setTransform(e[q]),b.drawGeometry(k[z])}}}return _.getImageData(0,0,x.width,x.height)}function mEe(i,e,t){const n=[];if(t){const r=Math.floor(Math.round(i[0])*ju),s=Math.floor(Math.round(i[1])*ju),o=(qr(r,0,t.width-1)+qr(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],h=t.data[o+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/e.length);h&&h%d===0&&n.push(e[h/d-1])}return n}const gEe=.5,fj={Point:EEe,LineString:bEe,Polygon:MEe,MultiPoint:wEe,MultiLineString:SEe,MultiPolygon:TEe,GeometryCollection:xEe,Circle:yEe};function _Ee(i,e){return parseInt(Ui(i),10)-parseInt(Ui(e),10)}function OU(i,e){const t=dj(i,e);return t*t}function dj(i,e){return gEe*i/e}function yEe(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=i.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,n,r)}const a=t.getText();if(a&&a.getText()){const l=i.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n)}}function IU(i,e,t,n,r,s,o,a){const l=[],u=t.getImage();if(u){let _=!0;const x=u.getImageState();x==li.LOADED||x==li.ERROR?_=!1:x==li.IDLE&&u.load(),_&&l.push(u.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const d=l.length>0;return d&&Promise.all(l).then(()=>r(null)),vEe(i,e,t,n,s,o,a),d}function vEe(i,e,t,n,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(n,r);if(t.getRenderer())Aj(i,l,t,e,o);else{const h=fj[l.getType()];h(i,l,t,e,o,s)}}function Aj(i,e,t,n,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Aj(i,o[a],t,n,r);return}i.getBuilder(t.getZIndex(),"Default").drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer(),r)}function xEe(i,e,t,n,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const u=fj[o[a].getType()];u(i,o[a],t,n,r,s)}}function bEe(i,e,t,n,r){const s=t.getStroke();if(s){const a=i.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,n,r)}const o=t.getText();if(o&&o.getText()){const a=i.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,n,r)}}function SEe(i,e,t,n,r){const s=t.getStroke();if(s){const a=i.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,n,r)}const o=t.getText();if(o&&o.getText()){const a=i.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,n,r)}}function TEe(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(o||s){const l=i.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,n,r)}const a=t.getText();if(a&&a.getText()){const l=i.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n,r)}}function EEe(i,e,t,n,r,s){const o=t.getImage(),a=t.getText(),l=a&&a.getText(),u=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=li.LOADED)return;const h=i.getBuilder(t.getZIndex(),"Image");h.setImageStyle(o,u),h.drawPoint(e,n,r)}if(l){const h=i.getBuilder(t.getZIndex(),"Text");h.setTextStyle(a,u),h.drawText(e,n,r)}}function wEe(i,e,t,n,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,l=t.getText(),u=l&&l.getText(),h=s&&a&&u?{}:void 0;if(a){if(o.getImageState()!=li.LOADED)return;const d=i.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawMultiPoint(e,n,r)}if(u){const d=i.getBuilder(t.getZIndex(),"Text");d.setTextStyle(l,h),d.drawText(e,n,r)}}function MEe(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=i.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,n,r)}const a=t.getText();if(a&&a.getText()){const l=i.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n,r)}}class REe extends rj{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ul(),this.wrappedRenderedExtent_=Ul(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,n){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),d=this.getLayer().getSource(),_=this.getLayer().getDeclutter(),x=t.pixelRatio,b=t.viewHints,R=!(b[xo.ANIMATING]||b[xo.INTERACTING]),E=this.context,w=Math.round(ir(r)/a*x),L=Math.round(Ho(r)/a*x),D=d.getWrapX()&&l.canWrapX(),O=D?ir(h):null,B=D?Math.ceil((r[2]-h[2])/O)+1:1;let G=D?Math.floor((r[0]-h[0])/O):0;do{let k=this.getRenderTransform(o,a,0,x,w,L,G*O);t.declutter&&(k=k.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],k,u,R,n===void 0?AA:n?hj:hEe,n?_&&t.declutter[_]:void 0)}while(++G<B)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Rs(this.context.canvas.width,this.context.canvas.height,EU))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,_3(this.context),EU.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const n=e.layerStatesArray[e.layerIndex];this.opacity_=n.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Ml.PRERENDER)||this.getLayer().hasListener(Ml.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&n.extent&&this.clipping){const l=Yf(n.extent);a=Vo(l,e.extent),this.clipped_=a&&!p_(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],d=n[0]*ju,_=n[1]*ju;h.push(this.getRenderTransform(r,s,o,ju,d,_,0).slice());const x=u.getSource(),b=a.getExtent();if(x.getWrapX()&&a.canWrapX()&&!p_(b,l)){let R=l[0];const E=ir(b);let w=0,L;for(;R<b[0];)--w,L=E*w,h.push(this.getRenderTransform(r,s,o,ju,d,_,L).slice()),R+=E;for(w=0,R=l[2];R>b[2];)++w,L=E*w,h.push(this.getRenderTransform(r,s,o,ju,d,_,L).slice()),R-=E}this.hitDetectionImageData_=pEe(n,h,this.renderedFeatures_,u.getStyleFunction(),l,s,o,OU(s,this.renderedPixelRatio_))}t(mEe(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,n,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),u={},h=function(_,x,b){const R=Ui(_),E=u[R];if(E){if(E!==!0&&b<E.distanceSq){if(b===0)return u[R]=!0,s.splice(s.lastIndexOf(E),1),r(_,l,x);E.geometry=x,E.distanceSq=b}}else{if(b===0)return u[R]=!0,r(_,l,x);s.push(u[R]={feature:_,layer:l,geometry:x,distanceSq:b,callback:r})}},d=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,n,h,d?t.declutter?.[d]?.all().map(_=>_.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),n=t.getSource();if(!n)return!1;const r=e.viewHints[xo.ANIMATING],s=e.viewHints[xo.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,d=u.resolution,_=e.pixelRatio,x=t.getRevision(),b=t.getRenderBuffer();let R=t.getRenderOrder();R===void 0&&(R=_Ee);const E=u.center.slice(),w=v6(l,b*d),L=w.slice(),D=[w.slice()],O=h.getExtent();if(n.getWrapX()&&h.canWrapX()&&!p_(O,e.extent)){const se=ir(O),ee=Math.max(ir(w)/2,se);w[0]=O[0]-ee,w[2]=O[2]+ee,hW(E,h);const $=uW(D[0],h);$[0]<O[0]&&$[2]<O[2]?D.push([$[0]+se,$[1],$[2]+se,$[3]]):$[0]>O[0]&&$[2]>O[2]&&D.push([$[0]-se,$[1],$[2]-se,$[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==x&&this.renderedRenderOrder_==R&&this.renderedFrameDeclutter_===!!e.declutter&&p_(this.wrappedRenderedExtent_,w))return _d(this.renderedExtent_,L)||(this.hitDetectionImageData_=null,this.renderedExtent_=L),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const B=new sEe(dj(d,_),w,d,_);let G;for(let se=0,ee=D.length;se<ee;++se)n.loadFeatures(D[se],d,h);const k=OU(d,_);let z=!0;const F=(se,ee)=>{let $;const re=se.getStyleFunction()||t.getStyleFunction();if(re&&($=re(se,d)),$){const ae=this.renderFeature(se,k,$,B,G,this.getLayer().getDeclutter(),ee);z=z&&!ae}},q=vW(w),H=n.getFeaturesInExtent(q);R&&H.sort(R);for(let se=0,ee=H.length;se<ee;++se)F(H[se],se);this.renderedFeatures_=H,this.ready=z;const Q=B.finish(),K=new fEe(w,d,_,n.getOverlaps(),Q,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=x,this.renderedRenderOrder_=R,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=L,this.wrappedRenderedExtent_=w,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=_,this.replayGroup_=K,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,n,r,s,o,a){if(!n)return!1;let l=!1;if(Array.isArray(n))for(let u=0,h=n.length;u<h;++u)l=IU(r,e,n[u],t,this.boundHandleStyleImageChange_,s,o,a)||l;else l=IU(r,e,n,t,this.boundHandleStyleImageChange_,s,o,a);return l}}class BU extends KW{constructor(e){super(e)}createRenderer(){return new REe(this)}}let CEe=!1;function NEe(i,e,t,n,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof i=="function"?i(t,n,r):i,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=CEe,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const u=e.getType();try{let h;u=="text"||u=="json"?h=a.responseText:u=="xml"?h=a.responseXML||a.responseText:u=="arraybuffer"&&(h=a.response),h?s(e.readFeatures(h,{extent:t,featureProjection:r}),e.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function UU(i,e){return function(t,n,r,s,o){NEe(i,e,t,n,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function DEe(i,e){return[[-1/0,-1/0,1/0,1/0]]}class w3 extends bc{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new w3(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ir(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Bi(e,ai.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?PEe(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function PEe(i){if(typeof i=="function")return i;let e;return Array.isArray(i)?e=i:(Ki(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[i]),function(){return e}}function LEe(i,e,t,n){const r=[];let s=Ul();for(let o=0,a=t.length;o<a;++o){const l=t[o];s=x6(i,e,l[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}function FU(i,e,t,n,r,s,o){let a,l;const u=(t-e)/n;if(u===1)a=e;else if(u===2)a=e,l=r;else if(u!==0){let h=i[e],d=i[e+1],_=0;const x=[0];for(let E=e+n;E<t;E+=n){const w=i[E],L=i[E+1];_+=Math.sqrt((w-h)*(w-h)+(L-d)*(L-d)),x.push(_),h=w,d=L}const b=r*_,R=Lxe(x,b);R<0?(l=(b-x[-R-2])/(x[-R-1]-x[-R-2]),a=e+(-R-2)*n):a=e+R*n}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?i[a+h]:Sl(i[a+h],i[a+n+h],l);return s}class tN extends p3{constructor(e,t,n){super(),n!==void 0&&t===void 0?this.setFlatCoordinates(n,e):(t=t||0,this.setCenterAndRadius(e,t,n))}clone(){const e=new tN(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,r){const s=this.flatCoordinates,o=e-s[0],a=t-s[1],l=o*o+a*a;if(l<r){if(l===0)for(let u=0;u<this.stride;++u)n[u]=s[u];else{const u=this.getRadius()/Math.sqrt(l);n[0]=s[0]+u*o,n[1]=s[1]+u*a;for(let h=2;h<this.stride;++h)n[h]=s[h]}return n.length=this.stride,l}return r}containsXY(e,t){const n=this.flatCoordinates,r=e-n[0],s=t-n[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,n=t[this.stride]-t[0];return Bh(t[0]-n,t[1]-n,t[0]+n,t[1]+n,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(Vo(e,t)){const n=this.getCenter();return e[0]<=n[0]&&e[2]>=n[0]||e[1]<=n[1]&&e[3]>=n[1]?!0:b6(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,n=this.flatCoordinates[t]-this.flatCoordinates[0],r=e.slice();r[t]=r[0]+n;for(let s=1;s<t;++s)r[t+s]=e[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(e,t,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=EW(r,0,e,this.stride);r[s++]=r[0]+t;for(let o=1,a=this.stride;o<a;++o)r[s++]=r[o];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const n=this.getCenter(),r=this.getStride();this.setCenter(P6(n,0,n.length,r,e,t,n)),this.changed()}}const kU=gu();class au{constructor(e,t,n,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?oW(this.flatCoordinates_):x6(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=YA(this.getExtent());this.flatInteriorPoints_=O6(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=sSe(this.flatCoordinates_,this.ends_),t=LEe(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=eSe(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=FU(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const n=this.ends_;for(let r=0,s=n.length;r<s;++r){const o=n[r],a=FU(e,t,o,2,.5);_6(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Ta(e);const t=e.getExtent(),n=e.getWorldExtent();if(t&&n){const r=Ho(n)/Ho(t);Uh(kU,n[0],n[3],r,-r,0,0,0),rd(this.flatCoordinates_,0,this.flatCoordinates_.length,2,kU,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new au(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=JH((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const n=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":n.length=L6(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,n,0),r=[n.length];break;case"MultiLineString":r=[],n.length=Kbe(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,n,0,r);break;case"Polygon":r=[],n.length=MW(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),n,0,r);break}return r&&(this.simplifiedGeometry_=new au(this.type_,n,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}au.prototype.getFlatCoordinates=au.prototype.getOrientedFlatCoordinates;class GU{constructor(e){this.rbush_=new UW(e),this.items_={}}insert(e,t){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[Ui(t)]=n}load(e,t){const n=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[r]=l,this.items_[Ui(a)]=l}this.rbush_.load(n)}remove(e){const t=Ui(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null}update(e,t){const n=this.items_[Ui(t)],r=[n.minX,n.minY,n.maxX,n.maxY];Py(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let n;for(let r=0,s=e.length;r<s;r++)if(n=t(e[r]),n)return n;return n}isEmpty(){return Jm(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Bh(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}const _l={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Ff extends Vh{constructor(e,t,n){super(e),this.feature=t,this.features=n}}class zU extends lj{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Dy,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Ki(this.format_,"`format` must be set when `url` is set"),this.loader_=UU(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:DEe;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new GU:null,this.loadedExtentsRtree_=new GU,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,r;Array.isArray(e.features)?r=e.features:e.features&&(n=e.features,r=n.getArray()),!t&&n===void 0&&(n=new Ku(r)),r!==void 0&&this.addFeaturesInternal(r),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=Ui(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const n=e.getGeometry();if(n){const r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Ff(_l.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof au||(this.featureChangeKeys_[e]=[Bi(t,ai.CHANGE,this.handleFeatureChange_,this),Bi(t,Zm.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let n=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof au){const s=this.idIndex_[r];s instanceof au?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:n=!1}else n=!1}return n&&(Ki(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),n}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],n=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=Ui(a);this.addToIndex_(l,a)&&n.push(a)}for(let s=0,o=n.length;s<o;s++){const a=n[s],l=Ui(a);this.setupChangeEvents_(l,a);const u=a.getGeometry();if(u){const h=u.getExtent();t.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(_l.ADDFEATURE))for(let s=0,o=n.length;s<o;s++)this.dispatchEvent(new Ff(_l.ADDFEATURE,n[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(_l.ADDFEATURE,function(n){t||(t=!0,e.push(n.feature),t=!1)}),this.addEventListener(_l.REMOVEFEATURE,function(n){t||(t=!0,e.remove(n.feature),t=!1)}),e.addEventListener(sa.ADD,n=>{t||(t=!0,this.addFeature(n.element),t=!1)}),e.addEventListener(sa.REMOVE,n=>{t||(t=!0,this.removeFeature(n.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(Ir);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(n=>{this.removeFeatureInternal(n)});for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Ff(_l.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const n=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(n,function(r){const s=r.getGeometry();if(s instanceof au||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(n){const r=n.getGeometry();if(r instanceof au||r.intersectsExtent(e)){const s=t(n);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Jm(this.nullGeometryFeatures_)||_6(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(n){t.push(n)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=cW(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const n=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||Ny,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),d=a;if(a=h instanceof au?0:h.closestPointXY(n,r,o,a),a<d){s=u;const _=Math.sqrt(a);l[0]=n-_,l[1]=r-_,l[2]=n+_,l[3]=r+_}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,n=Ui(t),r=t.getGeometry();if(!r)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[n]=t);else{const o=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[n]=t;this.changed(),this.dispatchEvent(new Ff(_l.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:Ui(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Jm(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,n){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,n);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return p_(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ff(_l.FEATURESLOADSTART)),this.loader_.call(this,l,t,n,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ff(_l.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ff(_l.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,n=t.forEachInExtent(e,function(r){if(Py(r.extent,e))return r});n&&t.remove(n)}removeFeatures(e){let t=!1;for(let n=0,r=e.length;n<r;++n)t=this.removeFeatureInternal(e[n])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=Ui(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Ir),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(_l.REMOVEFEATURE)&&this.dispatchEvent(new Ff(_l.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Ki(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(UU(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}const OEe="_Container_1r42f_1",IEe="_Bubble_1r42f_16",BEe="_BubbleShow_1r42f_25",UEe="_BubbleHide_1r42f_29",mb={Container:OEe,Bubble:IEe,BubbleShow:BEe,BubbleHide:UEe},FEe=()=>{const[i,e]=On.useState([]),[t,n]=On.useState(-1),[r,s]=On.useState(-1),o=u=>{console.log("new message: ",u);const h=i.slice();h.push(u),setTimeout(()=>{s(r+1)},3e3),setTimeout(()=>{n(t+1)},4e3),e(h)},a=u=>{o(u.message)},l=u=>{o(u.message)};return Km("InfoMessage",a),Km("ErrorMessage",l),On.useEffect(()=>{console.warn("new message has arrived",i),console.log(t,r,i.length)},[i]),rs.jsx("div",{className:mb.Container,children:i.slice(t).map((u,h)=>rs.jsx("p",{className:`${mb.Bubble} ${h<=r?mb.BubbleHide:mb.BubbleShow}`,children:u},u))})},kEe="_Container_stgi2_1",GEe="_Input_stgi2_16",VU={Container:kEe,Input:GEe},zEe="api.openf1.org",VEe="v1";let gb=Date.now();const PR=1e3;async function nN(i){if(console.log(new Date(gb+PR),new Date,gb<Date.now()),gb+PR>Date.now()){const e=PR;return new Promise(t=>{setTimeout(async()=>{t(await nN(i))},e)})}else return gb=Date.now(),await fetch(`https://${zEe}/${VEe}/${i}`)}async function qEe(i){const e=await nN(`drivers?session_key=${i}`);return e.status!==200?[[],{status:e.status,message:e.statusText}]:[await e.json(),null]}async function HEe(i,e){const t=new Date(i.getTime()+e*1e3),n=await nN(`location?session_key=9693&date>${i.toISOString()}&date<${t.toISOString()}`);return n.status===401?[await(await fetch("example.json")).json(),null]:n.status!==200?[[],{status:n.status,message:n.statusText}]:[await n.json(),null]}async function WEe(i,e){const t=(e.getTime()-i.getTime())/1e3,[n,r]=await HEe(i,t);return r&&console.error("Error while fetching chunk."),n}async function jEe(i,e,t){const n=new Date(i.getTime()),r=[];for(;n.getTime()<e.getTime();){const s=new Date(n.getTime()+t*1e3),o=await WEe(n,s);r.push(...o),n.setTime(s.getTime())}return r}function XEe(i){const e={timestamp:i.at(0).date,locations:new Map};return i.forEach(t=>{const{x:n,y:r,z:s}=t;e.locations.set(t.driver_number,{x:n,y:r,z:s})}),e}async function $Ee(i){let e=i.at(0).date,t=[];const n=[];return i.forEach(r=>{if(r.date!=e){const s=XEe(t.slice());n.push(s),t=[],e=r.date}t.push(r)}),n}const Qp=new Date("2025-03-16T04:00:00+00:00"),iN=new Date("2025-03-16T04:10:00+00:00"),rN=3.7,N4=1e3/rN,qU=(iN.getTime()-Qp.getTime())/N4;var HU;const YEe=Math.round((iN.getTime()-Qp.getTime())/1e3*rN),QEe=({origin:i,driverLayer:e})=>{const[t,n]=On.useState(!1),[r,s]=On.useState(0),[o,a]=On.useState(Qp),[l,u]=On.useState(new Array(YEe)),[h,d]=On.useState(new Map),_=i3(),x=D=>{s(Number(D.target.value))},b=D=>{const O=Qp.getTime()+D*N4;console.debug(`start: ${Qp.getTime()}, value: ${D}, interpolatedTime: ${O}, diff: ${D*N4}`);const B=new Date(O);return a(B),B},R=()=>{const D=l.at(r),O=.128;if(!D)return;const B=e.getSource();B.clear(),D.locations.forEach((G,k)=>{const z=N6(i,sg),F=new tN(z,20);F.translate(G.x*O+30,G.y*O+170);const q=h.get(k)?.name_acronym||"",H=h.get(k)?.team_colour||"";console.log(k,h.get(k)),B.addFeature(new w3({geometry:F,image:"red-pin.svg",driver:k,driver_name:q,driver_colour:H}))})},E=On.useRef(r),w=D=>{if(console.log(`timer is ${D?"enabled":"disabled"}`),clearInterval(HU),n(D),!D||E.current>qU)return;const O=1/rN;HU=setInterval(()=>{s(E.current+1)},O*1e3)};On.useEffect(()=>{},[o]);const L=On.useRef(0);return On.useEffect(()=>{if(L.current=L.current+1,L.current>1)return;(async()=>{_("InfoMessage",{message:"Loading session data..."});const O=await jEe(Qp,iN,120),B=await $Ee(O);console.log(O.length,O.at(0)),console.log(B.length,B.slice(0,10)),u(B);const[G,k]=await qEe(9693);k&&(_("ErrorMessage",{message:`Unable to get driver data: ${k.message}. Please try again later.`}),console.error("unable to get driver data.",k));const z=new Map;G.forEach(F=>{z.set(F.driver_number,F)}),d(z),_("InfoMessage",{message:"Session loaded!"})})()},[]),On.useEffect(()=>{console.log(h)},[h]),On.useEffect(()=>{console.log(l.length,l.slice(0,10))},[l]),On.useEffect(()=>{console.debug(`time: ${o.toISOString()}, value: ${r}`),a(b(r)),R()},[r]),rs.jsxs("div",{className:VU.Container,children:[rs.jsx("input",{className:VU.Input,type:"range",min:0,max:qU,value:r,onChange:x}),t?rs.jsx("input",{type:"button",value:"PAUSE",onClick:()=>{w(!1)}}):rs.jsx("input",{type:"button",value:"PLAY",onClick:()=>{w(!0)}})]})},WU=[144.97,-37.8503];function KEe(){const i=i3(),e=On.useRef(1),t=(a,l)=>{const u=l.getView().getZoom();e.current=l.getView().getResolution();const h=Y3e(l.getView().getCenter());u<10&&i("toggle3DGlobe",{visible:!0,lng:h[0],lat:h[1],altitude:.3})},n=new zU,r=new BU({style:a=>{const l=a;return new wh({image:new _2({anchor:[.48,.75],opacity:1,src:l.get("image")||"red-pin.svg",height:2350/e.current}),fill:new sd({color:"#5556"}),stroke:new UA({color:"orange",width:2,miterLimit:2})})},source:n});VS.tracks.forEach(a=>{const l=new m3(N6([a.lng,a.lat],sg));n.addFeature(new w3({geometry:l,image:a.image}))});const s=new zU,o=new BU({style:a=>new wh({zIndex:a.get("driver_position")||a.get("driver")||0,fill:new sd({color:"#FFFFFF"}),stroke:new UA({color:`#${a.get("driver_colour")||"333"}`,width:6,miterLimit:2}),text:new S3({justify:"center",textBaseline:"top",offsetY:-4.5,font:"bold 9pt  sans-serif",fill:new sd({color:"#222"}),padding:[2,4,2,4],text:`${a.get("driver")}
${a.get("driver_name")}`,stroke:new UA({color:"#FFFFFF",width:4,miterLimit:2})})}),source:s});return rs.jsxs(rs.Fragment,{children:[rs.jsx(Z3e,{layers:[r,o],mapCenter:WU,onClick:void 0,onInit:void 0,onMove:t,duringMove:t}),rs.jsx(wxe,{}),rs.jsxs(Nxe,{children:[rs.jsx(QEe,{origin:WU,driverLayer:o}),rs.jsx(FEe,{})]})]})}LX.createRoot(document.getElementById("root")).render(rs.jsx(On.StrictMode,{children:rs.jsx(KEe,{})}));
